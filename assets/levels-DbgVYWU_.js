import{k as R,l as S,m as D,n as E,b as G,M as F,u as g}from"./time-DcZILhUt.js";const z="/dumpster/assets/alley_one-Ch0po_m1.jpg",_="/dumpster/assets/alley_two-D6HTRiqu.png",M="/dumpster/assets/house-BZR3Z7t1.png",h=5,O=R(e=>({isPaused:!1,pause:()=>e({isPaused:!0}),play:()=>e({isPaused:!1}),currentLevel:"playground",setCurrentLevel:t=>e({currentLevel:t})})),p=new Set,y=new Set,b=new Set;let f=!1,w,k;function x(e){const t=e.toLowerCase();return t==="space"?" ":t==="enter"?"Enter":e}function N(){f||(f=!0,w=e=>{const t=e.key;p.has(t)||y.add(t),p.add(t)},k=e=>{const t=e.key;p.delete(t),b.add(t)},window.addEventListener("keydown",w),window.addEventListener("keyup",k))}function H(){f&&(window.removeEventListener("keydown",w),window.removeEventListener("keyup",k),f=!1,p.clear(),y.clear(),b.clear())}function I(e){return p.has(x(e))}function X(e){return y.has(x(e))}function A(e){return b.has(x(e))}function U(){y.clear(),b.clear()}const m={init:N,cleanup:H,isKeyDown:I,isKeyPressed:X,isKeyReleased:A,clearPressedAndReleased:U},v={first:!0};function B(e){if(!v.first)return;v.first=!1;let t=0,a=0;const{k:s,game:n}=L(e);return S.getState().setKeyDownFunction(m.isKeyDown),S.getState().setKeyPressedFunction(m.isKeyPressed),S.getState().setKeyReleasedFunction(m.isKeyReleased),D.getState().setMousePosFunction(()=>s.mousePos()),E.getState().setTimeFunction(()=>s.time()-a),E.getState().setDeltaTimeFunction(()=>s.dt()),s.onUpdate(()=>{if(O.getState().isPaused){n.paused||(t=s.time()),n.paused=!0;return}n.paused&&(a+=s.time()-t,t=0,n.paused=!1),G.getState().compute(),m.clearPressedAndReleased()}),s}let i;function L(e){if(i)return i;const t=F({global:!1,pixelDensity:2,touchToMouse:!0,debug:!1,debugKey:"f1",canvas:e}),a=t.add([t.timer()]);return i={k:t,game:a},i}function Z(){i&&(i=void 0,v.first=!0)}const j=()=>{const{k:e,game:t}=L();e.loadBean();const a=t.add([e.sprite("bean"),e.pos(20,130)]),s=t.add([e.sprite("bean"),e.color(0,0,0),e.pos(400,400),e.scale(.5),e.area()]);s.tag("trashCan"),t.add([e.sprite("bean"),e.color(255,0,0),e.pos(600,100),e.scale(4,.5),e.area()]).tag("finishLine"),e.onCollide("trashCan","finishLine",(o,l)=>{console.log("Collided with finish line")}),t.onUpdate(()=>{var r,c,d,u;if(O.getState().isPaused)return;const o=g.getState().gameObjects;a.pos.x=(a.pos.x+1)%1e3;const{access:l}=o.get("raccoon").get("xpos");o.get("raccoon").set("xpos",{access:l,value:a.pos.x}),s.pos.x=((c=(r=o.get("trashcan"))==null?void 0:r.get("xpos"))==null?void 0:c.value)??0,s.pos.y=((u=(d=o.get("trashcan"))==null?void 0:d.get("ypos"))==null?void 0:u.value)??0})},V=()=>{const{k:e,game:t}=L();e.loadSprite("background1","/game/backgrounds/background1.png"),e.loadSprite("background1light","/game/backgrounds/background1_light.png"),t.add([e.sprite("background1"),e.anchor("bot"),e.scale(e.height()*(1/180)),e.pos(0,0),e.z(0)]),t.add([e.sprite("background1light"),e.anchor("bot"),e.scale(e.height()*(1/180)),e.pos(e.width()/2+200,0),e.z(100),e.opacity(.75)]),e.loadSprite("raccoon","/game/sprites/raccoon_spritesheet.png",{sliceX:4,sliceY:4,anims:{idle:{from:0,to:0,loop:!1},idleHolding:{from:1,to:1,loop:!1},walk:{from:2,to:7,loop:!0},walkHolding:{from:8,to:13,loop:!0}}}),e.loadSprite("trashcan","/game/sprites/trashcan_spritesheet.png",{sliceX:2,sliceY:1,anims:{empty:{from:0,to:0,loop:!1},filled:{from:1,to:1,loop:!1}}}),e.loadSprite("flag","/game/sprites/flag_spritesheet.png",{sliceX:2,sliceY:2,anims:{default:{from:0,to:3,loop:!0}}});const a=t.add([e.sprite("raccoon",{anim:"walkHolding"}),e.pos(0,0),e.scale(h),e.anchor("bot"),e.z(2),e.state("idle",["idle","walkLeft","walkRight"])]);a.onStateEnter("idle",()=>{a.play("idle")}),a.onStateEnter("walkLeft",()=>{a.play("walk"),a.scaleTo(e.vec2(-5,h))}),a.onStateEnter("walkRight",()=>{a.play("walk"),a.scaleTo(e.vec2(h,h))});const s=t.add([e.sprite("trashcan",{anim:"filled"}),e.anchor("bot"),e.pos(0,0),e.scale(5),e.z(1)]);t.add([e.sprite("flag",{anim:"default"}),e.anchor("bot"),e.pos(200,0),e.scale(5),e.z(1)]),t.onUpdate(()=>{var r,c,d,u,T,P,K,C;const n=a.pos.x;a.pos.x=((c=(r=g.getState().gameObjects.get("raccoon"))==null?void 0:r.get("xpos"))==null?void 0:c.value)??0,a.pos.y=((u=(d=g.getState().gameObjects.get("raccoon"))==null?void 0:d.get("ypos"))==null?void 0:u.value)??0,s.pos.x=((P=(T=g.getState().gameObjects.get("trashcan"))==null?void 0:T.get("xpos"))==null?void 0:P.value)??0,s.pos.y=((C=(K=g.getState().gameObjects.get("trashcan"))==null?void 0:K.get("ypos"))==null?void 0:C.value)??0,e.setCamPos(a.pos.add(0,-e.height()/2));const o=a.pos.x-n,l=o===0?"idle":o<0?"walkLeft":"walkRight";a.state!==l&&a.enterState(l)})},q={playground:{id:"playground",name:"Playground",description:"This is a sandbox level where you can freely test game mechanics.",dialog:["This is a playground level where you can test your game mechanics.","Use of all nodes is permitted."],goals:["Test all features freely.","Experiment with different setups.","No restrictions in this mode."],category:"Sandbox",image:z,nodes:[],edges:[],initialState:V,solution:{nodes:[],edges:[]},hints:[],modifiableGameObjects:[{id:"raccoon",connections:[{label:"xpos",access:"all"},{label:"ypos",access:"all"}]},{id:"trashcan",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]}],availableNodes:["Value","Display","Time","KeyPress","MathFloat","ExportToGameobject","ImportFromGameobject","Switch","Group","ForLoop","MousePosition"]},"1.1":{id:"1.1",name:"Level 1.1",description:"This is the first level of the game, introducing basic mechanics.",dialog:["This is the first level of the game. It introduces the basic mechanics and objectives."],goals:["Create a character controller for the raccoon.","Navigate the raccoon to the goal flag."],category:"Introduction",image:_,nodes:[],edges:[],initialState:j,solution:{nodes:[],edges:[]},hints:[],modifiableGameObjects:[{id:"raccoon",connections:[{label:"xpos",access:"get"}]},{id:"trashcan",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]}],availableNodes:["Value","Display","MathFloat","ExportToGameobject"]},"1.2":{id:"1.2",name:"Level 1.2",description:"This is the second level of the game, building upon Level 1.1.",dialog:["This is the second level of the game. It builds upon the mechanics introduced in Level 1.1."],goals:["No goals defined yet."],category:"Introduction",image:M,nodes:[],edges:[],initialState:j,solution:{nodes:[],edges:[]},hints:[],modifiableGameObjects:[],availableNodes:["Display"]}};export{q as L,Z as c,m as g,B as i,O as u};
