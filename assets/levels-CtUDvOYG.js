import{k as E,l as k,m as F,n as P,b as O,M as j,u}from"./time-DcZILhUt.js";const G="/dumpster/assets/alley_one-Ch0po_m1.jpg",R="/dumpster/assets/alley_two-D6HTRiqu.png",D="/dumpster/assets/house-BZR3Z7t1.png",p=5,h=300,C=E(t=>({isPaused:!1,pause:()=>t({isPaused:!0}),play:()=>t({isPaused:!1}),currentLevel:"playground",setCurrentLevel:e=>t({currentLevel:e})})),d=new Set,y=new Set,b=new Set;let m=!1,S,w;function x(t){const e=t.toLowerCase();return e==="space"?" ":e==="enter"?"Enter":t}function _(){m||(m=!0,S=t=>{const e=t.key;d.has(e)||y.add(e),d.add(e)},w=t=>{const e=t.key;d.delete(e),b.add(e)},window.addEventListener("keydown",S),window.addEventListener("keyup",w))}function z(){m&&(window.removeEventListener("keydown",S),window.removeEventListener("keyup",w),m=!1,d.clear(),y.clear(),b.clear())}function N(t){return d.has(x(t))}function M(t){return y.has(x(t))}function H(t){return b.has(x(t))}function I(){y.clear(),b.clear()}const f={init:_,cleanup:z,isKeyDown:N,isKeyPressed:M,isKeyReleased:H,clearPressedAndReleased:I},v={first:!0};function V(t){if(!v.first)return;v.first=!1;let e=0,o=0;const{k:s,game:a}=g(t);return k.getState().setKeyDownFunction(f.isKeyDown),k.getState().setKeyPressedFunction(f.isKeyPressed),k.getState().setKeyReleasedFunction(f.isKeyReleased),F.getState().setMousePosFunction(()=>s.mousePos()),P.getState().setTimeFunction(()=>s.time()-o),P.getState().setDeltaTimeFunction(()=>s.dt()),s.onUpdate(()=>{if(C.getState().isPaused){a.paused||(e=s.time()),a.paused=!0;return}a.paused&&(o+=s.time()-e,e=0,a.paused=!1),O.getState().compute(),f.clearPressedAndReleased()}),s}let r;function g(t){if(r)return r;const e=j({global:!1,pixelDensity:2,touchToMouse:!0,debug:!1,debugKey:"f1",canvas:t,background:"#2b292f"}),o=e.add([e.timer()]);return r={k:e,game:o},r}function Z(){r&&(r=void 0,v.first=!0)}const K=()=>{const{k:t,game:e}=g();t.loadBean();const o=e.add([t.sprite("bean"),t.pos(20,130)]),s=e.add([t.sprite("bean"),t.color(0,0,0),t.pos(400,400),t.scale(.5),t.area()]);s.tag("trashCan"),e.add([t.sprite("bean"),t.color(255,0,0),t.pos(600,100),t.scale(4,.5),t.area()]).tag("finishLine"),t.onCollide("trashCan","finishLine",(n,i)=>{console.log("Collided with finish line")}),e.onUpdate(()=>{var l,c,L,T;if(C.getState().isPaused)return;const n=u.getState().gameObjects;o.pos.x=(o.pos.x+1)%1e3;const{access:i}=n.get("raccoon").get("xpos");n.get("raccoon").set("xpos",{access:i,value:o.pos.x}),s.pos.x=((c=(l=n.get("trashcan"))==null?void 0:l.get("xpos"))==null?void 0:c.value)??0,s.pos.y=((T=(L=n.get("trashcan"))==null?void 0:L.get("ypos"))==null?void 0:T.value)??0})};function A(t){const{k:e,game:o}=g(),s={};if(t.includes("raccoon")){e.loadSprite("raccoon","/game/sprites/raccoon_spritesheet.png",{sliceX:4,sliceY:4,anims:{idle:{from:0,to:0,loop:!1},idleHolding:{from:1,to:1,loop:!1},walk:{from:2,to:7,loop:!0},walkHolding:{from:8,to:13,loop:!0}}});const a=o.add([e.sprite("raccoon",{anim:"walkHolding"}),e.pos(0,0),e.scale(p),e.anchor("bot"),e.z(2),e.state("idle",["idle","walkLeft","walkRight"])]);a.onStateEnter("idle",()=>{a.play("idle")}),a.onStateEnter("walkLeft",()=>{a.play("walk"),a.scaleTo(e.vec2(-5,p))}),a.onStateEnter("walkRight",()=>{a.play("walk"),a.scaleTo(e.vec2(p,p))}),s.raccoon=a}if(t.includes("trashcan")){e.loadSprite("trashcan","/game/sprites/trashcan_spritesheet.png",{sliceX:2,sliceY:1,anims:{empty:{from:0,to:0,loop:!1},filled:{from:1,to:1,loop:!1}}});const a=o.add([e.sprite("trashcan",{anim:"filled"}),e.anchor("bot"),e.pos(0,0),e.scale(5),e.z(1)]);s.trashcan=a}if(t.includes("goalFlag")){e.loadSprite("flag","/game/sprites/flag_spritesheet.png",{sliceX:2,sliceY:2,anims:{default:{from:0,to:3,loop:!0}}});const a=o.add([e.sprite("flag",{anim:"default"}),e.anchor("bot"),e.pos(200,0),e.scale(5),e.z(1)]);s.goalFlag=a}return s}function U(t){const{k:e,game:o}=g();t.includes("background1")&&(e.loadSprite("background1","/game/backgrounds/background1.png"),e.loadSprite("background1light","/game/backgrounds/background1_light.png"),o.add([e.sprite("background1"),e.anchor("bot"),e.scale(8),e.pos(0,h),e.z(0)]),o.add([e.sprite("background1light"),e.anchor("bot"),e.scale(8),e.pos(0,h),e.z(100),e.opacity(.75)]))}function X(t,e){var n,i,l,c;const o=t.pos.x;t.pos.x=((i=(n=u.getState().gameObjects.get("raccoon"))==null?void 0:n.get("xpos"))==null?void 0:i.value)??0,t.pos.y=((c=(l=u.getState().gameObjects.get("raccoon"))==null?void 0:l.get("ypos"))==null?void 0:c.value)??0,e.setCamPos(e.lerp(e.getCamPos(),t.pos.add(0,-e.height()/2+h),.1));const s=t.pos.x-o,a=s===0?"idle":s<0?"walkLeft":"walkRight";t.state!==a&&t.enterState(a)}const B=()=>{const{k:t,game:e}=g();U(["background1"]);const{raccoon:o,trashcan:s,goalFlag:a}=A(["raccoon","trashcan","goalFlag"]);t.setCamPos(o.pos.add(0,-t.height()/2+h)),e.onUpdate(()=>{var n,i,l,c;X(o,t),s.pos.x=((i=(n=u.getState().gameObjects.get("trashcan"))==null?void 0:n.get("xpos"))==null?void 0:i.value)??0,s.pos.y=((c=(l=u.getState().gameObjects.get("trashcan"))==null?void 0:l.get("ypos"))==null?void 0:c.value)??0})},q={playground:{id:"playground",name:"Playground",description:"This is a sandbox level where you can freely test game mechanics.",dialog:["This is a playground level where you can test your game mechanics.","Use of all nodes is permitted."],goals:["Test all features freely.","Experiment with different setups.","No restrictions in this mode."],category:"Sandbox",image:G,nodes:[],edges:[],initialState:B,solution:{nodes:[],edges:[]},hints:["This is a playground level","You don't need hints here","stop clicking there is nothing coming","42"],modifiableGameObjects:[{id:"raccoon",connections:[{label:"xpos",access:"all"},{label:"ypos",access:"all"}]},{id:"trashcan",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]}],availableNodes:["Value","Display","Time","KeyPress","MathFloat","ExportToGameobject","ImportFromGameobject","Switch","Group","ForLoop","MousePosition"]},"1.1":{id:"1.1",name:"Level 1.1",description:"This is the first level of the game, introducing basic mechanics.",dialog:["This is the first level of the game. It introduces the basic mechanics and objectives."],goals:["Create a character controller for the raccoon.","Navigate the raccoon to the goal flag."],category:"Introduction",image:R,nodes:[],edges:[],initialState:K,solution:{nodes:[],edges:[]},hints:[],modifiableGameObjects:[{id:"raccoon",connections:[{label:"xpos",access:"get"}]},{id:"trashcan",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]}],availableNodes:["Value","Display","MathFloat","ExportToGameobject"]},"1.2":{id:"1.2",name:"Level 1.2",description:"This is the second level of the game, building upon Level 1.1.",dialog:["This is the second level of the game. It builds upon the mechanics introduced in Level 1.1."],goals:["No goals defined yet."],category:"Introduction",image:D,nodes:[],edges:[],initialState:K,solution:{nodes:[],edges:[]},hints:[],modifiableGameObjects:[],availableNodes:["Display"]}};export{q as L,Z as c,f as g,V as i,C as u};
