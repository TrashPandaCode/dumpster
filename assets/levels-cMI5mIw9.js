import{k as R,l as b,m as C,n as P,b as D,M as G,u as g}from"./time-DcZILhUt.js";const F="/dumpster/assets/alley_one-Ch0po_m1.jpg",O="/dumpster/assets/alley_two-D6HTRiqu.png",z="/dumpster/assets/house-BZR3Z7t1.png",E=R(e=>({isPaused:!1,pause:()=>e({isPaused:!0}),play:()=>e({isPaused:!1}),currentLevel:"playground",setCurrentLevel:t=>e({currentLevel:t})})),p=new Set,m=new Set,y=new Set;let h=!1,w,S;function v(e){const t=e.toLowerCase();return t==="space"?" ":t==="enter"?"Enter":e}function M(){h||(h=!0,w=e=>{const t=e.key;p.has(t)||m.add(t),p.add(t)},S=e=>{const t=e.key;p.delete(t),y.add(t)},window.addEventListener("keydown",w),window.addEventListener("keyup",S))}function _(){h&&(window.removeEventListener("keydown",w),window.removeEventListener("keyup",S),h=!1,p.clear(),m.clear(),y.clear())}function N(e){return p.has(v(e))}function H(e){return m.has(v(e))}function I(e){return y.has(v(e))}function U(){m.clear(),y.clear()}const f={init:M,cleanup:_,isKeyDown:N,isKeyPressed:H,isKeyReleased:I,clearPressedAndReleased:U},k={first:!0};function Y(e){if(!k.first)return;k.first=!1;let t=0,s=0;const{k:a,game:o}=x(e);return b.getState().setKeyDownFunction(f.isKeyDown),b.getState().setKeyPressedFunction(f.isKeyPressed),b.getState().setKeyReleasedFunction(f.isKeyReleased),C.getState().setMousePosFunction(()=>a.mousePos()),P.getState().setTimeFunction(()=>a.time()-s),P.getState().setDeltaTimeFunction(()=>a.dt()),a.onUpdate(()=>{if(E.getState().isPaused){o.paused||(t=a.time()),o.paused=!0;return}o.paused&&(s+=a.time()-t,t=0,o.paused=!1),D.getState().compute(),f.clearPressedAndReleased()}),a}let i;function x(e){if(i)return i;const t=G({global:!1,pixelDensity:2,touchToMouse:!0,debug:!1,debugKey:"f1",canvas:e}),s=t.add([t.timer()]);return i={k:t,game:s},i}function A(){i&&(i=void 0,k.first=!0)}const j=()=>{const{k:e,game:t}=x();e.loadBean();const s=t.add([e.sprite("bean"),e.pos(20,130)]),a=t.add([e.sprite("bean"),e.color(0,0,0),e.pos(400,400),e.scale(.5),e.area()]);a.tag("trashCan"),t.add([e.sprite("bean"),e.color(255,0,0),e.pos(600,100),e.scale(4,.5),e.area()]).tag("finishLine"),e.onCollide("trashCan","finishLine",(n,l)=>{console.log("Collided with finish line")}),t.onUpdate(()=>{var r,c,d,u;if(E.getState().isPaused)return;const n=g.getState().gameObjects;s.pos.x=(s.pos.x+1)%1e3;const{access:l}=n.get("raccoon").get("xpos");n.get("raccoon").set("xpos",{access:l,value:s.pos.x}),a.pos.x=((c=(r=n.get("trashcan"))==null?void 0:r.get("xpos"))==null?void 0:c.value)??0,a.pos.y=((u=(d=n.get("trashcan"))==null?void 0:d.get("ypos"))==null?void 0:u.value)??0})},X=()=>{const{k:e,game:t}=x();e.loadSprite("background1","/game/backgrounds/background1.png"),e.loadSprite("background1light","/game/backgrounds/background1_light.png"),t.add([e.sprite("background1"),e.anchor("top"),e.scale(e.height()*(1/180)),e.pos(e.width()/2+400,0),e.z(0)]),t.add([e.sprite("background1light"),e.anchor("top"),e.scale(e.height()*(1/180)),e.pos(e.width()/2+200,0),e.z(100),e.opacity(.75)]),e.loadSprite("raccoon","/game/sprites/raccoon_spritesheet.png",{sliceX:4,sliceY:4,anims:{idle:{from:0,to:0,loop:!1},idleHolding:{from:1,to:1,loop:!1},walk:{from:2,to:7,loop:!0},walkHolding:{from:8,to:13,loop:!0}}}),e.loadSprite("trashcan","/game/sprites/trashcan_spritesheet.png",{sliceX:2,sliceY:1,anims:{empty:{from:0,to:0,loop:!1},filled:{from:1,to:1,loop:!1}}}),e.loadSprite("flag","/game/sprites/flag_spritesheet.png",{sliceX:2,sliceY:2,anims:{default:{from:0,to:3,loop:!0}}});const s=5,a=t.add([e.sprite("raccoon",{anim:"walkHolding"}),e.pos(100,e.height()-100),e.scale(s),e.anchor("bot"),e.z(2),e.state("idle",["idle","walkLeft","walkRight"])]);a.onStateEnter("idle",()=>{a.play("idle")}),a.onStateEnter("walkLeft",()=>{a.play("walk"),a.scaleTo(e.vec2(-5,s))}),a.onStateEnter("walkRight",()=>{a.play("walk"),a.scaleTo(e.vec2(s,s))});const o=t.add([e.sprite("trashcan",{anim:"filled"}),e.pos(200,200),e.scale(5),e.z(1)]);t.add([e.sprite("flag",{anim:"default"}),e.pos(0,0),e.scale(5),e.z(1)]),t.onUpdate(()=>{var l,r,c,d,u,L,T,K;const n=a.pos.x;a.pos.x=((r=(l=g.getState().gameObjects.get("raccoon"))==null?void 0:l.get("xpos"))==null?void 0:r.value)??0,a.pos.y=((d=(c=g.getState().gameObjects.get("raccoon"))==null?void 0:c.get("ypos"))==null?void 0:d.value)??0,o.pos.x=((L=(u=g.getState().gameObjects.get("trashcan"))==null?void 0:u.get("xpos"))==null?void 0:L.value)??0,o.pos.y=((K=(T=g.getState().gameObjects.get("trashcan"))==null?void 0:T.get("ypos"))==null?void 0:K.value)??0,a.pos.x-n==0?a.state!="idle"&&a.enterState("idle"):a.pos.x-n<0?a.state!="walkLeft"&&a.enterState("walkLeft"):a.state!="walkRight"&&a.enterState("walkRight")})},B={playground:{id:"playground",name:"Playground",description:"This is a sandbox level where you can freely test game mechanics.",dialog:["This is a playground level where you can test your game mechanics.","Use of all nodes is permitted."],goals:["Test all features freely.","Experiment with different setups.","No restrictions in this mode."],category:"Sandbox",image:F,nodes:[],edges:[],initialState:X,solution:{nodes:[],edges:[]},hints:[],modifiableGameObjects:[{id:"raccoon",connections:[{label:"xpos",access:"all"},{label:"ypos",access:"all"}]},{id:"trashcan",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]}],availableNodes:["Value","Display","Time","KeyPress","MathFloat","ExportToGameobject","ImportFromGameobject","Switch","Group","ForLoop","MousePosition"]},"1.1":{id:"1.1",name:"Level 1.1",description:"This is the first level of the game, introducing basic mechanics.",dialog:["This is the first level of the game. It introduces the basic mechanics and objectives."],goals:["Create a character controller for the raccoon.","Navigate the raccoon to the goal flag."],category:"Introduction",image:O,nodes:[],edges:[],initialState:j,solution:{nodes:[],edges:[]},hints:[],modifiableGameObjects:[{id:"raccoon",connections:[{label:"xpos",access:"get"}]},{id:"trashcan",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]}],availableNodes:["Value","Display","MathFloat","ExportToGameobject"]},"1.2":{id:"1.2",name:"Level 1.2",description:"This is the second level of the game, building upon Level 1.1.",dialog:["This is the second level of the game. It builds upon the mechanics introduced in Level 1.1."],goals:["No goals defined yet."],category:"Introduction",image:z,nodes:[],edges:[],initialState:j,solution:{nodes:[],edges:[]},hints:[],modifiableGameObjects:[],availableNodes:["Display"]}};export{B as L,A as c,f as g,Y as i,E as u};
