import{k as C,l as b,m as E,n as T,b as F,M as j,u}from"./time-DcZILhUt.js";const G="/dumpster/assets/alley_one-Ch0po_m1.jpg",O="/dumpster/assets/alley_two-D6HTRiqu.png",R="/dumpster/assets/house-BZR3Z7t1.png",p=5,K=C(t=>({isPaused:!1,pause:()=>t({isPaused:!0}),play:()=>t({isPaused:!1}),currentLevel:"playground",setCurrentLevel:e=>t({currentLevel:e})})),d=new Set,m=new Set,y=new Set;let f=!1,k,S;function v(t){const e=t.toLowerCase();return e==="space"?" ":e==="enter"?"Enter":t}function D(){f||(f=!0,k=t=>{const e=t.key;d.has(e)||m.add(e),d.add(e)},S=t=>{const e=t.key;d.delete(e),y.add(e)},window.addEventListener("keydown",k),window.addEventListener("keyup",S))}function z(){f&&(window.removeEventListener("keydown",k),window.removeEventListener("keyup",S),f=!1,d.clear(),m.clear(),y.clear())}function _(t){return d.has(v(t))}function M(t){return m.has(v(t))}function N(t){return y.has(v(t))}function H(){m.clear(),y.clear()}const h={init:D,cleanup:z,isKeyDown:_,isKeyPressed:M,isKeyReleased:N,clearPressedAndReleased:H},w={first:!0};function B(t){if(!w.first)return;w.first=!1;let e=0,o=0;const{k:s,game:a}=g(t);return b.getState().setKeyDownFunction(h.isKeyDown),b.getState().setKeyPressedFunction(h.isKeyPressed),b.getState().setKeyReleasedFunction(h.isKeyReleased),E.getState().setMousePosFunction(()=>s.mousePos()),T.getState().setTimeFunction(()=>s.time()-o),T.getState().setDeltaTimeFunction(()=>s.dt()),s.onUpdate(()=>{if(K.getState().isPaused){a.paused||(e=s.time()),a.paused=!0;return}a.paused&&(o+=s.time()-e,e=0,a.paused=!1),F.getState().compute(),h.clearPressedAndReleased()}),s}let r;function g(t){if(r)return r;const e=j({global:!1,pixelDensity:2,touchToMouse:!0,debug:!1,debugKey:"f1",canvas:t}),o=e.add([e.timer()]);return r={k:e,game:o},r}function V(){r&&(r=void 0,w.first=!0)}const P=()=>{const{k:t,game:e}=g();t.loadBean();const o=e.add([t.sprite("bean"),t.pos(20,130)]),s=e.add([t.sprite("bean"),t.color(0,0,0),t.pos(400,400),t.scale(.5),t.area()]);s.tag("trashCan"),e.add([t.sprite("bean"),t.color(255,0,0),t.pos(600,100),t.scale(4,.5),t.area()]).tag("finishLine"),t.onCollide("trashCan","finishLine",(n,i)=>{console.log("Collided with finish line")}),e.onUpdate(()=>{var l,c,x,L;if(K.getState().isPaused)return;const n=u.getState().gameObjects;o.pos.x=(o.pos.x+1)%1e3;const{access:i}=n.get("raccoon").get("xpos");n.get("raccoon").set("xpos",{access:i,value:o.pos.x}),s.pos.x=((c=(l=n.get("trashcan"))==null?void 0:l.get("xpos"))==null?void 0:c.value)??0,s.pos.y=((L=(x=n.get("trashcan"))==null?void 0:x.get("ypos"))==null?void 0:L.value)??0})};function I(t){const{k:e,game:o}=g(),s={};if(t.includes("raccoon")){e.loadSprite("raccoon","/game/sprites/raccoon_spritesheet.png",{sliceX:4,sliceY:4,anims:{idle:{from:0,to:0,loop:!1},idleHolding:{from:1,to:1,loop:!1},walk:{from:2,to:7,loop:!0},walkHolding:{from:8,to:13,loop:!0}}});const a=o.add([e.sprite("raccoon",{anim:"walkHolding"}),e.pos(0,0),e.scale(p),e.anchor("bot"),e.z(2),e.state("idle",["idle","walkLeft","walkRight"])]);a.onStateEnter("idle",()=>{a.play("idle")}),a.onStateEnter("walkLeft",()=>{a.play("walk"),a.scaleTo(e.vec2(-5,p))}),a.onStateEnter("walkRight",()=>{a.play("walk"),a.scaleTo(e.vec2(p,p))}),s.raccoon=a}if(t.includes("trashcan")){e.loadSprite("trashcan","/game/sprites/trashcan_spritesheet.png",{sliceX:2,sliceY:1,anims:{empty:{from:0,to:0,loop:!1},filled:{from:1,to:1,loop:!1}}});const a=o.add([e.sprite("trashcan",{anim:"filled"}),e.anchor("bot"),e.pos(0,0),e.scale(5),e.z(1)]);s.trashcan=a}if(t.includes("goalFlag")){e.loadSprite("flag","/game/sprites/flag_spritesheet.png",{sliceX:2,sliceY:2,anims:{default:{from:0,to:3,loop:!0}}});const a=o.add([e.sprite("flag",{anim:"default"}),e.anchor("bot"),e.pos(200,0),e.scale(5),e.z(1)]);s.goalFlag=a}return s}function X(t){const{k:e,game:o}=g();t.includes("background1")&&(e.loadSprite("background1","/game/backgrounds/background1.png"),e.loadSprite("background1light","/game/backgrounds/background1_light.png"),o.add([e.sprite("background1"),e.anchor("bot"),e.scale(e.height()*(1/180)),e.pos(0,0),e.z(0)]),o.add([e.sprite("background1light"),e.anchor("bot"),e.scale(e.height()*(1/180)),e.pos(e.width()/2+200,0),e.z(100),e.opacity(.75)]))}function A(t,e){var n,i,l,c;const o=t.pos.x;t.pos.x=((i=(n=u.getState().gameObjects.get("raccoon"))==null?void 0:n.get("xpos"))==null?void 0:i.value)??0,t.pos.y=((c=(l=u.getState().gameObjects.get("raccoon"))==null?void 0:l.get("ypos"))==null?void 0:c.value)??0,e.setCamPos(t.pos.add(0,-e.height()/2));const s=t.pos.x-o,a=s===0?"idle":s<0?"walkLeft":"walkRight";t.state!==a&&t.enterState(a)}const U=()=>{const{k:t,game:e}=g();X(["background1"]);const{raccoon:o,trashcan:s,goalFlag:a}=I(["raccoon","trashcan","goalFlag"]);e.onUpdate(()=>{var n,i,l,c;A(o,t),s.pos.x=((i=(n=u.getState().gameObjects.get("trashcan"))==null?void 0:n.get("xpos"))==null?void 0:i.value)??0,s.pos.y=((c=(l=u.getState().gameObjects.get("trashcan"))==null?void 0:l.get("ypos"))==null?void 0:c.value)??0})},Z={playground:{id:"playground",name:"Playground",description:"This is a sandbox level where you can freely test game mechanics.",dialog:["This is a playground level where you can test your game mechanics.","Use of all nodes is permitted."],goals:["Test all features freely.","Experiment with different setups.","No restrictions in this mode."],category:"Sandbox",image:G,nodes:[],edges:[],initialState:U,solution:{nodes:[],edges:[]},hints:["This is a playground level","You don't need hints here","stop clicking there is nothing coming","42"],modifiableGameObjects:[{id:"raccoon",connections:[{label:"xpos",access:"all"},{label:"ypos",access:"all"}]},{id:"trashcan",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]}],availableNodes:["Value","Display","Time","KeyPress","MathFloat","ExportToGameobject","ImportFromGameobject","Switch","Group","ForLoop","MousePosition"]},"1.1":{id:"1.1",name:"Level 1.1",description:"This is the first level of the game, introducing basic mechanics.",dialog:["This is the first level of the game. It introduces the basic mechanics and objectives."],goals:["Create a character controller for the raccoon.","Navigate the raccoon to the goal flag."],category:"Introduction",image:O,nodes:[],edges:[],initialState:P,solution:{nodes:[],edges:[]},hints:[],modifiableGameObjects:[{id:"raccoon",connections:[{label:"xpos",access:"get"}]},{id:"trashcan",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]}],availableNodes:["Value","Display","MathFloat","ExportToGameobject"]},"1.2":{id:"1.2",name:"Level 1.2",description:"This is the second level of the game, building upon Level 1.1.",dialog:["This is the second level of the game. It builds upon the mechanics introduced in Level 1.1."],goals:["No goals defined yet."],category:"Introduction",image:R,nodes:[],edges:[],initialState:P,solution:{nodes:[],edges:[]},hints:[],modifiableGameObjects:[],availableNodes:["Display"]}};export{Z as L,V as c,h as g,B as i,K as u};
