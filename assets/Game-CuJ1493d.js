var F0=Object.defineProperty;var j0=(e,t,n)=>t in e?F0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var H=(e,t,n)=>j0(e,typeof t!="symbol"?t+"":t,n);import{w as q0}from"./with-props-D5gvZ7XN.js";import{a as x,s as z0,r as $d,t as H0,v as St,o as S,N as V0}from"./chunk-AYJ5UCUI-BvwBlbwa.js";import{c as Is,Q as U0,u as Ce,a as Ns,C as Ta,b as $0,d as G0,e as Gd,H as K0,P as W0,f as Y0,R as X0,D as Q0}from"./index-DiSpcOUP.js";import{a as Cl,R as Z0}from"./index-DYq_FHE1.js";import{c as Or,P as xe,a as ue,d as Kd,u as gt,b as Sr,e as Ts,f as ui}from"./index-CtnkkU4u.js";const di=x.createContext(null);di.displayName="PanelGroupContext";const Re={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},Pl=10,On=x.useLayoutEffect,jc=z0.useId,J0=typeof jc=="function"?jc:()=>null;let ey=0;function Rl(e=null){const t=J0(),n=x.useRef(e||t||null);return n.current===null&&(n.current=""+ey++),e??n.current}function Wd({children:e,className:t="",collapsedSize:n,collapsible:r,defaultSize:o,forwardedRef:s,id:i,maxSize:a,minSize:l,onCollapse:c,onExpand:d,onResize:f,order:u,style:h,tagName:p="div",...m}){const g=x.useContext(di);if(g===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:y,expandPanel:A,getPanelSize:w,getPanelStyle:E,groupId:R,isPanelCollapsed:b,reevaluatePanelConstraints:v,registerPanel:C,resizePanel:T,unregisterPanel:k}=g,D=Rl(i),B=x.useRef({callbacks:{onCollapse:c,onExpand:d,onResize:f},constraints:{collapsedSize:n,collapsible:r,defaultSize:o,maxSize:a,minSize:l},id:D,idIsFromProps:i!==void 0,order:u});x.useRef({didLogMissingDefaultSizeWarning:!1}),On(()=>{const{callbacks:P,constraints:O}=B.current,I={...O};B.current.id=D,B.current.idIsFromProps=i!==void 0,B.current.order=u,P.onCollapse=c,P.onExpand=d,P.onResize=f,O.collapsedSize=n,O.collapsible=r,O.defaultSize=o,O.maxSize=a,O.minSize=l,(I.collapsedSize!==O.collapsedSize||I.collapsible!==O.collapsible||I.maxSize!==O.maxSize||I.minSize!==O.minSize)&&v(B.current,I)}),On(()=>{const P=B.current;return C(P),()=>{k(P)}},[u,D,C,k]),x.useImperativeHandle(s,()=>({collapse:()=>{y(B.current)},expand:P=>{A(B.current,P)},getId(){return D},getSize(){return w(B.current)},isCollapsed(){return b(B.current)},isExpanded(){return!b(B.current)},resize:P=>{T(B.current,P)}}),[y,A,w,b,D,T]);const j=E(B.current,o);return x.createElement(p,{...m,children:e,className:t,id:D,style:{...j,...h},[Re.groupId]:R,[Re.panel]:"",[Re.panelCollapsible]:r||void 0,[Re.panelId]:D,[Re.panelSize]:parseFloat(""+j.flexGrow).toFixed(1)})}const ka=x.forwardRef((e,t)=>x.createElement(Wd,{...e,forwardedRef:t}));Wd.displayName="Panel";ka.displayName="forwardRef(Panel)";let _a=null,ys=-1,un=null;function ty(e,t){if(t){const n=(t&Jd)!==0,r=(t&ef)!==0,o=(t&tf)!==0,s=(t&nf)!==0;if(n)return o?"se-resize":s?"ne-resize":"e-resize";if(r)return o?"sw-resize":s?"nw-resize":"w-resize";if(o)return"s-resize";if(s)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function ny(){un!==null&&(document.head.removeChild(un),_a=null,un=null,ys=-1)}function Qi(e,t){var n,r;const o=ty(e,t);if(_a!==o){if(_a=o,un===null&&(un=document.createElement("style"),document.head.appendChild(un)),ys>=0){var s;(s=un.sheet)===null||s===void 0||s.removeRule(ys)}ys=(n=(r=un.sheet)===null||r===void 0?void 0:r.insertRule(`*{cursor: ${o} !important;}`))!==null&&n!==void 0?n:-1}}function Yd(e){return e.type==="keydown"}function Xd(e){return e.type.startsWith("pointer")}function Qd(e){return e.type.startsWith("mouse")}function fi(e){if(Xd(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(Qd(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}function ry(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function oy(e,t,n){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function sy(e,t){if(e===t)throw new Error("Cannot compare node with itself");const n={a:Hc(e),b:Hc(t)};let r;for(;n.a.at(-1)===n.b.at(-1);)e=n.a.pop(),t=n.b.pop(),r=e;he(r,"Stacking order can only be calculated for elements with a common ancestor");const o={a:zc(qc(n.a)),b:zc(qc(n.b))};if(o.a===o.b){const s=r.childNodes,i={a:n.a.at(-1),b:n.b.at(-1)};let a=s.length;for(;a--;){const l=s[a];if(l===i.a)return 1;if(l===i.b)return-1}}return Math.sign(o.a-o.b)}const iy=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function ay(e){var t;const n=getComputedStyle((t=Zd(e))!==null&&t!==void 0?t:e).display;return n==="flex"||n==="inline-flex"}function ly(e){const t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||ay(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||iy.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function qc(e){let t=e.length;for(;t--;){const n=e[t];if(he(n,"Missing node"),ly(n))return n}return null}function zc(e){return e&&Number(getComputedStyle(e).zIndex)||0}function Hc(e){const t=[];for(;e;)t.push(e),e=Zd(e);return t}function Zd(e){const{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}const Jd=1,ef=2,tf=4,nf=8,cy=ry()==="coarse";let Rt=[],wr=!1,kn=new Map,hi=new Map;const ho=new Set;function uy(e,t,n,r,o){var s;const{ownerDocument:i}=t,a={direction:n,element:t,hitAreaMargins:r,setResizeHandlerState:o},l=(s=kn.get(i))!==null&&s!==void 0?s:0;return kn.set(i,l+1),ho.add(a),ks(),function(){var d;hi.delete(e),ho.delete(a);const f=(d=kn.get(i))!==null&&d!==void 0?d:1;if(kn.set(i,f-1),ks(),f===1&&kn.delete(i),Rt.includes(a)){const u=Rt.indexOf(a);u>=0&&Rt.splice(u,1),Nl(),o("up",!0,null)}}}function dy(e){const{target:t}=e,{x:n,y:r}=fi(e);wr=!0,Il({target:t,x:n,y:r}),ks(),Rt.length>0&&(_s("down",e),e.preventDefault(),rf(t)||e.stopImmediatePropagation())}function Zi(e){const{x:t,y:n}=fi(e);if(wr&&e.buttons===0&&(wr=!1,_s("up",e)),!wr){const{target:r}=e;Il({target:r,x:t,y:n})}_s("move",e),Nl(),Rt.length>0&&e.preventDefault()}function Ji(e){const{target:t}=e,{x:n,y:r}=fi(e);hi.clear(),wr=!1,Rt.length>0&&(e.preventDefault(),rf(t)||e.stopImmediatePropagation()),_s("up",e),Il({target:t,x:n,y:r}),Nl(),ks()}function rf(e){let t=e;for(;t;){if(t.hasAttribute(Re.resizeHandle))return!0;t=t.parentElement}return!1}function Il({target:e,x:t,y:n}){Rt.splice(0);let r=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(r=e),ho.forEach(o=>{const{element:s,hitAreaMargins:i}=o,a=s.getBoundingClientRect(),{bottom:l,left:c,right:d,top:f}=a,u=cy?i.coarse:i.fine;if(t>=c-u&&t<=d+u&&n>=f-u&&n<=l+u){if(r!==null&&document.contains(r)&&s!==r&&!s.contains(r)&&!r.contains(s)&&sy(r,s)>0){let p=r,m=!1;for(;p&&!p.contains(s);){if(oy(p.getBoundingClientRect(),a)){m=!0;break}p=p.parentElement}if(m)return}Rt.push(o)}})}function ea(e,t){hi.set(e,t)}function Nl(){let e=!1,t=!1;Rt.forEach(r=>{const{direction:o}=r;o==="horizontal"?e=!0:t=!0});let n=0;hi.forEach(r=>{n|=r}),e&&t?Qi("intersection",n):e?Qi("horizontal",n):t?Qi("vertical",n):ny()}let ta=new AbortController;function ks(){ta.abort(),ta=new AbortController;const e={capture:!0,signal:ta.signal};ho.size&&(wr?(Rt.length>0&&kn.forEach((t,n)=>{const{body:r}=n;t>0&&(r.addEventListener("contextmenu",Ji,e),r.addEventListener("pointerleave",Zi,e),r.addEventListener("pointermove",Zi,e))}),window.addEventListener("pointerup",Ji,e),window.addEventListener("pointercancel",Ji,e)):kn.forEach((t,n)=>{const{body:r}=n;t>0&&(r.addEventListener("pointerdown",dy,e),r.addEventListener("pointermove",Zi,e))}))}function _s(e,t){ho.forEach(n=>{const{setResizeHandlerState:r}=n,o=Rt.includes(n);r(e,o,t)})}function fy(){const[e,t]=x.useState(0);return x.useCallback(()=>t(n=>n+1),[])}function he(e,t){if(!e)throw console.error(t),Error(t)}function qn(e,t,n=Pl){return e.toFixed(n)===t.toFixed(n)?0:e>t?1:-1}function Wt(e,t,n=Pl){return qn(e,t,n)===0}function Ze(e,t,n){return qn(e,t,n)===0}function hy(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){const o=e[r],s=t[r];if(!Ze(o,s,n))return!1}return!0}function pr({panelConstraints:e,panelIndex:t,size:n}){const r=e[t];he(r!=null,`Panel constraints not found for index ${t}`);let{collapsedSize:o=0,collapsible:s,maxSize:i=100,minSize:a=0}=r;if(qn(n,a)<0)if(s){const l=(o+a)/2;qn(n,l)<0?n=o:n=a}else n=a;return n=Math.min(i,n),n=parseFloat(n.toFixed(Pl)),n}function Wr({delta:e,initialLayout:t,panelConstraints:n,pivotIndices:r,prevLayout:o,trigger:s}){if(Ze(e,0))return t;const i=[...t],[a,l]=r;he(a!=null,"Invalid first pivot index"),he(l!=null,"Invalid second pivot index");let c=0;if(s==="keyboard"){{const f=e<0?l:a,u=n[f];he(u,`Panel constraints not found for index ${f}`);const{collapsedSize:h=0,collapsible:p,minSize:m=0}=u;if(p){const g=t[f];if(he(g!=null,`Previous layout not found for panel index ${f}`),Ze(g,h)){const y=m-g;qn(y,Math.abs(e))>0&&(e=e<0?0-y:y)}}}{const f=e<0?a:l,u=n[f];he(u,`No panel constraints found for index ${f}`);const{collapsedSize:h=0,collapsible:p,minSize:m=0}=u;if(p){const g=t[f];if(he(g!=null,`Previous layout not found for panel index ${f}`),Ze(g,m)){const y=g-h;qn(y,Math.abs(e))>0&&(e=e<0?0-y:y)}}}}{const f=e<0?1:-1;let u=e<0?l:a,h=0;for(;;){const m=t[u];he(m!=null,`Previous layout not found for panel index ${u}`);const y=pr({panelConstraints:n,panelIndex:u,size:100})-m;if(h+=y,u+=f,u<0||u>=n.length)break}const p=Math.min(Math.abs(e),Math.abs(h));e=e<0?0-p:p}{let u=e<0?a:l;for(;u>=0&&u<n.length;){const h=Math.abs(e)-Math.abs(c),p=t[u];he(p!=null,`Previous layout not found for panel index ${u}`);const m=p-h,g=pr({panelConstraints:n,panelIndex:u,size:m});if(!Ze(p,g)&&(c+=p-g,i[u]=g,c.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?u--:u++}}if(hy(o,i))return o;{const f=e<0?l:a,u=t[f];he(u!=null,`Previous layout not found for panel index ${f}`);const h=u+c,p=pr({panelConstraints:n,panelIndex:f,size:h});if(i[f]=p,!Ze(p,h)){let m=h-p,y=e<0?l:a;for(;y>=0&&y<n.length;){const A=i[y];he(A!=null,`Previous layout not found for panel index ${y}`);const w=A+m,E=pr({panelConstraints:n,panelIndex:y,size:w});if(Ze(A,E)||(m-=E-A,i[y]=E),Ze(m,0))break;e>0?y--:y++}}}const d=i.reduce((f,u)=>u+f,0);return Ze(d,100)?i:o}function py({layout:e,panelsArray:t,pivotIndices:n}){let r=0,o=100,s=0,i=0;const a=n[0];he(a!=null,"No pivot index found"),t.forEach((f,u)=>{const{constraints:h}=f,{maxSize:p=100,minSize:m=0}=h;u===a?(r=m,o=p):(s+=m,i+=p)});const l=Math.min(o,100-s),c=Math.max(r,100-i),d=e[a];return{valueMax:l,valueMin:c,valueNow:d}}function po(e,t=document){return Array.from(t.querySelectorAll(`[${Re.resizeHandleId}][data-panel-group-id="${e}"]`))}function of(e,t,n=document){const o=po(e,n).findIndex(s=>s.getAttribute(Re.resizeHandleId)===t);return o??null}function sf(e,t,n){const r=of(e,t,n);return r!=null?[r,r+1]:[-1,-1]}function af(e,t=document){var n;if(t instanceof HTMLElement&&(t==null||(n=t.dataset)===null||n===void 0?void 0:n.panelGroupId)==e)return t;const r=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return r||null}function pi(e,t=document){const n=t.querySelector(`[${Re.resizeHandleId}="${e}"]`);return n||null}function gy(e,t,n,r=document){var o,s,i,a;const l=pi(t,r),c=po(e,r),d=l?c.indexOf(l):-1,f=(o=(s=n[d])===null||s===void 0?void 0:s.id)!==null&&o!==void 0?o:null,u=(i=(a=n[d+1])===null||a===void 0?void 0:a.id)!==null&&i!==void 0?i:null;return[f,u]}function my({committedValuesRef:e,eagerValuesRef:t,groupId:n,layout:r,panelDataArray:o,panelGroupElement:s,setLayout:i}){x.useRef({didWarnAboutMissingResizeHandle:!1}),On(()=>{if(!s)return;const a=po(n,s);for(let l=0;l<o.length-1;l++){const{valueMax:c,valueMin:d,valueNow:f}=py({layout:r,panelsArray:o,pivotIndices:[l,l+1]}),u=a[l];if(u!=null){const h=o[l];he(h,`No panel data found for index "${l}"`),u.setAttribute("aria-controls",h.id),u.setAttribute("aria-valuemax",""+Math.round(c)),u.setAttribute("aria-valuemin",""+Math.round(d)),u.setAttribute("aria-valuenow",f!=null?""+Math.round(f):"")}}return()=>{a.forEach((l,c)=>{l.removeAttribute("aria-controls"),l.removeAttribute("aria-valuemax"),l.removeAttribute("aria-valuemin"),l.removeAttribute("aria-valuenow")})}},[n,r,o,s]),x.useEffect(()=>{if(!s)return;const a=t.current;he(a,"Eager values not found");const{panelDataArray:l}=a,c=af(n,s);he(c!=null,`No group found for id "${n}"`);const d=po(n,s);he(d,`No resize handles found for group id "${n}"`);const f=d.map(u=>{const h=u.getAttribute(Re.resizeHandleId);he(h,"Resize handle element has no handle id attribute");const[p,m]=gy(n,h,l,s);if(p==null||m==null)return()=>{};const g=y=>{if(!y.defaultPrevented)switch(y.key){case"Enter":{y.preventDefault();const A=l.findIndex(w=>w.id===p);if(A>=0){const w=l[A];he(w,`No panel data found for index ${A}`);const E=r[A],{collapsedSize:R=0,collapsible:b,minSize:v=0}=w.constraints;if(E!=null&&b){const C=Wr({delta:Ze(E,R)?v-R:R-E,initialLayout:r,panelConstraints:l.map(T=>T.constraints),pivotIndices:sf(n,h,s),prevLayout:r,trigger:"keyboard"});r!==C&&i(C)}}break}}};return u.addEventListener("keydown",g),()=>{u.removeEventListener("keydown",g)}});return()=>{f.forEach(u=>u())}},[s,e,t,n,r,o,i])}function Vc(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function lf(e,t){const n=e==="horizontal",{x:r,y:o}=fi(t);return n?r:o}function yy(e,t,n,r,o){const s=n==="horizontal",i=pi(t,o);he(i,`No resize handle element found for id "${t}"`);const a=i.getAttribute(Re.groupId);he(a,"Resize handle element has no group id attribute");let{initialCursorPosition:l}=r;const c=lf(n,e),d=af(a,o);he(d,`No group element found for id "${a}"`);const f=d.getBoundingClientRect(),u=s?f.width:f.height;return(c-l)/u*100}function wy(e,t,n,r,o,s){if(Yd(e)){const i=n==="horizontal";let a=0;e.shiftKey?a=100:o!=null?a=o:a=10;let l=0;switch(e.key){case"ArrowDown":l=i?0:a;break;case"ArrowLeft":l=i?-a:0;break;case"ArrowRight":l=i?a:0;break;case"ArrowUp":l=i?0:-a;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return r==null?0:yy(e,t,n,r,s)}function xy({panelDataArray:e}){const t=Array(e.length),n=e.map(s=>s.constraints);let r=0,o=100;for(let s=0;s<e.length;s++){const i=n[s];he(i,`Panel constraints not found for index ${s}`);const{defaultSize:a}=i;a!=null&&(r++,t[s]=a,o-=a)}for(let s=0;s<e.length;s++){const i=n[s];he(i,`Panel constraints not found for index ${s}`);const{defaultSize:a}=i;if(a!=null)continue;const l=e.length-r,c=o/l;r++,t[s]=c,o-=c}return t}function sr(e,t,n){t.forEach((r,o)=>{const s=e[o];he(s,`Panel data not found for index ${o}`);const{callbacks:i,constraints:a,id:l}=s,{collapsedSize:c=0,collapsible:d}=a,f=n[l];if(f==null||r!==f){n[l]=r;const{onCollapse:u,onExpand:h,onResize:p}=i;p&&p(r,f),d&&(u||h)&&(h&&(f==null||Wt(f,c))&&!Wt(r,c)&&h(),u&&(f==null||!Wt(f,c))&&Wt(r,c)&&u())}})}function Jo(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function vy({defaultSize:e,dragState:t,layout:n,panelData:r,panelIndex:o,precision:s=3}){const i=n[o];let a;return i==null?a=e!=null?e.toPrecision(s):"1":r.length===1?a="1":a=i.toPrecision(s),{flexBasis:0,flexGrow:a,flexShrink:1,overflow:"hidden",pointerEvents:t!==null?"none":void 0}}function by(e,t=10){let n=null;return(...o)=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{e(...o)},t)}}function Uc(e){try{if(typeof localStorage<"u")e.getItem=t=>localStorage.getItem(t),e.setItem=(t,n)=>{localStorage.setItem(t,n)};else throw new Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function cf(e){return`react-resizable-panels:${e}`}function uf(e){return e.map(t=>{const{constraints:n,id:r,idIsFromProps:o,order:s}=t;return o?r:s?`${s}:${JSON.stringify(n)}`:JSON.stringify(n)}).sort((t,n)=>t.localeCompare(n)).join(",")}function df(e,t){try{const n=cf(e),r=t.getItem(n);if(r){const o=JSON.parse(r);if(typeof o=="object"&&o!=null)return o}}catch{}return null}function Ay(e,t,n){var r,o;const s=(r=df(e,n))!==null&&r!==void 0?r:{},i=uf(t);return(o=s[i])!==null&&o!==void 0?o:null}function Ey(e,t,n,r,o){var s;const i=cf(e),a=uf(t),l=(s=df(e,o))!==null&&s!==void 0?s:{};l[a]={expandToSizes:Object.fromEntries(n.entries()),layout:r};try{o.setItem(i,JSON.stringify(l))}catch(c){console.error(c)}}function $c({layout:e,panelConstraints:t}){const n=[...e],r=n.reduce((s,i)=>s+i,0);if(n.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${n.map(s=>`${s}%`).join(", ")}`);if(!Ze(r,100)&&n.length>0)for(let s=0;s<t.length;s++){const i=n[s];he(i!=null,`No layout data found for index ${s}`);const a=100/r*i;n[s]=a}let o=0;for(let s=0;s<t.length;s++){const i=n[s];he(i!=null,`No layout data found for index ${s}`);const a=pr({panelConstraints:t,panelIndex:s,size:i});i!=a&&(o+=i-a,n[s]=a)}if(!Ze(o,0))for(let s=0;s<t.length;s++){const i=n[s];he(i!=null,`No layout data found for index ${s}`);const a=i+o,l=pr({panelConstraints:t,panelIndex:s,size:a});if(i!==l&&(o-=l-i,n[s]=l,Ze(o,0)))break}return n}const Sy=100,Yr={getItem:e=>(Uc(Yr),Yr.getItem(e)),setItem:(e,t)=>{Uc(Yr),Yr.setItem(e,t)}},Gc={};function ff({autoSaveId:e=null,children:t,className:n="",direction:r,forwardedRef:o,id:s=null,onLayout:i=null,keyboardResizeBy:a=null,storage:l=Yr,style:c,tagName:d="div",...f}){const u=Rl(s),h=x.useRef(null),[p,m]=x.useState(null),[g,y]=x.useState([]),A=fy(),w=x.useRef({}),E=x.useRef(new Map),R=x.useRef(0),b=x.useRef({autoSaveId:e,direction:r,dragState:p,id:u,keyboardResizeBy:a,onLayout:i,storage:l}),v=x.useRef({layout:g,panelDataArray:[],panelDataArrayChanged:!1});x.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),x.useImperativeHandle(o,()=>({getId:()=>b.current.id,getLayout:()=>{const{layout:K}=v.current;return K},setLayout:K=>{const{onLayout:Y}=b.current,{layout:ee,panelDataArray:Z}=v.current,q=$c({layout:K,panelConstraints:Z.map(W=>W.constraints)});Vc(ee,q)||(y(q),v.current.layout=q,Y&&Y(q),sr(Z,q,w.current))}}),[]),On(()=>{b.current.autoSaveId=e,b.current.direction=r,b.current.dragState=p,b.current.id=u,b.current.onLayout=i,b.current.storage=l}),my({committedValuesRef:b,eagerValuesRef:v,groupId:u,layout:g,panelDataArray:v.current.panelDataArray,setLayout:y,panelGroupElement:h.current}),x.useEffect(()=>{const{panelDataArray:K}=v.current;if(e){if(g.length===0||g.length!==K.length)return;let Y=Gc[e];Y==null&&(Y=by(Ey,Sy),Gc[e]=Y);const ee=[...K],Z=new Map(E.current);Y(e,ee,Z,g,l)}},[e,g,l]),x.useEffect(()=>{});const C=x.useCallback(K=>{const{onLayout:Y}=b.current,{layout:ee,panelDataArray:Z}=v.current;if(K.constraints.collapsible){const q=Z.map(oe=>oe.constraints),{collapsedSize:W=0,panelSize:te,pivotIndices:se}=In(Z,K,ee);if(he(te!=null,`Panel size not found for panel "${K.id}"`),!Wt(te,W)){E.current.set(K.id,te);const ne=dr(Z,K)===Z.length-1?te-W:W-te,J=Wr({delta:ne,initialLayout:ee,panelConstraints:q,pivotIndices:se,prevLayout:ee,trigger:"imperative-api"});Jo(ee,J)||(y(J),v.current.layout=J,Y&&Y(J),sr(Z,J,w.current))}}},[]),T=x.useCallback((K,Y)=>{const{onLayout:ee}=b.current,{layout:Z,panelDataArray:q}=v.current;if(K.constraints.collapsible){const W=q.map(re=>re.constraints),{collapsedSize:te=0,panelSize:se=0,minSize:oe=0,pivotIndices:ne}=In(q,K,Z),J=Y??oe;if(Wt(se,te)){const re=E.current.get(K.id),le=re!=null&&re>=J?re:J,me=dr(q,K)===q.length-1?se-le:le-se,de=Wr({delta:me,initialLayout:Z,panelConstraints:W,pivotIndices:ne,prevLayout:Z,trigger:"imperative-api"});Jo(Z,de)||(y(de),v.current.layout=de,ee&&ee(de),sr(q,de,w.current))}}},[]),k=x.useCallback(K=>{const{layout:Y,panelDataArray:ee}=v.current,{panelSize:Z}=In(ee,K,Y);return he(Z!=null,`Panel size not found for panel "${K.id}"`),Z},[]),D=x.useCallback((K,Y)=>{const{panelDataArray:ee}=v.current,Z=dr(ee,K);return vy({defaultSize:Y,dragState:p,layout:g,panelData:ee,panelIndex:Z})},[p,g]),B=x.useCallback(K=>{const{layout:Y,panelDataArray:ee}=v.current,{collapsedSize:Z=0,collapsible:q,panelSize:W}=In(ee,K,Y);return he(W!=null,`Panel size not found for panel "${K.id}"`),q===!0&&Wt(W,Z)},[]),j=x.useCallback(K=>{const{layout:Y,panelDataArray:ee}=v.current,{collapsedSize:Z=0,collapsible:q,panelSize:W}=In(ee,K,Y);return he(W!=null,`Panel size not found for panel "${K.id}"`),!q||qn(W,Z)>0},[]),P=x.useCallback(K=>{const{panelDataArray:Y}=v.current;Y.push(K),Y.sort((ee,Z)=>{const q=ee.order,W=Z.order;return q==null&&W==null?0:q==null?-1:W==null?1:q-W}),v.current.panelDataArrayChanged=!0,A()},[A]);On(()=>{if(v.current.panelDataArrayChanged){v.current.panelDataArrayChanged=!1;const{autoSaveId:K,onLayout:Y,storage:ee}=b.current,{layout:Z,panelDataArray:q}=v.current;let W=null;if(K){const se=Ay(K,q,ee);se&&(E.current=new Map(Object.entries(se.expandToSizes)),W=se.layout)}W==null&&(W=xy({panelDataArray:q}));const te=$c({layout:W,panelConstraints:q.map(se=>se.constraints)});Vc(Z,te)||(y(te),v.current.layout=te,Y&&Y(te),sr(q,te,w.current))}}),On(()=>{const K=v.current;return()=>{K.layout=[]}},[]);const O=x.useCallback(K=>{let Y=!1;const ee=h.current;return ee&&window.getComputedStyle(ee,null).getPropertyValue("direction")==="rtl"&&(Y=!0),function(q){q.preventDefault();const W=h.current;if(!W)return()=>null;const{direction:te,dragState:se,id:oe,keyboardResizeBy:ne,onLayout:J}=b.current,{layout:re,panelDataArray:le}=v.current,{initialLayout:ce}=se??{},me=sf(oe,K,W);let de=wy(q,K,te,se,ne,W);const be=te==="horizontal";be&&Y&&(de=-de);const ze=le.map(wt=>wt.constraints),Xe=Wr({delta:de,initialLayout:ce??re,panelConstraints:ze,pivotIndices:me,prevLayout:re,trigger:Yd(q)?"keyboard":"mouse-or-touch"}),lt=!Jo(re,Xe);(Xd(q)||Qd(q))&&R.current!=de&&(R.current=de,!lt&&de!==0?be?ea(K,de<0?Jd:ef):ea(K,de<0?tf:nf):ea(K,0)),lt&&(y(Xe),v.current.layout=Xe,J&&J(Xe),sr(le,Xe,w.current))}},[]),I=x.useCallback((K,Y)=>{const{onLayout:ee}=b.current,{layout:Z,panelDataArray:q}=v.current,W=q.map(re=>re.constraints),{panelSize:te,pivotIndices:se}=In(q,K,Z);he(te!=null,`Panel size not found for panel "${K.id}"`);const ne=dr(q,K)===q.length-1?te-Y:Y-te,J=Wr({delta:ne,initialLayout:Z,panelConstraints:W,pivotIndices:se,prevLayout:Z,trigger:"imperative-api"});Jo(Z,J)||(y(J),v.current.layout=J,ee&&ee(J),sr(q,J,w.current))},[]),_=x.useCallback((K,Y)=>{const{layout:ee,panelDataArray:Z}=v.current,{collapsedSize:q=0,collapsible:W}=Y,{collapsedSize:te=0,collapsible:se,maxSize:oe=100,minSize:ne=0}=K.constraints,{panelSize:J}=In(Z,K,ee);J!=null&&(W&&se&&Wt(J,q)?Wt(q,te)||I(K,te):J<ne?I(K,ne):J>oe&&I(K,oe))},[I]),F=x.useCallback((K,Y)=>{const{direction:ee}=b.current,{layout:Z}=v.current;if(!h.current)return;const q=pi(K,h.current);he(q,`Drag handle element not found for id "${K}"`);const W=lf(ee,Y);m({dragHandleId:K,dragHandleRect:q.getBoundingClientRect(),initialCursorPosition:W,initialLayout:Z})},[]),N=x.useCallback(()=>{m(null)},[]),z=x.useCallback(K=>{const{panelDataArray:Y}=v.current,ee=dr(Y,K);ee>=0&&(Y.splice(ee,1),delete w.current[K.id],v.current.panelDataArrayChanged=!0,A())},[A]),V=x.useMemo(()=>({collapsePanel:C,direction:r,dragState:p,expandPanel:T,getPanelSize:k,getPanelStyle:D,groupId:u,isPanelCollapsed:B,isPanelExpanded:j,reevaluatePanelConstraints:_,registerPanel:P,registerResizeHandle:O,resizePanel:I,startDragging:F,stopDragging:N,unregisterPanel:z,panelGroupElement:h.current}),[C,p,r,T,k,D,u,B,j,_,P,O,I,F,N,z]),U={display:"flex",flexDirection:r==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return x.createElement(di.Provider,{value:V},x.createElement(d,{...f,children:t,className:n,id:s,ref:h,style:{...U,...c},[Re.group]:"",[Re.groupDirection]:r,[Re.groupId]:u}))}const hf=x.forwardRef((e,t)=>x.createElement(ff,{...e,forwardedRef:t}));ff.displayName="PanelGroup";hf.displayName="forwardRef(PanelGroup)";function dr(e,t){return e.findIndex(n=>n===t||n.id===t.id)}function In(e,t,n){const r=dr(e,t),s=r===e.length-1?[r-1,r]:[r,r+1],i=n[r];return{...t.constraints,panelSize:i,pivotIndices:s}}function My({disabled:e,handleId:t,resizeHandler:n,panelGroupElement:r}){x.useEffect(()=>{if(e||n==null||r==null)return;const o=pi(t,r);if(o==null)return;const s=i=>{if(!i.defaultPrevented)switch(i.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{i.preventDefault(),n(i);break}case"F6":{i.preventDefault();const a=o.getAttribute(Re.groupId);he(a,`No group element found for id "${a}"`);const l=po(a,r),c=of(a,t,r);he(c!==null,`No resize element found for id "${t}"`);const d=i.shiftKey?c>0?c-1:l.length-1:c+1<l.length?c+1:0;l[d].focus();break}}};return o.addEventListener("keydown",s),()=>{o.removeEventListener("keydown",s)}},[r,e,t,n])}function pf({children:e=null,className:t="",disabled:n=!1,hitAreaMargins:r,id:o,onBlur:s,onClick:i,onDragging:a,onFocus:l,onPointerDown:c,onPointerUp:d,style:f={},tabIndex:u=0,tagName:h="div",...p}){var m,g;const y=x.useRef(null),A=x.useRef({onClick:i,onDragging:a,onPointerDown:c,onPointerUp:d});x.useEffect(()=>{A.current.onClick=i,A.current.onDragging=a,A.current.onPointerDown=c,A.current.onPointerUp=d});const w=x.useContext(di);if(w===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:E,groupId:R,registerResizeHandle:b,startDragging:v,stopDragging:C,panelGroupElement:T}=w,k=Rl(o),[D,B]=x.useState("inactive"),[j,P]=x.useState(!1),[O,I]=x.useState(null),_=x.useRef({state:D});On(()=>{_.current.state=D}),x.useEffect(()=>{if(n)I(null);else{const V=b(k);I(()=>V)}},[n,k,b]);const F=(m=r==null?void 0:r.coarse)!==null&&m!==void 0?m:15,N=(g=r==null?void 0:r.fine)!==null&&g!==void 0?g:5;x.useEffect(()=>{if(n||O==null)return;const V=y.current;he(V,"Element ref not attached");let U=!1;return uy(k,V,E,{coarse:F,fine:N},(Y,ee,Z)=>{if(!ee){B("inactive");return}switch(Y){case"down":{B("drag"),U=!1,he(Z,'Expected event to be defined for "down" action'),v(k,Z);const{onDragging:q,onPointerDown:W}=A.current;q==null||q(!0),W==null||W();break}case"move":{const{state:q}=_.current;U=!0,q!=="drag"&&B("hover"),he(Z,'Expected event to be defined for "move" action'),O(Z);break}case"up":{B("hover"),C();const{onClick:q,onDragging:W,onPointerUp:te}=A.current;W==null||W(!1),te==null||te(),U||q==null||q();break}}})},[F,E,n,N,b,k,O,v,C]),My({disabled:n,handleId:k,resizeHandler:O,panelGroupElement:T});const z={touchAction:"none",userSelect:"none"};return x.createElement(h,{...p,children:e,className:t,id:o,onBlur:()=>{P(!1),s==null||s()},onFocus:()=>{P(!0),l==null||l()},ref:y,role:"separator",style:{...z,...f},tabIndex:u,[Re.groupDirection]:E,[Re.groupId]:R,[Re.resizeHandle]:"",[Re.resizeHandleActive]:D==="drag"?"pointer":j?"keyboard":void 0,[Re.resizeHandleEnabled]:!n,[Re.resizeHandleId]:k,[Re.resizeHandleState]:D})}pf.displayName="PanelResizeHandle";function ke(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=ke(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Cy={value:()=>{}};function gi(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new ws(n)}function ws(e){this._=e}function Py(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}ws.prototype=gi.prototype={constructor:ws,on:function(e,t){var n=this._,r=Py(e+"",n),o,s=-1,i=r.length;if(arguments.length<2){for(;++s<i;)if((o=(e=r[s]).type)&&(o=Ry(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(o=(e=r[s]).type)n[o]=Kc(n[o],e.name,t);else if(t==null)for(o in n)n[o]=Kc(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ws(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,s;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,o=s.length;r<o;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,s=r.length;o<s;++o)r[o].value.apply(t,n)}};function Ry(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function Kc(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Cy,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Da="http://www.w3.org/1999/xhtml";const Wc={svg:"http://www.w3.org/2000/svg",xhtml:Da,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function mi(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Wc.hasOwnProperty(t)?{space:Wc[t],local:e}:e}function Iy(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Da&&t.documentElement.namespaceURI===Da?t.createElement(e):t.createElementNS(n,e)}}function Ny(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function gf(e){var t=mi(e);return(t.local?Ny:Iy)(t)}function Ty(){}function Tl(e){return e==null?Ty:function(){return this.querySelector(e)}}function ky(e){typeof e!="function"&&(e=Tl(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=new Array(i),l,c,d=0;d<i;++d)(l=s[d])&&(c=e.call(l,l.__data__,d,s))&&("__data__"in l&&(c.__data__=l.__data__),a[d]=c);return new ot(r,this._parents)}function _y(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Dy(){return[]}function mf(e){return e==null?Dy:function(){return this.querySelectorAll(e)}}function Oy(e){return function(){return _y(e.apply(this,arguments))}}function Ly(e){typeof e=="function"?e=Oy(e):e=mf(e);for(var t=this._groups,n=t.length,r=[],o=[],s=0;s<n;++s)for(var i=t[s],a=i.length,l,c=0;c<a;++c)(l=i[c])&&(r.push(e.call(l,l.__data__,c,i)),o.push(l));return new ot(r,o)}function yf(e){return function(){return this.matches(e)}}function wf(e){return function(t){return t.matches(e)}}var By=Array.prototype.find;function Fy(e){return function(){return By.call(this.children,e)}}function jy(){return this.firstElementChild}function qy(e){return this.select(e==null?jy:Fy(typeof e=="function"?e:wf(e)))}var zy=Array.prototype.filter;function Hy(){return Array.from(this.children)}function Vy(e){return function(){return zy.call(this.children,e)}}function Uy(e){return this.selectAll(e==null?Hy:Vy(typeof e=="function"?e:wf(e)))}function $y(e){typeof e!="function"&&(e=yf(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],l,c=0;c<i;++c)(l=s[c])&&e.call(l,l.__data__,c,s)&&a.push(l);return new ot(r,this._parents)}function xf(e){return new Array(e.length)}function Gy(){return new ot(this._enter||this._groups.map(xf),this._parents)}function Ds(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ds.prototype={constructor:Ds,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Ky(e){return function(){return e}}function Wy(e,t,n,r,o,s){for(var i=0,a,l=t.length,c=s.length;i<c;++i)(a=t[i])?(a.__data__=s[i],r[i]=a):n[i]=new Ds(e,s[i]);for(;i<l;++i)(a=t[i])&&(o[i]=a)}function Yy(e,t,n,r,o,s,i){var a,l,c=new Map,d=t.length,f=s.length,u=new Array(d),h;for(a=0;a<d;++a)(l=t[a])&&(u[a]=h=i.call(l,l.__data__,a,t)+"",c.has(h)?o[a]=l:c.set(h,l));for(a=0;a<f;++a)h=i.call(e,s[a],a,s)+"",(l=c.get(h))?(r[a]=l,l.__data__=s[a],c.delete(h)):n[a]=new Ds(e,s[a]);for(a=0;a<d;++a)(l=t[a])&&c.get(u[a])===l&&(o[a]=l)}function Xy(e){return e.__data__}function Qy(e,t){if(!arguments.length)return Array.from(this,Xy);var n=t?Yy:Wy,r=this._parents,o=this._groups;typeof e!="function"&&(e=Ky(e));for(var s=o.length,i=new Array(s),a=new Array(s),l=new Array(s),c=0;c<s;++c){var d=r[c],f=o[c],u=f.length,h=Zy(e.call(d,d&&d.__data__,c,r)),p=h.length,m=a[c]=new Array(p),g=i[c]=new Array(p),y=l[c]=new Array(u);n(d,f,m,g,y,h,t);for(var A=0,w=0,E,R;A<p;++A)if(E=m[A]){for(A>=w&&(w=A+1);!(R=g[w])&&++w<p;);E._next=R||null}}return i=new ot(i,r),i._enter=a,i._exit=l,i}function Zy(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Jy(){return new ot(this._exit||this._groups.map(xf),this._parents)}function ew(e,t,n){var r=this.enter(),o=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?s.remove():n(s),r&&o?r.merge(o).order():o}function tw(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,s=r.length,i=Math.min(o,s),a=new Array(o),l=0;l<i;++l)for(var c=n[l],d=r[l],f=c.length,u=a[l]=new Array(f),h,p=0;p<f;++p)(h=c[p]||d[p])&&(u[p]=h);for(;l<o;++l)a[l]=n[l];return new ot(a,this._parents)}function nw(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,s=r[o],i;--o>=0;)(i=r[o])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function rw(e){e||(e=ow);function t(f,u){return f&&u?e(f.__data__,u.__data__):!f-!u}for(var n=this._groups,r=n.length,o=new Array(r),s=0;s<r;++s){for(var i=n[s],a=i.length,l=o[s]=new Array(a),c,d=0;d<a;++d)(c=i[d])&&(l[d]=c);l.sort(t)}return new ot(o,this._parents).order()}function ow(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function sw(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function iw(){return Array.from(this)}function aw(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length;o<s;++o){var i=r[o];if(i)return i}return null}function lw(){let e=0;for(const t of this)++e;return e}function cw(){return!this.node()}function uw(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],s=0,i=o.length,a;s<i;++s)(a=o[s])&&e.call(a,a.__data__,s,o);return this}function dw(e){return function(){this.removeAttribute(e)}}function fw(e){return function(){this.removeAttributeNS(e.space,e.local)}}function hw(e,t){return function(){this.setAttribute(e,t)}}function pw(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function gw(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function mw(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function yw(e,t){var n=mi(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?fw:dw:typeof t=="function"?n.local?mw:gw:n.local?pw:hw)(n,t))}function vf(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ww(e){return function(){this.style.removeProperty(e)}}function xw(e,t,n){return function(){this.style.setProperty(e,t,n)}}function vw(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function bw(e,t,n){return arguments.length>1?this.each((t==null?ww:typeof t=="function"?vw:xw)(e,t,n??"")):Mr(this.node(),e)}function Mr(e,t){return e.style.getPropertyValue(t)||vf(e).getComputedStyle(e,null).getPropertyValue(t)}function Aw(e){return function(){delete this[e]}}function Ew(e,t){return function(){this[e]=t}}function Sw(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Mw(e,t){return arguments.length>1?this.each((t==null?Aw:typeof t=="function"?Sw:Ew)(e,t)):this.node()[e]}function bf(e){return e.trim().split(/^|\s+/)}function kl(e){return e.classList||new Af(e)}function Af(e){this._node=e,this._names=bf(e.getAttribute("class")||"")}Af.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Ef(e,t){for(var n=kl(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function Sf(e,t){for(var n=kl(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Cw(e){return function(){Ef(this,e)}}function Pw(e){return function(){Sf(this,e)}}function Rw(e,t){return function(){(t.apply(this,arguments)?Ef:Sf)(this,e)}}function Iw(e,t){var n=bf(e+"");if(arguments.length<2){for(var r=kl(this.node()),o=-1,s=n.length;++o<s;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?Rw:t?Cw:Pw)(n,t))}function Nw(){this.textContent=""}function Tw(e){return function(){this.textContent=e}}function kw(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function _w(e){return arguments.length?this.each(e==null?Nw:(typeof e=="function"?kw:Tw)(e)):this.node().textContent}function Dw(){this.innerHTML=""}function Ow(e){return function(){this.innerHTML=e}}function Lw(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Bw(e){return arguments.length?this.each(e==null?Dw:(typeof e=="function"?Lw:Ow)(e)):this.node().innerHTML}function Fw(){this.nextSibling&&this.parentNode.appendChild(this)}function jw(){return this.each(Fw)}function qw(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function zw(){return this.each(qw)}function Hw(e){var t=typeof e=="function"?e:gf(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Vw(){return null}function Uw(e,t){var n=typeof e=="function"?e:gf(e),r=t==null?Vw:typeof t=="function"?t:Tl(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function $w(){var e=this.parentNode;e&&e.removeChild(this)}function Gw(){return this.each($w)}function Kw(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ww(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Yw(e){return this.select(e?Ww:Kw)}function Xw(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Qw(e){return function(t){e.call(this,t,this.__data__)}}function Zw(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Jw(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,s;n<o;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function ex(e,t,n){return function(){var r=this.__on,o,s=Qw(t);if(r){for(var i=0,a=r.length;i<a;++i)if((o=r[i]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=s,o.options=n),o.value=t;return}}this.addEventListener(e.type,s,n),o={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(o):this.__on=[o]}}function tx(e,t,n){var r=Zw(e+""),o,s=r.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,d;l<c;++l)for(o=0,d=a[l];o<s;++o)if((i=r[o]).type===d.type&&i.name===d.name)return d.value}return}for(a=t?ex:Jw,o=0;o<s;++o)this.each(a(r[o],t,n));return this}function Mf(e,t,n){var r=vf(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function nx(e,t){return function(){return Mf(this,e,t)}}function rx(e,t){return function(){return Mf(this,e,t.apply(this,arguments))}}function ox(e,t){return this.each((typeof t=="function"?rx:nx)(e,t))}function*sx(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length,i;o<s;++o)(i=r[o])&&(yield i)}var Cf=[null];function ot(e,t){this._groups=e,this._parents=t}function Oo(){return new ot([[document.documentElement]],Cf)}function ix(){return this}ot.prototype=Oo.prototype={constructor:ot,select:ky,selectAll:Ly,selectChild:qy,selectChildren:Uy,filter:$y,data:Qy,enter:Gy,exit:Jy,join:ew,merge:tw,selection:ix,order:nw,sort:rw,call:sw,nodes:iw,node:aw,size:lw,empty:cw,each:uw,attr:yw,style:bw,property:Mw,classed:Iw,text:_w,html:Bw,raise:jw,lower:zw,append:Hw,insert:Uw,remove:Gw,clone:Yw,datum:Xw,on:tx,dispatch:ox,[Symbol.iterator]:sx};function et(e){return typeof e=="string"?new ot([[document.querySelector(e)]],[document.documentElement]):new ot([[e]],Cf)}function ax(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Mt(e,t){if(e=ax(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const lx={passive:!1},go={capture:!0,passive:!1};function na(e){e.stopImmediatePropagation()}function xr(e){e.preventDefault(),e.stopImmediatePropagation()}function Pf(e){var t=e.document.documentElement,n=et(e).on("dragstart.drag",xr,go);"onselectstart"in t?n.on("selectstart.drag",xr,go):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Rf(e,t){var n=e.document.documentElement,r=et(e).on("dragstart.drag",null);t&&(r.on("click.drag",xr,go),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const es=e=>()=>e;function Oa(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:s,x:i,y:a,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}Oa.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function cx(e){return!e.ctrlKey&&!e.button}function ux(){return this.parentNode}function dx(e,t){return t??{x:e.x,y:e.y}}function fx(){return navigator.maxTouchPoints||"ontouchstart"in this}function If(){var e=cx,t=ux,n=dx,r=fx,o={},s=gi("start","drag","end"),i=0,a,l,c,d,f=0;function u(E){E.on("mousedown.drag",h).filter(r).on("touchstart.drag",g).on("touchmove.drag",y,lx).on("touchend.drag touchcancel.drag",A).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(E,R){if(!(d||!e.call(this,E,R))){var b=w(this,t.call(this,E,R),E,R,"mouse");b&&(et(E.view).on("mousemove.drag",p,go).on("mouseup.drag",m,go),Pf(E.view),na(E),c=!1,a=E.clientX,l=E.clientY,b("start",E))}}function p(E){if(xr(E),!c){var R=E.clientX-a,b=E.clientY-l;c=R*R+b*b>f}o.mouse("drag",E)}function m(E){et(E.view).on("mousemove.drag mouseup.drag",null),Rf(E.view,c),xr(E),o.mouse("end",E)}function g(E,R){if(e.call(this,E,R)){var b=E.changedTouches,v=t.call(this,E,R),C=b.length,T,k;for(T=0;T<C;++T)(k=w(this,v,E,R,b[T].identifier,b[T]))&&(na(E),k("start",E,b[T]))}}function y(E){var R=E.changedTouches,b=R.length,v,C;for(v=0;v<b;++v)(C=o[R[v].identifier])&&(xr(E),C("drag",E,R[v]))}function A(E){var R=E.changedTouches,b=R.length,v,C;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),v=0;v<b;++v)(C=o[R[v].identifier])&&(na(E),C("end",E,R[v]))}function w(E,R,b,v,C,T){var k=s.copy(),D=Mt(T||b,R),B,j,P;if((P=n.call(E,new Oa("beforestart",{sourceEvent:b,target:u,identifier:C,active:i,x:D[0],y:D[1],dx:0,dy:0,dispatch:k}),v))!=null)return B=P.x-D[0]||0,j=P.y-D[1]||0,function O(I,_,F){var N=D,z;switch(I){case"start":o[C]=O,z=i++;break;case"end":delete o[C],--i;case"drag":D=Mt(F||_,R),z=i;break}k.call(I,E,new Oa(I,{sourceEvent:_,subject:P,target:u,identifier:C,active:z,x:D[0]+B,y:D[1]+j,dx:D[0]-N[0],dy:D[1]-N[1],dispatch:k}),v)}}return u.filter=function(E){return arguments.length?(e=typeof E=="function"?E:es(!!E),u):e},u.container=function(E){return arguments.length?(t=typeof E=="function"?E:es(E),u):t},u.subject=function(E){return arguments.length?(n=typeof E=="function"?E:es(E),u):n},u.touchable=function(E){return arguments.length?(r=typeof E=="function"?E:es(!!E),u):r},u.on=function(){var E=s.on.apply(s,arguments);return E===s?u:E},u.clickDistance=function(E){return arguments.length?(f=(E=+E)*E,u):Math.sqrt(f)},u}function _l(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Nf(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Lo(){}var mo=.7,Os=1/mo,vr="\\s*([+-]?\\d+)\\s*",yo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Bt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hx=/^#([0-9a-f]{3,8})$/,px=new RegExp(`^rgb\\(${vr},${vr},${vr}\\)$`),gx=new RegExp(`^rgb\\(${Bt},${Bt},${Bt}\\)$`),mx=new RegExp(`^rgba\\(${vr},${vr},${vr},${yo}\\)$`),yx=new RegExp(`^rgba\\(${Bt},${Bt},${Bt},${yo}\\)$`),wx=new RegExp(`^hsl\\(${yo},${Bt},${Bt}\\)$`),xx=new RegExp(`^hsla\\(${yo},${Bt},${Bt},${yo}\\)$`),Yc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};_l(Lo,wo,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Xc,formatHex:Xc,formatHex8:vx,formatHsl:bx,formatRgb:Qc,toString:Qc});function Xc(){return this.rgb().formatHex()}function vx(){return this.rgb().formatHex8()}function bx(){return Tf(this).formatHsl()}function Qc(){return this.rgb().formatRgb()}function wo(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=hx.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Zc(t):n===3?new Ke(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ts(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ts(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=px.exec(e))?new Ke(t[1],t[2],t[3],1):(t=gx.exec(e))?new Ke(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=mx.exec(e))?ts(t[1],t[2],t[3],t[4]):(t=yx.exec(e))?ts(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=wx.exec(e))?tu(t[1],t[2]/100,t[3]/100,1):(t=xx.exec(e))?tu(t[1],t[2]/100,t[3]/100,t[4]):Yc.hasOwnProperty(e)?Zc(Yc[e]):e==="transparent"?new Ke(NaN,NaN,NaN,0):null}function Zc(e){return new Ke(e>>16&255,e>>8&255,e&255,1)}function ts(e,t,n,r){return r<=0&&(e=t=n=NaN),new Ke(e,t,n,r)}function Ax(e){return e instanceof Lo||(e=wo(e)),e?(e=e.rgb(),new Ke(e.r,e.g,e.b,e.opacity)):new Ke}function La(e,t,n,r){return arguments.length===1?Ax(e):new Ke(e,t,n,r??1)}function Ke(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}_l(Ke,La,Nf(Lo,{brighter(e){return e=e==null?Os:Math.pow(Os,e),new Ke(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?mo:Math.pow(mo,e),new Ke(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ke(Ln(this.r),Ln(this.g),Ln(this.b),Ls(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Jc,formatHex:Jc,formatHex8:Ex,formatRgb:eu,toString:eu}));function Jc(){return`#${Dn(this.r)}${Dn(this.g)}${Dn(this.b)}`}function Ex(){return`#${Dn(this.r)}${Dn(this.g)}${Dn(this.b)}${Dn((isNaN(this.opacity)?1:this.opacity)*255)}`}function eu(){const e=Ls(this.opacity);return`${e===1?"rgb(":"rgba("}${Ln(this.r)}, ${Ln(this.g)}, ${Ln(this.b)}${e===1?")":`, ${e})`}`}function Ls(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ln(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Dn(e){return e=Ln(e),(e<16?"0":"")+e.toString(16)}function tu(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ct(e,t,n,r)}function Tf(e){if(e instanceof Ct)return new Ct(e.h,e.s,e.l,e.opacity);if(e instanceof Lo||(e=wo(e)),!e)return new Ct;if(e instanceof Ct)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),s=Math.max(t,n,r),i=NaN,a=s-o,l=(s+o)/2;return a?(t===s?i=(n-r)/a+(n<r)*6:n===s?i=(r-t)/a+2:i=(t-n)/a+4,a/=l<.5?s+o:2-s-o,i*=60):a=l>0&&l<1?0:i,new Ct(i,a,l,e.opacity)}function Sx(e,t,n,r){return arguments.length===1?Tf(e):new Ct(e,t,n,r??1)}function Ct(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}_l(Ct,Sx,Nf(Lo,{brighter(e){return e=e==null?Os:Math.pow(Os,e),new Ct(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?mo:Math.pow(mo,e),new Ct(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new Ke(ra(e>=240?e-240:e+120,o,r),ra(e,o,r),ra(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new Ct(nu(this.h),ns(this.s),ns(this.l),Ls(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ls(this.opacity);return`${e===1?"hsl(":"hsla("}${nu(this.h)}, ${ns(this.s)*100}%, ${ns(this.l)*100}%${e===1?")":`, ${e})`}`}}));function nu(e){return e=(e||0)%360,e<0?e+360:e}function ns(e){return Math.max(0,Math.min(1,e||0))}function ra(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const kf=e=>()=>e;function Mx(e,t){return function(n){return e+n*t}}function Cx(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Px(e){return(e=+e)==1?_f:function(t,n){return n-t?Cx(t,n,e):kf(isNaN(t)?n:t)}}function _f(e,t){var n=t-e;return n?Mx(e,n):kf(isNaN(e)?t:e)}const ru=function e(t){var n=Px(t);function r(o,s){var i=n((o=La(o)).r,(s=La(s)).r),a=n(o.g,s.g),l=n(o.b,s.b),c=_f(o.opacity,s.opacity);return function(d){return o.r=i(d),o.g=a(d),o.b=l(d),o.opacity=c(d),o+""}}return r.gamma=e,r}(1);function cn(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Ba=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,oa=new RegExp(Ba.source,"g");function Rx(e){return function(){return e}}function Ix(e){return function(t){return e(t)+""}}function Nx(e,t){var n=Ba.lastIndex=oa.lastIndex=0,r,o,s,i=-1,a=[],l=[];for(e=e+"",t=t+"";(r=Ba.exec(e))&&(o=oa.exec(t));)(s=o.index)>n&&(s=t.slice(n,s),a[i]?a[i]+=s:a[++i]=s),(r=r[0])===(o=o[0])?a[i]?a[i]+=o:a[++i]=o:(a[++i]=null,l.push({i,x:cn(r,o)})),n=oa.lastIndex;return n<t.length&&(s=t.slice(n),a[i]?a[i]+=s:a[++i]=s),a.length<2?l[0]?Ix(l[0].x):Rx(t):(t=l.length,function(c){for(var d=0,f;d<t;++d)a[(f=l[d]).i]=f.x(c);return a.join("")})}var ou=180/Math.PI,Fa={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Df(e,t,n,r,o,s){var i,a,l;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,i=-i),{translateX:o,translateY:s,rotate:Math.atan2(t,e)*ou,skewX:Math.atan(l)*ou,scaleX:i,scaleY:a}}var rs;function Tx(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Fa:Df(t.a,t.b,t.c,t.d,t.e,t.f)}function kx(e){return e==null||(rs||(rs=document.createElementNS("http://www.w3.org/2000/svg","g")),rs.setAttribute("transform",e),!(e=rs.transform.baseVal.consolidate()))?Fa:(e=e.matrix,Df(e.a,e.b,e.c,e.d,e.e,e.f))}function Of(e,t,n,r){function o(c){return c.length?c.pop()+" ":""}function s(c,d,f,u,h,p){if(c!==f||d!==u){var m=h.push("translate(",null,t,null,n);p.push({i:m-4,x:cn(c,f)},{i:m-2,x:cn(d,u)})}else(f||u)&&h.push("translate("+f+t+u+n)}function i(c,d,f,u){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),u.push({i:f.push(o(f)+"rotate(",null,r)-2,x:cn(c,d)})):d&&f.push(o(f)+"rotate("+d+r)}function a(c,d,f,u){c!==d?u.push({i:f.push(o(f)+"skewX(",null,r)-2,x:cn(c,d)}):d&&f.push(o(f)+"skewX("+d+r)}function l(c,d,f,u,h,p){if(c!==f||d!==u){var m=h.push(o(h)+"scale(",null,",",null,")");p.push({i:m-4,x:cn(c,f)},{i:m-2,x:cn(d,u)})}else(f!==1||u!==1)&&h.push(o(h)+"scale("+f+","+u+")")}return function(c,d){var f=[],u=[];return c=e(c),d=e(d),s(c.translateX,c.translateY,d.translateX,d.translateY,f,u),i(c.rotate,d.rotate,f,u),a(c.skewX,d.skewX,f,u),l(c.scaleX,c.scaleY,d.scaleX,d.scaleY,f,u),c=d=null,function(h){for(var p=-1,m=u.length,g;++p<m;)f[(g=u[p]).i]=g.x(h);return f.join("")}}}var _x=Of(Tx,"px, ","px)","deg)"),Dx=Of(kx,", ",")",")"),Ox=1e-12;function su(e){return((e=Math.exp(e))+1/e)/2}function Lx(e){return((e=Math.exp(e))-1/e)/2}function Bx(e){return((e=Math.exp(2*e))-1)/(e+1)}const Fx=function e(t,n,r){function o(s,i){var a=s[0],l=s[1],c=s[2],d=i[0],f=i[1],u=i[2],h=d-a,p=f-l,m=h*h+p*p,g,y;if(m<Ox)y=Math.log(u/c)/t,g=function(v){return[a+v*h,l+v*p,c*Math.exp(t*v*y)]};else{var A=Math.sqrt(m),w=(u*u-c*c+r*m)/(2*c*n*A),E=(u*u-c*c-r*m)/(2*u*n*A),R=Math.log(Math.sqrt(w*w+1)-w),b=Math.log(Math.sqrt(E*E+1)-E);y=(b-R)/t,g=function(v){var C=v*y,T=su(R),k=c/(n*A)*(T*Bx(t*C+R)-Lx(R));return[a+k*h,l+k*p,c*T/su(t*C+R)]}}return g.duration=y*1e3*t/Math.SQRT2,g}return o.rho=function(s){var i=Math.max(.001,+s),a=i*i,l=a*a;return e(i,a,l)},o}(Math.SQRT2,2,4);var Cr=0,Xr=0,Ur=0,Lf=1e3,Bs,Qr,Fs=0,zn=0,yi=0,xo=typeof performance=="object"&&performance.now?performance:Date,Bf=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Dl(){return zn||(Bf(jx),zn=xo.now()+yi)}function jx(){zn=0}function js(){this._call=this._time=this._next=null}js.prototype=Ff.prototype={constructor:js,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Dl():+n)+(t==null?0:+t),!this._next&&Qr!==this&&(Qr?Qr._next=this:Bs=this,Qr=this),this._call=e,this._time=n,ja()},stop:function(){this._call&&(this._call=null,this._time=1/0,ja())}};function Ff(e,t,n){var r=new js;return r.restart(e,t,n),r}function qx(){Dl(),++Cr;for(var e=Bs,t;e;)(t=zn-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Cr}function iu(){zn=(Fs=xo.now())+yi,Cr=Xr=0;try{qx()}finally{Cr=0,Hx(),zn=0}}function zx(){var e=xo.now(),t=e-Fs;t>Lf&&(yi-=t,Fs=e)}function Hx(){for(var e,t=Bs,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Bs=n);Qr=e,ja(r)}function ja(e){if(!Cr){Xr&&(Xr=clearTimeout(Xr));var t=e-zn;t>24?(e<1/0&&(Xr=setTimeout(iu,e-xo.now()-yi)),Ur&&(Ur=clearInterval(Ur))):(Ur||(Fs=xo.now(),Ur=setInterval(zx,Lf)),Cr=1,Bf(iu))}}function au(e,t,n){var r=new js;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var Vx=gi("start","end","cancel","interrupt"),Ux=[],jf=0,lu=1,qa=2,xs=3,cu=4,za=5,vs=6;function wi(e,t,n,r,o,s){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;$x(e,n,{name:t,index:r,group:o,on:Vx,tween:Ux,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:jf})}function Ol(e,t){var n=_t(e,t);if(n.state>jf)throw new Error("too late; already scheduled");return n}function Ut(e,t){var n=_t(e,t);if(n.state>xs)throw new Error("too late; already running");return n}function _t(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function $x(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=Ff(s,0,n.time);function s(c){n.state=lu,n.timer.restart(i,n.delay,n.time),n.delay<=c&&i(c-n.delay)}function i(c){var d,f,u,h;if(n.state!==lu)return l();for(d in r)if(h=r[d],h.name===n.name){if(h.state===xs)return au(i);h.state===cu?(h.state=vs,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[d]):+d<t&&(h.state=vs,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[d])}if(au(function(){n.state===xs&&(n.state=cu,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=qa,n.on.call("start",e,e.__data__,n.index,n.group),n.state===qa){for(n.state=xs,o=new Array(u=n.tween.length),d=0,f=-1;d<u;++d)(h=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(o[++f]=h);o.length=f+1}}function a(c){for(var d=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=za,1),f=-1,u=o.length;++f<u;)o[f].call(e,d);n.state===za&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=vs,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function bs(e,t){var n=e.__transition,r,o,s=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){s=!1;continue}o=r.state>qa&&r.state<za,r.state=vs,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}s&&delete e.__transition}}function Gx(e){return this.each(function(){bs(this,e)})}function Kx(e,t){var n,r;return function(){var o=Ut(this,e),s=o.tween;if(s!==n){r=n=s;for(var i=0,a=r.length;i<a;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}o.tween=r}}function Wx(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var s=Ut(this,e),i=s.tween;if(i!==r){o=(r=i).slice();for(var a={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=a;break}l===c&&o.push(a)}s.tween=o}}function Yx(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=_t(this.node(),n).tween,o=0,s=r.length,i;o<s;++o)if((i=r[o]).name===e)return i.value;return null}return this.each((t==null?Kx:Wx)(n,e,t))}function Ll(e,t,n){var r=e._id;return e.each(function(){var o=Ut(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return _t(o,r).value[t]}}function qf(e,t){var n;return(typeof t=="number"?cn:t instanceof wo?ru:(n=wo(t))?(t=n,ru):Nx)(e,t)}function Xx(e){return function(){this.removeAttribute(e)}}function Qx(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Zx(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttribute(e);return i===o?null:i===r?s:s=t(r=i,n)}}function Jx(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttributeNS(e.space,e.local);return i===o?null:i===r?s:s=t(r=i,n)}}function ev(e,t,n){var r,o,s;return function(){var i,a=n(this),l;return a==null?void this.removeAttribute(e):(i=this.getAttribute(e),l=a+"",i===l?null:i===r&&l===o?s:(o=l,s=t(r=i,a)))}}function tv(e,t,n){var r,o,s;return function(){var i,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),l=a+"",i===l?null:i===r&&l===o?s:(o=l,s=t(r=i,a)))}}function nv(e,t){var n=mi(e),r=n==="transform"?Dx:qf;return this.attrTween(e,typeof t=="function"?(n.local?tv:ev)(n,r,Ll(this,"attr."+e,t)):t==null?(n.local?Qx:Xx)(n):(n.local?Jx:Zx)(n,r,t))}function rv(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function ov(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function sv(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&ov(e,s)),n}return o._value=t,o}function iv(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&rv(e,s)),n}return o._value=t,o}function av(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=mi(e);return this.tween(n,(r.local?sv:iv)(r,t))}function lv(e,t){return function(){Ol(this,e).delay=+t.apply(this,arguments)}}function cv(e,t){return t=+t,function(){Ol(this,e).delay=t}}function uv(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?lv:cv)(t,e)):_t(this.node(),t).delay}function dv(e,t){return function(){Ut(this,e).duration=+t.apply(this,arguments)}}function fv(e,t){return t=+t,function(){Ut(this,e).duration=t}}function hv(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?dv:fv)(t,e)):_t(this.node(),t).duration}function pv(e,t){if(typeof t!="function")throw new Error;return function(){Ut(this,e).ease=t}}function gv(e){var t=this._id;return arguments.length?this.each(pv(t,e)):_t(this.node(),t).ease}function mv(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ut(this,e).ease=n}}function yv(e){if(typeof e!="function")throw new Error;return this.each(mv(this._id,e))}function wv(e){typeof e!="function"&&(e=yf(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],l,c=0;c<i;++c)(l=s[c])&&e.call(l,l.__data__,c,s)&&a.push(l);return new Jt(r,this._parents,this._name,this._id)}function xv(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,s=Math.min(r,o),i=new Array(r),a=0;a<s;++a)for(var l=t[a],c=n[a],d=l.length,f=i[a]=new Array(d),u,h=0;h<d;++h)(u=l[h]||c[h])&&(f[h]=u);for(;a<r;++a)i[a]=t[a];return new Jt(i,this._parents,this._name,this._id)}function vv(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function bv(e,t,n){var r,o,s=vv(t)?Ol:Ut;return function(){var i=s(this,e),a=i.on;a!==r&&(o=(r=a).copy()).on(t,n),i.on=o}}function Av(e,t){var n=this._id;return arguments.length<2?_t(this.node(),n).on.on(e):this.each(bv(n,e,t))}function Ev(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Sv(){return this.on("end.remove",Ev(this._id))}function Mv(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Tl(e));for(var r=this._groups,o=r.length,s=new Array(o),i=0;i<o;++i)for(var a=r[i],l=a.length,c=s[i]=new Array(l),d,f,u=0;u<l;++u)(d=a[u])&&(f=e.call(d,d.__data__,u,a))&&("__data__"in d&&(f.__data__=d.__data__),c[u]=f,wi(c[u],t,n,u,c,_t(d,n)));return new Jt(s,this._parents,t,n)}function Cv(e){var t=this._name,n=this._id;typeof e!="function"&&(e=mf(e));for(var r=this._groups,o=r.length,s=[],i=[],a=0;a<o;++a)for(var l=r[a],c=l.length,d,f=0;f<c;++f)if(d=l[f]){for(var u=e.call(d,d.__data__,f,l),h,p=_t(d,n),m=0,g=u.length;m<g;++m)(h=u[m])&&wi(h,t,n,m,u,p);s.push(u),i.push(d)}return new Jt(s,i,t,n)}var Pv=Oo.prototype.constructor;function Rv(){return new Pv(this._groups,this._parents)}function Iv(e,t){var n,r,o;return function(){var s=Mr(this,e),i=(this.style.removeProperty(e),Mr(this,e));return s===i?null:s===n&&i===r?o:o=t(n=s,r=i)}}function zf(e){return function(){this.style.removeProperty(e)}}function Nv(e,t,n){var r,o=n+"",s;return function(){var i=Mr(this,e);return i===o?null:i===r?s:s=t(r=i,n)}}function Tv(e,t,n){var r,o,s;return function(){var i=Mr(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),Mr(this,e))),i===l?null:i===r&&l===o?s:(o=l,s=t(r=i,a))}}function kv(e,t){var n,r,o,s="style."+t,i="end."+s,a;return function(){var l=Ut(this,e),c=l.on,d=l.value[s]==null?a||(a=zf(t)):void 0;(c!==n||o!==d)&&(r=(n=c).copy()).on(i,o=d),l.on=r}}function _v(e,t,n){var r=(e+="")=="transform"?_x:qf;return t==null?this.styleTween(e,Iv(e,r)).on("end.style."+e,zf(e)):typeof t=="function"?this.styleTween(e,Tv(e,r,Ll(this,"style."+e,t))).each(kv(this._id,e)):this.styleTween(e,Nv(e,r,t),n).on("end.style."+e,null)}function Dv(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Ov(e,t,n){var r,o;function s(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&Dv(e,i,n)),r}return s._value=t,s}function Lv(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Ov(e,t,n??""))}function Bv(e){return function(){this.textContent=e}}function Fv(e){return function(){var t=e(this);this.textContent=t??""}}function jv(e){return this.tween("text",typeof e=="function"?Fv(Ll(this,"text",e)):Bv(e==null?"":e+""))}function qv(e){return function(t){this.textContent=e.call(this,t)}}function zv(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&qv(o)),t}return r._value=e,r}function Hv(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,zv(e))}function Vv(){for(var e=this._name,t=this._id,n=Hf(),r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,l,c=0;c<a;++c)if(l=i[c]){var d=_t(l,t);wi(l,e,n,c,i,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Jt(r,this._parents,e,n)}function Uv(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(s,i){var a={value:i},l={value:function(){--o===0&&s()}};n.each(function(){var c=Ut(this,r),d=c.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),c.on=t}),o===0&&s()})}var $v=0;function Jt(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Hf(){return++$v}var Gt=Oo.prototype;Jt.prototype={constructor:Jt,select:Mv,selectAll:Cv,selectChild:Gt.selectChild,selectChildren:Gt.selectChildren,filter:wv,merge:xv,selection:Rv,transition:Vv,call:Gt.call,nodes:Gt.nodes,node:Gt.node,size:Gt.size,empty:Gt.empty,each:Gt.each,on:Av,attr:nv,attrTween:av,style:_v,styleTween:Lv,text:jv,textTween:Hv,remove:Sv,tween:Yx,delay:uv,duration:hv,ease:gv,easeVarying:yv,end:Uv,[Symbol.iterator]:Gt[Symbol.iterator]};function Gv(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Kv={time:null,delay:0,duration:250,ease:Gv};function Wv(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Yv(e){var t,n;e instanceof Jt?(t=e._id,e=e._name):(t=Hf(),(n=Kv).time=Dl(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,l,c=0;c<a;++c)(l=i[c])&&wi(l,e,t,c,i,n||Wv(l,t));return new Jt(r,this._parents,e,t)}Oo.prototype.interrupt=Gx;Oo.prototype.transition=Yv;const os=e=>()=>e;function Xv(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Yt(e,t,n){this.k=e,this.x=t,this.y=n}Yt.prototype={constructor:Yt,scale:function(e){return e===1?this:new Yt(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Yt(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var xi=new Yt(1,0,0);Vf.prototype=Yt.prototype;function Vf(e){for(;!e.__zoom;)if(!(e=e.parentNode))return xi;return e.__zoom}function sa(e){e.stopImmediatePropagation()}function $r(e){e.preventDefault(),e.stopImmediatePropagation()}function Qv(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Zv(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function uu(){return this.__zoom||xi}function Jv(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function eb(){return navigator.maxTouchPoints||"ontouchstart"in this}function tb(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function Uf(){var e=Qv,t=Zv,n=tb,r=Jv,o=eb,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,l=Fx,c=gi("start","zoom","end"),d,f,u,h=500,p=150,m=0,g=10;function y(P){P.property("__zoom",uu).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",T).on("dblclick.zoom",k).filter(o).on("touchstart.zoom",D).on("touchmove.zoom",B).on("touchend.zoom touchcancel.zoom",j).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(P,O,I,_){var F=P.selection?P.selection():P;F.property("__zoom",uu),P!==F?R(P,O,I,_):F.interrupt().each(function(){b(this,arguments).event(_).start().zoom(null,typeof O=="function"?O.apply(this,arguments):O).end()})},y.scaleBy=function(P,O,I,_){y.scaleTo(P,function(){var F=this.__zoom.k,N=typeof O=="function"?O.apply(this,arguments):O;return F*N},I,_)},y.scaleTo=function(P,O,I,_){y.transform(P,function(){var F=t.apply(this,arguments),N=this.__zoom,z=I==null?E(F):typeof I=="function"?I.apply(this,arguments):I,V=N.invert(z),U=typeof O=="function"?O.apply(this,arguments):O;return n(w(A(N,U),z,V),F,i)},I,_)},y.translateBy=function(P,O,I,_){y.transform(P,function(){return n(this.__zoom.translate(typeof O=="function"?O.apply(this,arguments):O,typeof I=="function"?I.apply(this,arguments):I),t.apply(this,arguments),i)},null,_)},y.translateTo=function(P,O,I,_,F){y.transform(P,function(){var N=t.apply(this,arguments),z=this.__zoom,V=_==null?E(N):typeof _=="function"?_.apply(this,arguments):_;return n(xi.translate(V[0],V[1]).scale(z.k).translate(typeof O=="function"?-O.apply(this,arguments):-O,typeof I=="function"?-I.apply(this,arguments):-I),N,i)},_,F)};function A(P,O){return O=Math.max(s[0],Math.min(s[1],O)),O===P.k?P:new Yt(O,P.x,P.y)}function w(P,O,I){var _=O[0]-I[0]*P.k,F=O[1]-I[1]*P.k;return _===P.x&&F===P.y?P:new Yt(P.k,_,F)}function E(P){return[(+P[0][0]+ +P[1][0])/2,(+P[0][1]+ +P[1][1])/2]}function R(P,O,I,_){P.on("start.zoom",function(){b(this,arguments).event(_).start()}).on("interrupt.zoom end.zoom",function(){b(this,arguments).event(_).end()}).tween("zoom",function(){var F=this,N=arguments,z=b(F,N).event(_),V=t.apply(F,N),U=I==null?E(V):typeof I=="function"?I.apply(F,N):I,K=Math.max(V[1][0]-V[0][0],V[1][1]-V[0][1]),Y=F.__zoom,ee=typeof O=="function"?O.apply(F,N):O,Z=l(Y.invert(U).concat(K/Y.k),ee.invert(U).concat(K/ee.k));return function(q){if(q===1)q=ee;else{var W=Z(q),te=K/W[2];q=new Yt(te,U[0]-W[0]*te,U[1]-W[1]*te)}z.zoom(null,q)}})}function b(P,O,I){return!I&&P.__zooming||new v(P,O)}function v(P,O){this.that=P,this.args=O,this.active=0,this.sourceEvent=null,this.extent=t.apply(P,O),this.taps=0}v.prototype={event:function(P){return P&&(this.sourceEvent=P),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(P,O){return this.mouse&&P!=="mouse"&&(this.mouse[1]=O.invert(this.mouse[0])),this.touch0&&P!=="touch"&&(this.touch0[1]=O.invert(this.touch0[0])),this.touch1&&P!=="touch"&&(this.touch1[1]=O.invert(this.touch1[0])),this.that.__zoom=O,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(P){var O=et(this.that).datum();c.call(P,this.that,new Xv(P,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:c}),O)}};function C(P,...O){if(!e.apply(this,arguments))return;var I=b(this,O).event(P),_=this.__zoom,F=Math.max(s[0],Math.min(s[1],_.k*Math.pow(2,r.apply(this,arguments)))),N=Mt(P);if(I.wheel)(I.mouse[0][0]!==N[0]||I.mouse[0][1]!==N[1])&&(I.mouse[1]=_.invert(I.mouse[0]=N)),clearTimeout(I.wheel);else{if(_.k===F)return;I.mouse=[N,_.invert(N)],bs(this),I.start()}$r(P),I.wheel=setTimeout(z,p),I.zoom("mouse",n(w(A(_,F),I.mouse[0],I.mouse[1]),I.extent,i));function z(){I.wheel=null,I.end()}}function T(P,...O){if(u||!e.apply(this,arguments))return;var I=P.currentTarget,_=b(this,O,!0).event(P),F=et(P.view).on("mousemove.zoom",U,!0).on("mouseup.zoom",K,!0),N=Mt(P,I),z=P.clientX,V=P.clientY;Pf(P.view),sa(P),_.mouse=[N,this.__zoom.invert(N)],bs(this),_.start();function U(Y){if($r(Y),!_.moved){var ee=Y.clientX-z,Z=Y.clientY-V;_.moved=ee*ee+Z*Z>m}_.event(Y).zoom("mouse",n(w(_.that.__zoom,_.mouse[0]=Mt(Y,I),_.mouse[1]),_.extent,i))}function K(Y){F.on("mousemove.zoom mouseup.zoom",null),Rf(Y.view,_.moved),$r(Y),_.event(Y).end()}}function k(P,...O){if(e.apply(this,arguments)){var I=this.__zoom,_=Mt(P.changedTouches?P.changedTouches[0]:P,this),F=I.invert(_),N=I.k*(P.shiftKey?.5:2),z=n(w(A(I,N),_,F),t.apply(this,O),i);$r(P),a>0?et(this).transition().duration(a).call(R,z,_,P):et(this).call(y.transform,z,_,P)}}function D(P,...O){if(e.apply(this,arguments)){var I=P.touches,_=I.length,F=b(this,O,P.changedTouches.length===_).event(P),N,z,V,U;for(sa(P),z=0;z<_;++z)V=I[z],U=Mt(V,this),U=[U,this.__zoom.invert(U),V.identifier],F.touch0?!F.touch1&&F.touch0[2]!==U[2]&&(F.touch1=U,F.taps=0):(F.touch0=U,N=!0,F.taps=1+!!d);d&&(d=clearTimeout(d)),N&&(F.taps<2&&(f=U[0],d=setTimeout(function(){d=null},h)),bs(this),F.start())}}function B(P,...O){if(this.__zooming){var I=b(this,O).event(P),_=P.changedTouches,F=_.length,N,z,V,U;for($r(P),N=0;N<F;++N)z=_[N],V=Mt(z,this),I.touch0&&I.touch0[2]===z.identifier?I.touch0[0]=V:I.touch1&&I.touch1[2]===z.identifier&&(I.touch1[0]=V);if(z=I.that.__zoom,I.touch1){var K=I.touch0[0],Y=I.touch0[1],ee=I.touch1[0],Z=I.touch1[1],q=(q=ee[0]-K[0])*q+(q=ee[1]-K[1])*q,W=(W=Z[0]-Y[0])*W+(W=Z[1]-Y[1])*W;z=A(z,Math.sqrt(q/W)),V=[(K[0]+ee[0])/2,(K[1]+ee[1])/2],U=[(Y[0]+Z[0])/2,(Y[1]+Z[1])/2]}else if(I.touch0)V=I.touch0[0],U=I.touch0[1];else return;I.zoom("touch",n(w(z,V,U),I.extent,i))}}function j(P,...O){if(this.__zooming){var I=b(this,O).event(P),_=P.changedTouches,F=_.length,N,z;for(sa(P),u&&clearTimeout(u),u=setTimeout(function(){u=null},h),N=0;N<F;++N)z=_[N],I.touch0&&I.touch0[2]===z.identifier?delete I.touch0:I.touch1&&I.touch1[2]===z.identifier&&delete I.touch1;if(I.touch1&&!I.touch0&&(I.touch0=I.touch1,delete I.touch1),I.touch0)I.touch0[1]=this.__zoom.invert(I.touch0[0]);else if(I.end(),I.taps===2&&(z=Mt(z,this),Math.hypot(f[0]-z[0],f[1]-z[1])<g)){var V=et(this).on("dblclick.zoom");V&&V.apply(this,arguments)}}}return y.wheelDelta=function(P){return arguments.length?(r=typeof P=="function"?P:os(+P),y):r},y.filter=function(P){return arguments.length?(e=typeof P=="function"?P:os(!!P),y):e},y.touchable=function(P){return arguments.length?(o=typeof P=="function"?P:os(!!P),y):o},y.extent=function(P){return arguments.length?(t=typeof P=="function"?P:os([[+P[0][0],+P[0][1]],[+P[1][0],+P[1][1]]]),y):t},y.scaleExtent=function(P){return arguments.length?(s[0]=+P[0],s[1]=+P[1],y):[s[0],s[1]]},y.translateExtent=function(P){return arguments.length?(i[0][0]=+P[0][0],i[1][0]=+P[1][0],i[0][1]=+P[0][1],i[1][1]=+P[1][1],y):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},y.constrain=function(P){return arguments.length?(n=P,y):n},y.duration=function(P){return arguments.length?(a=+P,y):a},y.interpolate=function(P){return arguments.length?(l=P,y):l},y.on=function(){var P=c.on.apply(c,arguments);return P===c?y:P},y.clickDistance=function(P){return arguments.length?(m=(P=+P)*P,y):Math.sqrt(m)},y.tapDistance=function(P){return arguments.length?(g=+P,y):g},y}const Nt={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},vo=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],$f=["Enter"," ","Escape"];var Pr;(function(e){e.Strict="strict",e.Loose="loose"})(Pr||(Pr={}));var Bn;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Bn||(Bn={}));var bo;(function(e){e.Partial="partial",e.Full="full"})(bo||(bo={}));const Gf={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var dn;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(dn||(dn={}));var qs;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(qs||(qs={}));var ae;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ae||(ae={}));const du={[ae.Left]:ae.Right,[ae.Right]:ae.Left,[ae.Top]:ae.Bottom,[ae.Bottom]:ae.Top};function nb(e,t){if(!e&&!t)return!0;if(!e||!t||e.size!==t.size)return!1;if(!e.size&&!t.size)return!0;for(const n of e.keys())if(!t.has(n))return!1;return!0}function fu(e,t,n){if(!n)return;const r=[];e.forEach((o,s)=>{t!=null&&t.has(s)||r.push(o)}),r.length&&n(r)}function Kf(e){return e===null?null:e?"valid":"invalid"}const Wf=e=>"id"in e&&"source"in e&&"target"in e,rb=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Bl=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Bo=(e,t=[0,0])=>{const{width:n,height:r}=nn(e),o=e.origin??t,s=n*o[0],i=r*o[1];return{x:e.position.x-s,y:e.position.y-i}},ob=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const s=typeof o=="string";let i=!t.nodeLookup&&!s?o:void 0;t.nodeLookup&&(i=s?t.nodeLookup.get(o):Bl(o)?o:t.nodeLookup.get(o.id));const a=i?zs(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return vi(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return bi(n)},Fo=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const o=zs(r);n=vi(n,o)}}),bi(n)},Yf=(e,t,[n,r,o]=[0,0,1],s=!1,i=!1)=>{const a={...jo(t,[n,r,o]),width:t.width/o,height:t.height/o},l=[];for(const c of e.values()){const{measured:d,selectable:f=!0,hidden:u=!1}=c;if(i&&!f||u)continue;const h=d.width??c.width??c.initialWidth??null,p=d.height??c.height??c.initialHeight??null,m=Ao(a,Ir(c)),g=(h??0)*(p??0),y=s&&m>0;(!c.internals.handleBounds||y||m>=g||c.dragging)&&l.push(c)}return l},sb=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function ib(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(o=>o.id)):null;return e.forEach(o=>{o.measured.width&&o.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!o.hidden)&&(!r||r.has(o.id))&&n.set(o.id,o)}),n}async function ab({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:s},i){if(e.size===0)return Promise.resolve(!0);const a=ib(e,i),l=Fo(a),c=Fl(l,t,n,(i==null?void 0:i.minZoom)??o,(i==null?void 0:i.maxZoom)??s,(i==null?void 0:i.padding)??.1);return await r.setViewport(c,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function Xf({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:s}){const i=n.get(e),a=i.parentId?n.get(i.parentId):void 0,{x:l,y:c}=a?a.internals.positionAbsolute:{x:0,y:0},d=i.origin??r;let f=o;if(i.extent==="parent"&&!i.expandParent)if(!a)s==null||s("005",Nt.error005());else{const h=a.measured.width,p=a.measured.height;h&&p&&(f=[[l,c],[l+h,c+p]])}else a&&Nr(i.extent)&&(f=[[i.extent[0][0]+l,i.extent[0][1]+c],[i.extent[1][0]+l,i.extent[1][1]+c]]);const u=Nr(f)?Hn(t,f,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&(s==null||s("015",Nt.error015())),{position:{x:u.x-l+(i.measured.width??0)*d[0],y:u.y-c+(i.measured.height??0)*d[1]},positionAbsolute:u}}async function lb({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const s=new Set(e.map(u=>u.id)),i=[];for(const u of n){if(u.deletable===!1)continue;const h=s.has(u.id),p=!h&&u.parentId&&i.find(m=>m.id===u.parentId);(h||p)&&i.push(u)}const a=new Set(t.map(u=>u.id)),l=r.filter(u=>u.deletable!==!1),d=sb(i,l);for(const u of l)a.has(u.id)&&!d.find(p=>p.id===u.id)&&d.push(u);if(!o)return{edges:d,nodes:i};const f=await o({nodes:i,edges:d});return typeof f=="boolean"?f?{edges:d,nodes:i}:{edges:[],nodes:[]}:f}const Rr=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Hn=(e={x:0,y:0},t,n)=>({x:Rr(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:Rr(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function Qf(e,t,n){const{width:r,height:o}=nn(n),{x:s,y:i}=n.internals.positionAbsolute;return Hn(e,[[s,i],[s+r,i+o]],t)}const hu=(e,t,n)=>e<t?Rr(Math.abs(e-t),1,t)/t:e>n?-Rr(Math.abs(e-n),1,t)/t:0,Zf=(e,t,n=15,r=40)=>{const o=hu(e.x,r,t.width-r)*n,s=hu(e.y,r,t.height-r)*n;return[o,s]},vi=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Ha=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),bi=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Ir=(e,t=[0,0])=>{var o,s;const{x:n,y:r}=Bl(e)?e.internals.positionAbsolute:Bo(e,t);return{x:n,y:r,width:((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0,height:((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0}},zs=(e,t=[0,0])=>{var o,s;const{x:n,y:r}=Bl(e)?e.internals.positionAbsolute:Bo(e,t);return{x:n,y:r,x2:n+(((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0),y2:r+(((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0)}},Jf=(e,t)=>bi(vi(Ha(e),Ha(t))),Ao=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},pu=e=>Pt(e.width)&&Pt(e.height)&&Pt(e.x)&&Pt(e.y),Pt=e=>!isNaN(e)&&isFinite(e),cb=(e,t)=>{},Ai=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),jo=({x:e,y:t},[n,r,o],s=!1,i=[1,1])=>{const a={x:(e-n)/o,y:(t-r)/o};return s?Ai(a,i):a},Hs=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r});function ir(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function ub(e,t,n){if(typeof e=="string"||typeof e=="number"){const r=ir(e,n),o=ir(e,t);return{top:r,right:o,bottom:r,left:o,x:o*2,y:r*2}}if(typeof e=="object"){const r=ir(e.top??e.y??0,n),o=ir(e.bottom??e.y??0,n),s=ir(e.left??e.x??0,t),i=ir(e.right??e.x??0,t);return{top:r,right:i,bottom:o,left:s,x:s+i,y:r+o}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function db(e,t,n,r,o,s){const{x:i,y:a}=Hs(e,[t,n,r]),{x:l,y:c}=Hs({x:e.x+e.width,y:e.y+e.height},[t,n,r]),d=o-l,f=s-c;return{left:Math.floor(i),top:Math.floor(a),right:Math.floor(d),bottom:Math.floor(f)}}const Fl=(e,t,n,r,o,s)=>{const i=ub(s,t,n),a=(t-i.x)/e.width,l=(n-i.y)/e.height,c=Math.min(a,l),d=Rr(c,r,o),f=e.x+e.width/2,u=e.y+e.height/2,h=t/2-f*d,p=n/2-u*d,m=db(e,h,p,d,t,n),g={left:Math.min(m.left-i.left,0),top:Math.min(m.top-i.top,0),right:Math.min(m.right-i.right,0),bottom:Math.min(m.bottom-i.bottom,0)};return{x:h-g.left+g.right,y:p-g.top+g.bottom,zoom:d}},Vs=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Nr(e){return e!==void 0&&e!=="parent"}function nn(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function eh(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function th(e,t={width:0,height:0},n,r,o){const s={...e},i=r.get(n);if(i){const a=i.origin||o;s.x+=i.internals.positionAbsolute.x-(t.width??0)*a[0],s.y+=i.internals.positionAbsolute.y-(t.height??0)*a[1]}return s}function gu(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function fb(){let e,t;return{promise:new Promise((r,o)=>{e=r,t=o}),resolve:e,reject:t}}function io(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){const{x:s,y:i}=Xt(e),a=jo({x:s-((o==null?void 0:o.left)??0),y:i-((o==null?void 0:o.top)??0)},r),{x:l,y:c}=n?Ai(a,t):a;return{xSnapped:l,ySnapped:c,...a}}const jl=e=>({width:e.offsetWidth,height:e.offsetHeight}),nh=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},hb=["INPUT","SELECT","TEXTAREA"];function rh(e){var r,o;const t=((o=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:o[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:hb.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const oh=e=>"clientX"in e,Xt=(e,t)=>{var s,i;const n=oh(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,o=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},mu=(e,t,n,r,o)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(i=>{const a=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:o,position:i.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...jl(i)}})};function sh({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:s,targetControlX:i,targetControlY:a}){const l=e*.125+o*.375+i*.375+n*.125,c=t*.125+s*.375+a*.375+r*.125,d=Math.abs(l-e),f=Math.abs(c-t);return[l,c,d,f]}function ss(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function yu({pos:e,x1:t,y1:n,x2:r,y2:o,c:s}){switch(e){case ae.Left:return[t-ss(t-r,s),n];case ae.Right:return[t+ss(r-t,s),n];case ae.Top:return[t,n-ss(n-o,s)];case ae.Bottom:return[t,n+ss(o-n,s)]}}function ih({sourceX:e,sourceY:t,sourcePosition:n=ae.Bottom,targetX:r,targetY:o,targetPosition:s=ae.Top,curvature:i=.25}){const[a,l]=yu({pos:n,x1:e,y1:t,x2:r,y2:o,c:i}),[c,d]=yu({pos:s,x1:r,y1:o,x2:e,y2:t,c:i}),[f,u,h,p]=sh({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${a},${l} ${c},${d} ${r},${o}`,f,u,h,p]}function ah({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,s=n<e?n+o:n-o,i=Math.abs(r-t)/2,a=r<t?r+i:r-i;return[s,a,o,i]}function pb({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:o=!1}){if(!o)return r;const s=n||t.selected||e.selected,i=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(s?i:0)}function gb({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const s=vi(zs(e),zs(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return Ao(i,bi(s))>0}const mb=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,yb=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),lh=(e,t)=>{if(!e.source||!e.target)return t;let n;return Wf(e)?n={...e}:n={...e,id:mb(e)},yb(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function ch({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,s,i,a]=ah({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,s,i,a]}const wu={[ae.Left]:{x:-1,y:0},[ae.Right]:{x:1,y:0},[ae.Top]:{x:0,y:-1},[ae.Bottom]:{x:0,y:1}},wb=({source:e,sourcePosition:t=ae.Bottom,target:n})=>t===ae.Left||t===ae.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},xu=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function xb({source:e,sourcePosition:t=ae.Bottom,target:n,targetPosition:r=ae.Top,center:o,offset:s}){const i=wu[t],a=wu[r],l={x:e.x+i.x*s,y:e.y+i.y*s},c={x:n.x+a.x*s,y:n.y+a.y*s},d=wb({source:l,sourcePosition:t,target:c}),f=d.x!==0?"x":"y",u=d[f];let h=[],p,m;const g={x:0,y:0},y={x:0,y:0},[A,w,E,R]=ah({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[f]*a[f]===-1){p=o.x??A,m=o.y??w;const v=[{x:p,y:l.y},{x:p,y:c.y}],C=[{x:l.x,y:m},{x:c.x,y:m}];i[f]===u?h=f==="x"?v:C:h=f==="x"?C:v}else{const v=[{x:l.x,y:c.y}],C=[{x:c.x,y:l.y}];if(f==="x"?h=i.x===u?C:v:h=i.y===u?v:C,t===r){const j=Math.abs(e[f]-n[f]);if(j<=s){const P=Math.min(s-1,s-j);i[f]===u?g[f]=(l[f]>e[f]?-1:1)*P:y[f]=(c[f]>n[f]?-1:1)*P}}if(t!==r){const j=f==="x"?"y":"x",P=i[f]===a[j],O=l[j]>c[j],I=l[j]<c[j];(i[f]===1&&(!P&&O||P&&I)||i[f]!==1&&(!P&&I||P&&O))&&(h=f==="x"?v:C)}const T={x:l.x+g.x,y:l.y+g.y},k={x:c.x+y.x,y:c.y+y.y},D=Math.max(Math.abs(T.x-h[0].x),Math.abs(k.x-h[0].x)),B=Math.max(Math.abs(T.y-h[0].y),Math.abs(k.y-h[0].y));D>=B?(p=(T.x+k.x)/2,m=h[0].y):(p=h[0].x,m=(T.y+k.y)/2)}return[[e,{x:l.x+g.x,y:l.y+g.y},...h,{x:c.x+y.x,y:c.y+y.y},n],p,m,E,R]}function vb(e,t,n,r){const o=Math.min(xu(e,t)/2,xu(t,n)/2,r),{x:s,y:i}=t;if(e.x===s&&s===n.x||e.y===i&&i===n.y)return`L${s} ${i}`;if(e.y===i){const c=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${s+o*c},${i}Q ${s},${i} ${s},${i+o*d}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${s},${i+o*l}Q ${s},${i} ${s+o*a},${i}`}function Va({sourceX:e,sourceY:t,sourcePosition:n=ae.Bottom,targetX:r,targetY:o,targetPosition:s=ae.Top,borderRadius:i=5,centerX:a,centerY:l,offset:c=20}){const[d,f,u,h,p]=xb({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:s,center:{x:a,y:l},offset:c});return[d.reduce((g,y,A)=>{let w="";return A>0&&A<d.length-1?w=vb(d[A-1],y,d[A+1],i):w=`${A===0?"M":"L"}${y.x} ${y.y}`,g+=w,g},""),f,u,h,p]}function vu(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function bb(e){var f;const{sourceNode:t,targetNode:n}=e;if(!vu(t)||!vu(n))return null;const r=t.internals.handleBounds||bu(t.handles),o=n.internals.handleBounds||bu(n.handles),s=Au((r==null?void 0:r.source)??[],e.sourceHandle),i=Au(e.connectionMode===Pr.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),e.targetHandle);if(!s||!i)return(f=e.onError)==null||f.call(e,"008",Nt.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(s==null?void 0:s.position)||ae.Bottom,l=(i==null?void 0:i.position)||ae.Top,c=Eo(t,s,a),d=Eo(n,i,l);return{sourceX:c.x,sourceY:c.y,targetX:d.x,targetY:d.y,sourcePosition:a,targetPosition:l}}function bu(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function Eo(e,t,n=ae.Left,r=!1){const o=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,s=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:a}=t??nn(e);if(r)return{x:o+i/2,y:s+a/2};switch((t==null?void 0:t.position)??n){case ae.Top:return{x:o+i/2,y:s};case ae.Right:return{x:o+i,y:s+a/2};case ae.Bottom:return{x:o+i/2,y:s+a};case ae.Left:return{x:o,y:s+a/2}}}function Au(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Ua(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function Ab(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const s=new Set;return e.reduce((i,a)=>([a.markerStart||r,a.markerEnd||o].forEach(l=>{if(l&&typeof l=="object"){const c=Ua(l,t);s.has(c)||(i.push({id:c,color:l.color||n,...l}),s.add(c))}}),i),[]).sort((i,a)=>i.id.localeCompare(a.id))}const ql={nodeOrigin:[0,0],nodeExtent:vo,elevateNodesOnSelect:!0,defaults:{}},Eb={...ql,checkEquality:!0};function zl(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function Sb(e,t,n){const r=zl(ql,n);for(const o of e.values())if(o.parentId)Hl(o,e,t,r);else{const s=Bo(o,r.nodeOrigin),i=Nr(o.extent)?o.extent:r.nodeExtent,a=Hn(s,i,nn(o));o.internals.positionAbsolute=a}}function $a(e,t,n,r){var l,c;const o=zl(Eb,r);let s=e.length>0;const i=new Map(t),a=o!=null&&o.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const d of e){let f=i.get(d.id);if(o.checkEquality&&d===(f==null?void 0:f.internals.userNode))t.set(d.id,f);else{const u=Bo(d,o.nodeOrigin),h=Nr(d.extent)?d.extent:o.nodeExtent,p=Hn(u,h,nn(d));f={...o.defaults,...d,measured:{width:(l=d.measured)==null?void 0:l.width,height:(c=d.measured)==null?void 0:c.height},internals:{positionAbsolute:p,handleBounds:d.measured?f==null?void 0:f.internals.handleBounds:void 0,z:uh(d,a),userNode:d}},t.set(d.id,f)}(f.measured===void 0||f.measured.width===void 0||f.measured.height===void 0)&&!f.hidden&&(s=!1),d.parentId&&Hl(f,t,n,r)}return s}function Mb(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Hl(e,t,n,r){const{elevateNodesOnSelect:o,nodeOrigin:s,nodeExtent:i}=zl(ql,r),a=e.parentId,l=t.get(a);if(!l){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Mb(e,n);const c=o?1e3:0,{x:d,y:f,z:u}=Cb(e,l,s,i,c),{positionAbsolute:h}=e.internals,p=d!==h.x||f!==h.y;(p||u!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:p?{x:d,y:f}:h,z:u}})}function uh(e,t){return(Pt(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Cb(e,t,n,r,o){const{x:s,y:i}=t.internals.positionAbsolute,a=nn(e),l=Bo(e,n),c=Nr(e.extent)?Hn(l,e.extent,a):l;let d=Hn({x:s+c.x,y:i+c.y},r,a);e.extent==="parent"&&(d=Qf(d,a,t));const f=uh(e,o),u=t.internals.z??0;return{x:d.x,y:d.y,z:u>f?u:f}}function Vl(e,t,n,r=[0,0]){var i;const o=[],s=new Map;for(const a of e){const l=t.get(a.parentId);if(!l)continue;const c=((i=s.get(a.parentId))==null?void 0:i.expandedRect)??Ir(l),d=Jf(c,a.rect);s.set(a.parentId,{expandedRect:d,parent:l})}return s.size>0&&s.forEach(({expandedRect:a,parent:l},c)=>{var w;const d=l.internals.positionAbsolute,f=nn(l),u=l.origin??r,h=a.x<d.x?Math.round(Math.abs(d.x-a.x)):0,p=a.y<d.y?Math.round(Math.abs(d.y-a.y)):0,m=Math.max(f.width,Math.round(a.width)),g=Math.max(f.height,Math.round(a.height)),y=(m-f.width)*u[0],A=(g-f.height)*u[1];(h>0||p>0||y||A)&&(o.push({id:c,type:"position",position:{x:l.position.x-h+y,y:l.position.y-p+A}}),(w=n.get(c))==null||w.forEach(E=>{e.some(R=>R.id===E.id)||o.push({id:E.id,type:"position",position:{x:E.position.x+h,y:E.position.y+p}})})),(f.width<a.width||f.height<a.height||h||p)&&o.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:m+(h?u[0]*h-y:0),height:g+(p?u[1]*p-A:0)}})}),o}function Pb(e,t,n,r,o,s){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let a=!1;if(!i)return{changes:[],updatedInternals:a};const l=[],c=window.getComputedStyle(i),{m22:d}=new window.DOMMatrixReadOnly(c.transform),f=[];for(const u of e.values()){const h=t.get(u.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}const p=jl(u.nodeElement),m=h.measured.width!==p.width||h.measured.height!==p.height;if(!!(p.width&&p.height&&(m||!h.internals.handleBounds||u.force))){const y=u.nodeElement.getBoundingClientRect(),A=Nr(h.extent)?h.extent:s;let{positionAbsolute:w}=h.internals;h.parentId&&h.extent==="parent"?w=Qf(w,p,t.get(h.parentId)):A&&(w=Hn(w,A,p));const E={...h,measured:p,internals:{...h.internals,positionAbsolute:w,handleBounds:{source:mu("source",u.nodeElement,y,d,h.id),target:mu("target",u.nodeElement,y,d,h.id)}}};t.set(h.id,E),h.parentId&&Hl(E,t,n,{nodeOrigin:o}),a=!0,m&&(l.push({id:h.id,type:"dimensions",dimensions:p}),h.expandParent&&h.parentId&&f.push({id:h.id,parentId:h.parentId,rect:Ir(E,o)}))}}if(f.length>0){const u=Vl(f,t,n,o);l.push(...u)}return{changes:l,updatedInternals:a}}async function Rb({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,s]],r),a=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(a)}function Eu(e,t,n,r,o,s){let i=o;const a=r.get(i)||new Map;r.set(i,a.set(n,t)),i=`${o}-${e}`;const l=r.get(i)||new Map;if(r.set(i,l.set(n,t)),s){i=`${o}-${e}-${s}`;const c=r.get(i)||new Map;r.set(i,c.set(n,t))}}function dh(e,t,n){e.clear(),t.clear();for(const r of n){const{source:o,target:s,sourceHandle:i=null,targetHandle:a=null}=r,l={edgeId:r.id,source:o,target:s,sourceHandle:i,targetHandle:a},c=`${o}-${i}--${s}-${a}`,d=`${s}-${a}--${o}-${i}`;Eu("source",l,d,e,o,i),Eu("target",l,c,e,s,a),t.set(r.id,r)}}function fh(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:fh(n,t):!1}function Su(e,t,n){var o;let r=e;do{if((o=r==null?void 0:r.matches)!=null&&o.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function Ib(e,t,n,r){const o=new Map;for(const[s,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!fh(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const a=e.get(s);a&&o.set(s,{id:s,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return o}function ia({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,a,l;const o=[];for(const[c,d]of t){const f=(i=n.get(c))==null?void 0:i.internals.userNode;f&&o.push({...f,position:d.position,dragging:r})}if(!e)return[o[0],o];const s=(a=n.get(e))==null?void 0:a.internals.userNode;return[s?{...s,position:((l=t.get(e))==null?void 0:l.position)||s.position,dragging:r}:o[0],o]}function Nb({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let s={x:null,y:null},i=0,a=new Map,l=!1,c={x:0,y:0},d=null,f=!1,u=null,h=!1;function p({noDragClassName:g,handleSelector:y,domNode:A,isSelectable:w,nodeId:E,nodeClickDistance:R=0}){u=et(A);function b({x:k,y:D},B){const{nodeLookup:j,nodeExtent:P,snapGrid:O,snapToGrid:I,nodeOrigin:_,onNodeDrag:F,onSelectionDrag:N,onError:z,updateNodePositions:V}=t();s={x:k,y:D};let U=!1,K={x:0,y:0,x2:0,y2:0};if(a.size>1&&P){const Y=Fo(a);K=Ha(Y)}for(const[Y,ee]of a){if(!j.has(Y))continue;let Z={x:k-ee.distance.x,y:D-ee.distance.y};I&&(Z=Ai(Z,O));let q=[[P[0][0],P[0][1]],[P[1][0],P[1][1]]];if(a.size>1&&P&&!ee.extent){const{positionAbsolute:se}=ee.internals,oe=se.x-K.x+P[0][0],ne=se.x+ee.measured.width-K.x2+P[1][0],J=se.y-K.y+P[0][1],re=se.y+ee.measured.height-K.y2+P[1][1];q=[[oe,J],[ne,re]]}const{position:W,positionAbsolute:te}=Xf({nodeId:Y,nextPosition:Z,nodeLookup:j,nodeExtent:q,nodeOrigin:_,onError:z});U=U||ee.position.x!==W.x||ee.position.y!==W.y,ee.position=W,ee.internals.positionAbsolute=te}if(U&&(V(a,!0),B&&(r||F||!E&&N))){const[Y,ee]=ia({nodeId:E,dragItems:a,nodeLookup:j});r==null||r(B,a,Y,ee),F==null||F(B,Y,ee),E||N==null||N(B,ee)}}async function v(){if(!d)return;const{transform:k,panBy:D,autoPanSpeed:B,autoPanOnNodeDrag:j}=t();if(!j){l=!1,cancelAnimationFrame(i);return}const[P,O]=Zf(c,d,B);(P!==0||O!==0)&&(s.x=(s.x??0)-P/k[2],s.y=(s.y??0)-O/k[2],await D({x:P,y:O})&&b(s,null)),i=requestAnimationFrame(v)}function C(k){var U;const{nodeLookup:D,multiSelectionActive:B,nodesDraggable:j,transform:P,snapGrid:O,snapToGrid:I,selectNodesOnDrag:_,onNodeDragStart:F,onSelectionDragStart:N,unselectNodesAndEdges:z}=t();f=!0,(!_||!w)&&!B&&E&&((U=D.get(E))!=null&&U.selected||z()),w&&_&&E&&(e==null||e(E));const V=io(k.sourceEvent,{transform:P,snapGrid:O,snapToGrid:I,containerBounds:d});if(s=V,a=Ib(D,j,V,E),a.size>0&&(n||F||!E&&N)){const[K,Y]=ia({nodeId:E,dragItems:a,nodeLookup:D});n==null||n(k.sourceEvent,a,K,Y),F==null||F(k.sourceEvent,K,Y),E||N==null||N(k.sourceEvent,Y)}}const T=If().clickDistance(R).on("start",k=>{const{domNode:D,nodeDragThreshold:B,transform:j,snapGrid:P,snapToGrid:O}=t();d=(D==null?void 0:D.getBoundingClientRect())||null,h=!1,B===0&&C(k),s=io(k.sourceEvent,{transform:j,snapGrid:P,snapToGrid:O,containerBounds:d}),c=Xt(k.sourceEvent,d)}).on("drag",k=>{const{autoPanOnNodeDrag:D,transform:B,snapGrid:j,snapToGrid:P,nodeDragThreshold:O,nodeLookup:I}=t(),_=io(k.sourceEvent,{transform:B,snapGrid:j,snapToGrid:P,containerBounds:d});if((k.sourceEvent.type==="touchmove"&&k.sourceEvent.touches.length>1||E&&!I.has(E))&&(h=!0),!h){if(!l&&D&&f&&(l=!0,v()),!f){const F=_.xSnapped-(s.x??0),N=_.ySnapped-(s.y??0);Math.sqrt(F*F+N*N)>O&&C(k)}(s.x!==_.xSnapped||s.y!==_.ySnapped)&&a&&f&&(c=Xt(k.sourceEvent,d),b(_,k.sourceEvent))}}).on("end",k=>{if(!(!f||h)&&(l=!1,f=!1,cancelAnimationFrame(i),a.size>0)){const{nodeLookup:D,updateNodePositions:B,onNodeDragStop:j,onSelectionDragStop:P}=t();if(B(a,!1),o||j||!E&&P){const[O,I]=ia({nodeId:E,dragItems:a,nodeLookup:D,dragging:!1});o==null||o(k.sourceEvent,a,O,I),j==null||j(k.sourceEvent,O,I),E||P==null||P(k.sourceEvent,I)}}}).filter(k=>{const D=k.target;return!k.button&&(!g||!Su(D,`.${g}`,A))&&(!y||Su(D,y,A))});u.call(T)}function m(){u==null||u.on(".drag",null)}return{update:p,destroy:m}}function Tb(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())Ao(o,Ir(s))>0&&r.push(s);return r}const kb=250;function _b(e,t,n,r){var a,l;let o=[],s=1/0;const i=Tb(e,n,t+kb);for(const c of i){const d=[...((a=c.internals.handleBounds)==null?void 0:a.source)??[],...((l=c.internals.handleBounds)==null?void 0:l.target)??[]];for(const f of d){if(r.nodeId===f.nodeId&&r.type===f.type&&r.id===f.id)continue;const{x:u,y:h}=Eo(c,f,f.position,!0),p=Math.sqrt(Math.pow(u-e.x,2)+Math.pow(h-e.y,2));p>t||(p<s?(o=[{...f,x:u,y:h}],s=p):p===s&&o.push({...f,x:u,y:h}))}}if(!o.length)return null;if(o.length>1){const c=r.type==="source"?"target":"source";return o.find(d=>d.type===c)??o[0]}return o[0]}function hh(e,t,n,r,o,s=!1){var c,d,f;const i=r.get(e);if(!i)return null;const a=o==="strict"?(c=i.internals.handleBounds)==null?void 0:c[t]:[...((d=i.internals.handleBounds)==null?void 0:d.source)??[],...((f=i.internals.handleBounds)==null?void 0:f.target)??[]],l=(n?a==null?void 0:a.find(u=>u.id===n):a==null?void 0:a[0])??null;return l&&s?{...l,...Eo(i,l,l.position,!0)}:l}function ph(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Db(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const gh=()=>!0;function Ob(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:s,isTarget:i,domNode:a,nodeLookup:l,lib:c,autoPanOnConnect:d,flowId:f,panBy:u,cancelConnection:h,onConnectStart:p,onConnect:m,onConnectEnd:g,isValidConnection:y=gh,onReconnectEnd:A,updateConnection:w,getTransform:E,getFromHandle:R,autoPanSpeed:b}){const v=nh(e.target);let C=0,T;const{x:k,y:D}=Xt(e),B=v==null?void 0:v.elementFromPoint(k,D),j=ph(s,B),P=a==null?void 0:a.getBoundingClientRect();if(!P||!j)return;const O=hh(o,j,r,l,t);if(!O)return;let I=Xt(e,P),_=!1,F=null,N=!1,z=null;function V(){if(!d||!P)return;const[te,se]=Zf(I,P,b);u({x:te,y:se}),C=requestAnimationFrame(V)}const U={...O,nodeId:o,type:j,position:O.position},K=l.get(o),ee={inProgress:!0,isValid:null,from:Eo(K,U,ae.Left,!0),fromHandle:U,fromPosition:U.position,fromNode:K,to:I,toHandle:null,toPosition:du[U.position],toNode:null};w(ee);let Z=ee;p==null||p(e,{nodeId:o,handleId:r,handleType:j});function q(te){if(!R()||!U){W(te);return}const se=E();I=Xt(te,P),T=_b(jo(I,se,!1,[1,1]),n,l,U),_||(V(),_=!0);const oe=mh(te,{handle:T,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:i?"target":"source",isValidConnection:y,doc:v,lib:c,flowId:f,nodeLookup:l});z=oe.handleDomNode,F=oe.connection,N=Db(!!T,oe.isValid);const ne={...Z,isValid:N,to:T&&N?Hs({x:T.x,y:T.y},se):I,toHandle:oe.toHandle,toPosition:N&&oe.toHandle?oe.toHandle.position:du[U.position],toNode:oe.toHandle?l.get(oe.toHandle.nodeId):null};N&&T&&Z.toHandle&&ne.toHandle&&Z.toHandle.type===ne.toHandle.type&&Z.toHandle.nodeId===ne.toHandle.nodeId&&Z.toHandle.id===ne.toHandle.id&&Z.to.x===ne.to.x&&Z.to.y===ne.to.y||(w(ne),Z=ne)}function W(te){(T||z)&&F&&N&&(m==null||m(F));const{inProgress:se,...oe}=Z,ne={...oe,toPosition:Z.toHandle?Z.toPosition:null};g==null||g(te,ne),s&&(A==null||A(te,ne)),h(),cancelAnimationFrame(C),_=!1,N=!1,F=null,z=null,v.removeEventListener("mousemove",q),v.removeEventListener("mouseup",W),v.removeEventListener("touchmove",q),v.removeEventListener("touchend",W)}v.addEventListener("mousemove",q),v.addEventListener("mouseup",W),v.addEventListener("touchmove",q),v.addEventListener("touchend",W)}function mh(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:s,doc:i,lib:a,flowId:l,isValidConnection:c=gh,nodeLookup:d}){const f=s==="target",u=t?i.querySelector(`.${a}-flow__handle[data-id="${l}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y:p}=Xt(e),m=i.elementFromPoint(h,p),g=m!=null&&m.classList.contains(`${a}-flow__handle`)?m:u,y={handleDomNode:g,isValid:!1,connection:null,toHandle:null};if(g){const A=ph(void 0,g),w=g.getAttribute("data-nodeid"),E=g.getAttribute("data-handleid"),R=g.classList.contains("connectable"),b=g.classList.contains("connectableend");if(!w||!A)return y;const v={source:f?w:r,sourceHandle:f?E:o,target:f?r:w,targetHandle:f?o:E};y.connection=v;const T=R&&b&&(n===Pr.Strict?f&&A==="source"||!f&&A==="target":w!==r||E!==o);y.isValid=T&&c(v),y.toHandle=hh(w,A,E,d,n,!1)}return y}const Ga={onPointerDown:Ob,isValid:mh};function Lb({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=et(e);function s({translateExtent:a,width:l,height:c,zoomStep:d=10,pannable:f=!0,zoomable:u=!0,inversePan:h=!1}){const p=w=>{const E=n();if(w.sourceEvent.type!=="wheel"||!t)return;const R=-w.sourceEvent.deltaY*(w.sourceEvent.deltaMode===1?.05:w.sourceEvent.deltaMode?1:.002)*d,b=E[2]*Math.pow(2,R);t.scaleTo(b)};let m=[0,0];const g=w=>{(w.sourceEvent.type==="mousedown"||w.sourceEvent.type==="touchstart")&&(m=[w.sourceEvent.clientX??w.sourceEvent.touches[0].clientX,w.sourceEvent.clientY??w.sourceEvent.touches[0].clientY])},y=w=>{const E=n();if(w.sourceEvent.type!=="mousemove"&&w.sourceEvent.type!=="touchmove"||!t)return;const R=[w.sourceEvent.clientX??w.sourceEvent.touches[0].clientX,w.sourceEvent.clientY??w.sourceEvent.touches[0].clientY],b=[R[0]-m[0],R[1]-m[1]];m=R;const v=r()*Math.max(E[2],Math.log(E[2]))*(h?-1:1),C={x:E[0]-b[0]*v,y:E[1]-b[1]*v},T=[[0,0],[l,c]];t.setViewportConstrained({x:C.x,y:C.y,zoom:E[2]},T,a)},A=Uf().on("start",g).on("zoom",f?y:null).on("zoom.wheel",u?p:null);o.call(A,{})}function i(){o.on("zoom",null)}return{update:s,destroy:i,pointer:Mt}}const Bb=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Ei=e=>({x:e.x,y:e.y,zoom:e.k}),aa=({x:e,y:t,zoom:n})=>xi.translate(e,t).scale(n),gr=(e,t)=>e.target.closest(`.${t}`),yh=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),la=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},wh=e=>{const t=e.ctrlKey&&Vs()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Fb({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:c}){return d=>{if(gr(d,t))return!1;d.preventDefault(),d.stopImmediatePropagation();const f=n.property("__zoom").k||1;if(d.ctrlKey&&i){const g=Mt(d),y=wh(d),A=f*Math.pow(2,y);r.scaleTo(n,A,g,d);return}const u=d.deltaMode===1?20:1;let h=o===Bn.Vertical?0:d.deltaX*u,p=o===Bn.Horizontal?0:d.deltaY*u;!Vs()&&d.shiftKey&&o!==Bn.Vertical&&(h=d.deltaY*u,p=0),r.translateBy(n,-(h/f)*s,-(p/f)*s,{internal:!0});const m=Ei(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(d,m)),e.isPanScrolling&&(l==null||l(d,m),e.panScrollTimeout=setTimeout(()=>{c==null||c(d,m),e.isPanScrolling=!1},150))}}function jb({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){const s=r.type==="wheel",i=!t&&s&&!r.ctrlKey,a=gr(r,e);if(r.ctrlKey&&s&&a&&r.preventDefault(),i||a)return null;r.preventDefault(),n.call(this,r,o)}}function qb({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var s,i,a;if((s=r.sourceEvent)!=null&&s.internal)return;const o=Ei(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=o,((a=r.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,o))}}function zb({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return s=>{var i,a;e.usedRightMouseButton=!!(n&&yh(t,e.mouseButton??0)),(i=s.sourceEvent)!=null&&i.sync||r([s.transform.x,s.transform.y,s.transform.k]),o&&!((a=s.sourceEvent)!=null&&a.internal)&&(o==null||o(s.sourceEvent,Ei(s.transform)))}}function Hb({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:s}){return i=>{var a;if(!((a=i.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,s&&yh(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),o&&Bb(e.prevViewport,i.transform))){const l=Ei(i.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o==null||o(i.sourceEvent,l)},n?150:0)}}}function Vb({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:a,noPanClassName:l,lib:c}){return d=>{var p;const f=e||t,u=n&&d.ctrlKey;if(d.button===1&&d.type==="mousedown"&&(gr(d,`${c}-flow__node`)||gr(d,`${c}-flow__edge`)))return!0;if(!r&&!f&&!o&&!s&&!n||i||gr(d,a)&&d.type==="wheel"||gr(d,l)&&(d.type!=="wheel"||o&&d.type==="wheel"&&!e)||!n&&d.ctrlKey&&d.type==="wheel")return!1;if(!n&&d.type==="touchstart"&&((p=d.touches)==null?void 0:p.length)>1)return d.preventDefault(),!1;if(!f&&!o&&!u&&d.type==="wheel"||!r&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(r)&&!r.includes(d.button)&&d.type==="mousedown")return!1;const h=Array.isArray(r)&&r.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||d.type==="wheel")&&h}}function Ub({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:o,viewport:s,onPanZoom:i,onPanZoomStart:a,onPanZoomEnd:l,onDraggingChange:c}){const d={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},f=e.getBoundingClientRect(),u=Uf().clickDistance(!Pt(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(o),h=et(e).call(u);w({x:s.x,y:s.y,zoom:Rr(s.zoom,t,n)},[[0,0],[f.width,f.height]],o);const p=h.on("wheel.zoom"),m=h.on("dblclick.zoom");u.wheelDelta(wh);function g(B,j){return h?new Promise(P=>{u==null||u.transform(la(h,j==null?void 0:j.duration,()=>P(!0)),B)}):Promise.resolve(!1)}function y({noWheelClassName:B,noPanClassName:j,onPaneContextMenu:P,userSelectionActive:O,panOnScroll:I,panOnDrag:_,panOnScrollMode:F,panOnScrollSpeed:N,preventScrolling:z,zoomOnPinch:V,zoomOnScroll:U,zoomOnDoubleClick:K,zoomActivationKeyPressed:Y,lib:ee,onTransformChange:Z}){O&&!d.isZoomingOrPanning&&A();const W=I&&!Y&&!O?Fb({zoomPanValues:d,noWheelClassName:B,d3Selection:h,d3Zoom:u,panOnScrollMode:F,panOnScrollSpeed:N,zoomOnPinch:V,onPanZoomStart:a,onPanZoom:i,onPanZoomEnd:l}):jb({noWheelClassName:B,preventScrolling:z,d3ZoomHandler:p});if(h.on("wheel.zoom",W,{passive:!1}),!O){const se=qb({zoomPanValues:d,onDraggingChange:c,onPanZoomStart:a});u.on("start",se);const oe=zb({zoomPanValues:d,panOnDrag:_,onPaneContextMenu:!!P,onPanZoom:i,onTransformChange:Z});u.on("zoom",oe);const ne=Hb({zoomPanValues:d,panOnDrag:_,panOnScroll:I,onPaneContextMenu:P,onPanZoomEnd:l,onDraggingChange:c});u.on("end",ne)}const te=Vb({zoomActivationKeyPressed:Y,panOnDrag:_,zoomOnScroll:U,panOnScroll:I,zoomOnDoubleClick:K,zoomOnPinch:V,userSelectionActive:O,noPanClassName:j,noWheelClassName:B,lib:ee});u.filter(te),K?h.on("dblclick.zoom",m):h.on("dblclick.zoom",null)}function A(){u.on("zoom",null)}async function w(B,j,P){const O=aa(B),I=u==null?void 0:u.constrain()(O,j,P);return I&&await g(I),new Promise(_=>_(I))}async function E(B,j){const P=aa(B);return await g(P,j),new Promise(O=>O(P))}function R(B){if(h){const j=aa(B),P=h.property("__zoom");(P.k!==B.zoom||P.x!==B.x||P.y!==B.y)&&(u==null||u.transform(h,j,null,{sync:!0}))}}function b(){const B=h?Vf(h.node()):{x:0,y:0,k:1};return{x:B.x,y:B.y,zoom:B.k}}function v(B,j){return h?new Promise(P=>{u==null||u.scaleTo(la(h,j==null?void 0:j.duration,()=>P(!0)),B)}):Promise.resolve(!1)}function C(B,j){return h?new Promise(P=>{u==null||u.scaleBy(la(h,j==null?void 0:j.duration,()=>P(!0)),B)}):Promise.resolve(!1)}function T(B){u==null||u.scaleExtent(B)}function k(B){u==null||u.translateExtent(B)}function D(B){const j=!Pt(B)||B<0?0:B;u==null||u.clickDistance(j)}return{update:y,destroy:A,setViewport:E,setViewportConstrained:w,getViewport:b,scaleTo:v,scaleBy:C,setScaleExtent:T,setTranslateExtent:k,syncViewport:R,setClickDistance:D}}var ao;(function(e){e.Line="line",e.Handle="handle"})(ao||(ao={}));function $b({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:s}){const i=e-t,a=n-r,l=[i>0?1:i<0?-1:0,a>0?1:a<0?-1:0];return i&&o&&(l[0]=l[0]*-1),a&&s&&(l[1]=l[1]*-1),l}function Gb(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:o}}function sn(e,t){return Math.max(0,t-e)}function an(e,t){return Math.max(0,e-t)}function is(e,t,n){return Math.max(0,t-e,e-n)}function Mu(e,t){return e?!t:t}function Kb(e,t,n,r,o,s,i,a){let{affectsX:l,affectsY:c}=t;const{isHorizontal:d,isVertical:f}=t,u=d&&f,{xSnapped:h,ySnapped:p}=n,{minWidth:m,maxWidth:g,minHeight:y,maxHeight:A}=r,{x:w,y:E,width:R,height:b,aspectRatio:v}=e;let C=Math.floor(d?h-e.pointerX:0),T=Math.floor(f?p-e.pointerY:0);const k=R+(l?-C:C),D=b+(c?-T:T),B=-s[0]*R,j=-s[1]*b;let P=is(k,m,g),O=is(D,y,A);if(i){let F=0,N=0;l&&C<0?F=sn(w+C+B,i[0][0]):!l&&C>0&&(F=an(w+k+B,i[1][0])),c&&T<0?N=sn(E+T+j,i[0][1]):!c&&T>0&&(N=an(E+D+j,i[1][1])),P=Math.max(P,F),O=Math.max(O,N)}if(a){let F=0,N=0;l&&C>0?F=an(w+C,a[0][0]):!l&&C<0&&(F=sn(w+k,a[1][0])),c&&T>0?N=an(E+T,a[0][1]):!c&&T<0&&(N=sn(E+D,a[1][1])),P=Math.max(P,F),O=Math.max(O,N)}if(o){if(d){const F=is(k/v,y,A)*v;if(P=Math.max(P,F),i){let N=0;!l&&!c||l&&!c&&u?N=an(E+j+k/v,i[1][1])*v:N=sn(E+j+(l?C:-C)/v,i[0][1])*v,P=Math.max(P,N)}if(a){let N=0;!l&&!c||l&&!c&&u?N=sn(E+k/v,a[1][1])*v:N=an(E+(l?C:-C)/v,a[0][1])*v,P=Math.max(P,N)}}if(f){const F=is(D*v,m,g)/v;if(O=Math.max(O,F),i){let N=0;!l&&!c||c&&!l&&u?N=an(w+D*v+B,i[1][0])/v:N=sn(w+(c?T:-T)*v+B,i[0][0])/v,O=Math.max(O,N)}if(a){let N=0;!l&&!c||c&&!l&&u?N=sn(w+D*v,a[1][0])/v:N=an(w+(c?T:-T)*v,a[0][0])/v,O=Math.max(O,N)}}}T=T+(T<0?O:-O),C=C+(C<0?P:-P),o&&(u?k>D*v?T=(Mu(l,c)?-C:C)/v:C=(Mu(l,c)?-T:T)*v:d?(T=C/v,c=l):(C=T*v,l=c));const I=l?w+C:w,_=c?E+T:E;return{width:R+(l?-C:C),height:b+(c?-T:T),x:s[0]*C*(l?-1:1)+I,y:s[1]*T*(c?-1:1)+_}}const xh={width:0,height:0,x:0,y:0},Wb={...xh,pointerX:0,pointerY:0,aspectRatio:1};function Yb(e){return[[0,0],[e.measured.width,e.measured.height]]}function Xb(e,t,n){const r=t.position.x+e.position.x,o=t.position.y+e.position.y,s=e.measured.width??0,i=e.measured.height??0,a=n[0]*s,l=n[1]*i;return[[r-a,o-l],[r+s-a,o+i-l]]}function Qb({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){const s=et(e);function i({controlPosition:l,boundaries:c,keepAspectRatio:d,resizeDirection:f,onResizeStart:u,onResize:h,onResizeEnd:p,shouldResize:m}){let g={...xh},y={...Wb};const A=Gb(l);let w,E=null,R=[],b,v,C;const T=If().on("start",k=>{const{nodeLookup:D,transform:B,snapGrid:j,snapToGrid:P,nodeOrigin:O,paneDomNode:I}=n();if(w=D.get(t),!w)return;E=(I==null?void 0:I.getBoundingClientRect())??null;const{xSnapped:_,ySnapped:F}=io(k.sourceEvent,{transform:B,snapGrid:j,snapToGrid:P,containerBounds:E});g={width:w.measured.width??0,height:w.measured.height??0,x:w.position.x??0,y:w.position.y??0},y={...g,pointerX:_,pointerY:F,aspectRatio:g.width/g.height},b=void 0,w.parentId&&(w.extent==="parent"||w.expandParent)&&(b=D.get(w.parentId),v=b&&w.extent==="parent"?Yb(b):void 0),R=[],C=void 0;for(const[N,z]of D)if(z.parentId===t&&(R.push({id:N,position:{...z.position},extent:z.extent}),z.extent==="parent"||z.expandParent)){const V=Xb(z,w,z.origin??O);C?C=[[Math.min(V[0][0],C[0][0]),Math.min(V[0][1],C[0][1])],[Math.max(V[1][0],C[1][0]),Math.max(V[1][1],C[1][1])]]:C=V}u==null||u(k,{...g})}).on("drag",k=>{const{transform:D,snapGrid:B,snapToGrid:j,nodeOrigin:P}=n(),O=io(k.sourceEvent,{transform:D,snapGrid:B,snapToGrid:j,containerBounds:E}),I=[];if(!w)return;const{x:_,y:F,width:N,height:z}=g,V={},U=w.origin??P,{width:K,height:Y,x:ee,y:Z}=Kb(y,A,O,c,d,U,v,C),q=K!==N,W=Y!==z,te=ee!==_&&q,se=Z!==F&&W;if(!te&&!se&&!q&&!W)return;if((te||se||U[0]===1||U[1]===1)&&(V.x=te?ee:g.x,V.y=se?Z:g.y,g.x=V.x,g.y=V.y,R.length>0)){const re=ee-_,le=Z-F;for(const ce of R)ce.position={x:ce.position.x-re+U[0]*(K-N),y:ce.position.y-le+U[1]*(Y-z)},I.push(ce)}if((q||W)&&(V.width=q&&(!f||f==="horizontal")?K:g.width,V.height=W&&(!f||f==="vertical")?Y:g.height,g.width=V.width,g.height=V.height),b&&w.expandParent){const re=U[0]*(V.width??0);V.x&&V.x<re&&(g.x=re,y.x=y.x-(V.x-re));const le=U[1]*(V.height??0);V.y&&V.y<le&&(g.y=le,y.y=y.y-(V.y-le))}const oe=$b({width:g.width,prevWidth:N,height:g.height,prevHeight:z,affectsX:A.affectsX,affectsY:A.affectsY}),ne={...g,direction:oe};(m==null?void 0:m(k,ne))!==!1&&(h==null||h(k,ne),r(V,I))}).on("end",k=>{p==null||p(k,{...g}),o==null||o({...g})});s.call(T)}function a(){s.on(".drag",null)}return{update:i,destroy:a}}var ca={exports:{}},ua={},da={exports:{}},fa={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cu;function Zb(){if(Cu)return fa;Cu=1;var e=$d();function t(f,u){return f===u&&(f!==0||1/f===1/u)||f!==f&&u!==u}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,o=e.useEffect,s=e.useLayoutEffect,i=e.useDebugValue;function a(f,u){var h=u(),p=r({inst:{value:h,getSnapshot:u}}),m=p[0].inst,g=p[1];return s(function(){m.value=h,m.getSnapshot=u,l(m)&&g({inst:m})},[f,h,u]),o(function(){return l(m)&&g({inst:m}),f(function(){l(m)&&g({inst:m})})},[f]),i(h),h}function l(f){var u=f.getSnapshot;f=f.value;try{var h=u();return!n(f,h)}catch{return!0}}function c(f,u){return u()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return fa.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,fa}var Pu;function Jb(){return Pu||(Pu=1,da.exports=Zb()),da.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ru;function e1(){if(Ru)return ua;Ru=1;var e=$d(),t=Jb();function n(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var r=typeof Object.is=="function"?Object.is:n,o=t.useSyncExternalStore,s=e.useRef,i=e.useEffect,a=e.useMemo,l=e.useDebugValue;return ua.useSyncExternalStoreWithSelector=function(c,d,f,u,h){var p=s(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=a(function(){function y(b){if(!A){if(A=!0,w=b,b=u(b),h!==void 0&&m.hasValue){var v=m.value;if(h(v,b))return E=v}return E=b}if(v=E,r(w,b))return v;var C=u(b);return h!==void 0&&h(v,C)?(w=b,v):(w=b,E=C)}var A=!1,w,E,R=f===void 0?null:f;return[function(){return y(d())},R===null?void 0:function(){return y(R())}]},[d,f,u,h]);var g=o(c,p[0],p[1]);return i(function(){m.hasValue=!0,m.value=g},[g]),l(g),g},ua}var Iu;function t1(){return Iu||(Iu=1,ca.exports=e1()),ca.exports}var n1=t1();const r1=H0(n1),o1={},Nu=e=>{let t;const n=new Set,r=(d,f)=>{const u=typeof d=="function"?d(t):d;if(!Object.is(u,t)){const h=t;t=f??(typeof u!="object"||u===null)?u:Object.assign({},t,u),n.forEach(p=>p(t,h))}},o=()=>t,l={setState:r,getState:o,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(o1?"gh-pages":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(r,o,l);return l},s1=e=>e?Nu(e):Nu,{useDebugValue:i1}=St,{useSyncExternalStoreWithSelector:a1}=r1,l1=e=>e;function vh(e,t=l1,n){const r=a1(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return i1(r),r}const Tu=(e,t)=>{const n=s1(e),r=(o,s=t)=>vh(n,o,s);return Object.assign(r,n),r},c1=(e,t)=>e?Tu(e,t):Tu;function Ne(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const Si=x.createContext(null),u1=Si.Provider,bh=Nt.error001();function ge(e,t){const n=x.useContext(Si);if(n===null)throw new Error(bh);return vh(n,e,t)}function Se(){const e=x.useContext(Si);if(e===null)throw new Error(bh);return x.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const ku={display:"none"},d1={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ah="react-flow__node-desc",Eh="react-flow__edge-desc",f1="react-flow__aria-live",h1=e=>e.ariaLiveMessage;function p1({rfId:e}){const t=ge(h1);return S.jsx("div",{id:`${f1}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:d1,children:t})}function g1({rfId:e,disableKeyboardA11y:t}){return S.jsxs(S.Fragment,{children:[S.jsxs("div",{id:`${Ah}-${e}`,style:ku,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),S.jsx("div",{id:`${Eh}-${e}`,style:ku,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&S.jsx(p1,{rfId:e})]})}const m1=e=>e.userSelectionActive?"none":"all",rn=x.forwardRef(({position:e="top-left",children:t,className:n,style:r,...o},s)=>{const i=ge(m1),a=`${e}`.split("-");return S.jsx("div",{className:ke(["react-flow__panel",n,...a]),style:{...r,pointerEvents:i},ref:s,...o,children:t})});rn.displayName="Panel";function y1({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:S.jsx(rn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:S.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const w1=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},as=e=>e.id;function x1(e,t){return Ne(e.selectedNodes.map(as),t.selectedNodes.map(as))&&Ne(e.selectedEdges.map(as),t.selectedEdges.map(as))}function v1({onSelectionChange:e}){const t=Se(),{selectedNodes:n,selectedEdges:r}=ge(w1,x1);return x.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChangeHandlers.forEach(s=>s(o))},[n,r,e]),null}const b1=e=>!!e.onSelectionChangeHandlers;function A1({onSelectionChange:e}){const t=ge(b1);return e||t?S.jsx(v1,{onSelectionChange:e}):null}const Sh=[0,0],E1={x:0,y:0,zoom:1},S1=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],_u=[...S1,"rfId"],M1=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Du={translateExtent:vo,nodeOrigin:Sh,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function C1(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:o,setTranslateExtent:s,setNodeExtent:i,reset:a,setDefaultNodesAndEdges:l,setPaneClickDistance:c}=ge(M1,Ne),d=Se();x.useEffect(()=>(l(e.defaultNodes,e.defaultEdges),()=>{f.current=Du,a()}),[]);const f=x.useRef(Du);return x.useEffect(()=>{for(const u of _u){const h=e[u],p=f.current[u];h!==p&&(typeof e[u]>"u"||(u==="nodes"?t(h):u==="edges"?n(h):u==="minZoom"?r(h):u==="maxZoom"?o(h):u==="translateExtent"?s(h):u==="nodeExtent"?i(h):u==="paneClickDistance"?c(h):u==="fitView"?d.setState({fitViewQueued:h}):u==="fitViewOptions"?d.setState({fitViewOptions:h}):d.setState({[u]:h})))}f.current=e},_u.map(u=>e[u])),null}function Ou(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function P1(e){var r;const[t,n]=x.useState(e==="system"?null:e);return x.useEffect(()=>{if(e!=="system"){n(e);return}const o=Ou(),s=()=>n(o!=null&&o.matches?"dark":"light");return s(),o==null||o.addEventListener("change",s),()=>{o==null||o.removeEventListener("change",s)}},[e]),t!==null?t:(r=Ou())!=null&&r.matches?"dark":"light"}const Lu=typeof document<"u"?document:null;function So(e=null,t={target:Lu,actInsideInputWithModifier:!0}){const[n,r]=x.useState(!1),o=x.useRef(!1),s=x.useRef(new Set([])),[i,a]=x.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=c.reduce((f,u)=>f.concat(...u),[]);return[c,d]}return[[],[]]},[e]);return x.useEffect(()=>{const l=(t==null?void 0:t.target)||Lu;if(e!==null){const c=u=>{var m,g;if(o.current=u.ctrlKey||u.metaKey||u.shiftKey||u.altKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&rh(u))return!1;const p=Fu(u.code,a);if(s.current.add(u[p]),Bu(i,s.current,!1)){const y=((g=(m=u.composedPath)==null?void 0:m.call(u))==null?void 0:g[0])||u.target,A=(y==null?void 0:y.nodeName)==="BUTTON"||(y==null?void 0:y.nodeName)==="A";t.preventDefault!==!1&&(o.current||!A)&&u.preventDefault(),r(!0)}},d=u=>{const h=Fu(u.code,a);Bu(i,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(u[h]),u.key==="Meta"&&s.current.clear(),o.current=!1},f=()=>{s.current.clear(),r(!1)};return l==null||l.addEventListener("keydown",c),l==null||l.addEventListener("keyup",d),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{l==null||l.removeEventListener("keydown",c),l==null||l.removeEventListener("keyup",d),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,r]),n}function Bu(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function Fu(e,t){return t.includes(e)?"code":"key"}const R1=()=>{const e=Se();return x.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,o,s],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??o,zoom:t.zoom??s},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>{const{width:o,height:s,maxZoom:i,panZoom:a}=e.getState(),l=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:i,c=o/2-t*l,d=s/2-n*l;return a?(await a.setViewport({x:c,y:d,zoom:l},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:o,minZoom:s,maxZoom:i,panZoom:a}=e.getState(),l=Fl(t,r,o,s,i,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(l,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:o,snapToGrid:s,domNode:i}=e.getState();if(!i)return t;const{x:a,y:l}=i.getBoundingClientRect(),c={x:t.x-a,y:t.y-l},d=n.snapGrid??o,f=n.snapToGrid??s;return jo(c,r,f,d)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:o,y:s}=r.getBoundingClientRect(),i=Hs(t,n);return{x:i.x+o,y:i.y+s}}}),[])};function Mh(e,t){const n=[],r=new Map,o=[];for(const s of e)if(s.type==="add"){o.push(s);continue}else if(s.type==="remove"||s.type==="replace")r.set(s.id,[s]);else{const i=r.get(s.id);i?i.push(s):r.set(s.id,[s])}for(const s of t){const i=r.get(s.id);if(!i){n.push(s);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const a={...s};for(const l of i)I1(l,a);n.push(a)}return o.length&&o.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function I1(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Ch(e,t){return Mh(e,t)}function Ph(e,t){return Mh(e,t)}function Tn(e,t){return{id:e,type:"select",selected:t}}function mr(e,t=new Set,n=!1){const r=[];for(const[o,s]of e){const i=t.has(o);!(s.selected===void 0&&!i)&&s.selected!==i&&(n&&(s.selected=i),r.push(Tn(s.id,i)))}return r}function ju({items:e=[],lookup:t}){var o;const n=[],r=new Map(e.map(s=>[s.id,s]));for(const[s,i]of e.entries()){const a=t.get(i.id),l=((o=a==null?void 0:a.internals)==null?void 0:o.userNode)??a;l!==void 0&&l!==i&&n.push({id:i.id,item:i,type:"replace"}),l===void 0&&n.push({item:i,type:"add",index:s})}for(const[s]of t)r.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function qu(e){return{id:e.id,type:"remove"}}const zu=e=>rb(e),N1=e=>Wf(e);function Rh(e){return x.forwardRef(e)}const T1=typeof window<"u"?x.useLayoutEffect:x.useEffect;function Hu(e){const[t,n]=x.useState(BigInt(0)),[r]=x.useState(()=>k1(()=>n(o=>o+BigInt(1))));return T1(()=>{const o=r.get();o.length&&(e(o),r.reset())},[t]),r}function k1(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Ih=x.createContext(null);function _1({children:e}){const t=Se(),n=x.useCallback(a=>{const{nodes:l=[],setNodes:c,hasDefaultNodes:d,onNodesChange:f,nodeLookup:u,fitViewQueued:h}=t.getState();let p=l;for(const m of a)p=typeof m=="function"?m(p):m;if(d)c(p);else{const m=ju({items:p,lookup:u});m.length>0?f==null||f(m):h&&window.requestAnimationFrame(()=>{const{fitViewQueued:g,nodes:y,setNodes:A}=t.getState();g&&A(y)})}},[]),r=Hu(n),o=x.useCallback(a=>{const{edges:l=[],setEdges:c,hasDefaultEdges:d,onEdgesChange:f,edgeLookup:u}=t.getState();let h=l;for(const p of a)h=typeof p=="function"?p(h):p;d?c(h):f&&f(ju({items:h,lookup:u}))},[]),s=Hu(o),i=x.useMemo(()=>({nodeQueue:r,edgeQueue:s}),[]);return S.jsx(Ih.Provider,{value:i,children:e})}function D1(){const e=x.useContext(Ih);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const O1=e=>!!e.panZoom;function $e(){const e=R1(),t=Se(),n=D1(),r=ge(O1),o=x.useMemo(()=>{const s=f=>t.getState().nodeLookup.get(f),i=f=>{n.nodeQueue.push(f)},a=f=>{n.edgeQueue.push(f)},l=f=>{var y,A;const{nodeLookup:u,nodeOrigin:h}=t.getState(),p=zu(f)?f:u.get(f.id),m=p.parentId?th(p.position,p.measured,p.parentId,u,h):p.position,g={...p,position:m,width:((y=p.measured)==null?void 0:y.width)??p.width,height:((A=p.measured)==null?void 0:A.height)??p.height};return Ir(g)},c=(f,u,h={replace:!1})=>{i(p=>p.map(m=>{if(m.id===f){const g=typeof u=="function"?u(m):u;return h.replace&&zu(g)?g:{...m,...g}}return m}))},d=(f,u,h={replace:!1})=>{a(p=>p.map(m=>{if(m.id===f){const g=typeof u=="function"?u(m):u;return h.replace&&N1(g)?g:{...m,...g}}return m}))};return{getNodes:()=>t.getState().nodes.map(f=>({...f})),getNode:f=>{var u;return(u=s(f))==null?void 0:u.internals.userNode},getInternalNode:s,getEdges:()=>{const{edges:f=[]}=t.getState();return f.map(u=>({...u}))},getEdge:f=>t.getState().edgeLookup.get(f),setNodes:i,setEdges:a,addNodes:f=>{const u=Array.isArray(f)?f:[f];n.nodeQueue.push(h=>[...h,...u])},addEdges:f=>{const u=Array.isArray(f)?f:[f];n.edgeQueue.push(h=>[...h,...u])},toObject:()=>{const{nodes:f=[],edges:u=[],transform:h}=t.getState(),[p,m,g]=h;return{nodes:f.map(y=>({...y})),edges:u.map(y=>({...y})),viewport:{x:p,y:m,zoom:g}}},deleteElements:async({nodes:f=[],edges:u=[]})=>{const{nodes:h,edges:p,onNodesDelete:m,onEdgesDelete:g,triggerNodeChanges:y,triggerEdgeChanges:A,onDelete:w,onBeforeDelete:E}=t.getState(),{nodes:R,edges:b}=await lb({nodesToRemove:f,edgesToRemove:u,nodes:h,edges:p,onBeforeDelete:E}),v=b.length>0,C=R.length>0;if(v){const T=b.map(qu);g==null||g(b),A(T)}if(C){const T=R.map(qu);m==null||m(R),y(T)}return(C||v)&&(w==null||w({nodes:R,edges:b})),{deletedNodes:R,deletedEdges:b}},getIntersectingNodes:(f,u=!0,h)=>{const p=pu(f),m=p?f:l(f),g=h!==void 0;return m?(h||t.getState().nodes).filter(y=>{const A=t.getState().nodeLookup.get(y.id);if(A&&!p&&(y.id===f.id||!A.internals.positionAbsolute))return!1;const w=Ir(g?y:A),E=Ao(w,m);return u&&E>0||E>=m.width*m.height}):[]},isNodeIntersecting:(f,u,h=!0)=>{const m=pu(f)?f:l(f);if(!m)return!1;const g=Ao(m,u);return h&&g>0||g>=m.width*m.height},updateNode:c,updateNodeData:(f,u,h={replace:!1})=>{c(f,p=>{const m=typeof u=="function"?u(p):u;return h.replace?{...p,data:m}:{...p,data:{...p.data,...m}}},h)},updateEdge:d,updateEdgeData:(f,u,h={replace:!1})=>{d(f,p=>{const m=typeof u=="function"?u(p):u;return h.replace?{...p,data:m}:{...p,data:{...p.data,...m}}},h)},getNodesBounds:f=>{const{nodeLookup:u,nodeOrigin:h}=t.getState();return ob(f,{nodeLookup:u,nodeOrigin:h})},getHandleConnections:({type:f,id:u,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}-${f}${u?`-${u}`:""}`))==null?void 0:p.values())??[])},getNodeConnections:({type:f,handleId:u,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}${f?u?`-${f}-${u}`:`-${f}`:""}`))==null?void 0:p.values())??[])},fitView:async f=>{const u=t.getState().fitViewResolver??fb();return t.setState({fitViewQueued:!0,fitViewOptions:f,fitViewResolver:u}),n.nodeQueue.push(h=>[...h]),u.promise}}},[]);return x.useMemo(()=>({...o,...e,viewportInitialized:r}),[r])}const Vu=e=>e.selected,L1={actInsideInputWithModifier:!1},B1=typeof window<"u"?window:void 0;function F1({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=Se(),{deleteElements:r}=$e(),o=So(e,L1),s=So(t,{target:B1});x.useEffect(()=>{if(o){const{edges:i,nodes:a}=n.getState();r({nodes:a.filter(Vu),edges:i.filter(Vu)}),n.setState({nodesSelectionActive:!1})}},[o]),x.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function j1(e){const t=Se();x.useEffect(()=>{const n=()=>{var o,s;if(!e.current)return!1;const r=jl(e.current);(r.height===0||r.width===0)&&((s=(o=t.getState()).onError)==null||s.call(o,"004",Nt.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const Mi={position:"absolute",width:"100%",height:"100%",top:0,left:0},q1=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function z1({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:o=.5,panOnScrollMode:s=Bn.Free,zoomOnDoubleClick:i=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:c,minZoom:d,maxZoom:f,zoomActivationKeyCode:u,preventScrolling:h=!0,children:p,noWheelClassName:m,noPanClassName:g,onViewportChange:y,isControlledViewport:A,paneClickDistance:w}){const E=Se(),R=x.useRef(null),{userSelectionActive:b,lib:v}=ge(q1,Ne),C=So(u),T=x.useRef();j1(R);const k=x.useCallback(D=>{y==null||y({x:D[0],y:D[1],zoom:D[2]}),A||E.setState({transform:D})},[y,A]);return x.useEffect(()=>{if(R.current){T.current=Ub({domNode:R.current,minZoom:d,maxZoom:f,translateExtent:c,viewport:l,paneClickDistance:w,onDraggingChange:P=>E.setState({paneDragging:P}),onPanZoomStart:(P,O)=>{const{onViewportChangeStart:I,onMoveStart:_}=E.getState();_==null||_(P,O),I==null||I(O)},onPanZoom:(P,O)=>{const{onViewportChange:I,onMove:_}=E.getState();_==null||_(P,O),I==null||I(O)},onPanZoomEnd:(P,O)=>{const{onViewportChangeEnd:I,onMoveEnd:_}=E.getState();_==null||_(P,O),I==null||I(O)}});const{x:D,y:B,zoom:j}=T.current.getViewport();return E.setState({panZoom:T.current,transform:[D,B,j],domNode:R.current.closest(".react-flow")}),()=>{var P;(P=T.current)==null||P.destroy()}}},[]),x.useEffect(()=>{var D;(D=T.current)==null||D.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:o,panOnScrollMode:s,zoomOnDoubleClick:i,panOnDrag:a,zoomActivationKeyPressed:C,preventScrolling:h,noPanClassName:g,userSelectionActive:b,noWheelClassName:m,lib:v,onTransformChange:k})},[e,t,n,r,o,s,i,a,C,h,g,b,m,v,k]),S.jsx("div",{className:"react-flow__renderer",ref:R,style:Mi,children:p})}const H1=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function V1(){const{userSelectionActive:e,userSelectionRect:t}=ge(H1,Ne);return e&&t?S.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const ha=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},U1=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function $1({isSelecting:e,selectionKeyPressed:t,selectionMode:n=bo.Full,panOnDrag:r,selectionOnDrag:o,onSelectionStart:s,onSelectionEnd:i,onPaneClick:a,onPaneContextMenu:l,onPaneScroll:c,onPaneMouseEnter:d,onPaneMouseMove:f,onPaneMouseLeave:u,children:h}){const p=Se(),{userSelectionActive:m,elementsSelectable:g,dragging:y,connectionInProgress:A}=ge(U1,Ne),w=g&&(e||m),E=x.useRef(null),R=x.useRef(),b=x.useRef(new Set),v=x.useRef(new Set),C=x.useRef(!1),T=x.useRef(!1),k=_=>{if(C.current||A){C.current=!1;return}a==null||a(_),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},D=_=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){_.preventDefault();return}l==null||l(_)},B=c?_=>c(_):void 0,j=_=>{var U,K;const{resetSelectedElements:F,domNode:N}=p.getState();if(R.current=N==null?void 0:N.getBoundingClientRect(),!g||!e||_.button!==0||_.target!==E.current||!R.current)return;(K=(U=_.target)==null?void 0:U.setPointerCapture)==null||K.call(U,_.pointerId),T.current=!0,C.current=!1;const{x:z,y:V}=Xt(_.nativeEvent,R.current);F(),p.setState({userSelectionRect:{width:0,height:0,startX:z,startY:V,x:z,y:V}}),s==null||s(_)},P=_=>{const{userSelectionRect:F,transform:N,nodeLookup:z,edgeLookup:V,connectionLookup:U,triggerNodeChanges:K,triggerEdgeChanges:Y,defaultEdgeOptions:ee}=p.getState();if(!R.current||!F)return;C.current=!0;const{x:Z,y:q}=Xt(_.nativeEvent,R.current),{startX:W,startY:te}=F,se={startX:W,startY:te,x:Z<W?Z:W,y:q<te?q:te,width:Math.abs(Z-W),height:Math.abs(q-te)},oe=b.current,ne=v.current;b.current=new Set(Yf(z,se,N,n===bo.Partial,!0).map(re=>re.id)),v.current=new Set;const J=(ee==null?void 0:ee.selectable)??!0;for(const re of b.current){const le=U.get(re);if(le)for(const{edgeId:ce}of le.values()){const me=V.get(ce);me&&(me.selectable??J)&&v.current.add(ce)}}if(!gu(oe,b.current)){const re=mr(z,b.current,!0);K(re)}if(!gu(ne,v.current)){const re=mr(V,v.current);Y(re)}p.setState({userSelectionRect:se,userSelectionActive:!0,nodesSelectionActive:!1})},O=_=>{var N,z;if(_.button!==0||!T.current)return;(z=(N=_.target)==null?void 0:N.releasePointerCapture)==null||z.call(N,_.pointerId);const{userSelectionRect:F}=p.getState();!m&&F&&_.target===E.current&&(k==null||k(_)),p.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:b.current.size>0}),i==null||i(_),(t||o)&&(C.current=!1),T.current=!1},I=r===!0||Array.isArray(r)&&r.includes(0);return S.jsxs("div",{className:ke(["react-flow__pane",{draggable:I,dragging:y,selection:e}]),onClick:w?void 0:ha(k,E),onContextMenu:ha(D,E),onWheel:ha(B,E),onPointerEnter:w?void 0:d,onPointerDown:w?j:f,onPointerMove:w?P:f,onPointerUp:w?O:void 0,onPointerLeave:u,ref:E,style:Mi,children:[h,S.jsx(V1,{})]})}function Ka({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:s,multiSelectionActive:i,nodeLookup:a,onError:l}=t.getState(),c=a.get(e);if(!c){l==null||l("012",Nt.error012(e));return}t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&i)&&(s({nodes:[c],edges:[]}),requestAnimationFrame(()=>{var d;return(d=r==null?void 0:r.current)==null?void 0:d.blur()})):o([e])}function Nh({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:s,nodeClickDistance:i}){const a=Se(),[l,c]=x.useState(!1),d=x.useRef();return x.useEffect(()=>{d.current=Nb({getStoreItems:()=>a.getState(),onNodeMouseDown:f=>{Ka({id:f,store:a,nodeRef:e})},onDragStart:()=>{c(!0)},onDragStop:()=>{c(!1)}})},[]),x.useEffect(()=>{var f,u;if(t)(f=d.current)==null||f.destroy();else if(e.current)return(u=d.current)==null||u.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:s,nodeId:o,nodeClickDistance:i}),()=>{var h;(h=d.current)==null||h.destroy()}},[n,r,t,s,e,o]),l}const G1=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Th(){const e=Se();return x.useCallback(n=>{const{nodeExtent:r,snapToGrid:o,snapGrid:s,nodesDraggable:i,onError:a,updateNodePositions:l,nodeLookup:c,nodeOrigin:d}=e.getState(),f=new Map,u=G1(i),h=o?s[0]:5,p=o?s[1]:5,m=n.direction.x*h*n.factor,g=n.direction.y*p*n.factor;for(const[,y]of c){if(!u(y))continue;let A={x:y.internals.positionAbsolute.x+m,y:y.internals.positionAbsolute.y+g};o&&(A=Ai(A,s));const{position:w,positionAbsolute:E}=Xf({nodeId:y.id,nextPosition:A,nodeLookup:c,nodeExtent:r,nodeOrigin:d,onError:a});y.position=w,y.internals.positionAbsolute=E,f.set(y.id,y)}l(f)},[])}const Ul=x.createContext(null),K1=Ul.Provider;Ul.Consumer;const $l=()=>x.useContext(Ul),W1=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Y1=(e,t,n)=>r=>{const{connectionClickStartHandle:o,connectionMode:s,connection:i}=r,{fromHandle:a,toHandle:l,isValid:c}=i,d=(l==null?void 0:l.nodeId)===e&&(l==null?void 0:l.id)===t&&(l==null?void 0:l.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:d,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.id)===t&&(o==null?void 0:o.type)===n,isPossibleEndHandle:s===Pr.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!o,valid:d&&c}};function X1({type:e="source",position:t=ae.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:s=!0,id:i,onConnect:a,children:l,className:c,onMouseDown:d,onTouchStart:f,...u},h){var O,I;const p=i||null,m=e==="target",g=Se(),y=$l(),{connectOnClick:A,noPanClassName:w,rfId:E}=ge(W1,Ne),{connectingFrom:R,connectingTo:b,clickConnecting:v,isPossibleEndHandle:C,connectionInProcess:T,clickConnectionInProcess:k,valid:D}=ge(Y1(y,p,e),Ne);y||(I=(O=g.getState()).onError)==null||I.call(O,"010",Nt.error010());const B=_=>{const{defaultEdgeOptions:F,onConnect:N,hasDefaultEdges:z}=g.getState(),V={...F,..._};if(z){const{edges:U,setEdges:K}=g.getState();K(lh(V,U))}N==null||N(V),a==null||a(V)},j=_=>{if(!y)return;const F=oh(_.nativeEvent);if(o&&(F&&_.button===0||!F)){const N=g.getState();Ga.onPointerDown(_.nativeEvent,{autoPanOnConnect:N.autoPanOnConnect,connectionMode:N.connectionMode,connectionRadius:N.connectionRadius,domNode:N.domNode,nodeLookup:N.nodeLookup,lib:N.lib,isTarget:m,handleId:p,nodeId:y,flowId:N.rfId,panBy:N.panBy,cancelConnection:N.cancelConnection,onConnectStart:N.onConnectStart,onConnectEnd:N.onConnectEnd,updateConnection:N.updateConnection,onConnect:B,isValidConnection:n||N.isValidConnection,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle,autoPanSpeed:N.autoPanSpeed})}F?d==null||d(_):f==null||f(_)},P=_=>{const{onClickConnectStart:F,onClickConnectEnd:N,connectionClickStartHandle:z,connectionMode:V,isValidConnection:U,lib:K,rfId:Y,nodeLookup:ee,connection:Z}=g.getState();if(!y||!z&&!o)return;if(!z){F==null||F(_.nativeEvent,{nodeId:y,handleId:p,handleType:e}),g.setState({connectionClickStartHandle:{nodeId:y,type:e,id:p}});return}const q=nh(_.target),W=n||U,{connection:te,isValid:se}=Ga.isValid(_.nativeEvent,{handle:{nodeId:y,id:p,type:e},connectionMode:V,fromNodeId:z.nodeId,fromHandleId:z.id||null,fromType:z.type,isValidConnection:W,flowId:Y,doc:q,lib:K,nodeLookup:ee});se&&te&&B(te);const oe=structuredClone(Z);delete oe.inProgress,oe.toPosition=oe.toHandle?oe.toHandle.position:null,N==null||N(_,oe),g.setState({connectionClickStartHandle:null})};return S.jsx("div",{"data-handleid":p,"data-nodeid":y,"data-handlepos":t,"data-id":`${E}-${y}-${p}-${e}`,className:ke(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",w,c,{source:!m,target:m,connectable:r,connectablestart:o,connectableend:s,clickconnecting:v,connectingfrom:R,connectingto:b,valid:D,connectionindicator:r&&(!T||C)&&(T||k?s:o)}]),onMouseDown:j,onTouchStart:j,onClick:A?P:void 0,ref:h,...u,children:l})}const Tr=x.memo(Rh(X1));function Q1({data:e,isConnectable:t,sourcePosition:n=ae.Bottom}){return S.jsxs(S.Fragment,{children:[e==null?void 0:e.label,S.jsx(Tr,{type:"source",position:n,isConnectable:t})]})}function Z1({data:e,isConnectable:t,targetPosition:n=ae.Top,sourcePosition:r=ae.Bottom}){return S.jsxs(S.Fragment,{children:[S.jsx(Tr,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,S.jsx(Tr,{type:"source",position:r,isConnectable:t})]})}function J1(){return null}function eA({data:e,isConnectable:t,targetPosition:n=ae.Top}){return S.jsxs(S.Fragment,{children:[S.jsx(Tr,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Us={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Uu={input:Q1,default:Z1,output:eA,group:J1};function tA(e){var t,n,r,o;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((o=e.style)==null?void 0:o.height)}}const nA=e=>{const{width:t,height:n,x:r,y:o}=Fo(e.nodeLookup,{filter:s=>!!s.selected});return{width:Pt(t)?t:null,height:Pt(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${o}px)`}};function rA({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=Se(),{width:o,height:s,transformString:i,userSelectionActive:a}=ge(nA,Ne),l=Th(),c=x.useRef(null);if(x.useEffect(()=>{var u;n||(u=c.current)==null||u.focus({preventScroll:!0})},[n]),Nh({nodeRef:c}),a||!o||!s)return null;const d=e?u=>{const h=r.getState().nodes.filter(p=>p.selected);e(u,h)}:void 0,f=u=>{Object.prototype.hasOwnProperty.call(Us,u.key)&&(u.preventDefault(),l({direction:Us[u.key],factor:u.shiftKey?4:1}))};return S.jsx("div",{className:ke(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:S.jsx("div",{ref:c,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:o,height:s}})})}const $u=typeof window<"u"?window:void 0,oA=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function kh({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:c,selectionOnDrag:d,selectionMode:f,onSelectionStart:u,onSelectionEnd:h,multiSelectionKeyCode:p,panActivationKeyCode:m,zoomActivationKeyCode:g,elementsSelectable:y,zoomOnScroll:A,zoomOnPinch:w,panOnScroll:E,panOnScrollSpeed:R,panOnScrollMode:b,zoomOnDoubleClick:v,panOnDrag:C,defaultViewport:T,translateExtent:k,minZoom:D,maxZoom:B,preventScrolling:j,onSelectionContextMenu:P,noWheelClassName:O,noPanClassName:I,disableKeyboardA11y:_,onViewportChange:F,isControlledViewport:N}){const{nodesSelectionActive:z,userSelectionActive:V}=ge(oA),U=So(c,{target:$u}),K=So(m,{target:$u}),Y=K||C,ee=K||E,Z=d&&Y!==!0,q=U||V||Z;return F1({deleteKeyCode:l,multiSelectionKeyCode:p}),S.jsx(z1,{onPaneContextMenu:s,elementsSelectable:y,zoomOnScroll:A,zoomOnPinch:w,panOnScroll:ee,panOnScrollSpeed:R,panOnScrollMode:b,zoomOnDoubleClick:v,panOnDrag:!U&&Y,defaultViewport:T,translateExtent:k,minZoom:D,maxZoom:B,zoomActivationKeyCode:g,preventScrolling:j,noWheelClassName:O,noPanClassName:I,onViewportChange:F,isControlledViewport:N,paneClickDistance:a,children:S.jsxs($1,{onSelectionStart:u,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:Y,isSelecting:!!q,selectionMode:f,selectionKeyPressed:U,selectionOnDrag:Z,children:[e,z&&S.jsx(rA,{onSelectionContextMenu:P,noPanClassName:I,disableKeyboardA11y:_})]})})}kh.displayName="FlowRenderer";const sA=x.memo(kh),iA=e=>t=>e?Yf(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function aA(e){return ge(x.useCallback(iA(e),[e]),Ne)}const lA=e=>e.updateNodeInternals;function cA(){const e=ge(lA),[t]=x.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(o=>{const s=o.target.getAttribute("data-id");r.set(s,{id:s,nodeElement:o.target,force:!0})}),e(r)}));return x.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function uA({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const o=Se(),s=x.useRef(null),i=x.useRef(null),a=x.useRef(e.sourcePosition),l=x.useRef(e.targetPosition),c=x.useRef(t),d=n&&!!e.internals.handleBounds;return x.useEffect(()=>{s.current&&!e.hidden&&(!d||i.current!==s.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(s.current),i.current=s.current)},[d,e.hidden]),x.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),x.useEffect(()=>{if(s.current){const f=c.current!==t,u=a.current!==e.sourcePosition,h=l.current!==e.targetPosition;(f||u||h)&&(c.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function dA({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:s,onDoubleClick:i,nodesDraggable:a,elementsSelectable:l,nodesConnectable:c,nodesFocusable:d,resizeObserver:f,noDragClassName:u,noPanClassName:h,disableKeyboardA11y:p,rfId:m,nodeTypes:g,nodeClickDistance:y,onError:A}){const{node:w,internals:E,isParent:R}=ge(q=>{const W=q.nodeLookup.get(e),te=q.parentLookup.has(e);return{node:W,internals:W.internals,isParent:te}},Ne);let b=w.type||"default",v=(g==null?void 0:g[b])||Uu[b];v===void 0&&(A==null||A("003",Nt.error003(b)),b="default",v=Uu.default);const C=!!(w.draggable||a&&typeof w.draggable>"u"),T=!!(w.selectable||l&&typeof w.selectable>"u"),k=!!(w.connectable||c&&typeof w.connectable>"u"),D=!!(w.focusable||d&&typeof w.focusable>"u"),B=Se(),j=eh(w),P=uA({node:w,nodeType:b,hasDimensions:j,resizeObserver:f}),O=Nh({nodeRef:P,disabled:w.hidden||!C,noDragClassName:u,handleSelector:w.dragHandle,nodeId:e,isSelectable:T,nodeClickDistance:y}),I=Th();if(w.hidden)return null;const _=nn(w),F=tA(w),N=T||C||t||n||r||o,z=n?q=>n(q,{...E.userNode}):void 0,V=r?q=>r(q,{...E.userNode}):void 0,U=o?q=>o(q,{...E.userNode}):void 0,K=s?q=>s(q,{...E.userNode}):void 0,Y=i?q=>i(q,{...E.userNode}):void 0,ee=q=>{const{selectNodesOnDrag:W,nodeDragThreshold:te}=B.getState();T&&(!W||!C||te>0)&&Ka({id:e,store:B,nodeRef:P}),t&&t(q,{...E.userNode})},Z=q=>{if(!(rh(q.nativeEvent)||p))if($f.includes(q.key)&&T){const W=q.key==="Escape";Ka({id:e,store:B,unselect:W,nodeRef:P})}else C&&w.selected&&Object.prototype.hasOwnProperty.call(Us,q.key)&&(q.preventDefault(),B.setState({ariaLiveMessage:`Moved selected node ${q.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~E.positionAbsolute.x}, y: ${~~E.positionAbsolute.y}`}),I({direction:Us[q.key],factor:q.shiftKey?4:1}))};return S.jsx("div",{className:ke(["react-flow__node",`react-flow__node-${b}`,{[h]:C},w.className,{selected:w.selected,selectable:T,parent:R,draggable:C,dragging:O}]),ref:P,style:{zIndex:E.z,transform:`translate(${E.positionAbsolute.x}px,${E.positionAbsolute.y}px)`,pointerEvents:N?"all":"none",visibility:j?"visible":"hidden",...w.style,...F},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:z,onMouseMove:V,onMouseLeave:U,onContextMenu:K,onClick:ee,onDoubleClick:Y,onKeyDown:D?Z:void 0,tabIndex:D?0:void 0,role:D?"button":void 0,"aria-describedby":p?void 0:`${Ah}-${m}`,"aria-label":w.ariaLabel,children:S.jsx(K1,{value:e,children:S.jsx(v,{id:e,data:w.data,type:b,positionAbsoluteX:E.positionAbsolute.x,positionAbsoluteY:E.positionAbsolute.y,selected:w.selected??!1,selectable:T,draggable:C,deletable:w.deletable??!0,isConnectable:k,sourcePosition:w.sourcePosition,targetPosition:w.targetPosition,dragging:O,dragHandle:w.dragHandle,zIndex:E.z,parentId:w.parentId,..._})})})}const fA=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function _h(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:s}=ge(fA,Ne),i=aA(e.onlyRenderVisibleElements),a=cA();return S.jsx("div",{className:"react-flow__nodes",style:Mi,children:i.map(l=>S.jsx(dA,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,nodeClickDistance:e.nodeClickDistance,onError:s},l))})}_h.displayName="NodeRenderer";const hA=x.memo(_h);function pA(e){return ge(x.useCallback(n=>{if(!e)return n.edges.map(o=>o.id);const r=[];if(n.width&&n.height)for(const o of n.edges){const s=n.nodeLookup.get(o.source),i=n.nodeLookup.get(o.target);s&&i&&gb({sourceNode:s,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&r.push(o.id)}return r},[e]),Ne)}const gA=({color:e="none",strokeWidth:t=1})=>S.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),mA=({color:e="none",strokeWidth:t=1})=>S.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Gu={[qs.Arrow]:gA,[qs.ArrowClosed]:mA};function yA(e){const t=Se();return x.useMemo(()=>{var o,s;return Object.prototype.hasOwnProperty.call(Gu,e)?Gu[e]:((s=(o=t.getState()).onError)==null||s.call(o,"009",Nt.error009(e)),null)},[e])}const wA=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const l=yA(t);return l?S.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:S.jsx(l,{color:n,strokeWidth:i})}):null},Dh=({defaultColor:e,rfId:t})=>{const n=ge(s=>s.edges),r=ge(s=>s.defaultEdgeOptions),o=x.useMemo(()=>Ab(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return o.length?S.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:S.jsx("defs",{children:o.map(s=>S.jsx(wA,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};Dh.displayName="MarkerDefinitions";var xA=x.memo(Dh);function Oh({x:e,y:t,label:n,labelStyle:r,labelShowBg:o=!0,labelBgStyle:s,labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...d}){const[f,u]=x.useState({x:1,y:0,width:0,height:0}),h=ke(["react-flow__edge-textwrapper",c]),p=x.useRef(null);return x.useEffect(()=>{if(p.current){const m=p.current.getBBox();u({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),n?S.jsxs("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:h,visibility:f.width?"visible":"hidden",...d,children:[o&&S.jsx("rect",{width:f.width+2*i[0],x:-i[0],y:-i[1],height:f.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),S.jsx("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:p,style:r,children:n}),l]}):null}Oh.displayName="EdgeText";const vA=x.memo(Oh);function Ci({path:e,labelX:t,labelY:n,label:r,labelStyle:o,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:c=20,...d}){return S.jsxs(S.Fragment,{children:[S.jsx("path",{...d,d:e,fill:"none",className:ke(["react-flow__edge-path",d.className])}),c&&S.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:c,className:"react-flow__edge-interaction"}),r&&Pt(t)&&Pt(n)?S.jsx(vA,{x:t,y:n,label:r,labelStyle:o,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function Ku({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===ae.Left||e===ae.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Lh({sourceX:e,sourceY:t,sourcePosition:n=ae.Bottom,targetX:r,targetY:o,targetPosition:s=ae.Top}){const[i,a]=Ku({pos:n,x1:e,y1:t,x2:r,y2:o}),[l,c]=Ku({pos:s,x1:r,y1:o,x2:e,y2:t}),[d,f,u,h]=sh({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:i,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${e},${t} C${i},${a} ${l},${c} ${r},${o}`,d,f,u,h]}function Bh(e){return x.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,sourcePosition:i,targetPosition:a,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:g,interactionWidth:y})=>{const[A,w,E]=Lh({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:s,targetPosition:a}),R=e.isInternal?void 0:t;return S.jsx(Ci,{id:R,path:A,labelX:w,labelY:E,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:g,interactionWidth:y})})}const bA=Bh({isInternal:!1}),Fh=Bh({isInternal:!0});bA.displayName="SimpleBezierEdge";Fh.displayName="SimpleBezierEdgeInternal";function jh(e){return x.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,style:u,sourcePosition:h=ae.Bottom,targetPosition:p=ae.Top,markerEnd:m,markerStart:g,pathOptions:y,interactionWidth:A})=>{const[w,E,R]=Va({sourceX:n,sourceY:r,sourcePosition:h,targetX:o,targetY:s,targetPosition:p,borderRadius:y==null?void 0:y.borderRadius,offset:y==null?void 0:y.offset}),b=e.isInternal?void 0:t;return S.jsx(Ci,{id:b,path:w,labelX:E,labelY:R,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,style:u,markerEnd:m,markerStart:g,interactionWidth:A})})}const qh=jh({isInternal:!1}),zh=jh({isInternal:!0});qh.displayName="SmoothStepEdge";zh.displayName="SmoothStepEdgeInternal";function Hh(e){return x.memo(({id:t,...n})=>{var o;const r=e.isInternal?void 0:t;return S.jsx(qh,{...n,id:r,pathOptions:x.useMemo(()=>{var s;return{borderRadius:0,offset:(s=n.pathOptions)==null?void 0:s.offset}},[(o=n.pathOptions)==null?void 0:o.offset])})})}const AA=Hh({isInternal:!1}),Vh=Hh({isInternal:!0});AA.displayName="StepEdge";Vh.displayName="StepEdgeInternal";function Uh(e){return x.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,style:u,markerEnd:h,markerStart:p,interactionWidth:m})=>{const[g,y,A]=ch({sourceX:n,sourceY:r,targetX:o,targetY:s}),w=e.isInternal?void 0:t;return S.jsx(Ci,{id:w,path:g,labelX:y,labelY:A,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,style:u,markerEnd:h,markerStart:p,interactionWidth:m})})}const EA=Uh({isInternal:!1}),$h=Uh({isInternal:!0});EA.displayName="StraightEdge";$h.displayName="StraightEdgeInternal";function Gh(e){return x.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,sourcePosition:i=ae.Bottom,targetPosition:a=ae.Top,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:g,pathOptions:y,interactionWidth:A})=>{const[w,E,R]=ih({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:s,targetPosition:a,curvature:y==null?void 0:y.curvature}),b=e.isInternal?void 0:t;return S.jsx(Ci,{id:b,path:w,labelX:E,labelY:R,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:g,interactionWidth:A})})}const SA=Gh({isInternal:!1}),Kh=Gh({isInternal:!0});SA.displayName="BezierEdge";Kh.displayName="BezierEdgeInternal";const Wu={default:Kh,straight:$h,step:Vh,smoothstep:zh,simplebezier:Fh},Yu={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},MA=(e,t,n)=>n===ae.Left?e-t:n===ae.Right?e+t:e,CA=(e,t,n)=>n===ae.Top?e-t:n===ae.Bottom?e+t:e,Xu="react-flow__edgeupdater";function Qu({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:s,onMouseOut:i,type:a}){return S.jsx("circle",{onMouseDown:o,onMouseEnter:s,onMouseOut:i,className:ke([Xu,`${Xu}-${a}`]),cx:MA(t,r,e),cy:CA(n,r,e),r,stroke:"transparent",fill:"transparent"})}function PA({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:o,targetX:s,targetY:i,sourcePosition:a,targetPosition:l,onReconnect:c,onReconnectStart:d,onReconnectEnd:f,setReconnecting:u,setUpdateHover:h}){const p=Se(),m=(E,R)=>{if(E.button!==0)return;const{autoPanOnConnect:b,domNode:v,isValidConnection:C,connectionMode:T,connectionRadius:k,lib:D,onConnectStart:B,onConnectEnd:j,cancelConnection:P,nodeLookup:O,rfId:I,panBy:_,updateConnection:F}=p.getState(),N=R.type==="target";u(!0),d==null||d(E,n,R.type);const z=(U,K)=>{u(!1),f==null||f(U,n,R.type,K)},V=U=>c==null?void 0:c(n,U);Ga.onPointerDown(E.nativeEvent,{autoPanOnConnect:b,connectionMode:T,connectionRadius:k,domNode:v,handleId:R.id,nodeId:R.nodeId,nodeLookup:O,isTarget:N,edgeUpdaterType:R.type,lib:D,flowId:I,cancelConnection:P,panBy:_,isValidConnection:C,onConnect:V,onConnectStart:B,onConnectEnd:j,onReconnectEnd:z,updateConnection:F,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle})},g=E=>m(E,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),y=E=>m(E,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),A=()=>h(!0),w=()=>h(!1);return S.jsxs(S.Fragment,{children:[(e===!0||e==="source")&&S.jsx(Qu,{position:a,centerX:r,centerY:o,radius:t,onMouseDown:g,onMouseEnter:A,onMouseOut:w,type:"source"}),(e===!0||e==="target")&&S.jsx(Qu,{position:l,centerX:s,centerY:i,radius:t,onMouseDown:y,onMouseEnter:A,onMouseOut:w,type:"target"})]})}function RA({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:o,onDoubleClick:s,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,reconnectRadius:d,onReconnect:f,onReconnectStart:u,onReconnectEnd:h,rfId:p,edgeTypes:m,noPanClassName:g,onError:y,disableKeyboardA11y:A}){let w=ge(ne=>ne.edgeLookup.get(e));const E=ge(ne=>ne.defaultEdgeOptions);w=E?{...E,...w}:w;let R=w.type||"default",b=(m==null?void 0:m[R])||Wu[R];b===void 0&&(y==null||y("011",Nt.error011(R)),R="default",b=Wu.default);const v=!!(w.focusable||t&&typeof w.focusable>"u"),C=typeof f<"u"&&(w.reconnectable||n&&typeof w.reconnectable>"u"),T=!!(w.selectable||r&&typeof w.selectable>"u"),k=x.useRef(null),[D,B]=x.useState(!1),[j,P]=x.useState(!1),O=Se(),{zIndex:I,sourceX:_,sourceY:F,targetX:N,targetY:z,sourcePosition:V,targetPosition:U}=ge(x.useCallback(ne=>{const J=ne.nodeLookup.get(w.source),re=ne.nodeLookup.get(w.target);if(!J||!re)return{zIndex:w.zIndex,...Yu};const le=bb({id:e,sourceNode:J,targetNode:re,sourceHandle:w.sourceHandle||null,targetHandle:w.targetHandle||null,connectionMode:ne.connectionMode,onError:y});return{zIndex:pb({selected:w.selected,zIndex:w.zIndex,sourceNode:J,targetNode:re,elevateOnSelect:ne.elevateEdgesOnSelect}),...le||Yu}},[w.source,w.target,w.sourceHandle,w.targetHandle,w.selected,w.zIndex]),Ne),K=x.useMemo(()=>w.markerStart?`url('#${Ua(w.markerStart,p)}')`:void 0,[w.markerStart,p]),Y=x.useMemo(()=>w.markerEnd?`url('#${Ua(w.markerEnd,p)}')`:void 0,[w.markerEnd,p]);if(w.hidden||_===null||F===null||N===null||z===null)return null;const ee=ne=>{var ce;const{addSelectedEdges:J,unselectNodesAndEdges:re,multiSelectionActive:le}=O.getState();T&&(O.setState({nodesSelectionActive:!1}),w.selected&&le?(re({nodes:[],edges:[w]}),(ce=k.current)==null||ce.blur()):J([e])),o&&o(ne,w)},Z=s?ne=>{s(ne,{...w})}:void 0,q=i?ne=>{i(ne,{...w})}:void 0,W=a?ne=>{a(ne,{...w})}:void 0,te=l?ne=>{l(ne,{...w})}:void 0,se=c?ne=>{c(ne,{...w})}:void 0,oe=ne=>{var J;if(!A&&$f.includes(ne.key)&&T){const{unselectNodesAndEdges:re,addSelectedEdges:le}=O.getState();ne.key==="Escape"?((J=k.current)==null||J.blur(),re({edges:[w]})):le([e])}};return S.jsx("svg",{style:{zIndex:I},children:S.jsxs("g",{className:ke(["react-flow__edge",`react-flow__edge-${R}`,w.className,g,{selected:w.selected,animated:w.animated,inactive:!T&&!o,updating:D,selectable:T}]),onClick:ee,onDoubleClick:Z,onContextMenu:q,onMouseEnter:W,onMouseMove:te,onMouseLeave:se,onKeyDown:v?oe:void 0,tabIndex:v?0:void 0,role:v?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":w.ariaLabel===null?void 0:w.ariaLabel||`Edge from ${w.source} to ${w.target}`,"aria-describedby":v?`${Eh}-${p}`:void 0,ref:k,children:[!j&&S.jsx(b,{id:e,source:w.source,target:w.target,type:w.type,selected:w.selected,animated:w.animated,selectable:T,deletable:w.deletable??!0,label:w.label,labelStyle:w.labelStyle,labelShowBg:w.labelShowBg,labelBgStyle:w.labelBgStyle,labelBgPadding:w.labelBgPadding,labelBgBorderRadius:w.labelBgBorderRadius,sourceX:_,sourceY:F,targetX:N,targetY:z,sourcePosition:V,targetPosition:U,data:w.data,style:w.style,sourceHandleId:w.sourceHandle,targetHandleId:w.targetHandle,markerStart:K,markerEnd:Y,pathOptions:"pathOptions"in w?w.pathOptions:void 0,interactionWidth:w.interactionWidth}),C&&S.jsx(PA,{edge:w,isReconnectable:C,reconnectRadius:d,onReconnect:f,onReconnectStart:u,onReconnectEnd:h,sourceX:_,sourceY:F,targetX:N,targetY:z,sourcePosition:V,targetPosition:U,setUpdateHover:B,setReconnecting:P})]})})}const IA=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Wh({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:o,onReconnect:s,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:d,reconnectRadius:f,onEdgeDoubleClick:u,onReconnectStart:h,onReconnectEnd:p,disableKeyboardA11y:m}){const{edgesFocusable:g,edgesReconnectable:y,elementsSelectable:A,onError:w}=ge(IA,Ne),E=pA(t);return S.jsxs("div",{className:"react-flow__edges",children:[S.jsx(xA,{defaultColor:e,rfId:n}),E.map(R=>S.jsx(RA,{id:R,edgesFocusable:g,edgesReconnectable:y,elementsSelectable:A,noPanClassName:o,onReconnect:s,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:d,reconnectRadius:f,onDoubleClick:u,onReconnectStart:h,onReconnectEnd:p,rfId:n,onError:w,edgeTypes:r,disableKeyboardA11y:m},R))]})}Wh.displayName="EdgeRenderer";const NA=x.memo(Wh),TA=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function kA({children:e}){const t=ge(TA);return S.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function _A(e){const t=$e(),n=x.useRef(!1);x.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const DA=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function OA(e){const t=ge(DA),n=Se();return x.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function LA(e){return e.connection.inProgress?{...e.connection,to:jo(e.connection.to,e.transform)}:{...e.connection}}function BA(e){return LA}function FA(e){const t=BA();return ge(t,Ne)}const jA=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function qA({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:o,width:s,height:i,isValid:a,inProgress:l}=ge(jA,Ne);return!(s&&o&&l)?null:S.jsx("svg",{style:e,width:s,height:i,className:"react-flow__connectionline react-flow__container",children:S.jsx("g",{className:ke(["react-flow__connection",Kf(a)]),children:S.jsx(Yh,{style:t,type:n,CustomComponent:r,isValid:a})})})}const Yh=({style:e,type:t=dn.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:o,from:s,fromNode:i,fromHandle:a,fromPosition:l,to:c,toNode:d,toHandle:f,toPosition:u}=FA();if(!o)return;if(n)return S.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:a,fromX:s.x,fromY:s.y,toX:c.x,toY:c.y,fromPosition:l,toPosition:u,connectionStatus:Kf(r),toNode:d,toHandle:f});let h="";const p={sourceX:s.x,sourceY:s.y,sourcePosition:l,targetX:c.x,targetY:c.y,targetPosition:u};switch(t){case dn.Bezier:[h]=ih(p);break;case dn.SimpleBezier:[h]=Lh(p);break;case dn.Step:[h]=Va({...p,borderRadius:0});break;case dn.SmoothStep:[h]=Va(p);break;default:[h]=ch(p)}return S.jsx("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};Yh.displayName="ConnectionLine";const zA={};function Zu(e=zA){x.useRef(e),Se(),x.useEffect(()=>{},[e])}function HA(){Se(),x.useRef(!1),x.useEffect(()=>{},[])}function Xh({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:o,onNodeDoubleClick:s,onEdgeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:d,onSelectionContextMenu:f,onSelectionStart:u,onSelectionEnd:h,connectionLineType:p,connectionLineStyle:m,connectionLineComponent:g,connectionLineContainerStyle:y,selectionKeyCode:A,selectionOnDrag:w,selectionMode:E,multiSelectionKeyCode:R,panActivationKeyCode:b,zoomActivationKeyCode:v,deleteKeyCode:C,onlyRenderVisibleElements:T,elementsSelectable:k,defaultViewport:D,translateExtent:B,minZoom:j,maxZoom:P,preventScrolling:O,defaultMarkerColor:I,zoomOnScroll:_,zoomOnPinch:F,panOnScroll:N,panOnScrollSpeed:z,panOnScrollMode:V,zoomOnDoubleClick:U,panOnDrag:K,onPaneClick:Y,onPaneMouseEnter:ee,onPaneMouseMove:Z,onPaneMouseLeave:q,onPaneScroll:W,onPaneContextMenu:te,paneClickDistance:se,nodeClickDistance:oe,onEdgeContextMenu:ne,onEdgeMouseEnter:J,onEdgeMouseMove:re,onEdgeMouseLeave:le,reconnectRadius:ce,onReconnect:me,onReconnectStart:de,onReconnectEnd:be,noDragClassName:ze,noWheelClassName:Xe,noPanClassName:lt,disableKeyboardA11y:wt,nodeExtent:Pn,rfId:xt,viewport:Le,onViewportChange:Qe}){return Zu(e),Zu(t),HA(),_A(n),OA(Le),S.jsx(sA,{onPaneClick:Y,onPaneMouseEnter:ee,onPaneMouseMove:Z,onPaneMouseLeave:q,onPaneContextMenu:te,onPaneScroll:W,paneClickDistance:se,deleteKeyCode:C,selectionKeyCode:A,selectionOnDrag:w,selectionMode:E,onSelectionStart:u,onSelectionEnd:h,multiSelectionKeyCode:R,panActivationKeyCode:b,zoomActivationKeyCode:v,elementsSelectable:k,zoomOnScroll:_,zoomOnPinch:F,zoomOnDoubleClick:U,panOnScroll:N,panOnScrollSpeed:z,panOnScrollMode:V,panOnDrag:K,defaultViewport:D,translateExtent:B,minZoom:j,maxZoom:P,onSelectionContextMenu:f,preventScrolling:O,noDragClassName:ze,noWheelClassName:Xe,noPanClassName:lt,disableKeyboardA11y:wt,onViewportChange:Qe,isControlledViewport:!!Le,children:S.jsxs(kA,{children:[S.jsx(NA,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:i,onReconnect:me,onReconnectStart:de,onReconnectEnd:be,onlyRenderVisibleElements:T,onEdgeContextMenu:ne,onEdgeMouseEnter:J,onEdgeMouseMove:re,onEdgeMouseLeave:le,reconnectRadius:ce,defaultMarkerColor:I,noPanClassName:lt,disableKeyboardA11y:wt,rfId:xt}),S.jsx(qA,{style:m,type:p,component:g,containerStyle:y}),S.jsx("div",{className:"react-flow__edgelabel-renderer"}),S.jsx(hA,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:d,nodeClickDistance:oe,onlyRenderVisibleElements:T,noPanClassName:lt,noDragClassName:ze,disableKeyboardA11y:wt,nodeExtent:Pn,rfId:xt}),S.jsx("div",{className:"react-flow__viewport-portal"})]})})}Xh.displayName="GraphView";const VA=x.memo(Xh),Ju=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:l=.5,maxZoom:c=2,nodeOrigin:d,nodeExtent:f}={})=>{const u=new Map,h=new Map,p=new Map,m=new Map,g=r??t??[],y=n??e??[],A=d??[0,0],w=f??vo;dh(p,m,g);const E=$a(y,u,h,{nodeOrigin:A,nodeExtent:w,elevateNodesOnSelect:!1});let R=[0,0,1];if(i&&o&&s){const b=Fo(u,{filter:k=>!!((k.width||k.initialWidth)&&(k.height||k.initialHeight))}),{x:v,y:C,zoom:T}=Fl(b,o,s,l,c,(a==null?void 0:a.padding)??.1);R=[v,C,T]}return{rfId:"1",width:0,height:0,transform:R,nodes:y,nodesInitialized:E,nodeLookup:u,parentLookup:h,edges:g,edgeLookup:m,connectionLookup:p,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:l,maxZoom:c,translateExtent:vo,nodeExtent:w,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Pr.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:A,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Gf},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:cb,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},UA=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:l,maxZoom:c,nodeOrigin:d,nodeExtent:f})=>c1((u,h)=>{async function p(){const{nodeLookup:m,panZoom:g,fitViewOptions:y,fitViewResolver:A,width:w,height:E,minZoom:R,maxZoom:b}=h();g&&(await ab({nodes:m,width:w,height:E,panZoom:g,minZoom:R,maxZoom:b},y),A==null||A.resolve(!0),u({fitViewResolver:null}))}return{...Ju({nodes:e,edges:t,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:l,maxZoom:c,nodeOrigin:d,nodeExtent:f,defaultNodes:n,defaultEdges:r}),setNodes:m=>{const{nodeLookup:g,parentLookup:y,nodeOrigin:A,elevateNodesOnSelect:w,fitViewQueued:E}=h(),R=$a(m,g,y,{nodeOrigin:A,nodeExtent:f,elevateNodesOnSelect:w,checkEquality:!0});E&&R?(p(),u({nodes:m,nodesInitialized:R,fitViewQueued:!1,fitViewOptions:void 0})):u({nodes:m,nodesInitialized:R})},setEdges:m=>{const{connectionLookup:g,edgeLookup:y}=h();dh(g,y,m),u({edges:m})},setDefaultNodesAndEdges:(m,g)=>{if(m){const{setNodes:y}=h();y(m),u({hasDefaultNodes:!0})}if(g){const{setEdges:y}=h();y(g),u({hasDefaultEdges:!0})}},updateNodeInternals:m=>{const{triggerNodeChanges:g,nodeLookup:y,parentLookup:A,domNode:w,nodeOrigin:E,nodeExtent:R,debug:b,fitViewQueued:v}=h(),{changes:C,updatedInternals:T}=Pb(m,y,A,w,E,R);T&&(Sb(y,A,{nodeOrigin:E,nodeExtent:R}),v?(p(),u({fitViewQueued:!1,fitViewOptions:void 0})):u({}),(C==null?void 0:C.length)>0&&(b&&console.log("React Flow: trigger node changes",C),g==null||g(C)))},updateNodePositions:(m,g=!1)=>{const y=[],A=[],{nodeLookup:w,triggerNodeChanges:E}=h();for(const[R,b]of m){const v=w.get(R),C=!!(v!=null&&v.expandParent&&(v!=null&&v.parentId)&&(b!=null&&b.position)),T={id:R,type:"position",position:C?{x:Math.max(0,b.position.x),y:Math.max(0,b.position.y)}:b.position,dragging:g};C&&v.parentId&&y.push({id:R,parentId:v.parentId,rect:{...b.internals.positionAbsolute,width:b.measured.width??0,height:b.measured.height??0}}),A.push(T)}if(y.length>0){const{parentLookup:R,nodeOrigin:b}=h(),v=Vl(y,w,R,b);A.push(...v)}E(A)},triggerNodeChanges:m=>{const{onNodesChange:g,setNodes:y,nodes:A,hasDefaultNodes:w,debug:E}=h();if(m!=null&&m.length){if(w){const R=Ch(m,A);y(R)}E&&console.log("React Flow: trigger node changes",m),g==null||g(m)}},triggerEdgeChanges:m=>{const{onEdgesChange:g,setEdges:y,edges:A,hasDefaultEdges:w,debug:E}=h();if(m!=null&&m.length){if(w){const R=Ph(m,A);y(R)}E&&console.log("React Flow: trigger edge changes",m),g==null||g(m)}},addSelectedNodes:m=>{const{multiSelectionActive:g,edgeLookup:y,nodeLookup:A,triggerNodeChanges:w,triggerEdgeChanges:E}=h();if(g){const R=m.map(b=>Tn(b,!0));w(R);return}w(mr(A,new Set([...m]),!0)),E(mr(y))},addSelectedEdges:m=>{const{multiSelectionActive:g,edgeLookup:y,nodeLookup:A,triggerNodeChanges:w,triggerEdgeChanges:E}=h();if(g){const R=m.map(b=>Tn(b,!0));E(R);return}E(mr(y,new Set([...m]))),w(mr(A,new Set,!0))},unselectNodesAndEdges:({nodes:m,edges:g}={})=>{const{edges:y,nodes:A,nodeLookup:w,triggerNodeChanges:E,triggerEdgeChanges:R}=h(),b=m||A,v=g||y,C=b.map(k=>{const D=w.get(k.id);return D&&(D.selected=!1),Tn(k.id,!1)}),T=v.map(k=>Tn(k.id,!1));E(C),R(T)},setMinZoom:m=>{const{panZoom:g,maxZoom:y}=h();g==null||g.setScaleExtent([m,y]),u({minZoom:m})},setMaxZoom:m=>{const{panZoom:g,minZoom:y}=h();g==null||g.setScaleExtent([y,m]),u({maxZoom:m})},setTranslateExtent:m=>{var g;(g=h().panZoom)==null||g.setTranslateExtent(m),u({translateExtent:m})},setPaneClickDistance:m=>{var g;(g=h().panZoom)==null||g.setClickDistance(m)},resetSelectedElements:()=>{const{edges:m,nodes:g,triggerNodeChanges:y,triggerEdgeChanges:A,elementsSelectable:w}=h();if(!w)return;const E=g.reduce((b,v)=>v.selected?[...b,Tn(v.id,!1)]:b,[]),R=m.reduce((b,v)=>v.selected?[...b,Tn(v.id,!1)]:b,[]);y(E),A(R)},setNodeExtent:m=>{const{nodes:g,nodeLookup:y,parentLookup:A,nodeOrigin:w,elevateNodesOnSelect:E,nodeExtent:R}=h();m[0][0]===R[0][0]&&m[0][1]===R[0][1]&&m[1][0]===R[1][0]&&m[1][1]===R[1][1]||($a(g,y,A,{nodeOrigin:w,nodeExtent:m,elevateNodesOnSelect:E,checkEquality:!1}),u({nodeExtent:m}))},panBy:m=>{const{transform:g,width:y,height:A,panZoom:w,translateExtent:E}=h();return Rb({delta:m,panZoom:w,transform:g,translateExtent:E,width:y,height:A})},cancelConnection:()=>{u({connection:{...Gf}})},updateConnection:m=>{u({connection:m})},reset:()=>u({...Ju()})}},Object.is);function Qh({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:o,initialHeight:s,initialMinZoom:i,initialMaxZoom:a,initialFitViewOptions:l,fitView:c,nodeOrigin:d,nodeExtent:f,children:u}){const[h]=x.useState(()=>UA({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:c,minZoom:i,maxZoom:a,fitViewOptions:l,nodeOrigin:d,nodeExtent:f}));return S.jsx(u1,{value:h,children:S.jsx(_1,{children:u})})}function $A({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:s,height:i,fitView:a,fitViewOptions:l,minZoom:c,maxZoom:d,nodeOrigin:f,nodeExtent:u}){return x.useContext(Si)?S.jsx(S.Fragment,{children:e}):S.jsx(Qh,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:o,initialWidth:s,initialHeight:i,fitView:a,initialFitViewOptions:l,initialMinZoom:c,initialMaxZoom:d,nodeOrigin:f,nodeExtent:u,children:e})}const GA={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function KA({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:s,edgeTypes:i,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:d,onMoveStart:f,onMoveEnd:u,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:g,onClickConnectEnd:y,onNodeMouseEnter:A,onNodeMouseMove:w,onNodeMouseLeave:E,onNodeContextMenu:R,onNodeDoubleClick:b,onNodeDragStart:v,onNodeDrag:C,onNodeDragStop:T,onNodesDelete:k,onEdgesDelete:D,onDelete:B,onSelectionChange:j,onSelectionDragStart:P,onSelectionDrag:O,onSelectionDragStop:I,onSelectionContextMenu:_,onSelectionStart:F,onSelectionEnd:N,onBeforeDelete:z,connectionMode:V,connectionLineType:U=dn.Bezier,connectionLineStyle:K,connectionLineComponent:Y,connectionLineContainerStyle:ee,deleteKeyCode:Z="Backspace",selectionKeyCode:q="Shift",selectionOnDrag:W=!1,selectionMode:te=bo.Full,panActivationKeyCode:se="Space",multiSelectionKeyCode:oe=Vs()?"Meta":"Control",zoomActivationKeyCode:ne=Vs()?"Meta":"Control",snapToGrid:J,snapGrid:re,onlyRenderVisibleElements:le=!1,selectNodesOnDrag:ce,nodesDraggable:me,nodesConnectable:de,nodesFocusable:be,nodeOrigin:ze=Sh,edgesFocusable:Xe,edgesReconnectable:lt,elementsSelectable:wt=!0,defaultViewport:Pn=E1,minZoom:xt=.5,maxZoom:Le=2,translateExtent:Qe=vo,preventScrolling:nr=!0,nodeExtent:Be,defaultMarkerColor:Rn="#b1b1b7",zoomOnScroll:vt=!0,zoomOnPinch:rr=!0,panOnScroll:$i=!1,panOnScrollSpeed:Gi=.5,panOnScrollMode:Wo=Bn.Free,zoomOnDoubleClick:Ki=!0,panOnDrag:Wi=!0,onPaneClick:Ve,onPaneMouseEnter:Hr,onPaneMouseMove:or,onPaneMouseLeave:Yo,onPaneScroll:Xo,onPaneContextMenu:Yi,paneClickDistance:Vr=0,nodeClickDistance:Qo=0,children:L,onReconnect:G,onReconnectStart:Q,onReconnectEnd:ie,onEdgeContextMenu:fe,onEdgeDoubleClick:Ae,onEdgeMouseEnter:Oe,onEdgeMouseMove:Pe,onEdgeMouseLeave:bt,reconnectRadius:ct=10,onNodesChange:At,onEdgesChange:d0,noDragClassName:f0="nodrag",noWheelClassName:h0="nowheel",noPanClassName:_c="nopan",fitView:Dc,fitViewOptions:Oc,connectOnClick:p0,attributionPosition:g0,proOptions:m0,defaultEdgeOptions:y0,elevateNodesOnSelect:w0,elevateEdgesOnSelect:x0,disableKeyboardA11y:Lc=!1,autoPanOnConnect:v0,autoPanOnNodeDrag:b0,autoPanSpeed:A0,connectionRadius:E0,isValidConnection:S0,onError:M0,style:C0,id:Bc,nodeDragThreshold:P0,viewport:R0,onViewportChange:I0,width:N0,height:T0,colorMode:k0="light",debug:_0,onScroll:Zo,...D0},O0){const Xi=Bc||"1",L0=P1(k0),B0=x.useCallback(Fc=>{Fc.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Zo==null||Zo(Fc)},[Zo]);return S.jsx("div",{"data-testid":"rf__wrapper",...D0,onScroll:B0,style:{...C0,...GA},ref:O0,className:ke(["react-flow",o,L0]),id:Bc,children:S.jsxs($A,{nodes:e,edges:t,width:N0,height:T0,fitView:Dc,fitViewOptions:Oc,minZoom:xt,maxZoom:Le,nodeOrigin:ze,nodeExtent:Be,children:[S.jsx(VA,{onInit:c,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:A,onNodeMouseMove:w,onNodeMouseLeave:E,onNodeContextMenu:R,onNodeDoubleClick:b,nodeTypes:s,edgeTypes:i,connectionLineType:U,connectionLineStyle:K,connectionLineComponent:Y,connectionLineContainerStyle:ee,selectionKeyCode:q,selectionOnDrag:W,selectionMode:te,deleteKeyCode:Z,multiSelectionKeyCode:oe,panActivationKeyCode:se,zoomActivationKeyCode:ne,onlyRenderVisibleElements:le,defaultViewport:Pn,translateExtent:Qe,minZoom:xt,maxZoom:Le,preventScrolling:nr,zoomOnScroll:vt,zoomOnPinch:rr,zoomOnDoubleClick:Ki,panOnScroll:$i,panOnScrollSpeed:Gi,panOnScrollMode:Wo,panOnDrag:Wi,onPaneClick:Ve,onPaneMouseEnter:Hr,onPaneMouseMove:or,onPaneMouseLeave:Yo,onPaneScroll:Xo,onPaneContextMenu:Yi,paneClickDistance:Vr,nodeClickDistance:Qo,onSelectionContextMenu:_,onSelectionStart:F,onSelectionEnd:N,onReconnect:G,onReconnectStart:Q,onReconnectEnd:ie,onEdgeContextMenu:fe,onEdgeDoubleClick:Ae,onEdgeMouseEnter:Oe,onEdgeMouseMove:Pe,onEdgeMouseLeave:bt,reconnectRadius:ct,defaultMarkerColor:Rn,noDragClassName:f0,noWheelClassName:h0,noPanClassName:_c,rfId:Xi,disableKeyboardA11y:Lc,nodeExtent:Be,viewport:R0,onViewportChange:I0}),S.jsx(C1,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:g,onClickConnectEnd:y,nodesDraggable:me,nodesConnectable:de,nodesFocusable:be,edgesFocusable:Xe,edgesReconnectable:lt,elementsSelectable:wt,elevateNodesOnSelect:w0,elevateEdgesOnSelect:x0,minZoom:xt,maxZoom:Le,nodeExtent:Be,onNodesChange:At,onEdgesChange:d0,snapToGrid:J,snapGrid:re,connectionMode:V,translateExtent:Qe,connectOnClick:p0,defaultEdgeOptions:y0,fitView:Dc,fitViewOptions:Oc,onNodesDelete:k,onEdgesDelete:D,onDelete:B,onNodeDragStart:v,onNodeDrag:C,onNodeDragStop:T,onSelectionDrag:O,onSelectionDragStart:P,onSelectionDragStop:I,onMove:d,onMoveStart:f,onMoveEnd:u,noPanClassName:_c,nodeOrigin:ze,rfId:Xi,autoPanOnConnect:v0,autoPanOnNodeDrag:b0,autoPanSpeed:A0,onError:M0,connectionRadius:E0,isValidConnection:S0,selectNodesOnDrag:ce,nodeDragThreshold:P0,onBeforeDelete:z,paneClickDistance:Vr,debug:_0}),S.jsx(A1,{onSelectionChange:j}),L,S.jsx(y1,{proOptions:m0,position:g0}),S.jsx(g1,{rfId:Xi,disableKeyboardA11y:Lc})]})})}var WA=Rh(KA);const YA=Nt.error014();function Mo({id:e,handleType:t,handleId:n,onConnect:r,onDisconnect:o}={}){const s=$l(),i=e??s;if(!i)throw new Error(YA);const a=x.useRef(null),l=ge(c=>c.connectionLookup.get(`${i}${t?n?`-${t}-${n}`:`-${t}`:""}`),nb);return x.useEffect(()=>{if(a.current&&a.current!==l){const c=l??new Map;fu(a.current,c,o),fu(c,a.current,r)}a.current=l??new Map},[l,r,o]),x.useMemo(()=>Array.from((l==null?void 0:l.values())??[]),[l])}function XA({dimensions:e,lineWidth:t,variant:n,className:r}){return S.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ke(["react-flow__background-pattern",n,r])})}function QA({radius:e,className:t}){return S.jsx("circle",{cx:e,cy:e,r:e,className:ke(["react-flow__background-pattern","dots",t])})}var hn;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(hn||(hn={}));const ZA={[hn.Dots]:1,[hn.Lines]:1,[hn.Cross]:6},JA=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Zh({id:e,variant:t=hn.Dots,gap:n=20,size:r,lineWidth:o=1,offset:s=0,color:i,bgColor:a,style:l,className:c,patternClassName:d}){const f=x.useRef(null),{transform:u,patternId:h}=ge(JA,Ne),p=r||ZA[t],m=t===hn.Dots,g=t===hn.Cross,y=Array.isArray(n)?n:[n,n],A=[y[0]*u[2]||1,y[1]*u[2]||1],w=p*u[2],E=Array.isArray(s)?s:[s,s],R=g?[w,w]:A,b=[E[0]*u[2]||1+R[0]/2,E[1]*u[2]||1+R[1]/2],v=`${h}${e||""}`;return S.jsxs("svg",{className:ke(["react-flow__background",c]),style:{...l,...Mi,"--xy-background-color-props":a,"--xy-background-pattern-color-props":i},ref:f,"data-testid":"rf__background",children:[S.jsx("pattern",{id:v,x:u[0]%A[0],y:u[1]%A[1],width:A[0],height:A[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${b[0]},-${b[1]})`,children:m?S.jsx(QA,{radius:w/2,className:d}):S.jsx(XA,{dimensions:R,lineWidth:o,variant:t,className:d})}),S.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${v})`})]})}Zh.displayName="Background";const eE=x.memo(Zh);function tE(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:S.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function nE(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:S.jsx("path",{d:"M0 0h32v4.2H0z"})})}function rE(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:S.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function oE(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:S.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function sE(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:S.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function ls({children:e,className:t,...n}){return S.jsx("button",{type:"button",className:ke(["react-flow__controls-button",t]),...n,children:e})}const iE=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function Jh({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:s,onZoomOut:i,onFitView:a,onInteractiveChange:l,className:c,children:d,position:f="bottom-left",orientation:u="vertical","aria-label":h="React Flow controls"}){const p=Se(),{isInteractive:m,minZoomReached:g,maxZoomReached:y}=ge(iE,Ne),{zoomIn:A,zoomOut:w,fitView:E}=$e(),R=()=>{A(),s==null||s()},b=()=>{w(),i==null||i()},v=()=>{E(o),a==null||a()},C=()=>{p.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),l==null||l(!m)},T=u==="horizontal"?"horizontal":"vertical";return S.jsxs(rn,{className:ke(["react-flow__controls",T,c]),position:f,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&S.jsxs(S.Fragment,{children:[S.jsx(ls,{onClick:R,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:y,children:S.jsx(tE,{})}),S.jsx(ls,{onClick:b,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:g,children:S.jsx(nE,{})})]}),n&&S.jsx(ls,{className:"react-flow__controls-fitview",onClick:v,title:"fit view","aria-label":"fit view",children:S.jsx(rE,{})}),r&&S.jsx(ls,{className:"react-flow__controls-interactive",onClick:C,title:"toggle interactivity","aria-label":"toggle interactivity",children:m?S.jsx(sE,{}):S.jsx(oE,{})}),d]})}Jh.displayName="Controls";x.memo(Jh);function aE({id:e,x:t,y:n,width:r,height:o,style:s,color:i,strokeColor:a,strokeWidth:l,className:c,borderRadius:d,shapeRendering:f,selected:u,onClick:h}){const{background:p,backgroundColor:m}=s||{},g=i||p||m;return S.jsx("rect",{className:ke(["react-flow__minimap-node",{selected:u},c]),x:t,y:n,rx:d,ry:d,width:r,height:o,style:{fill:g,stroke:a,strokeWidth:l},shapeRendering:f,onClick:h?y=>h(y,e):void 0})}const lE=x.memo(aE),cE=e=>e.nodes.map(t=>t.id),pa=e=>e instanceof Function?e:()=>e;function uE({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o,nodeComponent:s=lE,onClick:i}){const a=ge(cE,Ne),l=pa(t),c=pa(e),d=pa(n),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return S.jsx(S.Fragment,{children:a.map(u=>S.jsx(fE,{id:u,nodeColorFunc:l,nodeStrokeColorFunc:c,nodeClassNameFunc:d,nodeBorderRadius:r,nodeStrokeWidth:o,NodeComponent:s,onClick:i,shapeRendering:f},u))})}function dE({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:o,nodeStrokeWidth:s,shapeRendering:i,NodeComponent:a,onClick:l}){const{node:c,x:d,y:f,width:u,height:h}=ge(p=>{const{internals:m}=p.nodeLookup.get(e),g=m.userNode,{x:y,y:A}=m.positionAbsolute,{width:w,height:E}=nn(g);return{node:g,x:y,y:A,width:w,height:E}},Ne);return!c||c.hidden||!eh(c)?null:S.jsx(a,{x:d,y:f,width:u,height:h,style:c.style,selected:!!c.selected,className:r(c),color:t(c),borderRadius:o,strokeColor:n(c),strokeWidth:s,shapeRendering:i,onClick:l,id:c.id})}const fE=x.memo(dE);var hE=x.memo(uE);const pE=200,gE=150,mE=e=>!e.hidden,yE=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Jf(Fo(e.nodeLookup,{filter:mE}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},wE="react-flow__minimap-desc";function ep({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:o="",nodeBorderRadius:s=5,nodeStrokeWidth:i,nodeComponent:a,bgColor:l,maskColor:c,maskStrokeColor:d,maskStrokeWidth:f,position:u="bottom-right",onClick:h,onNodeClick:p,pannable:m=!1,zoomable:g=!1,ariaLabel:y="React Flow mini map",inversePan:A,zoomStep:w=10,offsetScale:E=5}){const R=Se(),b=x.useRef(null),{boundingRect:v,viewBB:C,rfId:T,panZoom:k,translateExtent:D,flowWidth:B,flowHeight:j}=ge(yE,Ne),P=(e==null?void 0:e.width)??pE,O=(e==null?void 0:e.height)??gE,I=v.width/P,_=v.height/O,F=Math.max(I,_),N=F*P,z=F*O,V=E*F,U=v.x-(N-v.width)/2-V,K=v.y-(z-v.height)/2-V,Y=N+V*2,ee=z+V*2,Z=`${wE}-${T}`,q=x.useRef(0),W=x.useRef();q.current=F,x.useEffect(()=>{if(b.current&&k)return W.current=Lb({domNode:b.current,panZoom:k,getTransform:()=>R.getState().transform,getViewScale:()=>q.current}),()=>{var oe;(oe=W.current)==null||oe.destroy()}},[k]),x.useEffect(()=>{var oe;(oe=W.current)==null||oe.update({translateExtent:D,width:B,height:j,inversePan:A,pannable:m,zoomStep:w,zoomable:g})},[m,g,A,w,D,B,j]);const te=h?oe=>{var re;const[ne,J]=((re=W.current)==null?void 0:re.pointer(oe))||[0,0];h(oe,{x:ne,y:J})}:void 0,se=p?x.useCallback((oe,ne)=>{const J=R.getState().nodeLookup.get(ne).internals.userNode;p(oe,J)},[]):void 0;return S.jsx(rn,{position:u,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof f=="number"?f*F:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:ke(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:S.jsxs("svg",{width:P,height:O,viewBox:`${U} ${K} ${Y} ${ee}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Z,ref:b,onClick:te,children:[y&&S.jsx("title",{id:Z,children:y}),S.jsx(hE,{onClick:se,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:o,nodeStrokeWidth:i,nodeComponent:a}),S.jsx("path",{className:"react-flow__minimap-mask",d:`M${U-V},${K-V}h${Y+V*2}v${ee+V*2}h${-Y-V*2}z
        M${C.x},${C.y}h${C.width}v${C.height}h${-C.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}ep.displayName="MiniMap";x.memo(ep);function xE({nodeId:e,position:t,variant:n=ao.Handle,className:r,style:o={},children:s,color:i,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:f=!1,resizeDirection:u,shouldResize:h,onResizeStart:p,onResize:m,onResizeEnd:g}){const y=$l(),A=typeof e=="string"?e:y,w=Se(),E=x.useRef(null),R=n===ao.Line?"right":"bottom-right",b=t??R,v=x.useRef(null);x.useEffect(()=>{if(!(!E.current||!A))return v.current||(v.current=Qb({domNode:E.current,nodeId:A,getStoreItems:()=>{const{nodeLookup:D,transform:B,snapGrid:j,snapToGrid:P,nodeOrigin:O,domNode:I}=w.getState();return{nodeLookup:D,transform:B,snapGrid:j,snapToGrid:P,nodeOrigin:O,paneDomNode:I}},onChange:(D,B)=>{const{triggerNodeChanges:j,nodeLookup:P,parentLookup:O,nodeOrigin:I}=w.getState(),_=[],F={x:D.x,y:D.y},N=P.get(A);if(N&&N.expandParent&&N.parentId){const z=N.origin??I,V=D.width??N.measured.width??0,U=D.height??N.measured.height??0,K={id:N.id,parentId:N.parentId,rect:{width:V,height:U,...th({x:D.x??N.position.x,y:D.y??N.position.y},{width:V,height:U},N.parentId,P,z)}},Y=Vl([K],P,O,I);_.push(...Y),F.x=D.x?Math.max(z[0]*V,D.x):void 0,F.y=D.y?Math.max(z[1]*U,D.y):void 0}if(F.x!==void 0&&F.y!==void 0){const z={id:A,type:"position",position:{...F}};_.push(z)}if(D.width!==void 0&&D.height!==void 0){const V={id:A,type:"dimensions",resizing:!0,setAttributes:u?u==="horizontal"?"width":"height":!0,dimensions:{width:D.width,height:D.height}};_.push(V)}for(const z of B){const V={...z,type:"position"};_.push(V)}j(_)},onEnd:({width:D,height:B})=>{const j={id:A,type:"dimensions",resizing:!1,dimensions:{width:D,height:B}};w.getState().triggerNodeChanges([j])}})),v.current.update({controlPosition:b,boundaries:{minWidth:a,minHeight:l,maxWidth:c,maxHeight:d},keepAspectRatio:f,resizeDirection:u,onResizeStart:p,onResize:m,onResizeEnd:g,shouldResize:h}),()=>{var D;(D=v.current)==null||D.destroy()}},[b,a,l,c,d,f,p,m,g,h]);const C=b.split("-"),T=n===ao.Line?"borderColor":"backgroundColor",k=i?{...o,[T]:i}:o;return S.jsx("div",{className:ke(["react-flow__resize-control","nodrag",...C,n,r]),ref:E,style:k,children:s})}x.memo(xE);const ed=e=>{let t;const n=new Set,r=(c,d)=>{const f=typeof c=="function"?c(t):c;if(!Object.is(f,t)){const u=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(h=>h(t,u))}},o=()=>t,a={setState:r,getState:o,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=t=e(r,o,a);return a},vE=e=>e?ed(e):ed,bE=e=>e;function AE(e,t=bE){const n=St.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return St.useDebugValue(n),n}const td=e=>{const t=vE(e),n=r=>AE(t,r);return Object.assign(n,t),n},qo=e=>e?td(e):td;class EE{constructor(t,n){H(this,"inputs",new Map);H(this,"outputs",new Map);H(this,"results",new Map);H(this,"mark",null);H(this,"nodeId");H(this,"compute");this.nodeId=t,this.updateData(n)}updateData(t){Object.entries(t).forEach(([n,r])=>{n==="compute"&&(this.compute=r)})}getResult(t){return this.results.get(t)}}const yr=qo(e=>({nodeMap:new Map,sortedNodes:[],mapErrors:{cycle:!1},replaceNode:t=>{e(n=>{var r;return n.nodeMap.has(t.id)?(r=n.nodeMap.get(t.id))==null||r.updateData(t.data):n.nodeMap.set(t.id,new EE(t.id,t.data)),n})},removeNode:t=>{e(n=>(n.nodeMap.delete(t),n))},addEdge:t=>{e(n=>{const r=n.nodeMap.get(t.source),o=n.nodeMap.get(t.target);if(r&&o&&t.targetHandle&&t.sourceHandle){let s=null;"id"in t?s=t.id:s=ME(t),r.outputs.set(s,{targetNode:o,targetHandleId:t.targetHandle,sourceHandleId:t.sourceHandle}),o.inputs.set(t.targetHandle,{sourceNode:r,sourceHandleId:t.sourceHandle,edgeId:s})}return{...n,sortedNodes:nd(n.mapErrors,n.nodeMap)}})},removeEdge:t=>{e(n=>{const{edgeSource:r,edgeTarget:o}=SE(t),s=n.nodeMap.get(r),i=n.nodeMap.get(o);return s==null||s.outputs.delete(t),i&&Array.from(i.inputs).some(([a,l])=>l.edgeId===t&&i.inputs.delete(a)),{...n,sortedNodes:nd(n.mapErrors,n.nodeMap)}})},compute:()=>{e(t=>(CE(t.mapErrors,t.sortedNodes),t))},debugPrint:()=>{e(t=>(console.log(t.mapErrors.cycle),t.nodeMap.forEach(n=>{console.log(n)}),t))}}));function SE(e){const t=/^xy-edge__([0-9a-fA-F-]{36})(.*?)-([0-9a-fA-F-]{36})(.*)$/,n=e.match(t);if(!n)throw new Error("String does not match expected format");return{edgeSource:n[1],edgeSourceHandle:n[2],edgeTarget:n[3],edgeTargetHandle:n[4]}}function ME(e){return"xy-edge__"+e.source+e.sourceHandle+"-"+e.target+e.targetHandle}function CE(e,t){if(e.cycle){console.log("Cannot compute because of cycle");return}t.forEach(([n,r])=>{if(!r.compute)throw new Error("Compute is not defined");r.compute(r.inputs,r.results)})}function nd(e,t){e.cycle=!1,t.forEach(r=>{r.mark=null});let n=new Map;return t.forEach(r=>{r.mark||tp(r,n,e)}),e.cycle?[]:Array.from(n).reverse()}function tp(e,t,n){if(e.mark!=1){if(e.mark==0){console.log("Found cycle"),n.cycle=!0;return}e.mark=0,e.outputs.forEach(({targetNode:r})=>{tp(r,t,n)}),e.mark=1,t.set(e.nodeId,e)}}const $s=qo(e=>({isKeyDown:()=>!1,setKeyDownFunction:t=>e({isKeyDown:t}),isKeyPressed:()=>!1,setKeyPressedFunction:t=>e({isKeyPressed:t})})),Gs=qo(e=>({time:0,deltaTime:0,setTime:t=>(t=Math.round(t*1e3)/1e3,e({time:t})),setDeltaTime:t=>e({deltaTime:t})}));var PE=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:t*4-205]=t;return n=>{for(var r=n.length,o=new Uint8Array((r-(n[r-1]=="=")-(n[r-2]=="="))*3/4|0),s=0,i=0;s<r;){var a=e[n.charCodeAt(s++)],l=e[n.charCodeAt(s++)],c=e[n.charCodeAt(s++)],d=e[n.charCodeAt(s++)];o[i++]=a<<2|l>>4,o[i++]=l<<4|c>>2,o[i++]=c<<6|d}return o}})(),RE={version:"3001.0.16"};function Ft(e,t,n){return t>n?Ft(e,n,t):Math.min(Math.max(e,t),n)}var ye,pe=(ye=class{constructor(t,n,r){H(this,"r",255);H(this,"g",255);H(this,"b",255);this.r=Ft(t,0,255),this.g=Ft(n,0,255),this.b=Ft(r,0,255)}static fromArray(t){return new ye(t[0],t[1],t[2])}static fromHex(t){if(typeof t=="number")return new ye(t>>16&255,t>>8&255,t>>0&255);if(typeof t=="string"){let n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(!n)throw new Error("Invalid hex color format");return new ye(parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16))}else throw new Error("Invalid hex color format")}static fromHSL(t,n,r){if(n==0)return new ye(255*r,255*r,255*r);let o=(d,f,u)=>(u<0&&(u+=1),u>1&&(u-=1),u<1/6?d+(f-d)*6*u:u<1/2?f:u<2/3?d+(f-d)*(2/3-u)*6:d),s=r<.5?r*(1+n):r+n-r*n,i=2*r-s,a=o(i,s,t+1/3),l=o(i,s,t),c=o(i,s,t-1/3);return new ye(Math.round(a*255),Math.round(l*255),Math.round(c*255))}clone(){return new ye(this.r,this.g,this.b)}lighten(t){return new ye(this.r+t,this.g+t,this.b+t)}darken(t){return this.lighten(-t)}invert(){return new ye(255-this.r,255-this.g,255-this.b)}mult(t){return new ye(this.r*t.r/255,this.g*t.g/255,this.b*t.b/255)}lerp(t,n){return new ye(nt(this.r,t.r,n),nt(this.g,t.g,n),nt(this.b,t.b,n))}toHSL(){let t=this.r/255,n=this.g/255,r=this.b/255,o=Math.max(t,n,r),s=Math.min(t,n,r),i=(o+s)/2,a=i,l=i;if(o==s)i=a=0;else{let c=o-s;switch(a=l>.5?c/(2-o-s):c/(o+s),o){case t:i=(n-r)/c+(n<r?6:0);break;case n:i=(r-t)/c+2;break;case r:i=(t-n)/c+4;break}i/=6}return[i,a,l]}eq(t){return this.r===t.r&&this.g===t.g&&this.b===t.b}toString(){return`rgb(${this.r}, ${this.g}, ${this.b})`}toHex(){return"#"+((1<<24)+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1)}toArray(){return[this.r,this.g,this.b]}},H(ye,"RED",new ye(255,0,0)),H(ye,"GREEN",new ye(0,255,0)),H(ye,"BLUE",new ye(0,0,255)),H(ye,"YELLOW",new ye(255,255,0)),H(ye,"MAGENTA",new ye(255,0,255)),H(ye,"CYAN",new ye(0,255,255)),H(ye,"WHITE",new ye(255,255,255)),H(ye,"BLACK",new ye(0,0,0)),ye);function we(...e){if(e.length===0)return new pe(255,255,255);if(e.length===1){if(e[0]instanceof pe)return e[0].clone();if(typeof e[0]=="string")return pe.fromHex(e[0]);if(Array.isArray(e[0])&&e[0].length===3)return pe.fromArray(e[0])}else if(e.length===2){if(e[0]instanceof pe)return e[0].clone()}else if(e.length===3||e.length===4)return new pe(e[0],e[1],e[2]);throw new Error("Invalid color arguments")}var IE=(e,t,n)=>pe.fromHSL(e,t,n);function De(e){return e*Math.PI/180}function Vn(e){return e*180/Math.PI}function nt(e,t,n){if(typeof e=="number"&&typeof t=="number")return e+(t-e)*n;if(e instanceof X&&t instanceof X||e instanceof pe&&t instanceof pe)return e.lerp(t,n);throw new Error(`Bad value for lerp(): ${e}, ${t}. Only number, Vec2 and Color is supported.`)}function Lt(e,t,n,r,o){return r+(e-t)/(n-t)*(o-r)}function NE(e,t,n,r,o){return Ft(Lt(e,t,n,r,o),r,o)}var ve,X=(ve=class{constructor(t=0,n=t){H(this,"x",0);H(this,"y",0);this.x=t,this.y=n}static fromAngle(t){let n=De(t);return new ve(Math.cos(n),Math.sin(n))}static fromArray(t){return new ve(t[0],t[1])}clone(){return new ve(this.x,this.y)}add(...t){let n=$(...t);return new ve(this.x+n.x,this.y+n.y)}sub(...t){let n=$(...t);return new ve(this.x-n.x,this.y-n.y)}scale(...t){let n=$(...t);return new ve(this.x*n.x,this.y*n.y)}dist(...t){let n=$(...t);return this.sub(n).len()}sdist(...t){let n=$(...t);return this.sub(n).slen()}static sdist(t,n){let r=t.x-n.x,o=t.y-n.y;return r*r+o*o}len(){return Math.sqrt(this.dot(this))}slen(){return this.dot(this)}unit(){let t=this.len();return t===0?new ve(0):this.scale(1/t)}normal(){return new ve(this.y,-this.x)}reflect(t){return this.sub(t.scale(2*this.dot(t)))}project(t){return t.scale(t.dot(this)/t.len())}reject(t){return this.sub(this.project(t))}dot(t){return this.x*t.x+this.y*t.y}static dot(t,n){return t.x*n.x+t.y*n.y}cross(t){return this.x*t.y-this.y*t.x}static cross(t,n){return t.x*n.y-t.y*n.x}angle(...t){let n=$(...t);return Vn(Math.atan2(this.y-n.y,this.x-n.x))}angleBetween(...t){let n=$(...t);return Vn(Math.atan2(this.cross(n),this.dot(n)))}lerp(t,n){return new ve(nt(this.x,t.x,n),nt(this.y,t.y,n))}slerp(t,n){let r=this.dot(t),o=this.cross(t),s=Math.atan2(o,r);return this.scale(Math.sin((1-n)*s)).add(t.scale(Math.sin(n*s))).scale(1/o)}isZero(){return this.x===0&&this.y===0}toFixed(t){return new ve(Number(this.x.toFixed(t)),Number(this.y.toFixed(t)))}transform(t){return t.multVec2(this)}eq(t){return this.x===t.x&&this.y===t.y}bbox(){return new Ee(this,0,0)}toString(){return`vec2(${this.x.toFixed(2)}, ${this.y.toFixed(2)})`}toArray(){return[this.x,this.y]}},H(ve,"ZERO",new ve(0,0)),H(ve,"ONE",new ve(1,1)),H(ve,"LEFT",new ve(-1,0)),H(ve,"RIGHT",new ve(1,0)),H(ve,"UP",new ve(0,-1)),H(ve,"DOWN",new ve(0,1)),ve);function $(...e){if(e.length===1){if(e[0]instanceof X)return new X(e[0].x,e[0].y);if(Array.isArray(e[0])&&e[0].length===2)return new X(...e[0])}return new X(...e)}var Ie=class Wa{constructor(t,n,r,o){H(this,"x",0);H(this,"y",0);H(this,"w",1);H(this,"h",1);this.x=t,this.y=n,this.w=r,this.h=o}scale(t){return new Wa(this.x+this.w*t.x,this.y+this.h*t.y,this.w*t.w,this.h*t.h)}pos(){return new X(this.x,this.y)}clone(){return new Wa(this.x,this.y,this.w,this.h)}eq(t){return this.x===t.x&&this.y===t.y&&this.w===t.w&&this.h===t.h}toString(){return`quad(${this.x}, ${this.y}, ${this.w}, ${this.h})`}};function _e(e,t,n,r){return new Ie(e,t,n,r)}var Ks=class fr{constructor(t,n,r,o){H(this,"a");H(this,"b");H(this,"c");H(this,"d");this.a=t,this.b=n,this.c=r,this.d=o}mul(t){return new fr(this.a*t.a+this.b*t.c,this.a*t.b+this.b*t.d,this.c*t.a+this.d*t.c,this.c*t.b+this.d*t.d)}transform(t){return $(this.a*t.x+this.b*t.y,this.c*t.x+this.d*t.y)}get inverse(){let t=this.det;return new fr(this.d/t,-this.b/t,-this.c/t,this.a/t)}get transpose(){return new fr(this.a,this.c,this.b,this.d)}get eigenvalues(){let t=this.trace/2,n=this.det,r=t+Math.sqrt(t*t-n),o=t-Math.sqrt(t*t-n);return[r,o]}eigenvectors(t,n){return this.c!=0?[[t-this.d,this.c],[n-this.d,this.c]]:this.b!=0?[[this.b,t-this.a],[this.b,n-this.a]]:Math.abs(this.transform($(1,0)).x-t)<Number.EPSILON?[[1,0],[0,1]]:[[0,1],[1,0]]}get det(){return this.a*this.d-this.b*this.c}get trace(){return this.a+this.d}static rotation(t){let n=Math.cos(t),r=Math.sin(t);return new fr(n,r,-r,n)}static scale(t,n){return new fr(t,0,0,n)}},Zr=class Jr{constructor(t,n,r,o,s,i,a,l,c){H(this,"m11");H(this,"m12");H(this,"m13");H(this,"m21");H(this,"m22");H(this,"m23");H(this,"m31");H(this,"m32");H(this,"m33");this.m11=t,this.m12=n,this.m13=r,this.m21=o,this.m22=s,this.m23=i,this.m31=a,this.m32=l,this.m33=c}static fromMat2(t){return new Jr(t.a,t.b,0,t.c,t.d,0,0,0,1)}toMat2(){return new Ks(this.m11,this.m12,this.m21,this.m22)}mul(t){return new Jr(this.m11*t.m11+this.m12*t.m21+this.m13*t.m31,this.m11*t.m12+this.m12*t.m22+this.m13*t.m32,this.m11*t.m13+this.m12*t.m23+this.m13*t.m33,this.m21*t.m11+this.m22*t.m21+this.m23*t.m31,this.m21*t.m12+this.m22*t.m22+this.m23*t.m32,this.m21*t.m13+this.m22*t.m23+this.m23*t.m33,this.m31*t.m11+this.m32*t.m21+this.m33*t.m31,this.m31*t.m12+this.m32*t.m22+this.m33*t.m32,this.m31*t.m13+this.m32*t.m23+this.m33*t.m33)}get det(){return this.m11*this.m22*this.m33+this.m12*this.m23*this.m31+this.m13*this.m21*this.m32-this.m13*this.m22*this.m31-this.m12*this.m21*this.m33-this.m11*this.m23*this.m32}rotate(t){let n=Math.cos(t),r=Math.sin(t),o=this.m11,s=this.m12;return this.m11=n*this.m11+r*this.m21,this.m12=n*this.m12+r*this.m22,this.m21=n*this.m21-r*o,this.m22=n*this.m22-r*s,this}scale(t,n){return this.m11*=t,this.m12*=t,this.m21*=n,this.m22*=n,this}get inverse(){let t=this.det;return new Jr((this.m22*this.m33-this.m23*this.m32)/t,(this.m13*this.m32-this.m12*this.m33)/t,(this.m12*this.m23-this.m13*this.m22)/t,(this.m23*this.m31-this.m21*this.m33)/t,(this.m11*this.m33-this.m13*this.m31)/t,(this.m13*this.m21-this.m11*this.m23)/t,(this.m21*this.m32-this.m22*this.m31)/t,(this.m12*this.m31-this.m11*this.m32)/t,(this.m11*this.m22-this.m12*this.m21)/t)}get transpose(){return new Jr(this.m11,this.m21,this.m31,this.m12,this.m22,this.m32,this.m13,this.m23,this.m33)}},jt=class Kt{constructor(t){H(this,"m",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);t&&(this.m=t)}static translate(t){return new Kt([1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,0,1])}static scale(t){return new Kt([t.x,0,0,0,0,t.y,0,0,0,0,1,0,0,0,0,1])}static rotateX(t){t=De(-t);let n=Math.cos(t),r=Math.sin(t);return new Kt([1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1])}static rotateY(t){t=De(-t);let n=Math.cos(t),r=Math.sin(t);return new Kt([n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1])}static rotateZ(t){t=De(-t);let n=Math.cos(t),r=Math.sin(t);return new Kt([n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1])}translate(t){return this.m[12]+=this.m[0]*t.x+this.m[4]*t.y,this.m[13]+=this.m[1]*t.x+this.m[5]*t.y,this.m[14]+=this.m[2]*t.x+this.m[6]*t.y,this.m[15]+=this.m[3]*t.x+this.m[7]*t.y,this}scale(t){return this.m[0]*=t.x,this.m[4]*=t.y,this.m[1]*=t.x,this.m[5]*=t.y,this.m[2]*=t.x,this.m[6]*=t.y,this.m[3]*=t.x,this.m[7]*=t.y,this}rotate(t){t=De(-t);let n=Math.cos(t),r=Math.sin(t),o=this.m[0],s=this.m[1],i=this.m[4],a=this.m[5];return this.m[0]=o*n+s*r,this.m[1]=-o*r+s*n,this.m[4]=i*n+a*r,this.m[5]=-i*r+a*n,this}mult(t){let n=[];for(let r=0;r<4;r++)for(let o=0;o<4;o++)n[r*4+o]=this.m[0*4+o]*t.m[r*4+0]+this.m[1*4+o]*t.m[r*4+1]+this.m[2*4+o]*t.m[r*4+2]+this.m[3*4+o]*t.m[r*4+3];return new Kt(n)}multVec2(t){return new X(t.x*this.m[0]+t.y*this.m[4]+this.m[12],t.x*this.m[1]+t.y*this.m[5]+this.m[13])}getTranslation(){return new X(this.m[12],this.m[13])}getScale(){if(this.m[0]!=0||this.m[1]!=0){let t=this.m[0]*this.m[5]-this.m[1]*this.m[4],n=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return new X(n,t/n)}else if(this.m[4]!=0||this.m[5]!=0){let t=this.m[0]*this.m[5]-this.m[1]*this.m[4],n=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]);return new X(t/n,n)}else return new X(0,0)}getRotation(){if(this.m[0]!=0||this.m[1]!=0){let t=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return Vn(this.m[1]>0?Math.acos(this.m[0]/t):-Math.acos(this.m[0]/t))}else if(this.m[4]!=0||this.m[5]!=0){let t=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]);return Vn(Math.PI/2-(this.m[5]>0?Math.acos(-this.m[4]/t):-Math.acos(this.m[4]/t)))}else return 0}getSkew(){if(this.m[0]!=0||this.m[1]!=0){let t=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return new X(Math.atan(this.m[0]*this.m[4]+this.m[1]*this.m[5])/(t*t),0)}else if(this.m[4]!=0||this.m[5]!=0){let t=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]);return new X(0,Math.atan(this.m[0]*this.m[4]+this.m[1]*this.m[5])/(t*t))}else return new X(0,0)}invert(){let t=[],n=this.m[10]*this.m[15]-this.m[14]*this.m[11],r=this.m[9]*this.m[15]-this.m[13]*this.m[11],o=this.m[9]*this.m[14]-this.m[13]*this.m[10],s=this.m[8]*this.m[15]-this.m[12]*this.m[11],i=this.m[8]*this.m[14]-this.m[12]*this.m[10],a=this.m[8]*this.m[13]-this.m[12]*this.m[9],l=this.m[6]*this.m[15]-this.m[14]*this.m[7],c=this.m[5]*this.m[15]-this.m[13]*this.m[7],d=this.m[5]*this.m[14]-this.m[13]*this.m[6],f=this.m[4]*this.m[15]-this.m[12]*this.m[7],u=this.m[4]*this.m[14]-this.m[12]*this.m[6],h=this.m[5]*this.m[15]-this.m[13]*this.m[7],p=this.m[4]*this.m[13]-this.m[12]*this.m[5],m=this.m[6]*this.m[11]-this.m[10]*this.m[7],g=this.m[5]*this.m[11]-this.m[9]*this.m[7],y=this.m[5]*this.m[10]-this.m[9]*this.m[6],A=this.m[4]*this.m[11]-this.m[8]*this.m[7],w=this.m[4]*this.m[10]-this.m[8]*this.m[6],E=this.m[4]*this.m[9]-this.m[8]*this.m[5];t[0]=this.m[5]*n-this.m[6]*r+this.m[7]*o,t[4]=-(this.m[4]*n-this.m[6]*s+this.m[7]*i),t[8]=this.m[4]*r-this.m[5]*s+this.m[7]*a,t[12]=-(this.m[4]*o-this.m[5]*i+this.m[6]*a),t[1]=-(this.m[1]*n-this.m[2]*r+this.m[3]*o),t[5]=this.m[0]*n-this.m[2]*s+this.m[3]*i,t[9]=-(this.m[0]*r-this.m[1]*s+this.m[3]*a),t[13]=this.m[0]*o-this.m[1]*i+this.m[2]*a,t[2]=this.m[1]*l-this.m[2]*c+this.m[3]*d,t[6]=-(this.m[0]*l-this.m[2]*f+this.m[3]*u),t[10]=this.m[0]*h-this.m[1]*f+this.m[3]*p,t[14]=-(this.m[0]*d-this.m[1]*u+this.m[2]*p),t[3]=-(this.m[1]*m-this.m[2]*g+this.m[3]*y),t[7]=this.m[0]*m-this.m[2]*A+this.m[3]*w,t[11]=-(this.m[0]*g-this.m[1]*A+this.m[3]*E),t[15]=this.m[0]*y-this.m[1]*w+this.m[2]*E;let R=this.m[0]*t[0]+this.m[1]*t[4]+this.m[2]*t[8]+this.m[3]*t[12];for(let b=0;b<4;b++)for(let v=0;v<4;v++)t[b*4+v]*=1/R;return new Kt(t)}clone(){return new Kt([...this.m])}toString(){return this.m.toString()}};function np(e,t,n,r=o=>-Math.cos(o)){return e+(r(n)+1)/2*(t-e)}var TE=1103515245,kE=12345,rd=2147483648,rp=class{constructor(e){H(this,"seed");this.seed=e}gen(){return this.seed=(TE*this.seed+kE)%rd,this.seed/rd}genNumber(e,t){return e+this.gen()*(t-e)}genVec2(e,t){return new X(this.genNumber(e.x,t.x),this.genNumber(e.y,t.y))}genColor(e,t){return new pe(this.genNumber(e.r,t.r),this.genNumber(e.g,t.g),this.genNumber(e.b,t.b))}genAny(...e){if(e.length===0)return this.gen();if(e.length===1){if(typeof e[0]=="number")return this.genNumber(0,e[0]);if(e[0]instanceof X)return this.genVec2($(0,0),e[0]);if(e[0]instanceof pe)return this.genColor(we(0,0,0),e[0])}else if(e.length===2){if(typeof e[0]=="number"&&typeof e[1]=="number")return this.genNumber(e[0],e[1]);if(e[0]instanceof X&&e[1]instanceof X)return this.genVec2(e[0],e[1]);if(e[0]instanceof pe&&e[1]instanceof pe)return this.genColor(e[0],e[1])}throw new Error("More than 2 arguments not supported")}},Ya=new rp(Date.now());function _E(e){return e!=null&&(Ya.seed=e),Ya.seed}function je(...e){return Ya.genAny(...e)}function op(...e){return Math.floor(je(...e.length>0?e:[2]))}function DE(e){return je()<=e}function sp(e){for(let t=e.length-1;t>0;t--){let n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function OE(e,t){return e.length<=t?e.slice():sp(e.slice()).slice(0,t)}function LE(e){return e[op(e.length)]}function ip(e,t){return e.pos.x+e.width>t.pos.x&&e.pos.x<t.pos.x+t.width&&e.pos.y+e.height>t.pos.y&&e.pos.y<t.pos.y+t.height}function BE(e,t){if(e.p1.x===e.p2.x&&e.p1.y===e.p2.y||t.p1.x===t.p2.x&&t.p1.y===t.p2.y)return null;let n=(t.p2.y-t.p1.y)*(e.p2.x-e.p1.x)-(t.p2.x-t.p1.x)*(e.p2.y-e.p1.y);if(n===0)return null;let r=((t.p2.x-t.p1.x)*(e.p1.y-t.p1.y)-(t.p2.y-t.p1.y)*(e.p1.x-t.p1.x))/n,o=((e.p2.x-e.p1.x)*(e.p1.y-t.p1.y)-(e.p2.y-e.p1.y)*(e.p1.x-t.p1.x))/n;return r<0||r>1||o<0||o>1?null:r}function Gl(e,t){let n=BE(e,t);return n?$(e.p1.x+n*(e.p2.x-e.p1.x),e.p1.y+n*(e.p2.y-e.p1.y)):null}function Kl(e,t){let n=t.p2.sub(t.p1),r=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;if(n.x!=0){let s=(e.pos.x-t.p1.x)/n.x,i=(e.pos.x+e.width-t.p1.x)/n.x;r=Math.max(r,Math.min(s,i)),o=Math.min(o,Math.max(s,i))}if(n.y!=0){let s=(e.pos.y-t.p1.y)/n.y,i=(e.pos.y+e.height-t.p1.y)/n.y;r=Math.max(r,Math.min(s,i)),o=Math.min(o,Math.max(s,i))}return o>=r&&o>=0&&r<=1}function Pi(e,t){return t.x>e.pos.x&&t.x<e.pos.x+e.width&&t.y>e.pos.y&&t.y<e.pos.y+e.height}function ap(e,t){let n=Math.max(e.pos.x,Math.min(t.center.x,e.pos.x+e.width)),r=Math.max(e.pos.y,Math.min(t.center.y,e.pos.y+e.height));return $(n,r).sdist(t.center)<=t.radius*t.radius}function lp(e,t){return cp(t,new Ye(e.points()))}function Wl(e,t){let n=t.sub(e.p1),r=e.p2.sub(e.p1);if(Math.abs(n.cross(r))>Number.EPSILON)return!1;let o=n.dot(r)/r.dot(r);return o>=0&&o<=1}function zo(e,t){let n=e.p2.sub(e.p1),r=n.dot(n),o=e.p1.sub(t.center),s=2*n.dot(o),i=o.dot(o)-t.radius*t.radius,a=s*s-4*r*i;if(r<=Number.EPSILON||a<0)return!1;if(a==0){let l=-s/(2*r);if(l>=0&&l<=1)return!0}else{let l=(-s+Math.sqrt(a))/(2*r),c=(-s-Math.sqrt(a))/(2*r);if(l>=0&&l<=1||c>=0&&c<=1)return!0}return Ri(t,e.p1)}function Yl(e,t){if(wn(t,e.p1)||wn(t,e.p2))return!0;for(let n=0;n<t.pts.length;n++){let r=t.pts[n],o=t.pts[(n+1)%t.pts.length];if(Gl(e,new it(r,o)))return!0}return!1}function Ri(e,t){return e.center.sdist(t)<e.radius*e.radius}function FE(e,t){return e.center.sdist(t.center)<(e.radius+t.radius)*(e.radius+t.radius)}function Ii(e,t){let n=t.pts[t.pts.length-1];for(let r of t.pts){if(zo(new it(n,r),e))return!0;n=r}return Ri(e,t.pts[0])?!0:wn(t,e.center)}function cp(e,t){for(let n=0;n<e.pts.length;n++)if(Yl(new it(e.pts[n],e.pts[(n+1)%e.pts.length]),t))return!0;return!!(e.pts.some(n=>wn(t,n))||t.pts.some(n=>wn(e,n)))}function wn(e,t){let n=!1,r=e.pts;for(let o=0,s=r.length-1;o<r.length;s=o++)r[o].y>t.y!=r[s].y>t.y&&t.x<(r[s].x-r[o].x)*(t.y-r[o].y)/(r[s].y-r[o].y)+r[o].x&&(n=!n);return n}function Xl(e,t){t=t.sub(e.center);let n=De(e.angle),r=Math.cos(n),o=Math.sin(n),s=t.x*r+t.y*o,i=-t.x*o+t.y*r;return s*s/(e.radiusX*e.radiusX)+i*i/(e.radiusY*e.radiusY)<1}function Ws(e,t){let n=t.center.sub(e.center),r=De(e.angle),o=Math.cos(r),s=Math.sin(r),i=n.x*o+n.y*s,a=-n.x*s+n.y*o;return Xl(new on($(),e.radiusX+t.radius,e.radiusY+t.radius,0),$(i,a))}function up(e,t){let n=e.toMat2().inverse;return t=new it(n.transform(t.p1.sub(e.center)),n.transform(t.p2.sub(e.center))),zo(t,new st($(),1))}function jE(e,t){if(e.radiusX===e.radiusY)return Ws(t,new st(e.center,e.radiusX));if(t.radiusX===t.radiusY)return Ws(e,new st(t.center,t.radiusX));let n=new Zr(1/e.radiusX**2,0,0,0,1/e.radiusY**2,0,0,0,-1),r=new Zr(1/t.radiusX**2,0,0,0,1/t.radiusY**2,0,0,0,-1),o=e.center.x,s=e.center.y,i=t.center.x,a=t.center.y,l=De(e.angle),c=De(t.angle),d=new Zr(Math.cos(l),-Math.sin(l),o,Math.sin(l),Math.cos(l),s,0,0,1),f=new Zr(Math.cos(c),-Math.sin(c),i,Math.sin(c),Math.cos(c),a,0,0,1),u=d.inverse,h=f.inverse,p=u.transpose.mul(n).mul(u),m=h.transpose.mul(r).mul(h),g=p.m11,y=p.m12,A=p.m13,w=p.m21,E=p.m22,R=p.m23,b=p.m31,v=p.m32,C=p.m33,T=m.m11,k=m.m12,D=m.m13,B=m.m21,j=m.m22,P=m.m23,O=m.m31,I=m.m32,_=m.m33,F=g*E*C-g*R*v-y*w*C+y*R*b+A*w*v-A*E*b,N=(g*E*_-g*R*I-g*v*P+g*C*j-y*w*_+y*R*O+y*b*P-y*C*B+A*w*I-A*E*O-A*b*j+A*v*B+w*v*D-w*C*k-E*b*D+E*C*T+R*b*k-R*v*T)/F,z=(g*j*_-g*P*I-y*B*_+y*P*O+A*B*I-A*j*O-w*k*_+w*D*I+E*T*_-E*D*O-R*T*I+R*k*O+b*k*P-b*D*j-v*T*P+v*D*B+C*T*j-C*k*B)/F,V=(T*j*_-T*P*I-k*B*_+k*P*O+D*B*I-D*j*O)/F;if(N>=0){let U=-3*z+N**2,K=3*N*V+z*N**2-4*z**2,Y=-27*V**2+18*V*N*z+N**2*z**2-4*N**3*V-4*z**3;return!(U>0&&K<0&&Y>0)}else{let U=-3*z+N**2,K=-27*V**2+18*V*N*z+N**2*z**2-4*N**3*V-4*z**3;return!(U>0&&K>0)}}function dp(e,t){return Ql(e,new Ye(t.points()))}function Ql(e,t){let n=e.toMat2().inverse;return t=new Ye(t.pts.map(r=>n.transform(r.sub(e.center)))),Ii(new st($(),1),t)}function qE(e,t){return e.x===t.x&&e.y===t.y}function zE(e,t){return t instanceof X?qE(t,e.pt):t instanceof st?Ri(t,e.pt):t instanceof it?Wl(t,e.pt):t instanceof Ee?Pi(t,e.pt):t instanceof Ye?wn(t,e.pt):t instanceof on?Xl(t,e.pt):!1}function HE(e,t){return t instanceof X?Wl(e,t):t instanceof st?zo(e,t):t instanceof it?Gl(e,t)!=null:t instanceof Ee?Kl(t,e):t instanceof Ye?Yl(e,t):t instanceof on?up(t,e):!1}function VE(e,t){return t instanceof X?Ri(e,t):t instanceof st?FE(e,t):t instanceof it?zo(t,e):t instanceof Ee?ap(t,e):t instanceof Ye?Ii(e,t):t instanceof on?Ws(t,e):!1}function UE(e,t){return t instanceof X?Pi(e,t):t instanceof st?ap(e,t):t instanceof it?Kl(e,t):t instanceof Ee?ip(e,t):t instanceof Ye?lp(e,t):t instanceof on?dp(t,e):!1}function $E(e,t){return t instanceof X?wn(e,t):t instanceof st?Ii(t,e):t instanceof it?Yl(t,e):t instanceof Ee?lp(t,e):t instanceof Ye?cp(t,e):t instanceof on?Ql(t,e):!1}function GE(e,t){return t instanceof X?Xl(e,t):t instanceof st?Ws(e,t):t instanceof it?up(e,t):t instanceof Ee?dp(e,t):t instanceof Ye?Ql(e,t):t instanceof on?jE(t,e):!1}function fp(e,t,n){let r=e,o=n.p1,s=n.p2,i=t,a=s.sub(o),l=i.cross(a);if(Math.abs(l)<Number.EPSILON)return null;let c=o.sub(r),d=c.cross(a)/l;if(d<=0||d>=1)return null;let f=c.cross(i)/l;if(f<=0||f>=1)return null;let u=a.normal().unit();return t.dot(u)>0&&(u.x*=-1,u.y*=-1),{point:r.add(i.scale(d)),normal:u,fraction:d}}function KE(e,t,n){let r=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY,s;if(e.x!=0){let i=(n.pos.x-e.x)/t.x,a=(n.pos.x+n.width-e.x)/t.x;s=$(-Math.sign(t.x),0),r=Math.max(r,Math.min(i,a)),o=Math.min(o,Math.max(i,a))}if(e.y!=0){let i=(n.pos.y-e.y)/t.y,a=(n.pos.y+n.height-e.y)/t.y;Math.min(i,a)>r&&(s=$(0,-Math.sign(t.y))),r=Math.max(r,Math.min(i,a)),o=Math.min(o,Math.max(i,a))}return o>=r&&r>=0&&r<=1?{point:e.add(t.scale(r)),normal:s,fraction:r}:null}function hp(e,t,n){let r=e,o=n.center,s=t,i=s.dot(s),a=r.sub(o),l=2*s.dot(a),c=a.dot(a)-n.radius*n.radius,d=l*l-4*i*c;if(i<=Number.EPSILON||d<0)return null;if(d==0){let f=-l/(2*i);if(f>=0&&f<=1){let u=r.add(s.scale(f));return{point:u,normal:u.sub(o),fraction:f}}}else{let f=(-l+Math.sqrt(d))/(2*i),u=(-l-Math.sqrt(d))/(2*i),h=null;if(f>=0&&f<=1&&(h=f),u>=0&&u<=1&&(h=Math.min(u,h??u)),h!=null){let p=r.add(s.scale(h));return{point:p,normal:p.sub(o).unit(),fraction:h}}}return null}function WE(e,t,n){let r=n.pts,o=null,s=r[r.length-1];for(let i=0;i<r.length;i++){let a=r[i],l=fp(e,t,new it(s,a));l&&(!o||o.fraction>l.fraction)&&(o=l),s=a}return o}function YE(e,t,n){let r=n.toMat2(),o=r.inverse,s=o.transform(e.sub(n.center)),i=o.transform(t),a=hp(s,i,new st($(),1));if(a){let l=Ks.rotation(De(-n.angle)),c=Ks.scale(n.radiusX,n.radiusY).transform(a.point),d=r.transform(a.point).add(n.center),f=d.dist(e)/t.len();return{point:d,normal:l.transform($(n.radiusY**2*c.x,n.radiusX**2*c.y)).unit(),fraction:f}}return a}function XE(e,t,n,r=64){let o=e,s=t.len(),i=t.scale(1/s),a=0,l=$(Math.floor(e.x),Math.floor(e.y)),c=$(i.x>0?1:-1,i.y>0?1:-1),d=$(Math.abs(1/i.x),Math.abs(1/i.y)),f=$(c.x>0?l.x+1-e.x:e.x-l.x,c.y>0?l.y+1-e.y:e.y-l.y),u=$(d.x<1/0?d.x*f.x:1/0,d.y<1/0?d.y*f.y:1/0),h=-1;for(;a<=r;){let p=n(l);if(p===!0)return{point:o.add(i.scale(a)),normal:$(h===0?-c.x:0,h===1?-c.y:0),fraction:a/s,gridPos:l};if(p)return p;u.x<u.y?(l.x+=c.x,a=u.x,u.x+=d.x,h=0):(l.y+=c.y,a=u.y,u.y+=d.y,h=1)}return null}var QE=class Xa{constructor(t){H(this,"pt");this.pt=t.clone()}transform(t){return new Xa(t.multVec2(this.pt))}bbox(){return new Ee(this.pt,0,0)}area(){return 0}clone(){return new Xa(this.pt)}collides(t){return zE(this,t)}contains(t){return this.pt.eq(t)}raycast(t,n){return null}random(){return this.pt.clone()}},it=class Qa{constructor(t,n){H(this,"p1");H(this,"p2");this.p1=t.clone(),this.p2=n.clone()}transform(t){return new Qa(t.multVec2(this.p1),t.multVec2(this.p2))}bbox(){return Ee.fromPoints(this.p1,this.p2)}area(){return this.p1.dist(this.p2)}clone(){return new Qa(this.p1,this.p2)}collides(t){return HE(this,t)}contains(t){return this.collides(t)}raycast(t,n){return fp(t,n,this)}random(){return this.p1.add(this.p2.sub(this.p1).scale(je(1)))}},Ee=class Za{constructor(t,n,r){H(this,"pos");H(this,"width");H(this,"height");this.pos=t.clone(),this.width=n,this.height=r}static fromPoints(t,n){return new Za(t.clone(),n.x-t.x,n.y-t.y)}center(){return new X(this.pos.x+this.width/2,this.pos.y+this.height/2)}points(){return[this.pos,this.pos.add(this.width,0),this.pos.add(this.width,this.height),this.pos.add(0,this.height)]}transform(t){return new Ye(this.points().map(n=>t.multVec2(n)))}bbox(){return this.clone()}area(){return this.width*this.height}clone(){return new Za(this.pos.clone(),this.width,this.height)}distToPoint(t){return Math.sqrt(this.sdistToPoint(t))}sdistToPoint(t){let n=this.pos,r=this.pos.add(this.width,this.height),o=Math.max(n.x-t.x,0,t.x-r.x),s=Math.max(n.y-t.y,0,t.y-r.y);return o*o+s*s}collides(t){return UE(this,t)}contains(t){return this.collides(t)}raycast(t,n){return KE(t,n,this)}random(){return this.pos.add(je(this.width),je(this.height))}},st=class pp{constructor(t,n){H(this,"center");H(this,"radius");this.center=t.clone(),this.radius=n}transform(t){return new on(this.center,this.radius,this.radius).transform(t)}bbox(){return Ee.fromPoints(this.center.sub($(this.radius)),this.center.add($(this.radius)))}area(){return this.radius*this.radius*Math.PI}clone(){return new pp(this.center,this.radius)}collides(t){return VE(this,t)}contains(t){return this.collides(t)}raycast(t,n){return hp(t,n,this)}random(){return this.center.add(X.fromAngle(je(360)).scale(je(this.radius)))}},on=class hr{constructor(t,n,r,o=0){H(this,"center");H(this,"radiusX");H(this,"radiusY");H(this,"angle");this.center=t.clone(),this.radiusX=n,this.radiusY=r,this.angle=o}static fromMat2(t){let n=t.inverse,r=n.transpose.mul(n),[o,s]=r.eigenvalues,[i,a]=r.eigenvectors(o,s),[l,c]=[1/Math.sqrt(o),1/Math.sqrt(s)];return l>c?new hr($(),l,c,Vn(Math.atan2(-i[1],i[0]))):new hr($(),c,l,Vn(Math.atan2(-a[1],a[0])))}toMat2(){let t=De(this.angle),n=Math.cos(t),r=Math.sin(t);return new Ks(n*this.radiusX,-r*this.radiusY,r*this.radiusX,n*this.radiusY)}transform(t){if(this.angle==0&&t.getRotation()==0)return new hr(t.multVec2(this.center),t.m[0]*this.radiusX,t.m[5]*this.radiusY);{let n=this.toMat2(),r=t.getRotation(),o=t.getScale();n=Zr.fromMat2(n).scale(o.x,o.y).rotate(r).toMat2();let s=hr.fromMat2(n);return s.center=t.multVec2(this.center),s}}bbox(){if(this.angle==0)return Ee.fromPoints(this.center.sub($(this.radiusX,this.radiusY)),this.center.add($(this.radiusX,this.radiusY)));{let t=De(this.angle),n=Math.cos(t),r=Math.sin(t),o=this.radiusX*n,s=this.radiusX*r,i=this.radiusY*r,a=this.radiusY*n,l=Math.sqrt(o*o+i*i),c=Math.sqrt(s*s+a*a);return Ee.fromPoints(this.center.sub($(l,c)),this.center.add($(l,c)))}}area(){return this.radiusX*this.radiusY*Math.PI}clone(){return new hr(this.center,this.radiusX,this.radiusY,this.angle)}collides(t){return GE(this,t)}contains(t){t=t.sub(this.center);let n=De(this.angle),r=Math.cos(n),o=Math.sin(n),s=t.x*r+t.y*o,i=-t.x*o+t.y*r;return s*s/(this.radiusX*this.radiusX)+i*i/(this.radiusY*this.radiusY)<1}raycast(t,n){return YE(t,n,this)}random(){return this.center}};function ZE(e,t,n,r){let o=t.sub(e),s=r.sub(n),i=o.cross(s);return i<1e-5&&i>-1e-5||(i=n.sub(e).cross(s)/i,i<0||i>1)?null:e.add(o.scale(i))}var Ye=class eo{constructor(t){H(this,"pts");if(t.length<3)throw new Error("Polygons should have at least 3 vertices");this.pts=t}transform(t){return new eo(this.pts.map(n=>t.multVec2(n)))}bbox(){let t=$(Number.MAX_VALUE),n=$(-Number.MAX_VALUE);for(let r of this.pts)t.x=Math.min(t.x,r.x),n.x=Math.max(n.x,r.x),t.y=Math.min(t.y,r.y),n.y=Math.max(n.y,r.y);return Ee.fromPoints(t,n)}area(){let t=0,n=this.pts.length;for(let r=0;r<n;r++){let o=this.pts[r],s=this.pts[(r+1)%n];t+=o.x*s.y*.5,t-=s.x*o.y*.5}return Math.abs(t)}clone(){return new eo(this.pts.map(t=>t.clone()))}collides(t){return $E(this,t)}contains(t){return this.collides(t)}raycast(t,n){return WE(t,n,this)}random(){return $()}cut(t,n){new it(t,n);let r=[],o=[],s=n.sub(t),i=this.pts[this.pts.length-1],a=i.sub(t),l=s.cross(a)>0;return this.pts.forEach(c=>{a=c.sub(t);let d=s.cross(a)>0;if(l!=d){let f=ZE(i,c,t,n);r.push(f),o.push(f),l=d}(d?r:o).push(c),i=c}),[r.length?new eo(r):null,o.length?new eo(o):null]}};function JE(e,t,n,r){let o=r*r,s=1-r,i=s*s;return e.scale(i).add(t.scale(2*s*r)).add(n.scale(o))}function eS(e,t,n,r){let o=1-r;return t.sub(e).scale(2*o).add(n.sub(t).scale(2*r))}function tS(e,t,n,r){return n.sub(t.scale(2)).add(e).scale(2)}function Zl(e,t,n,r,o){let s=o*o,i=s*o,a=1-o,l=a*a,c=l*a;return e.scale(c).add(t.scale(3*l*o)).add(n.scale(3*a*s)).add(r.scale(i))}function nS(e,t,n,r,o){let s=o*o,i=1-o,a=i*i;return t.sub(e).scale(3*a).add(n.sub(t).scale(6*i*o)).add(r.sub(n).scale(3*s))}function rS(e,t,n,r,o){let s=1-o;return n.sub(t.scale(2)).add(e).scale(6*s).add(r.sub(n.scale(2)).add(t).scale(6*o))}function oS(e,t,n,r,o){let s=.5*(((-o+2)*o-1)*o),i=.5*((3*o-5)*o*o+2),a=.5*(((-3*o+4)*o+1)*o),l=.5*((o-1)*o*o);return e.scale(s).add(t.scale(i)).add(n.scale(a)).add(r.scale(l))}function sS(e,t,n,r,o){let s=.5*((-3*o+4)*o-1),i=.5*((9*o-10)*o),a=.5*((-9*o+8)*o+1),l=.5*((3*o-2)*o);return e.scale(s).add(t.scale(i)).add(n.scale(a)).add(r.scale(l))}function iS(e){let t=gp(e),n=t(1);return r=>{let o=r*n,s=t(o,!0);return e(s)}}function gp(e,t=10,n=10){let r=[0],o=[0],s=1/(t-1)/n,i=0,a=e(0),l=0;for(let c=1;c<t;c++){for(let d=0;d<n;d++){l+=s;let f=e(l),u=f.dist(a);i+=u,a=f}r[c]=i,o[c]=l}return o[t-1]=1,(c,d=!1)=>{if(d){let f=c;if(f<=0)return 0;if(f>=i)return 1;let u=0;for(;r[u+1]<f;)u++;let h=o[u],p=o[u+1],m=r[u],g=r[u+1],y=(f-m)/(g-m);return h+(p-h)*y}else{if(c<=0)return 0;if(c>=1)return r[t-1];let f=0;for(;o[f+1]<c;)f++;let u=o[f],h=o[f+1],p=r[f],m=r[f+1],g=(c-u)/(h-u);return p+(m-p)*g}}}function Ho(e,t,n,r){let o=2*e+t-2*r+n,s=-3*e+3*r-2*t-n,i=t,a=e;return l=>{let c=l*l,d=c*l;return o*d+s*c+i*l+a}}function mp(e,t,n,r,o,s=Ho){let i=s(t.x,(1-o)*(n.x-e.x),(1-o)*(r.x-t.x),n.x),a=s(t.y,(1-o)*(n.y-e.y),(1-o)*(r.y-t.y),n.y);return l=>new X(i(l),a(l))}function Ys(e,t,n,r,o=Ho){return mp(e,t,n,r,.5,o)}function aS(e,t,n,r,o=Ho){return Ys(r.add(e.sub(t).scale(6)),e,r,e.add(r.sub(n).scale(6)),o)}function lS(e,t,n,r,o,s,i,a=Ho){let l=a(t.x,.5*(1-o)*(1+i)*(1+s)*(t.x-e.x)+.5*(1-o)*(1-i)*(1-s)*(n.x-t.x),.5*(1-o)*(1+i)*(1-s)*(n.x-t.x)+.5*(1-o)*(1-i)*(1+s)*(r.x-n.x),n.x),c=a(t.y,.5*(1-o)*(1+i)*(1+s)*(t.y-e.y)+.5*(1-o)*(1-i)*(1-s)*(n.y-t.y),.5*(1-o)*(1+i)*(1-s)*(n.y-t.y)+.5*(1-o)*(1-i)*(1+s)*(r.y-n.y),n.y);return d=>new X(l(d),c(d))}function cS(e,t,n,r){let o=2*e+t-2*r+n,s=-3*e+3*r-2*t+n,i=t;return a=>{let l=a*a;return 3*o*l+2*s*a+i}}function Gr(e){return 0<=e&&e<=1}function ga(e,t){return Math.abs(e-t)<=Number.EPSILON}function Kr(e){return e<0?-Math.pow(-e,1/3):Math.pow(e,1/3)}function uS(e,t,n,r){let o=3*e-6*t+3*n,s=-3*e+3*t,i=e,a=-e+3*t-3*n+r;if(ga(a,0)){if(ga(o,0))return ga(s,0)?[]:[-i/s].filter(Gr);let g=Math.sqrt(s*s-4*o*i),y=2*o;return[(g-s)/y,(-s-g)/y].filter(Gr)}o/=a,s/=a,i/=a;let l=(3*s-o*o)/3,c=l/3,d=(2*o*o*o-9*o*s+27*i)/27,f=d/2,u=f*f+c*c*c;if(u<0){let g=-l/3,y=g*g*g,A=Math.sqrt(y),w=-d/(2*A),E=w<-1?-1:w>1?1:w,R=Math.acos(E),b=2*Kr(A),v=b*Math.cos(R/3)-o/3,C=b*Math.cos((R+2*Math.PI)/3)-o/3,T=b*Math.cos((R+4*Math.PI)/3)-o/3;return[v,C,T].filter(Gr)}if(u===0){let g=f<0?Kr(-f):-Kr(f),y=2*g-o/3,A=-g-o/3;return[y,A].filter(Gr)}let h=Math.sqrt(u),p=Kr(h-f),m=Kr(h+f);return[p-m-o/3].filter(Gr)}function dS(e,t,n,r,o){let s=uS(e.x-o,t.x-o,n.x-o,r.x-o);return s.length>0?Zl(e,t,n,r,s[0]).y:NaN}function fS(e){if(!e||e.length==0)throw new Error("Need at least one point for easingLinear.");let t=e.length;return n=>{if(n<=0||e.length==1||n<=e[0].x)return e[0].y;for(let r=0;r<t;r++)if(e[r].x>=n)return Lt(n,e[r-1].x,e[r].x,e[r-1].y,e[r].y);return e[e.length-1].y}}function hS(e,t){return n=>dS($(0,0),e,t,$(1,1),n)}function pS(e,t="jump-end"){let n=1/e,r=t=="jump-start"||t=="jump-both",o=t=="jump-end"||t=="jump-both",s=1/(e+(o?1:0)),i=r?s:0;return a=>{let l=Math.floor(a/n);return i+l*s}}function gS(e,t){let n=Number.MAX_VALUE,r={normal:$(0),distance:0};for(let o of[e,t])for(let s=0;s<o.pts.length;s++){let i=o.pts[s],a=o.pts[(s+1)%o.pts.length].sub(i).normal().unit(),l=Number.MAX_VALUE,c=-Number.MAX_VALUE;for(let h=0;h<e.pts.length;h++){let p=e.pts[h].dot(a);l=Math.min(l,p),c=Math.max(c,p)}let d=Number.MAX_VALUE,f=-Number.MAX_VALUE;for(let h=0;h<t.pts.length;h++){let p=t.pts[h].dot(a);d=Math.min(d,p),f=Math.max(f,p)}let u=Math.min(c,f)-Math.max(l,d);if(u<0)return null;if(u<Math.abs(n)){let h=f-l,p=d-c;n=Math.abs(h)<Math.abs(p)?h:p,r.normal=a,r.distance=n}}return r}function yp(e,t,n){return(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)>=0}function mS(e){let t=0,n=e[e.length-1];for(let r=0;r<e.length;r++)t+=(e[r].x-n.x)*(e[r].y+n.y),n=e[r];return t<0}function ma(e,t,n,r){let o=r.x-n.x,s=r.y-n.y,i=o*(e.y-n.y)-s*(e.x-n.x),a=o*(t.y-n.y)-s*(t.x-n.x);return i*a>=0}function yS(e,t,n,r){return ma(e,t,n,r)&&ma(e,n,t,r)&&ma(e,r,t,n)}function wS(e,t,n,r){for(let o of e)if(o!==t&&o!==n&&o!==r&&yS(o,t,n,r))return!0;return!1}function xS(e,t,n,r){return yp(e,t,n)&&!wS(r,e,t,n)}function wp(e){if(e.length<3)return[];if(e.length==3)return[e];let t=[],n=[],r=0;for(let f=0;f<e.length;f++){let u=e[r],h=e[f];(h.x<u.x||h.x==u.x&&h.y<u.y)&&(r=r),t[f]=f+1,n[f]=f-1}t[t.length-1]=0,n[0]=n.length-1,mS(e)||([t,n]=[n,t]);let o=[];for(let f=0;f<e.length;++f)yp(e[n[f]],e[f],e[t[f]])||o.push(e[f]);let s=[],i=e.length,a=1,l=0,c,d;for(;i>3;){c=t[a],d=n[a];let f=e[d],u=e[a],h=e[c];if(xS(f,u,h,o))s.push([f,u,h]),t[d]=c,n[c]=d,o.splice(o.indexOf(u),1),--i,l=0;else if(++l>i)return[];a=c}return c=t[a],d=n[a],s.push([e[d],e[a],e[c]]),s}function vS(e){if(e.length<3)return!1;let t=e.length-2,n=e.length-1,r=0,o=e[n].sub(e[t]),s=e[r].sub(e[n]),i=o.cross(s);for(;r+1<e.length;)if(t=n,n=r,r++,o=e[n].sub(e[t]),s=e[r].sub(e[n]),o.cross(s)*i<0)return!1;return!0}var xp=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",Ni="topleft",bS="monospace",Xs="monospace",Ja="linear",Jl=[{name:"a_pos",size:2},{name:"a_uv",size:2},{name:"a_color",size:4}],AS=Jl.reduce((e,t)=>e+t.size,0),vp=2048,ES=vp*4*AS,SS=vp*6,MS=`
attribute vec2 a_pos;
attribute vec2 a_uv;
attribute vec4 a_color;

varying vec2 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

vec4 def_vert() {
	return vec4(a_pos, 0.0, 1.0);
}

{{user}}

void main() {
	vec4 pos = vert(a_pos, a_uv, a_color);
	v_pos = a_pos;
	v_uv = a_uv;
	v_color = a_color;
	gl_Position = pos;
}
`,CS=`
precision mediump float;

varying vec2 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

uniform sampler2D u_tex;

vec4 def_frag() {
	vec4 texColor = texture2D(u_tex, v_uv);
	return vec4((v_color.rgb * texColor.rgb), texColor.a) * v_color.a;
}

{{user}}

void main() {
	gl_FragColor = frag(v_pos, v_uv, v_color, u_tex);
	if (gl_FragColor.a == 0.0) {
		discard;
	}
}
`,el=`
vec4 vert(vec2 pos, vec2 uv, vec4 color) {
	return def_vert();
}
`,tl=`
vec4 frag(vec2 pos, vec2 uv, vec4 color, sampler2D tex) {
	return def_frag();
}
`,PS=new Set(["id","require"]),RS=new Set(["add","fixedUpdate","update","draw","destroy","inspect","drawInspect"]),od=200,IS=640,NS=65536,bp=Symbol.for("kaplay.cancel"),Ap=class extends Map{constructor(){super(...arguments);H(this,"lastID",0)}push(t){let n=this.lastID;return this.set(n,t),this.lastID++,n}pushd(t){let n=this.push(t);return()=>this.delete(n)}},Zn=class Ep{constructor(t){H(this,"paused",!1);H(this,"cancel");this.cancel=t}static join(t){let n=new Ep(()=>t.forEach(r=>r.cancel()));return Object.defineProperty(n,"paused",{get:()=>t[0].paused,set:r=>t.forEach(o=>o.paused=r)}),n.paused=!1,n}static replace(t,n){return t.cancel=()=>n.cancel(),n.paused=t.paused,Object.defineProperty(t,"paused",{get:()=>n.paused,set:r=>n.paused=r}),t}},We=class{constructor(){H(this,"cancellers",new WeakMap);H(this,"handlers",new Ap)}add(e){function t(...o){if(!r.paused)return e(...o)}let n=this.handlers.pushd(t),r=new Zn(n);return this.cancellers.set(t,n),r}addOnce(e){let t=this.add((...n)=>{t.cancel(),e(...n)});return t}next(){return new Promise(e=>this.addOnce(e))}trigger(...e){this.handlers.forEach(t=>{let n=t(...e),r;n===bp&&(r=this.cancellers.get(t))&&r()})}numListeners(){return this.handlers.size}clear(){this.handlers.clear()}},Co=class{constructor(){H(this,"handlers",{});H(this,"registers",{})}on(e,t){return this.handlers[e]||(this.handlers[e]=new We),this.handlers[e].add(t)}onOnce(e,t){let n=this.on(e,(...r)=>{n.cancel(),t(...r)});return n}next(e){return new Promise(t=>{this.onOnce(e,(...n)=>t(n[0]))})}trigger(e,...t){this.handlers[e]&&this.handlers[e].trigger(...t)}remove(e){delete this.handlers[e]}clear(){this.handlers={}}numListeners(e){var t;return((t=this.handlers[e])==null?void 0:t.numListeners())??0}},TS=e=>e[0]instanceof pe,kS=e=>e[0]instanceof X,_S=e=>typeof e[0]=="number",Sp=class{constructor(e=(t,n)=>t<n){H(this,"_items");H(this,"_compareFn");this._compareFn=e,this._items=[]}insert(e){this._items.push(e),this.moveUp(this._items.length-1)}remove(){if(this._items.length===0)return null;let e=this._items[0],t=this._items.pop();return this._items.length!==0&&(this._items[0]=t,this.moveDown(0)),e}clear(){this._items.splice(0,this._items.length)}moveUp(e){for(;e>0;){let t=Math.floor((e-1)/2);if(!this._compareFn(this._items[e],this._items[t])&&this._items[e]>=this._items[t])break;this.swap(e,t),e=t}}moveDown(e){for(;e<Math.floor(this._items.length/2);){let t=2*e+1;if(t<this._items.length-1&&!this._compareFn(this._items[t],this._items[t+1])&&++t,this._compareFn(this._items[e],this._items[t]))break;this.swap(e,t),e=t}}swap(e,t){[this._items[e],this._items[t]]=[this._items[t],this._items[e]]}get length(){return this._items.length}};function DS(e){let t=window.atob(e),n=t.length,r=new Uint8Array(n);for(let o=0;o<n;o++)r[o]=t.charCodeAt(o);return r.buffer}function OS(e){return DS(e.split(",")[1])}function ec(e,t){let n=document.createElement("a");n.href=t,n.download=e,n.click()}function Mp(e,t){ec(e,"data:text/plain;charset=utf-8,"+t)}function LS(e,t){Mp(e,JSON.stringify(t))}function sd(e,t){let n=URL.createObjectURL(t);ec(e,n),URL.revokeObjectURL(n)}var Cp=e=>e.match(/^data:\w+\/\w+;base64,.+/),BS=e=>e.split(".").slice(0,-1).join(".");function tc(e,t){if(e===t)return!0;let n=typeof e,r=typeof t;if(n!==r)return!1;if(n==="object"&&r==="object"&&e!==null&&t!==null){if(Array.isArray(e)!==Array.isArray(t))return!1;let o=Object.keys(e),s=Object.keys(t);if(o.length!==s.length)return!1;for(let i of o){let a=e[i],l=t[i];if(!tc(a,l))return!1}return!0}return!1}var id=new Set,FS=e=>e instanceof Error?e.message:String(e);function jS(e){id.has(e)||(id.add(e),console.warn(e))}function Lr(e,t){jS(`${e} is deprecated. Use ${t} instead.`)}function nl(e,t){return Number(e.toFixed(t))}function Me(e,t){return(...n)=>{let r=n.length;if(r===e.length)return e(...n);if(r===t.length)return t(...n)}}var qS=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);function zS(e){if(typeof e!="string")throw new TypeError("string cannot be undefined or null");let t=[],n=0,r=0;for(;n<e.length;){if(r+=HS(n+r,e),YS(e[n+r])&&r++,GS(e[n+r])&&r++,KS(e[n+r])&&r++,XS(e[n+r])){r++;continue}t.push(e.substring(n,n+r)),n+=r,r=0}return t}function HS(e,t){let n=t[e];if(!VS(n)||e===t.length-1)return 1;let r=n+t[e+1],o=t.substring(e+2,e+5);return ad(r)&&ad(o)?4:US(r)&&WS(o)?t.slice(e).indexOf(String.fromCodePoint(917631))+2:$S(o)?4:2}function VS(e){return e&&Jn(e[0].charCodeAt(0),55296,56319)}function ad(e){return Jn(nc(e),127462,127487)}function US(e){return Jn(nc(e),127988,127988)}function $S(e){return Jn(nc(e),127995,127999)}function GS(e){return typeof e=="string"&&Jn(e.charCodeAt(0),65024,65039)}function KS(e){return typeof e=="string"&&Jn(e.charCodeAt(0),8400,8447)}function WS(e){let t=e.codePointAt(0);return typeof e=="string"&&typeof t=="number"&&Jn(t,917504,917631)}function YS(e){return typeof e=="string"&&qS.includes(e.charCodeAt(0))}function XS(e){return typeof e=="string"&&e.charCodeAt(0)===8205}function nc(e){let t=e.charCodeAt(0)-55296,n=e.charCodeAt(1)-56320;return(t<<10)+n+65536}function Jn(e,t,n){return e>=t&&e<=n}var ut=(e,t)=>Array.isArray(e)?e==null?void 0:e.includes(t):e===t,Dt=(e,t)=>Array.isArray(t)?t.some(n=>e.has(n)):e.has(t),cs=(e,t,n)=>{var r;e.has(t)?(r=e.get(t))==null||r.push(n):e.set(t,[n])},QS=(()=>{let e=0;return()=>e++})(),ZS={"Joy-Con L+R (STANDARD GAMEPAD Vendor: 057e Product: 200e)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",6:"ltrigger",7:"rtrigger",8:"select",9:"start",10:"lstick",11:"rstick",12:"dpad-up",13:"dpad-down",14:"dpad-left",15:"dpad-right",16:"home",17:"capture"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}},"Joy-Con (L) (STANDARD GAMEPAD Vendor: 057e Product: 2006)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",9:"select",10:"lstick",16:"start"},sticks:{left:{x:0,y:1}}},"Joy-Con (R) (STANDARD GAMEPAD Vendor: 057e Product: 2007)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",9:"start",10:"lstick",16:"select"},sticks:{left:{x:0,y:1}}},"Pro Controller (STANDARD GAMEPAD Vendor: 057e Product: 2009)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",6:"ltrigger",7:"rtrigger",8:"select",9:"start",10:"lstick",11:"rstick",12:"dpad-up",13:"dpad-down",14:"dpad-left",15:"dpad-right",16:"home",17:"capture"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}},default:{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",6:"ltrigger",7:"rtrigger",8:"select",9:"start",10:"lstick",11:"rstick",12:"dpad-up",13:"dpad-down",14:"dpad-left",15:"dpad-right",16:"home"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}}};function Pp(){let e=M.globalOpt.pixelDensity??1,t=M.globalOpt.width,n=M.globalOpt.height,r=M.gfx.ggl.gl.drawingBufferWidth,o=M.gfx.ggl.gl.drawingBufferHeight,s=r/e,i=o/e,a=0,l=0,c=s,d=i;if(M.globalOpt.letterbox){if(!t||!n)throw new Error("Letterboxing requires width and height defined.");let f=s/i,u=t/n;if(f>u){let h=i*u;a=(s-h)/2,c=h}else{let h=s/u;d=h,l=(i-h)/2}}if(M.globalOpt.stretch&&(!M.globalOpt.width||!M.globalOpt.height))throw new Error("Stretching requires width and height defined.");M.gfx.viewport={x:a,y:l,width:c,height:d,scale:(M.gfx.viewport.width+M.gfx.viewport.height)/(M.gfx.width+M.gfx.height)}}function JS(e){return new X(e.x*M.gfx.viewport.width/M.gfx.width,e.y*M.gfx.viewport.height/M.gfx.height)}function eM(e){return new X((e.x-M.gfx.viewport.x)*M.gfx.width/M.gfx.viewport.width,(e.y-M.gfx.viewport.y)*M.gfx.height/M.gfx.viewport.height)}var tM=()=>_n.lastInputDevice,nM=()=>{let e=_n.buttons;for(let t in e){let n=e[t].keyboard&&[e[t].keyboard].flat(),r=e[t].keyboardCode&&[e[t].keyboardCode].flat(),o=e[t].gamepad&&[e[t].gamepad].flat(),s=e[t].mouse&&[e[t].mouse].flat();n&&n.forEach(i=>{cs(_n.buttonsByKey,i,t)}),r&&r.forEach(i=>{cs(_n.buttonsByKeyCode,i,t)}),o&&o.forEach(i=>{cs(_n.buttonsByGamepad,i,t)}),s&&s.forEach(i=>{cs(_n.buttonsByMouse,i,t)})}},lo=class{constructor(){H(this,"pressed",new Set([]));H(this,"pressedRepeat",new Set([]));H(this,"released",new Set([]));H(this,"down",new Set([]))}update(){this.pressed.clear(),this.released.clear(),this.pressedRepeat.clear()}press(e){this.pressed.add(e),this.pressedRepeat.add(e),this.down.add(e)}pressRepeat(e){this.pressedRepeat.add(e)}release(e){this.down.delete(e),this.pressed.delete(e),this.released.add(e)}},rM=class{constructor(){H(this,"buttonState",new lo);H(this,"stickState",new Map)}},oM=class{constructor(){H(this,"dts",[]);H(this,"timer",0);H(this,"fps",0)}tick(e){this.dts.push(e),this.timer+=e,this.timer>=1&&(this.timer=0,this.fps=Math.round(1/(this.dts.reduce((t,n)=>t+n)/this.dts.length)),this.dts=[])}},_n,ld=ZS,sM=e=>{let t=e.buttons??{};return{canvas:e.canvas,buttons:t,buttonsByKey:new Map,buttonsByMouse:new Map,buttonsByGamepad:new Map,buttonsByKeyCode:new Map,loopID:null,stopped:!1,dt:0,fixedDt:1/50,restDt:0,time:0,realTime:0,fpsCounter:new oM,timeScale:1,skipTime:!1,isHidden:!1,numFrames:0,mousePos:new X(0),mouseDeltaPos:new X(0),keyState:new lo,mouseState:new lo,mergedGamepadState:new rM,gamepadStates:new Map,lastInputDevice:null,buttonState:new lo,gamepads:[],charInputted:[],isMouseMoved:!1,lastWidth:e.canvas.offsetWidth,lastHeight:e.canvas.offsetHeight,events:new Co}},iM=e=>{if(!e.canvas)throw new Error("Please provide a canvas");let t=sM(e);_n=t,nM();function n(){return t.dt*t.timeScale}function r(){return t.fixedDt*t.timeScale}function o(){return t.restDt*t.timeScale}function s(){return t.isHidden}function i(){return t.time}function a(){return t.fpsCounter.fps}function l(){return t.numFrames}function c(){return t.canvas.toDataURL()}function d(L){t.canvas.style.cursor=L}function f(){return t.canvas.style.cursor}function u(L){if(L)try{let G=t.canvas.requestPointerLock();G!=null&&G.catch&&G.catch(Q=>console.error(Q))}catch(G){console.error(G)}else document.exitPointerLock()}function h(){return!!document.pointerLockElement}function p(L){L.requestFullscreen?L.requestFullscreen():L.webkitRequestFullscreen&&L.webkitRequestFullscreen()}function m(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullScreen&&document.webkitExitFullScreen()}function g(L=!0){L?p(t.canvas):m()}function y(){return document.fullscreenElement===t.canvas||document.webkitFullscreenElement===t.canvas}function A(){t.stopped=!0;let L=Object.entries(Ve),G=Object.entries(Hr),Q=Object.entries(or);for(let[ie,fe]of L)t.canvas.removeEventListener(ie,fe);for(let[ie,fe]of G)document.removeEventListener(ie,fe);for(let[ie,fe]of Q)window.removeEventListener(ie,fe);Qo.disconnect()}function w(L,G){t.loopID!==null&&cancelAnimationFrame(t.loopID);let Q=0,ie=0,fe=Ae=>{if(t.stopped)return;if(document.visibilityState!=="visible"){t.loopID=requestAnimationFrame(fe);return}let Oe=Ae/1e3,Pe=Math.min(Oe-t.realTime,.25),bt=e.maxFPS?1/e.maxFPS:0;if(t.realTime=Oe,ie+=Pe,ie>bt){if(!t.skipTime){for(Q+=ie,t.dt=t.fixedDt,t.restDt=0;Q>t.fixedDt;)Q-=t.fixedDt,Q<t.fixedDt&&(t.restDt=Q),L();t.restDt=Q,t.dt=ie,t.time+=n(),t.fpsCounter.tick(t.dt)}ie=0,t.skipTime=!1,t.numFrames++,G($i,Gi)}t.loopID=requestAnimationFrame(fe)};fe(0)}function E(){return"ontouchstart"in window||navigator.maxTouchPoints>0}function R(){return t.mousePos.clone()}function b(){return t.mouseDeltaPos.clone()}function v(L="left"){return t.mouseState.pressed.has(L)}function C(L="left"){return t.mouseState.down.has(L)}function T(L="left"){return t.mouseState.released.has(L)}function k(){return t.isMouseMoved}function D(L){return L===void 0?t.keyState.pressed.size>0:Dt(t.keyState.pressed,L)}function B(L){return L===void 0?t.keyState.pressedRepeat.size>0:Dt(t.keyState.pressedRepeat,L)}function j(L){return L===void 0?t.keyState.down.size>0:Dt(t.keyState.down,L)}function P(L){return L===void 0?t.keyState.released.size>0:Dt(t.keyState.released,L)}function O(L){return L===void 0?t.mergedGamepadState.buttonState.pressed.size>0:Dt(t.mergedGamepadState.buttonState.pressed,L)}function I(L){return L===void 0?t.mergedGamepadState.buttonState.down.size>0:Dt(t.mergedGamepadState.buttonState.down,L)}function _(L){return L===void 0?t.mergedGamepadState.buttonState.released.size>0:Dt(t.mergedGamepadState.buttonState.released,L)}function F(L){return L===void 0?t.buttonState.pressed.size>0:Dt(t.buttonState.pressed,L)}function N(L){return L===void 0?t.buttonState.down.size>0:Dt(t.buttonState.down,L)}function z(L){return L===void 0?t.buttonState.released.size>0:Dt(t.buttonState.released,L)}function V(L){var G;return(G=t.buttons)==null?void 0:G[L]}function U(L,G){t.buttons[L]={...t.buttons[L],...G}}function K(L){t.buttonState.press(L),t.events.trigger("buttonPress",L)}function Y(L){t.buttonState.release(L),t.events.trigger("buttonRelease",L)}function ee(L){return t.events.on("resize",L)}let Z=Me(L=>t.events.on("keyDown",L),(L,G)=>t.events.on("keyDown",Q=>ut(L,Q)&&G(Q))),q=Me(L=>t.events.on("keyPress",G=>L(G)),(L,G)=>t.events.on("keyPress",Q=>ut(L,Q)&&G(Q))),W=Me(L=>t.events.on("keyPressRepeat",L),(L,G)=>t.events.on("keyPressRepeat",Q=>ut(L,Q)&&G(Q))),te=Me(L=>t.events.on("keyRelease",L),(L,G)=>t.events.on("keyRelease",Q=>ut(L,Q)&&G(Q))),se=Me(L=>t.events.on("mouseDown",G=>L(G)),(L,G)=>t.events.on("mouseDown",Q=>ut(L,Q)&&G(Q))),oe=Me(L=>t.events.on("mousePress",G=>L(G)),(L,G)=>t.events.on("mousePress",Q=>ut(L,Q)&&G(Q))),ne=Me(L=>t.events.on("mouseRelease",G=>L(G)),(L,G)=>t.events.on("mouseRelease",Q=>Q===L&&G(Q)));function J(L){return t.events.on("mouseMove",()=>L(R(),b()))}function re(L){return t.events.on("charInput",L)}function le(L){return t.events.on("touchStart",L)}function ce(L){return t.events.on("touchMove",L)}function me(L){return t.events.on("touchEnd",L)}function de(L){return t.events.on("scroll",L)}function be(L){return t.events.on("hide",L)}function ze(L){return t.events.on("show",L)}let Xe=Me(L=>t.events.on("gamepadButtonPress",(G,Q)=>L(G,Q)),(L,G)=>t.events.on("gamepadButtonPress",(Q,ie)=>ut(L,Q)&&G(Q,ie))),lt=Me(L=>t.events.on("gamepadButtonDown",(G,Q)=>L(G,Q)),(L,G)=>t.events.on("gamepadButtonDown",(Q,ie)=>ut(L,Q)&&G(Q,ie))),wt=Me(L=>t.events.on("gamepadButtonRelease",(G,Q)=>L(G,Q)),(L,G)=>t.events.on("gamepadButtonRelease",(Q,ie)=>ut(L,Q)&&G(Q,ie)));function Pn(L,G){return t.events.on("gamepadStick",(Q,ie,fe)=>Q===L&&G(ie,fe))}function xt(L){t.events.on("gamepadConnect",L)}function Le(L){t.events.on("gamepadDisconnect",L)}function Qe(L){return t.mergedGamepadState.stickState.get(L)||new X(0)}function nr(){return[...t.charInputted]}function Be(){return[...t.gamepads]}let Rn=Me(L=>t.events.on("buttonPress",G=>L(G)),(L,G)=>t.events.on("buttonPress",Q=>ut(L,Q)&&G(Q))),vt=Me(L=>t.events.on("buttonDown",G=>L(G)),(L,G)=>t.events.on("buttonDown",Q=>ut(L,Q)&&G(Q))),rr=Me(L=>t.events.on("buttonRelease",G=>L(G)),(L,G)=>t.events.on("buttonRelease",Q=>ut(L,Q)&&G(Q)));function $i(){t.events.trigger("input"),t.keyState.down.forEach(L=>t.events.trigger("keyDown",L)),t.mouseState.down.forEach(L=>t.events.trigger("mouseDown",L)),t.buttonState.down.forEach(L=>{t.events.trigger("buttonDown",L)}),Wi()}function Gi(){t.keyState.update(),t.mouseState.update(),t.buttonState.update(),t.mergedGamepadState.buttonState.update(),t.mergedGamepadState.stickState.forEach((L,G)=>{t.mergedGamepadState.stickState.set(G,new X(0))}),t.charInputted=[],t.isMouseMoved=!1,t.mouseDeltaPos=new X(0),t.gamepadStates.forEach(L=>{L.buttonState.update(),L.stickState.forEach((G,Q)=>{L.stickState.set(Q,new X(0))})})}function Wo(L){let G={index:L.index,isPressed:Q=>{var ie;return((ie=t.gamepadStates.get(L.index))==null?void 0:ie.buttonState.pressed.has(Q))||!1},isDown:Q=>{var ie;return((ie=t.gamepadStates.get(L.index))==null?void 0:ie.buttonState.down.has(Q))||!1},isReleased:Q=>{var ie;return((ie=t.gamepadStates.get(L.index))==null?void 0:ie.buttonState.released.has(Q))||!1},getStick:Q=>{var ie;return((ie=t.gamepadStates.get(L.index))==null?void 0:ie.stickState.get(Q))||$()}};return t.gamepads.push(G),t.gamepadStates.set(L.index,{buttonState:new lo,stickState:new Map([["left",new X(0)],["right",new X(0)]])}),G}function Ki(L){t.gamepads=t.gamepads.filter(G=>G.index!==L.index),t.gamepadStates.delete(L.index)}function Wi(){var L,G;for(let Q of navigator.getGamepads())Q&&!t.gamepadStates.has(Q.index)&&Wo(Q);for(let Q of t.gamepads){let ie=navigator.getGamepads()[Q.index];if(!ie)continue;let fe=(e.gamepads??{})[ie.id]||ld[ie.id]||ld.default,Ae=t.gamepadStates.get(Q.index);if(Ae){for(let Oe=0;Oe<ie.buttons.length;Oe++){let Pe=fe.buttons[Oe],bt=ie.buttons[Oe],ct=t.buttonsByGamepad.has(Pe);if(bt.pressed){if(Ae.buttonState.down.has(Pe)){t.events.trigger("gamepadButtonDown",Pe,Q);continue}t.lastInputDevice="gamepad",ct&&((L=t.buttonsByGamepad.get(Pe))==null||L.forEach(At=>{t.buttonState.press(At),t.events.trigger("buttonPress",At)})),t.mergedGamepadState.buttonState.press(Pe),Ae.buttonState.press(Pe),t.events.trigger("gamepadButtonPress",Pe,Q)}else Ae.buttonState.down.has(Pe)&&(ct&&((G=t.buttonsByGamepad.get(Pe))==null||G.forEach(At=>{t.buttonState.release(At),t.events.trigger("buttonRelease",At)})),t.mergedGamepadState.buttonState.release(Pe),Ae.buttonState.release(Pe),t.events.trigger("gamepadButtonRelease",Pe,Q))}for(let Oe in fe.sticks){let Pe=fe.sticks[Oe];if(!Pe)continue;let bt=new X(ie.axes[Pe.x],ie.axes[Pe.y]);Ae.stickState.set(Oe,bt),t.mergedGamepadState.stickState.set(Oe,bt),t.events.trigger("gamepadStick",Oe,bt,Q)}}}}let Ve={},Hr={},or={},Yo=e.pixelDensity||1;Ve.mousemove=L=>{let G=eM(new X(L.offsetX,L.offsetY)),Q=new X(L.movementX,L.movementY);if(y()){let ie=t.canvas.width/Yo,fe=t.canvas.height/Yo,Ae=window.innerWidth,Oe=window.innerHeight,Pe=Ae/Oe,bt=ie/fe;if(Pe>bt){let ct=Oe/fe,At=(Ae-ie*ct)/2;G.x=Lt(L.offsetX-At,0,ie*ct,0,ie),G.y=Lt(L.offsetY,0,fe*ct,0,fe)}else{let ct=Ae/ie,At=(Oe-fe*ct)/2;G.x=Lt(L.offsetX,0,ie*ct,0,ie),G.y=Lt(L.offsetY-At,0,fe*ct,0,fe)}}t.events.onOnce("input",()=>{t.isMouseMoved=!0,t.mousePos=G,t.mouseDeltaPos=Q,t.events.trigger("mouseMove")})};let Xo=["left","middle","right","back","forward"];Ve.mousedown=L=>{t.events.onOnce("input",()=>{var Q;let G=Xo[L.button];G&&(t.lastInputDevice="mouse",t.buttonsByMouse.has(G)&&((Q=t.buttonsByMouse.get(G))==null||Q.forEach(ie=>{t.buttonState.press(ie),t.events.trigger("buttonPress",ie)})),t.mouseState.press(G),t.events.trigger("mousePress",G))})},Ve.mouseup=L=>{t.events.onOnce("input",()=>{var Q;let G=Xo[L.button];G&&(t.buttonsByMouse.has(G)&&((Q=t.buttonsByMouse.get(G))==null||Q.forEach(ie=>{t.buttonState.release(ie),t.events.trigger("buttonRelease",ie)})),t.mouseState.release(G),t.events.trigger("mouseRelease",G))})};let Yi=new Set([" ","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Tab"]),Vr={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"};Ve.keydown=L=>{Yi.has(L.key)&&L.preventDefault(),t.events.onOnce("input",()=>{var ie,fe;let G=Vr[L.key]||L.key.toLowerCase(),Q=L.code;if(G===void 0)throw new Error(`Unknown key: ${L.key}`);G.length===1?(t.events.trigger("charInput",G),t.charInputted.push(G)):G==="space"&&(t.events.trigger("charInput"," "),t.charInputted.push(" ")),L.repeat?(t.keyState.pressRepeat(G),t.events.trigger("keyPressRepeat",G)):(t.lastInputDevice="keyboard",t.buttonsByKey.has(G)&&((ie=t.buttonsByKey.get(G))==null||ie.forEach(Ae=>{t.buttonState.press(Ae),t.events.trigger("buttonPress",Ae)})),t.buttonsByKeyCode.has(Q)&&((fe=t.buttonsByKeyCode.get(Q))==null||fe.forEach(Ae=>{t.buttonState.press(Ae),t.events.trigger("buttonPress",Ae)})),t.keyState.press(G),t.events.trigger("keyPressRepeat",G),t.events.trigger("keyPress",G))})},Ve.keyup=L=>{t.events.onOnce("input",()=>{var ie,fe;let G=Vr[L.key]||L.key.toLowerCase(),Q=L.code;t.buttonsByKey.has(G)&&((ie=t.buttonsByKey.get(G))==null||ie.forEach(Ae=>{t.buttonState.release(Ae),t.events.trigger("buttonRelease",Ae)})),t.buttonsByKeyCode.has(Q)&&((fe=t.buttonsByKeyCode.get(Q))==null||fe.forEach(Ae=>{t.buttonState.release(Ae),t.events.trigger("buttonRelease",Ae)})),t.keyState.release(G),t.events.trigger("keyRelease",G)})},Ve.touchstart=L=>{L.preventDefault(),t.events.onOnce("input",()=>{var ie;let G=[...L.changedTouches],Q=t.canvas.getBoundingClientRect();e.touchToMouse!==!1&&(t.mousePos=new X(G[0].clientX-Q.x,G[0].clientY-Q.y),t.lastInputDevice="mouse",t.buttonsByMouse.has("left")&&((ie=t.buttonsByMouse.get("left"))==null||ie.forEach(fe=>{t.buttonState.press(fe),t.events.trigger("buttonPress",fe)})),t.mouseState.press("left"),t.events.trigger("mousePress","left")),G.forEach(fe=>{t.events.trigger("touchStart",new X(fe.clientX-Q.x,fe.clientY-Q.y),fe)})})},Ve.touchmove=L=>{L.preventDefault(),t.events.onOnce("input",()=>{let G=[...L.changedTouches],Q=t.canvas.getBoundingClientRect();if(e.touchToMouse!==!1){let ie=t.mousePos;t.mousePos=new X(G[0].clientX-Q.x,G[0].clientY-Q.y),t.mouseDeltaPos=t.mousePos.sub(ie),t.events.trigger("mouseMove")}G.forEach(ie=>{t.events.trigger("touchMove",new X(ie.clientX-Q.x,ie.clientY-Q.y),ie)})})},Ve.touchend=L=>{t.events.onOnce("input",()=>{var ie;let G=[...L.changedTouches],Q=t.canvas.getBoundingClientRect();e.touchToMouse!==!1&&(t.mousePos=new X(G[0].clientX-Q.x,G[0].clientY-Q.y),t.mouseDeltaPos=new X(0,0),t.buttonsByMouse.has("left")&&((ie=t.buttonsByMouse.get("left"))==null||ie.forEach(fe=>{t.buttonState.release(fe),t.events.trigger("buttonRelease",fe)})),t.mouseState.release("left"),t.events.trigger("mouseRelease","left")),G.forEach(fe=>{t.events.trigger("touchEnd",new X(fe.clientX-Q.x,fe.clientY-Q.y),fe)})})},Ve.touchcancel=L=>{t.events.onOnce("input",()=>{let G=[...L.changedTouches],Q=t.canvas.getBoundingClientRect();e.touchToMouse!==!1&&(t.mousePos=new X(G[0].clientX-Q.x,G[0].clientY-Q.y),t.mouseState.release("left"),t.events.trigger("mouseRelease","left")),G.forEach(ie=>{t.events.trigger("touchEnd",new X(ie.clientX-Q.x,ie.clientY-Q.y),ie)})})},Ve.wheel=L=>{L.preventDefault(),t.events.onOnce("input",()=>{t.events.trigger("scroll",new X(L.deltaX,L.deltaY))})},Ve.contextmenu=L=>L.preventDefault(),Hr.visibilitychange=()=>{document.visibilityState==="visible"?(t.skipTime=!0,t.isHidden=!1,t.events.trigger("show")):(t.isHidden=!0,t.events.trigger("hide"))},or.gamepadconnected=L=>{let G=Wo(L.gamepad);t.events.onOnce("input",()=>{t.events.trigger("gamepadConnect",G)})},or.gamepaddisconnected=L=>{let G=Be().filter(Q=>Q.index===L.gamepad.index)[0];Ki(L.gamepad),t.events.onOnce("input",()=>{t.events.trigger("gamepadDisconnect",G)})};for(let[L,G]of Object.entries(Ve))t.canvas.addEventListener(L,G);for(let[L,G]of Object.entries(Hr))document.addEventListener(L,G);for(let[L,G]of Object.entries(or))window.addEventListener(L,G);let Qo=new ResizeObserver(L=>{for(let G of L)if(G.target===t.canvas){if(t.lastWidth===t.canvas.offsetWidth&&t.lastHeight===t.canvas.offsetHeight)return;t.lastWidth=t.canvas.offsetWidth,t.lastHeight=t.canvas.offsetHeight,t.events.onOnce("input",()=>{t.events.trigger("resize")})}});return Qo.observe(t.canvas),{state:t,dt:n,fixedDt:r,restDt:o,time:i,run:w,canvas:t.canvas,fps:a,numFrames:l,quit:A,isHidden:s,setFullscreen:g,isFullscreen:y,setCursor:d,screenshot:c,getGamepads:Be,getCursor:f,setCursorLocked:u,isCursorLocked:h,isTouchscreen:E,mousePos:R,mouseDeltaPos:b,isKeyDown:j,isKeyPressed:D,isKeyPressedRepeat:B,isKeyReleased:P,isMouseDown:C,isMousePressed:v,isMouseReleased:T,isMouseMoved:k,isGamepadButtonPressed:O,isGamepadButtonDown:I,isGamepadButtonReleased:_,getGamepadStick:Qe,isButtonPressed:F,isButtonDown:N,isButtonReleased:z,setButton:U,getButton:V,pressButton:K,releaseButton:Y,charInputted:nr,onResize:ee,onKeyDown:Z,onKeyPress:q,onKeyPressRepeat:W,onKeyRelease:te,onMouseDown:se,onMousePress:oe,onMouseRelease:ne,onMouseMove:J,onCharInput:re,onTouchStart:le,onTouchMove:ce,onTouchEnd:me,onScroll:de,onHide:be,onShow:ze,onGamepadButtonDown:lt,onGamepadButtonPress:Xe,onGamepadButtonRelease:wt,onGamepadStick:Pn,onGamepadConnect:xt,onGamepadDisconnect:Le,onButtonPress:Rn,onButtonDown:vt,onButtonRelease:rr,getLastInputDeviceType:tM,events:t.events}};function qe(){return M.app.dt()}function rl(){return M.app.fixedDt()}function ol(){return M.app.restDt()}var aM=new X(-1,-1),lM=new X(0,-1),cM=new X(1,-1),uM=new X(-1,0),dM=new X(0,0),fM=new X(1,0),hM=new X(-1,1),pM=new X(0,1),gM=new X(1,1);function Br(e){switch(e){case"topleft":return aM;case"top":return lM;case"topright":return cM;case"left":return uM;case"center":return dM;case"right":return fM;case"botleft":return hM;case"bot":return pM;case"botright":return gM;default:return e}}function mM(e){switch(e){case"left":return 0;case"center":return .5;case"right":return 1;default:return 0}}function yM(e){return e.createBuffer(1,1,44100)}var us=2.5949095,cd=1.70158+1,ud=2*Math.PI/3,dd=2*Math.PI/4.5,As={linear:e=>e,easeInSine:e=>1-Math.cos(e*Math.PI/2),easeOutSine:e=>Math.sin(e*Math.PI/2),easeInOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,easeInQuad:e=>e*e,easeOutQuad:e=>1-(1-e)*(1-e),easeInOutQuad:e=>e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2,easeInCubic:e=>e*e*e,easeOutCubic:e=>1-Math.pow(1-e,3),easeInOutCubic:e=>e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1-Math.pow(1-e,4),easeInOutQuart:e=>e<.5?8*e*e*e*e:1-Math.pow(-2*e+2,4)/2,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1-Math.pow(1-e,5),easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2,easeInExpo:e=>e===0?0:Math.pow(2,10*e-10),easeOutExpo:e=>e===1?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>e===0?0:e===1?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2,easeInCirc:e=>1-Math.sqrt(1-Math.pow(e,2)),easeOutCirc:e=>Math.sqrt(1-Math.pow(e-1,2)),easeInOutCirc:e=>e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2,easeInBack:e=>cd*e*e*e-1.70158*e*e,easeOutBack:e=>1+cd*Math.pow(e-1,3)+1.70158*Math.pow(e-1,2),easeInOutBack:e=>e<.5?Math.pow(2*e,2)*((us+1)*2*e-us)/2:(Math.pow(2*e-2,2)*((us+1)*(e*2-2)+us)+2)/2,easeInElastic:e=>e===0?0:e===1?1:-Math.pow(2,10*e-10)*Math.sin((e*10-10.75)*ud),easeOutElastic:e=>e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e*10-.75)*ud)+1,easeInOutElastic:e=>e===0?0:e===1?1:e<.5?-(Math.pow(2,20*e-10)*Math.sin((20*e-11.125)*dd))/2:Math.pow(2,-20*e+10)*Math.sin((20*e-11.125)*dd)/2+1,easeInBounce:e=>1-As.easeOutBounce(1-e),easeOutBounce:e=>e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,easeInOutBounce:e=>e<.5?(1-As.easeOutBounce(1-2*e))/2:(1+As.easeOutBounce(2*e-1))/2},Po=As;function wM(e,t,n){let r=[],o=t;for(r.push(o);o!==e;){if(o=n.get(o),o==null)return null;r.push(o)}return r.reverse()}function xM(e,t,n){var i;let r=new Sp((a,l)=>a.cost<l.cost);r.insert({cost:0,node:t});let o=new Map;o.set(t,t);let s=new Map;for(s.set(t,0);r.length!==0;){let a=(i=r.remove())==null?void 0:i.node;if(a===n)break;let l=e.getNeighbours(a);for(let c of l){let d=(s.get(a)||0)+e.getCost(a,c)+e.getHeuristic(c,n);(!s.has(c)||d<s.get(c))&&(s.set(c,d),r.insert({cost:d,node:c}),o.set(c,a))}}return wM(t,n,o)}var vM=class{constructor(e,t,n){H(this,"a");H(this,"b");H(this,"polygon");this.a=e,this.b=t,this.polygon=new WeakRef(n)}isLeft(e,t){return(this.b.x-this.a.x)*(t-this.a.y)-(e-this.a.x)*(this.b.y-this.a.y)}get middle(){return this.a.add(this.b).scale(.5)}},bM=class{constructor(e){H(this,"_edges");H(this,"_centroid");H(this,"_id");this._id=e}get id(){return this._id}set edges(e){this._edges=e;let t=0,n=0,r=0;for(let o of this._edges){o.polygon=new WeakRef(this);let s=o.a.x*o.b.y-o.a.y*o.b.x;t+=(o.a.x+o.b.x)*s,n+=(o.a.y+o.b.y)*s,r+=s}r/=2,this._centroid=$(t/(6*r),n/(6*r))}get edges(){return this._edges}get centroid(){return this._centroid}contains(e){let t=!1;for(let n of this.edges)n.b.y>e.y!=n.a.y>e.y&&e.x<(n.a.x-n.b.x)*(e.y-n.b.y)/(n.a.y-n.b.y)+n.b.x&&(t=!t);return t}},AM=class{constructor(){H(this,"_polygons");H(this,"_pointCache");H(this,"_edgeCache");this._polygons=[],this._pointCache={},this._edgeCache={}}_addPoint(e){let t=this._pointCache[`${e.x}_${e.y}`];return t||(t=e.clone(),this._pointCache[`${e.x}_${e.y}`]=t,t)}_addEdge(e){let t=`${e.a.x}_${e.a.y}-${e.b.x}_${e.b.y}`;return this._edgeCache[t]=e,e}_findEdge(e,t){let n=`${e.x}_${e.y}-${t.x}_${t.y}`;return this._edgeCache[n]}_findCommonEdge(e,t){for(let n of e.edges){let r=this._findEdge(n.b,n.a);if(r&&r.polygon.deref().id===t.id)return r}return null}addPolygon(e){let t=new bM(this._polygons.length),n=e.map((r,o)=>new vM(r,e[(o+1)%e.length],t));t.edges=n,this._polygons.push(t);for(let r of t.edges)this._addEdge(r);return t}addRect(e,t){let n=this._addPoint(e),r=this._addPoint(e.add(t.x,0)),o=this._addPoint(e.add(t)),s=this._addPoint(e.add(0,t.y));return this.addPolygon([n,r,o,s])}_getLocation(e){for(let t of this._polygons)if(t.contains(e))return t;return null}getNeighbours(e){let t=[];for(let n of this._polygons[e].edges){let r=this._findEdge(n.b,n.a);if(r){let o=r.polygon.deref();o&&t.push(o.id)}}return t}getCost(e,t){return 1}getHeuristic(e,t){let n=this._polygons[e],r=this._polygons[t],o=n.centroid.x-r.centroid.x,s=n.centroid.y-r.centroid.y;return Math.sqrt(o*o+s*s)}getPath(e,t){return e===void 0||t===void 0?[]:e===t?[e,t]:xM(this,e,t)}getWaypointPath(e,t,n){let r=(n==null?void 0:n.type)||"centroids",o=this._getLocation(e),s=this._getLocation(t);if(o===void 0||s===void 0)return[];let i=this.getPath(o.id,s.id);if(!i)return[];if(r==="edges"){let a=[];for(let l=1;l<i.length;l++){let c=this._polygons[i[l-1]],d=this._polygons[i[l]],f=this._findCommonEdge(c,d);a.push(f.middle.add(d.centroid.sub(f.middle).unit().scale(4)))}return[e,...a,t]}else return[e,...i.slice(1,-1).map(a=>this._polygons[a].centroid),t]}};function co(e){let t=new jt;return e.pos&&t.translate(e.pos),e.scale&&t.scale(e.scale),e.angle&&t.rotate(e.angle),e.parent?t.mult(e.parent.transform):t}function EM(e){return new X(e.x/He()*2-1,-e.y/Ue()*2+1)}function to(e,t,n,r,o,s=1){r=De(r%360),o=De(o%360),o<=r&&(o+=Math.PI*2);let i=[],a=Math.ceil((o-r)/De(8)*s),l=(o-r)/a,c=$(Math.cos(r),Math.sin(r)),d=$(Math.cos(l),Math.sin(l));for(let f=0;f<=a;f++)i.push(e.add(t*c.x,n*c.y)),c=$(c.x*d.x-c.y*d.y,c.x*d.y+c.y*d.x);return i}function SM(...e){let t=we(...e),n=e[3]??1;M.gfx.bgColor=t,M.gfx.bgAlpha=n,M.gfx.ggl.gl.clearColor(t.r/255,t.g/255,t.b/255,n)}function MM(){var e,t;return((t=(e=M.gfx.bgColor)==null?void 0:e.clone)==null?void 0:t.call(e))??null}function Te(...e){if(e[0]===void 0)return;let t=$(...e);t.x===0&&t.y===0||M.gfx.transform.translate(t)}function dt(){M.gfx.transformStack.push(M.gfx.transform.clone())}function CM(e){M.gfx.transform=e.clone()}function Ro(...e){if(e[0]===void 0)return;let t=$(...e);t.x===1&&t.y===1||M.gfx.transform.scale(t)}function kr(e){e&&M.gfx.transform.rotate(e)}function tt(){M.gfx.transformStack.length>0&&(M.gfx.transform=M.gfx.transformStack.pop())}function ft(){M.gfx.renderer.flush()}function He(){return M.gfx.width}function Ue(){return M.gfx.height}function Rp(){return(M.gfx.viewport.width+M.gfx.viewport.height)/(M.gfx.width+M.gfx.height)}function Qs(){return $(He()/2,Ue()/2)}var PM=class{constructor(e,t,n,r){H(this,"lastTextureId",0);H(this,"textures",[]);H(this,"bigTextures",[]);H(this,"texturesPosition",new Map);H(this,"canvas");H(this,"c2d");H(this,"x",0);H(this,"y",0);H(this,"curHeight",0);H(this,"gfx");H(this,"padding");this.gfx=e,this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=n,this.textures=[gn.fromImage(e,this.canvas)],this.bigTextures=[],this.padding=r;let o=this.canvas.getContext("2d");if(!o)throw new Error("Failed to get 2d context");this.c2d=o}add_single(e){let t=gn.fromImage(this.gfx,e);return this.bigTextures.push(t),[t,new Ie(0,0,1,1),0]}add(e){let t=e.width+this.padding*2,n=e.height+this.padding*2;(t>this.canvas.width||n>this.canvas.height)&&this.add_single(e),this.x+t>this.canvas.width&&(this.x=0,this.y+=this.curHeight,this.curHeight=0),this.y+n>this.canvas.height&&(this.c2d.clearRect(0,0,this.canvas.width,this.canvas.height),this.textures.push(gn.fromImage(this.gfx,this.canvas)),this.x=0,this.y=0,this.curHeight=0);let r=this.textures[this.textures.length-1],o=new X(this.x+this.padding,this.y+this.padding);return this.x+=t,n>this.curHeight&&(this.curHeight=n),e instanceof ImageData?this.c2d.putImageData(e,o.x,o.y):this.c2d.drawImage(e,o.x,o.y),r.update(this.canvas),this.texturesPosition.set(this.lastTextureId,{position:o,size:new X(e.width,e.height),texture:r}),this.lastTextureId++,[r,new Ie(o.x/this.canvas.width,o.y/this.canvas.height,e.width/this.canvas.width,e.height/this.canvas.height),this.lastTextureId-1]}free(){for(let e of this.textures)e.free();for(let e of this.bigTextures)e.free()}};function mt(e){return typeof e!="string"||Cp(e)?e:M.assets.urlPrefix+e}var yt=class Ip{constructor(t){H(this,"loaded",!1);H(this,"data",null);H(this,"error",null);H(this,"onLoadEvents",new We);H(this,"onErrorEvents",new We);H(this,"onFinishEvents",new We);t.then(n=>{this.loaded=!0,this.data=n,this.onLoadEvents.trigger(n)}).catch(n=>{if(this.error=n,this.onErrorEvents.numListeners()>0)this.onErrorEvents.trigger(n);else throw n}).finally(()=>{this.onFinishEvents.trigger(),this.loaded=!0})}static loaded(t){let n=new Ip(Promise.resolve(t));return n.data=t,n.loaded=!0,n}onLoad(t){return this.loaded&&this.data?t(this.data):this.onLoadEvents.add(t),this}onError(t){return this.loaded&&this.error?t(this.error):this.onErrorEvents.add(t),this}onFinish(t){return this.loaded?t():this.onFinishEvents.add(t),this}then(t){return this.onLoad(t)}catch(t){return this.onError(t)}finally(t){return this.onFinish(t)}},ar=class{constructor(){H(this,"assets",new Map);H(this,"lastUID",0)}add(e,t){let n=e??this.lastUID+++"",r=new yt(t);return this.assets.set(n,r),r}addLoaded(e,t){let n=e??this.lastUID+++"",r=yt.loaded(t);return this.assets.set(n,r),r}get(e){return this.assets.get(e)}progress(){if(this.assets.size===0)return 1;let e=0;return this.assets.forEach(t=>{t.loaded&&e++}),e/this.assets.size}getFailedAssets(){return Array.from(this.assets.keys()).filter(e=>this.assets.get(e).error!==null).map(e=>[e,this.assets.get(e)])}};function rc(e){return fetch(e).then(t=>{if(!t.ok)throw new Error(`Failed to fetch "${e}"`);return t})}function Ti(e){return rc(e).then(t=>t.json())}function RM(e){return rc(e).then(t=>t.text())}function IM(e){return rc(e).then(t=>t.arrayBuffer())}function NM(e){return e!==void 0&&(M.assets.urlPrefix=e),M.assets.urlPrefix}function TM(e,t){return M.assets.custom.add(e,Ti(mt(t)))}function ki(e){let t=new Image;return t.crossOrigin="anonymous",t.src=e,new Promise((n,r)=>{t.onload=()=>n(t),t.onerror=()=>r(new Error(`Failed to load image from "${e}"`))})}function Un(){let e=[M.assets.sprites,M.assets.sounds,M.assets.shaders,M.assets.fonts,M.assets.bitmapFonts,M.assets.custom];return e.reduce((t,n)=>t+n.progress(),0)/e.length}function Np(){return[M.assets.sprites,M.assets.sounds,M.assets.shaders,M.assets.fonts,M.assets.bitmapFonts,M.assets.custom].reduce((e,t)=>e.concat(t.getFailedAssets()),[])}function kM(e){return M.assets.custom.get(e)??null}function sl(e){return M.assets.custom.add(null,e)}var _M=(e,t)=>({urlPrefix:"",sprites:new ar,fonts:new ar,bitmapFonts:new ar,sounds:new ar,shaders:new ar,custom:new ar,music:{},packer:new PM(e,2048,2048,t),loaded:!1}),DM="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA1CAYAAADyMeOEAAAAAXNSR0IArs4c6QAAAoVJREFUaIHdm7txwkAQhheGAqACiCHzOKQDQrqgILpwSAeEDBnEUAF0gCMxZ7G72qce/mec2Lpf9+3unaS78wgSNZ8uX5729+d1FNWXUuGmXlBOUUEIMckEpeQJgBu6C+BSFngztBR2vd+ovY+7g+p6LbgaWgJrAeUkDYIUXgXdBBwNi6kpABJwMTQH3AZsXRR8GHTfgEth8E3gjdAUcNewpbTgY85sCMCUuOokozE0YM0YRzM9NGAAXd8+omAF5h4lnmBRvpSnZHyLoLEbaN+aKB9KWv/KWw0tAbbANnlG+UvB2dm77NxxdwgBpjrF/d7rW9cbmpvio2A5z8iAYpVU8pGZlo6/2+MSco2lHfd3rv9jAP038e1xef9o2mjvYb2OqpqKE81028/jeietlSEVO5FRWsxWsJit1G3aFpW8iWe5RwpiCZAk25QvV6nz6fIlynRGuTd5WqpJ4guAlDfVKBK87hXljflgv1ON6fV+4+5gVlA17SfeG0heKqQd4l4jI/wrmaA9N9R4ar+wpHJDZyrrfcH0nB66PqAzPi76pn+faSyJk/vzOorYhGurQrzj/P68jtBMawHaHBIR9xoD5O34dy0qQOSYHvqExq2TpT2nf76+w7y251OYF0CRaU+J920TwLUa6inx6OxE6g80lu2ux7Y2eJLF/rCXE6zEPdnenk9o+4ih9AEdnW2q81HXl5LuU6OTl2fXUhqganbXAGq3g6jJOWV/OnoesO6YqqEB/GdNsjf7uHtwj2DzmRNpp7iOZfm6D9oAxB6Yi1gC4oIYeo4MIPdopEQRB+cAko5J1tW386HpB2Kz1eop4Epdwls/kgZ1sh8gZsEjdcWkr//D8Qu3Z3l5Nl1NtAAAAABJRU5ErkJggg==",xn=class no{constructor(t,n,r={},o=null){H(this,"tex");H(this,"frames",[new Ie(0,0,1,1)]);H(this,"anims",{});H(this,"slice9",null);this.tex=t,n&&(this.frames=n),this.anims=r,this.slice9=o}get width(){return this.tex.width*this.frames[0].w}get height(){return this.tex.height*this.frames[0].h}static from(t,n={}){return typeof t=="string"?no.fromURL(t,n):Promise.resolve(no.fromImage(t,n))}static fromImage(t,n={}){let[r,o]=n.singular?M.assets.packer.add_single(t):M.assets.packer.add(t),s=n.frames?n.frames.map(i=>new Ie(o.x+i.x*o.w,o.y+i.y*o.h,i.w*o.w,i.h*o.h)):kp(n.sliceX||1,n.sliceY||1,o.x,o.y,o.w,o.h);return new no(r,s,n.anims,n.slice9)}static fromURL(t,n={}){return ki(t).then(r=>no.fromImage(r,n))}};function Es(e){if(typeof e=="string"){let t=Tp(e);if(t)return t;if(Un()<1)return null;throw new Error(`Sprite not found: ${e}`)}else{if(e instanceof xn)return yt.loaded(e);if(e instanceof yt)return e;throw new Error(`Invalid sprite: ${e}`)}}function Tp(e){return M.assets.sprites.get(e)??null}function uo(e,t,n={sliceX:1,sliceY:1,anims:{}}){return t=mt(t),Array.isArray(t)?t.some(r=>typeof r=="string")?M.assets.sprites.add(e,Promise.all(t.map(r=>typeof r=="string"?ki(r):Promise.resolve(r))).then(r=>fd(r,n))):M.assets.sprites.addLoaded(e,fd(t,n)):typeof t=="string"?M.assets.sprites.add(e,xn.from(t,n)):M.assets.sprites.addLoaded(e,xn.fromImage(t,n))}function kp(e=1,t=1,n=0,r=0,o=1,s=1){let i=[],a=o/e,l=s/t;for(let c=0;c<t;c++)for(let d=0;d<e;d++)i.push(new Ie(n+d*a,r+c*l,a,l));return i}function fd(e,t={}){let n=document.createElement("canvas"),r=e[0].width,o=e[0].height;n.width=r*e.length,n.height=o;let s=n.getContext("2d");if(!s)throw new Error("Failed to create canvas context");e.forEach((a,l)=>{a instanceof ImageData?s.putImageData(a,l*r,0):s.drawImage(a,l*r,0)});let i=s.getImageData(0,0,e.length*r,o);return xn.fromImage(i,{...t,sliceX:e.length,sliceY:1})}function OM(e="bean"){return uo(e,DM)}function LM(e,t,n){t=mt(t),n=mt(n),typeof t=="string"&&!n&&(n=BS(t)+".json");let r=typeof n=="string"?Ti(n):Promise.resolve(n);return M.assets.sprites.add(e,r.then(o=>{let s=o.meta.size,i=o.frames.map(l=>new Ie(l.frame.x/s.w,l.frame.y/s.h,l.frame.w/s.w,l.frame.h/s.h)),a={};for(let l of o.meta.frameTags)l.from===l.to?a[l.name]=l.from:a[l.name]={from:l.from,to:l.to,speed:10,loop:!0,pingpong:l.direction==="pingpong"};return xn.from(t,{frames:i,anims:a})}))}var Ss=class{constructor(e,t={}){H(this,"fontface");H(this,"filter",Ja);H(this,"outline",null);H(this,"size",64);if(this.fontface=e,this.filter=t.filter??Ja,this.size=t.size??64,this.size>256)throw new Error("Max font size: 256");t.outline&&(this.outline={width:1,color:we(0,0,0)},typeof t.outline=="number"?this.outline.width=t.outline:typeof t.outline=="object"&&(t.outline.width&&(this.outline.width=t.outline.width),t.outline.color&&(this.outline.color=t.outline.color)))}};function _p(e){if(!e)return _p(M.globalOpt.font??bS);if(typeof e=="string"){let t=Op(e),n=Dp(e);if(t)return t.data??t;if(n)return n.data??n;if(document.fonts.check(`64px ${e}`))return e;if(Un()<1)return null;throw new Error(`Font not found: ${e}`)}else if(e instanceof yt)return e.data?e.data:e;return e}function Dp(e){return M.assets.fonts.get(e)??null}function BM(e,t,n={}){let r=mt(t),o=new FontFace(e,typeof t=="string"?`url(${r})`:r);return document.fonts.add(o),M.assets.fonts.add(e,o.load().catch(s=>{throw new Error(`Failed to load font from "${r}": ${s}`)}).then(s=>new Ss(s,n)))}function FM(e,t,n,r){let o=e.width/t,s={},i=r.split("").entries();for(let[a,l]of i)s[l]=new Ie(a%o*t,Math.floor(a/o)*n,t,n);return{tex:e,map:s,size:n}}function Op(e){return M.assets.bitmapFonts.get(e)??null}function jM(e,t,n,r,o={}){let s=mt(t);return M.assets.bitmapFonts.add(e,ki(s).then(i=>FM(gn.fromImage(M.gfx.ggl,i,o),n,r,o.chars??xp)))}function qM(e,t){return t=mt(t),M.assets.sprites.add(e,new Promise(async n=>{let r=typeof t=="string"?await Ti(t):t,o=await Promise.all(r.frames.map(ki)),s=document.createElement("canvas");s.width=r.width,s.height=r.height*r.frames.length;let i=s.getContext("2d");if(!i)throw new Error("Failed to create canvas context");o.forEach((l,c)=>{i.drawImage(l,0,c*r.height)});let a=await uo(null,s,{sliceY:r.frames.length,anims:r.anims});n(a)}))}var zM=class{constructor(e,t,n,r){H(this,"ctx");H(this,"glProgram");this.ctx=e,e.onDestroy(()=>this.free());let o=e.gl,s=o.createShader(o.VERTEX_SHADER),i=o.createShader(o.FRAGMENT_SHADER);if(!s||!i)throw new Error("Failed to create shader");o.shaderSource(s,t),o.shaderSource(i,n),o.compileShader(s),o.compileShader(i);let a=o.createProgram();if(this.glProgram=a,o.attachShader(a,s),o.attachShader(a,i),r.forEach((l,c)=>o.bindAttribLocation(a,c,l)),o.linkProgram(a),!o.getProgramParameter(a,o.LINK_STATUS)){let l=o.getShaderInfoLog(s);if(l)throw new Error("VERTEX SHADER "+l);let c=o.getShaderInfoLog(i);if(c)throw new Error("FRAGMENT SHADER "+c)}o.deleteShader(s),o.deleteShader(i)}bind(){this.ctx.pushProgram(this.glProgram)}unbind(){this.ctx.popProgram()}send(e){let t=this.ctx.gl;for(let n in e){let r=e[n],o=t.getUniformLocation(this.glProgram,n);if(typeof r=="number")t.uniform1f(o,r);else if(r instanceof jt)t.uniformMatrix4fv(o,!1,new Float32Array(r.m));else if(r instanceof pe)t.uniform3f(o,r.r,r.g,r.b);else if(r instanceof X)t.uniform2f(o,r.x,r.y);else if(Array.isArray(r))r[0],_S(r)?t.uniform1fv(o,r):kS(r)?t.uniform2fv(o,r.map(s=>[s.x,s.y]).flat()):TS(r)&&t.uniform3fv(o,r.map(s=>[s.r,s.g,s.b]).flat());else throw new Error("Unsupported uniform data type")}}free(){this.ctx.gl.deleteProgram(this.glProgram)}};function oc(e,t=el,n=tl){let r=MS.replace("{{user}}",t??el),o=CS.replace("{{user}}",n??tl);try{return new zM(e,r,o,Jl.map(s=>s.name))}catch(s){let i=/(?<type>^\w+) SHADER ERROR: 0:(?<line>\d+): (?<msg>.+)/,a=FS(s).match(i);if(!(a!=null&&a.groups))throw s;let l=Number(a.groups.line)-14,c=a.groups.msg.trim(),d=a.groups.type.toLowerCase();throw new Error(`${d} shader line ${l}: ${c}`)}}function HM(e){if(!e)return M.gfx.defShader;if(typeof e=="string"){let t=Lp(e);if(t)return t.data??t;if(Un()<1)return null;throw new Error(`Shader not found: ${e}`)}else if(e instanceof yt)return e.data?e.data:e;return e}function Lp(e){return M.assets.shaders.get(e)??null}function VM(e,t,n){return M.assets.shaders.addLoaded(e,oc(M.gfx.ggl,t,n))}function UM(e,t,n){t=mt(t),n=mt(n);let r=s=>s?RM(s):Promise.resolve(null),o=Promise.all([r(t),r(n)]).then(([s,i])=>oc(M.gfx.ggl,s,i));return M.assets.shaders.add(e,o)}var Io=class Ms{constructor(t){H(this,"buf");this.buf=t}static fromArrayBuffer(t){return new Promise((n,r)=>M.audio.ctx.decodeAudioData(t,n,r)).then(n=>new Ms(n))}static fromURL(t){return Cp(t)?Ms.fromArrayBuffer(OS(t)):IM(t).then(n=>Ms.fromArrayBuffer(n))}};function $M(e){if(typeof e=="string"){let t=Bp(e);if(t)return t;if(Un()<1)return null;throw new Error(`Sound not found: ${e}`)}else{if(e instanceof Io)return yt.loaded(e);if(e instanceof yt)return e;throw new Error(`Invalid sound: ${e}`)}}function Bp(e){return M.assets.sounds.get(e)??null}function GM(e,t){return t=mt(t),M.assets.sounds.add(e,typeof t=="string"?Io.fromURL(t):Io.fromArrayBuffer(t))}function KM(e,t){let n=mt(t),r=new Audio(n);return r.preload="auto",M.assets.music[e]=n}function Fp(e,t){return e=mt(e),sl(typeof t=="string"?new Promise((n,r)=>{Ti(t).then(o=>{Fp(e,o).then(n).catch(r)})}):xn.from(e).then(n=>{let r={};for(let o in t){let s=t[o],i=n.frames[0],a=2048*i.w,l=2048*i.h,c=s.frames?s.frames.map(f=>new Ie(i.x+(s.x+f.x)/a*i.w,i.y+(s.y+f.y)/l*i.h,f.w/a*i.w,f.h/l*i.h)):kp(s.sliceX||1,s.sliceY||1,i.x+s.x/a*i.w,i.y+s.y/l*i.h,s.width/a*i.w,s.height/l*i.h),d=new xn(n.tex,c,s.anims);M.assets.sprites.addLoaded(o,d),r[o]=d}return r}))}function En(e,t,n=!1,r,o,s={}){let i=r??M.gfx.defTex,a=o??M.gfx.defShader,l=HM(a);if(!l||l instanceof yt)return;let c=M.gfx.fixed||n?M.gfx.transform:M.game.cam.transform.mult(M.gfx.transform),d=[];for(let f of e){let u=EM(c.multVec2(f.pos));d.push(u.x,u.y,f.uv.x,f.uv.y,f.color.r/255,f.color.g/255,f.color.b/255,f.opacity)}M.gfx.renderer.push(M.gfx.ggl.gl.TRIANGLES,d,t,l,i,s)}function pn(e){if(!e.pts)throw new Error('drawPolygon() requires property "pts".');let t=e.pts.length;if(!(t<3)){if(dt(),Te(e.pos),Ro(e.scale),kr(e.angle),Te(e.offset),e.fill!==!1){let n=e.color??pe.WHITE,r=e.pts.map((s,i)=>({pos:new X(s.x,s.y),uv:e.uv?e.uv[i]:new X(0,0),color:e.colors&&e.colors[i]?e.colors[i].mult(n):n,opacity:e.opacity??1})),o;e.triangulate?o=wp(e.pts).map(s=>s.map(i=>e.pts.indexOf(i))).flat():o=[...Array(t-2).keys()].map(s=>[0,s+1,s+2]).flat(),En(r,e.indices??o,e.fixed,e.uv?e.tex:M.gfx.defTex,e.shader,e.uniform??void 0)}e.outline&&sc({pts:[...e.pts,e.pts[0]],radius:e.radius,width:e.outline.width,color:e.outline.color,join:e.outline.join,uniform:e.uniform,fixed:e.fixed,opacity:e.opacity??e.outline.opacity}),tt()}}function jp(e){if(e.radiusX===void 0||e.radiusY===void 0)throw new Error('drawEllipse() requires properties "radiusX" and "radiusY".');if(e.radiusX===0||e.radiusY===0)return;let t=e.start??0,n=e.end??360,r=Br(e.anchor??"center").scale(new X(-e.radiusX,-e.radiusY)),o=to(r,e.radiusX,e.radiusY,t,n,e.resolution);o.unshift(r);let s=Object.assign({},e,{pts:o,radius:0,...e.gradient?{colors:[e.gradient[0],...Array(o.length-1).fill(e.gradient[1])]}:{}});if(n-t>=360&&e.outline){e.fill!==!1&&pn(Object.assign({},s,{outline:null})),pn(Object.assign({},s,{pts:o.slice(1),fill:!1}));return}pn(s)}function Fr(e){if(typeof e.radius!="number")throw new Error('drawCircle() requires property "radius".');e.radius!==0&&jp(Object.assign({},e,{radiusX:e.radius,radiusY:e.radius,angle:0}))}function ro(e){let{p1:t,p2:n}=e;if(!t||!n)throw new Error('drawLine() requires properties "p1" and "p2".');let r=e.width||1,o=n.sub(t).unit().normal().scale(r*.5),s=[t.sub(o),t.add(o),n.add(o),n.sub(o)].map(i=>({pos:new X(i.x,i.y),uv:new X(0),color:e.color??pe.WHITE,opacity:e.opacity??1}));En(s,[0,1,3,1,2,3],e.fixed,M.gfx.defTex,e.shader,e.uniform??void 0)}function WM(e){let t=e.pts,n=[],r=(e.width||1)*.5,o=t[0]===t[t.length-1]||t[0].eq(t[t.length-1]),s=e.pos||$(0,0),i;o?i=t[0].sub(t[t.length-2]):i=t[1].sub(t[0]);let a=i.len(),l=i.normal().scale(-r/a),c,d=t[0];if(!o)switch(e.cap){case"square":{let p=i.scale(-r/a);n.push(d.add(p).add(l)),n.push(d.add(p).sub(l));break}case"round":{let p=Math.max(r,10),m=Math.PI/p,g=l.scale(-1),y=Math.cos(m),A=Math.sin(m);for(let w=0;w<p;w++)n.push(d),n.push(d.sub(g)),g=$(g.x*y-g.y*A,g.x*A+g.y*y)}}for(let p=1;p<t.length;p++){if(d===t[p]||d.eq(t[p]))continue;c=d,d=t[p];let m=d.sub(c),g=m.len(),y=m.normal().scale(-r/g),A=i.cross(m);if(Math.abs(A)/(a*g)<.05){n.push(c.add(l)),n.push(c.sub(l)),i.dot(m)<0&&(n.push(c.sub(l)),n.push(c.add(l))),i=m,a=g,l=y;continue}let w=y.sub(l).cross(m)/A,E=l.add(i.scale(w));A>0?(n.push(c.add(E)),n.push(c.sub(l)),n.push(c.add(E)),n.push(c.sub(y))):(n.push(c.add(l)),n.push(c.sub(E)),n.push(c.add(y)),n.push(c.sub(E))),i=m,a=g,l=y}if(!o)switch(n.push(d.add(l)),n.push(d.sub(l)),e.cap){case"square":{let p=i.scale(r/a);n.push(d.add(p).add(l)),n.push(d.add(p).sub(l));break}case"round":{let p=Math.max(r,10),m=Math.PI/p,g=l.scale(1),y=Math.cos(m),A=Math.sin(m);for(let w=0;w<p;w++)g=$(g.x*y-g.y*A,g.x*A+g.y*y),n.push(d),n.push(d.sub(g))}}if(n.length<4)return;let f=n.map(p=>({pos:s.add(p),uv:$(),color:e.color||pe.WHITE,opacity:e.opacity??1})),u=[],h=0;for(let p=0;p<n.length-2;p+=2)u[h++]=p+1,u[h++]=p,u[h++]=p+2,u[h++]=p+2,u[h++]=p+3,u[h++]=p+1;o&&(u[h++]=n.length-1,u[h++]=n.length-2,u[h++]=0,u[h++]=0,u[h++]=1,u[h++]=n.length-1),En(f,u,e.fixed,M.gfx.defTex,e.shader,e.uniform??void 0)}function YM(e){let t=e.pts,n=[],r=(e.width||1)*.5,o=t[0]===t[t.length-1]||t[0].eq(t[t.length-1]),s=e.pos||$(0,0),i;o?i=t[0].sub(t[t.length-2]):i=t[1].sub(t[0]);let a=i.len(),l=i.normal().scale(-r/a),c,d=t[0];if(!o)switch(e.cap){case"square":{let p=i.scale(-r/a);n.push(d.add(p).add(l)),n.push(d.add(p).sub(l));break}case"round":{let p=Math.max(r,10),m=Math.PI/p,g=l.scale(-1),y=Math.cos(m),A=Math.sin(m);for(let w=0;w<p;w++)n.push(d),n.push(d.sub(g)),g=$(g.x*y-g.y*A,g.x*A+g.y*y)}}for(let p=1;p<t.length;p++){if(d===t[p]||d.eq(t[p]))continue;c=d,d=t[p];let m=d.sub(c),g=m.len(),y=m.normal().scale(-r/g),A=i.cross(m);if(Math.abs(A)/(a*g)<.05){n.push(c.add(l)),n.push(c.sub(l)),i.dot(m)<0&&(n.push(c.sub(l)),n.push(c.add(l))),i=m,a=g,l=y;continue}let w=y.sub(l).cross(m)/A,E=l.add(i.scale(w));if(A>0){let R=c.add(E),b=Math.max(r,10),v=De(l.angleBetween(y)/b),C=l,T=Math.cos(v),k=Math.sin(v);for(let D=0;D<b;D++)n.push(R),n.push(c.sub(C)),C=$(C.x*T-C.y*k,C.x*k+C.y*T)}else{let R=c.sub(E),b=Math.max(r,10),v=De(l.angleBetween(y)/b),C=l,T=Math.cos(v),k=Math.sin(v);for(let D=0;D<b;D++)n.push(c.add(C)),n.push(R),C=$(C.x*T-C.y*k,C.x*k+C.y*T)}i=m,a=g,l=y}if(!o)switch(n.push(d.add(l)),n.push(d.sub(l)),e.cap){case"square":{let p=i.scale(r/a);n.push(d.add(p).add(l)),n.push(d.add(p).sub(l));break}case"round":{let p=Math.max(r,10),m=Math.PI/p,g=l.scale(1),y=Math.cos(m),A=Math.sin(m);for(let w=0;w<p;w++)g=$(g.x*y-g.y*A,g.x*A+g.y*y),n.push(d),n.push(d.sub(g))}}if(n.length<4)return;let f=n.map(p=>({pos:s.add(p),uv:$(),color:e.color||pe.WHITE,opacity:e.opacity??1})),u=[],h=0;for(let p=0;p<n.length-2;p+=2)u[h++]=p+1,u[h++]=p,u[h++]=p+2,u[h++]=p+2,u[h++]=p+3,u[h++]=p+1;o&&(u[h++]=n.length-1,u[h++]=n.length-2,u[h++]=0,u[h++]=0,u[h++]=1,u[h++]=n.length-1),En(f,u,e.fixed,M.gfx.defTex,e.shader,e.uniform??void 0)}function XM(e){let t=e.pts,n=[],r=(e.width||1)*.5,o=t[0]===t[t.length-1]||t[0].eq(t[t.length-1]),s=e.pos||$(0,0),i;o?i=t[0].sub(t[t.length-2]):i=t[1].sub(t[0]);let a=i.len(),l=i.normal().scale(-r/a),c,d=t[0];if(!o)switch(e.cap){case"square":{let p=i.scale(-r/a);n.push(d.add(p).add(l)),n.push(d.add(p).sub(l));break}case"round":{let p=Math.max(r,10),m=Math.PI/p,g=l.scale(-1),y=Math.cos(m),A=Math.sin(m);for(let w=0;w<p;w++)n.push(d),n.push(d.sub(g)),g=$(g.x*y-g.y*A,g.x*A+g.y*y)}}for(let p=1;p<t.length;p++){if(d===t[p]||d.eq(t[p]))continue;c=d,d=t[p];let m=d.sub(c),g=m.len(),y=m.normal().scale(-r/g),A=i.cross(m);if(Math.abs(A)/(a*g)<.05){n.push(c.add(l)),n.push(c.sub(l)),i.dot(m)<0&&(n.push(c.sub(l)),n.push(c.add(l))),i=m,a=g,l=y;continue}let w=y.sub(l).cross(m)/A,E=l.add(i.scale(w));n.push(c.add(E)),n.push(c.sub(E)),i=m,a=g,l=y}if(!o)switch(n.push(d.add(l)),n.push(d.sub(l)),e.cap){case"square":{let p=i.scale(r/a);n.push(d.add(p).add(l)),n.push(d.add(p).sub(l));break}case"round":{let p=Math.max(r,10),m=Math.PI/p,g=l.scale(1),y=Math.cos(m),A=Math.sin(m);for(let w=0;w<p;w++)g=$(g.x*y-g.y*A,g.x*A+g.y*y),n.push(d),n.push(d.sub(g))}}if(n.length<4)return;let f=n.map(p=>({pos:s.add(p),uv:$(),color:e.color||pe.WHITE,opacity:e.opacity??1})),u=[],h=0;for(let p=0;p<n.length-2;p+=2)u[h++]=p+1,u[h++]=p,u[h++]=p+2,u[h++]=p+2,u[h++]=p+3,u[h++]=p+1;o&&(u[h++]=n.length-1,u[h++]=n.length-2,u[h++]=0,u[h++]=0,u[h++]=1,u[h++]=n.length-1),En(f,u,e.fixed,M.gfx.defTex,e.shader,e.uniform??void 0)}function sc(e){let t=e.pts,n=e.width??1;if(!t)throw new Error('drawLines() requires property "pts".');if(!(t.length<2)){if(t.length>2)switch(e.join){case"bevel":return WM(e);case"round":return YM(e);case"miter":return XM(e)}if(e.radius&&t.length>=3){ro(Object.assign({},e,{p1:t[0],p2:t[1]}));for(let r=1;r<t.length-2;r++){let o=t[r],s=t[r+1];ro(Object.assign({},e,{p1:o,p2:s}))}ro(Object.assign({},e,{p1:t[t.length-2],p2:t[t.length-1]}))}else for(let r=0;r<t.length-1;r++)ro(Object.assign({},e,{p1:t[r],p2:t[r+1]})),e.join!=="none"&&Fr(Object.assign({},e,{pos:t[r],radius:n/2}))}}function qp(e,t){let n=t.segments??16,r=[];for(let o=0;o<=n;o++)r.push(e(o/n));sc({pts:r,width:t.width||1,pos:t.pos,color:t.color,opacity:t.opacity})}function QM(e){qp(t=>Zl(e.pt1,e.pt2,e.pt3,e.pt4,t),e)}var gn=class zp{constructor(t,n,r,o={}){H(this,"ctx");H(this,"src",null);H(this,"glTex");H(this,"width");H(this,"height");this.ctx=t;let s=t.gl,i=t.gl.createTexture();if(!i)throw new Error("Failed to create texture");this.glTex=i,t.onDestroy(()=>this.free()),this.width=n,this.height=r;let a={linear:s.LINEAR,nearest:s.NEAREST}[o.filter??t.opts.texFilter??"nearest"],l={repeat:s.REPEAT,clampToEdge:s.CLAMP_TO_EDGE}[o.wrap??"clampToEdge"];this.bind(),n&&r&&s.texImage2D(s.TEXTURE_2D,0,s.RGBA,n,r,0,s.RGBA,s.UNSIGNED_BYTE,null),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,l),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,l),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this.unbind()}static fromImage(t,n,r={}){let o=new zp(t,n.width,n.height,r);return o.update(n),o.src=n,o}update(t,n=0,r=0){let o=this.ctx.gl;this.bind(),o.texSubImage2D(o.TEXTURE_2D,0,n,r,o.RGBA,o.UNSIGNED_BYTE,t),this.unbind()}bind(){this.ctx.pushTexture2D(this.glTex)}unbind(){this.ctx.popTexture2D()}free(){this.ctx.gl.deleteTexture(this.glTex)}},Zs=class{constructor(e,t,n,r={}){H(this,"ctx");H(this,"tex");H(this,"glFramebuffer");H(this,"glRenderbuffer");this.ctx=e;let o=e.gl;e.onDestroy(()=>this.free()),this.tex=new gn(e,t,n,r);let s=o.createFramebuffer(),i=o.createRenderbuffer();if(!s||!i)throw new Error("Failed to create framebuffer");this.glFramebuffer=s,this.glRenderbuffer=i,this.bind(),o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,t,n),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,this.tex.glTex,0),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,this.glRenderbuffer),this.unbind()}get width(){return this.tex.width}get height(){return this.tex.height}toImageData(){let e=this.ctx.gl,t=new Uint8ClampedArray(this.width*this.height*4);this.bind(),e.readPixels(0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,t),this.unbind();let n=this.width*4,r=new Uint8Array(n);for(let o=0;o<(this.height/2|0);o++){let s=o*n,i=(this.height-o-1)*n;r.set(t.subarray(s,s+n)),t.copyWithin(s,i,i+n),t.set(r,i)}return new ImageData(t,this.width,this.height)}toDataURL(){let e=document.createElement("canvas"),t=e.getContext("2d");if(e.width=this.width,e.height=this.height,!t)throw new Error("Failed to get 2d context");return t.putImageData(this.toImageData(),0,0),e.toDataURL()}clear(){let e=this.ctx.gl;e.clear(e.COLOR_BUFFER_BIT)}draw(e){this.bind(),e(),this.unbind()}bind(){this.ctx.pushFramebuffer(this.glFramebuffer),this.ctx.pushRenderbuffer(this.glRenderbuffer),this.ctx.pushViewport({x:0,y:0,w:this.width,h:this.height})}unbind(){this.ctx.popFramebuffer(),this.ctx.popRenderbuffer(),this.ctx.popViewport()}free(){let e=this.ctx.gl;e.deleteFramebuffer(this.glFramebuffer),e.deleteRenderbuffer(this.glRenderbuffer),this.tex.free()}},ZM=class{constructor(e,t,n,r){H(this,"ctx");H(this,"glVBuf");H(this,"glIBuf");H(this,"vqueue",[]);H(this,"iqueue",[]);H(this,"stride");H(this,"maxVertices");H(this,"maxIndices");H(this,"vertexFormat");H(this,"numDraws",0);H(this,"curPrimitive",null);H(this,"curTex",null);H(this,"curShader",null);H(this,"curUniform",{});let o=e.gl;this.vertexFormat=t,this.ctx=e,this.stride=t.reduce((i,a)=>i+a.size,0),this.maxVertices=n,this.maxIndices=r;let s=o.createBuffer();if(!s)throw new Error("Failed to create vertex buffer");this.glVBuf=s,e.pushArrayBuffer(this.glVBuf),o.bufferData(o.ARRAY_BUFFER,n*4,o.DYNAMIC_DRAW),e.popArrayBuffer(),this.glIBuf=o.createBuffer(),e.pushElementArrayBuffer(this.glIBuf),o.bufferData(o.ELEMENT_ARRAY_BUFFER,r*4,o.DYNAMIC_DRAW),e.popElementArrayBuffer()}push(e,t,n,r,o=null,s={}){(e!==this.curPrimitive||o!==this.curTex||r!==this.curShader||!tc(this.curUniform,s)||this.vqueue.length+t.length*this.stride>this.maxVertices||this.iqueue.length+n.length>this.maxIndices)&&this.flush();let i=this.vqueue.length/this.stride;for(let a of t)this.vqueue.push(a);for(let a of n)this.iqueue.push(a+i);this.curPrimitive=e,this.curShader=r,this.curTex=o,this.curUniform=s}flush(){var t,n;if(!this.curPrimitive||!this.curShader||this.vqueue.length===0||this.iqueue.length===0)return;let e=this.ctx.gl;this.ctx.pushArrayBuffer(this.glVBuf),e.bufferSubData(e.ARRAY_BUFFER,0,new Float32Array(this.vqueue)),this.ctx.pushElementArrayBuffer(this.glIBuf),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(this.iqueue)),this.ctx.setVertexFormat(this.vertexFormat),this.curShader.bind(),this.curShader.send(this.curUniform),(t=this.curTex)==null||t.bind(),e.drawElements(this.curPrimitive,this.iqueue.length,e.UNSIGNED_SHORT,0),(n=this.curTex)==null||n.unbind(),this.curShader.unbind(),this.ctx.popArrayBuffer(),this.ctx.popElementArrayBuffer(),this.vqueue=[],this.iqueue=[],this.numDraws++}free(){let e=this.ctx.gl;e.deleteBuffer(this.glVBuf),e.deleteBuffer(this.glIBuf)}};function Nn(e){let t=[],n=s=>{t.push(s),e(s)},r=()=>{t.pop(),e(o()??null)},o=()=>t[t.length-1];return[n,r,o]}function JM(e,t={}){let n=[];function r(R){n.push(R)}function o(){n.forEach(b=>b());let R=e.getExtension("WEBGL_lose_context");R&&R.loseContext()}let s=null;function i(R){if(tc(R,s))return;s=R;let b=R.reduce((v,C)=>v+C.size,0);R.reduce((v,C,T)=>(e.vertexAttribPointer(T,C.size,e.FLOAT,!1,b*4,v),e.enableVertexAttribArray(T),v+C.size*4),0)}let[a,l]=Nn(R=>e.bindTexture(e.TEXTURE_2D,R)),[c,d]=Nn(R=>e.bindBuffer(e.ARRAY_BUFFER,R)),[f,u]=Nn(R=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,R)),[h,p]=Nn(R=>e.bindFramebuffer(e.FRAMEBUFFER,R)),[m,g]=Nn(R=>e.bindRenderbuffer(e.RENDERBUFFER,R)),[y,A]=Nn(R=>{if(!R)return;let{x:b,y:v,w:C,h:T}=R;e.viewport(b,v,C,T)}),[w,E]=Nn(R=>e.useProgram(R));return y({x:0,y:0,w:e.drawingBufferWidth,h:e.drawingBufferHeight}),{gl:e,opts:t,onDestroy:r,destroy:o,pushTexture2D:a,popTexture2D:l,pushArrayBuffer:c,popArrayBuffer:d,pushElementArrayBuffer:f,popElementArrayBuffer:u,pushFramebuffer:h,popFramebuffer:p,pushRenderbuffer:m,popRenderbuffer:g,pushViewport:y,popViewport:A,pushProgram:w,popProgram:E,setVertexFormat:i}}var ya={};function hd(e,t){if(t.override){Object.assign(e,t);return}t.pos&&(e.pos=e.pos.add(t.pos)),t.scale&&(e.scale=e.scale.scale($(t.scale))),t.angle&&(e.angle+=t.angle),t.color&&e.ch.length===1&&(e.color=e.color.mult(t.color)),t.opacity!=null&&(e.opacity*=t.opacity)}function il(e){let t={},n="",r=[],o=String(e),s=i=>{r.length>0&&(t[n.length]=r.slice()),n+=i};for(;o!=="";){if(o[0]==="\\"){if(o.length===1)throw new Error("Styled text error: \\ at end of string");s(o[1]),o=o.slice(2);continue}if(o[0]==="["){let i=/^\[(\/)?(\w+?)\]/.exec(o);if(!i){s(o[0]),o=o.slice(1);continue}let[a,l,c]=i;if(l!==void 0){let d=r.pop();if(d!==c)throw d!==void 0?new Error(`Styled text error: mismatched tags. Expected [/${d}], got [/${c}]`):new Error(`Styled text error: stray end tag [/${c}]`)}else r.push(c);o=o.slice(a.length);continue}s(o[0]),o=o.slice(1)}if(r.length>0)throw new Error(`Styled text error: unclosed tags ${r}`);return{charStyleMap:t,text:n}}function $n(e){var w,E,R;if(e.text===void 0)throw new Error('formatText() requires property "text".');let t=_p(e.font);if(!e.text||e.text===""||t instanceof yt||!t)return{width:0,height:0,chars:[],opt:e,renderedText:""};let{charStyleMap:n,text:r}=il(e.text+""),o=zS(r);if(t instanceof Ss||typeof t=="string"){let b=t instanceof Ss?t.fontface.family:t,v=t instanceof Ss?{outline:t.outline,filter:t.filter}:{outline:null,filter:Ja},C=ya[b]??{font:{tex:new gn(M.gfx.ggl,2048,2048,{filter:v.filter}),map:{},size:64},cursor:new X(0),maxHeight:0,outline:v.outline};ya[b]||(ya[b]=C),t=C.font;for(let T of o)if(!C.font.map[T]){let k=M.fontCacheC2d;if(!k)throw new Error("fontCacheC2d is not defined.");if(!M.fontCacheCanvas)throw new Error("fontCacheCanvas is not defined.");k.clearRect(0,0,M.fontCacheCanvas.width,M.fontCacheCanvas.height),k.font=`${t.size}px ${b}`,k.textBaseline="top",k.textAlign="left",k.fillStyle="#ffffff";let D=k.measureText(T),B=Math.ceil(D.width);if(!B)continue;let j=Math.ceil(Math.abs(D.actualBoundingBoxAscent))+Math.ceil(Math.abs(D.actualBoundingBoxDescent));C.outline&&C.outline.width&&C.outline.color&&(k.lineJoin="round",k.lineWidth=C.outline.width*2,k.strokeStyle=C.outline.color.toHex(),k.strokeText(T,C.outline.width,C.outline.width),B+=C.outline.width*2,j+=C.outline.width*3),k.fillText(T,((w=C.outline)==null?void 0:w.width)??0,((E=C.outline)==null?void 0:E.width)??0);let P=k.getImageData(0,0,B,j);if(C.cursor.x+B>2048&&(C.cursor.x=0,C.cursor.y+=C.maxHeight,C.maxHeight=0,C.cursor.y>2048))throw new Error("Font atlas exceeds character limit");t.tex.update(P,C.cursor.x,C.cursor.y),t.map[T]=new Ie(C.cursor.x,C.cursor.y,B,j),C.cursor.x+=B+1,C.maxHeight=Math.max(C.maxHeight,j)}}let s=e.size||t.size,i=$(e.scale??1).scale(s/t.size),a=e.lineSpacing??0,l=e.letterSpacing??0,c=0,d=0,f=0,u=[],h=[],p=0,m=null,g=0,y;for(;p<o.length;){let b=o[p];if(b===`
`)f+=s+a,u.push({width:c-l,chars:h}),m=null,g=0,c=0,h=[],y=void 0;else{let v=t.map[b];if(v){let C=v.w*i.x;e.width&&c+C>e.width&&(f+=s+a,m!=null&&(p-=h.length-m,b=o[p],v=t.map[b],C=v.w*i.x,h=h.slice(0,m-1),c=g),m=null,g=0,u.push({width:c-l,chars:h}),c=y??0,h=[]),h.push({tex:t.tex,width:v.w,height:v.h,quad:new Ie(v.x/t.tex.width,v.y/t.tex.height,v.w/t.tex.width,v.h/t.tex.height),ch:b,pos:new X(c,f),opacity:e.opacity??1,color:e.color??pe.WHITE,scale:$(i),angle:0}),b===" "&&(m=h.length,g=c),e.indentAll&&y===void 0&&/\S/.test(b)&&(y=c),c+=C,d=Math.max(d,c),c+=l}}p++}u.push({width:c-l,chars:h}),f+=s,e.width&&(d=e.width);let A=[];for(let b=0;b<u.length;b++){let v=(d-u[b].width)*mM(e.align??"left");for(let C of u[b].chars){let T=t.map[C.ch],k=A.length+b;if(C.pos=C.pos.add(v,0).add(T.w*i.x*.5,T.h*i.y*.5),e.transform){let D=typeof e.transform=="function"?e.transform(k,C.ch):e.transform;D&&hd(C,D)}if(n[k]){let D=n[k];for(let B of D){let j=(R=e.styles)==null?void 0:R[B],P=typeof j=="function"?j(k,C.ch):j;P&&hd(C,P)}}A.push(C)}}return{width:d,height:f,chars:A,opt:e,renderedText:r}}function No(e){if(e.width===void 0||e.height===void 0)throw new Error('drawUVQuad() requires property "width" and "height".');if(e.width<=0||e.height<=0)return;let t=e.width,n=e.height,r=Br(e.anchor||Ni).scale(new X(t,n).scale(-.5)),o=e.quad||new Ie(0,0,1,1),s=e.color||we(255,255,255),i=e.opacity??1,a=e.tex?.1/e.tex.width:0,l=e.tex?.1/e.tex.height:0,c=o.x+a,d=o.y+l,f=o.w-a*2,u=o.h-l*2;dt(),Te(e.pos),kr(e.angle),Ro(e.scale),Te(r),En([{pos:new X(-t/2,n/2),uv:new X(e.flipX?c+f:c,e.flipY?d:d+u),color:s,opacity:i},{pos:new X(-t/2,-n/2),uv:new X(e.flipX?c+f:c,e.flipY?d+u:d),color:s,opacity:i},{pos:new X(t/2,-n/2),uv:new X(e.flipX?c:c+f,e.flipY?d+u:d),color:s,opacity:i},{pos:new X(t/2,n/2),uv:new X(e.flipX?c:c+f,e.flipY?d:d+u),color:s,opacity:i}],[0,1,3,1,2,3],e.fixed,e.tex,e.shader,e.uniform??void 0),tt()}function Gn(e){dt(),Te(e.opt.pos),kr(e.opt.angle),Te(Br(e.opt.anchor??"topleft").add(1,1).scale(e.width,e.height).scale(-.5)),e.chars.forEach(t=>{No({tex:t.tex,width:t.width,height:t.height,pos:t.pos,scale:t.scale,angle:t.angle,color:t.color,opacity:t.opacity,quad:t.quad,anchor:"center",uniform:e.opt.uniform,shader:e.opt.shader,fixed:e.opt.fixed})}),tt()}function ht(e){if(e.width===void 0||e.height===void 0)throw new Error('drawRect() requires property "width" and "height".');if(e.width<=0||e.height<=0)return;let t=e.width,n=e.height,r=Br(e.anchor||Ni).add(1,1).scale(new X(t,n).scale(-.5)),o=[new X(0,0),new X(t,0),new X(t,n),new X(0,n)];if(e.radius){let s=Math.min(t,n)/2,i=Array.isArray(e.radius)?e.radius.map(a=>Math.min(s,a)):new Array(4).fill(Math.min(s,e.radius));o=[new X(i[0],0),...i[1]?to(new X(t-i[1],i[1]),i[1],i[1],270,360):[$(t,0)],...i[2]?to(new X(t-i[2],n-i[2]),i[2],i[2],0,90):[$(t,n)],...i[3]?to(new X(i[3],n-i[3]),i[3],i[3],90,180):[$(0,n)],...i[0]?to(new X(i[0],i[0]),i[0],i[0],180,270):[]]}pn(Object.assign({},e,{offset:r,pts:o,...e.gradient?{colors:e.horizontal?[e.gradient[0],e.gradient[1],e.gradient[1],e.gradient[0]]:[e.gradient[0],e.gradient[0],e.gradient[1],e.gradient[1]]}:{}}))}function fn(e){ft();let t=M.gfx.width,n=M.gfx.height;M.gfx.width=M.gfx.viewport.width,M.gfx.height=M.gfx.viewport.height,e(),ft(),M.gfx.width=t,M.gfx.height=n}function pd(e,t){fn(()=>{let n=$(8);dt(),Te(e);let r=$n({text:t,font:Xs,size:16,pos:n,color:we(255,255,255),fixed:!0}),o=r.width+n.x*2,s=r.height+n.x*2;e.x+o>=He()&&Te($(-o,0)),e.y+s>=Ue()&&Te($(0,-s)),ht({width:o,height:s,color:we(0,0,0),radius:4,opacity:.8,fixed:!0}),Gn(r),tt()})}function Hp(e){if(!e.p1||!e.p2||!e.p3)throw new Error('drawTriangle() requires properties "p1", "p2" and "p3".');return pn(Object.assign({},e,{pts:[e.p1,e.p2,e.p3]}))}function eC(){if(M.debug.inspect){let e=null;for(let t of M.game.root.get("*",{recursive:!0}))if(t.has("area")&&t.isHovering()){e=t;break}if(M.game.root.drawInspect(),e){let t=[],n=e.inspect();for(let r in n)n[r]?t.push(`${n[r]}`):t.push(`${r}`);pd(JS(M.k.mousePos()),t.join(`
`))}pd($(8),`FPS: ${M.debug.fps()}`)}M.debug.paused&&fn(()=>{dt(),Te(He(),0),Te(-8,8);let e=32;ht({width:e,height:e,anchor:"topright",color:we(0,0,0),opacity:.8,radius:4,fixed:!0});for(let t=1;t<=2;t++)ht({width:4,height:e*.6,anchor:"center",pos:$(-32/3*t,e*.5),color:we(255,255,255),radius:2,fixed:!0});tt()}),M.debug.timeScale!==1&&fn(()=>{dt(),Te(He(),Ue()),Te(-8,-8);let e=8,t=$n({text:M.debug.timeScale.toFixed(1),font:Xs,size:16,color:we(255,255,255),pos:$(-8),anchor:"botright",fixed:!0});ht({width:t.width+e*2+e*4,height:t.height+e*2,anchor:"botright",color:we(0,0,0),opacity:.8,radius:4,fixed:!0});for(let n=0;n<2;n++){let r=M.debug.timeScale<1;Hp({p1:$(-t.width-e*(r?2:3.5),-8),p2:$(-t.width-e*(r?2:3.5),-8-t.height),p3:$(-t.width-e*(r?3.5:2),-8-t.height/2),pos:$(-n*e*1+(r?-8*.5:0),0),color:we(255,255,255),fixed:!0})}Gn(t),tt()}),M.debug.curRecording&&fn(()=>{dt(),Te(0,Ue()),Te(24,-24),Fr({radius:12,color:we(255,0,0),opacity:np(0,1,M.app.time()*4),fixed:!0}),tt()}),M.debug.showLog&&M.game.logs.length>0&&fn(()=>{dt(),Te(0,Ue()),Te(8,-8);let e=8,t=[];for(let r of M.game.logs){let o="",s=r.msg instanceof Error?"error":"info";o+=`[time]${r.time.toFixed(2)}[/time]`,o+=" ",o+=`[${s}]${al(r.msg)}[/${s}]`,t.push(o)}M.game.logs=M.game.logs.filter(r=>M.app.time()-r.time<(M.globalOpt.logTime||4));let n=$n({text:t.join(`
`),font:Xs,pos:$(e,-8),anchor:"botleft",size:16,width:He()*.6,lineSpacing:e/2,fixed:!0,styles:{time:{color:we(127,127,127)},info:{color:we(255,255,255)},error:{color:we(255,0,127)}}});ht({width:n.width+e*2,height:n.height+e*2,anchor:"botleft",color:we(0,0,0),radius:4,opacity:.8,fixed:!0}),Gn(n),tt()})}function al(e,t=!1,n=new Set){if(n.has(e))return"<recursive>";var r="",o;return t&&typeof e=="string"&&(e=JSON.stringify(e)),Array.isArray(e)&&(r=["[",e.map(s=>al(s,!0,n.union(new Set([e])))).join(", "),"]"].join(""),e=r),e===null?"null":(typeof e=="object"&&e.toString===Object.prototype.toString&&(e.constructor!==Object&&(r+=e.constructor.name+" "),r+=["{",(o=Object.getOwnPropertyNames(e).map(s=>`${/^\w+$/.test(s)?s:JSON.stringify(s)}: ${al(e[s],!0,n.union(new Set([e])))}`).join(", "))?` ${o} `:"","}"].join(""),e=r),String(e).replaceAll(new RegExp("(?<!\\\\)\\[","g"),"\\["))}function tC(){let e=M.game.cam,t=X.fromAngle(je(0,360)).scale(e.shake);e.shake=nt(e.shake,0,5*qe()),e.transform=new jt().translate(Qs()).scale(e.scale).rotate(e.angle).translate((e.pos??Qs()).scale(-1).add(t)),M.game.root.draw(),ft()}function nC(){let e=Un();M.game.events.numListeners("loading")>0?M.game.events.trigger("loading",e):fn(()=>{let t=He()/2,n=24,r=$(He()/2,Ue()/2).sub($(t/2,n/2));ht({pos:$(0),width:He(),height:Ue(),color:we(0,0,0)}),ht({pos:r,width:t,height:n,fill:!1,outline:{width:4}}),ht({pos:r,width:t*e,height:n})})}function Vp(e,t,n){let r=M.gfx.ggl.gl;ft(),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST),r.stencilFunc(r.NEVER,1,255),r.stencilOp(r.REPLACE,r.REPLACE,r.REPLACE),t(),ft(),r.stencilFunc(n,1,255),r.stencilOp(r.KEEP,r.KEEP,r.KEEP),e(),ft(),r.disable(r.STENCIL_TEST)}function rC(e,t){let n=M.gfx.ggl.gl;Vp(e,t,n.EQUAL)}function Js(e){var s,i;if(!e.tex)throw new Error('drawTexture() requires property "tex".');let t=e.quad??new Ie(0,0,1,1),n=e.tex.width*t.w,r=e.tex.height*t.h,o=new X(1);if(e.tiled){let a=Br(e.anchor||Ni);(((s=e.pos)==null?void 0:s.x)||0)-(a.x+1)*.5*(e.width||n),(((i=e.pos)==null?void 0:i.y)||0)-(a.y+1)*.5*(e.height||r);let l=(e.width||n)/n,c=(e.height||r)/r,d=Math.floor(l),f=Math.floor(c),u=l-d,h=c-f,p=(d+u?1:0)*(f+h?1:0),m=new Array(p*6),g=new Array(p*4),y=0,A=(w,E,R,b,v)=>{m[y*6+0]=y*4+0,m[y*6+1]=y*4+1,m[y*6+2]=y*4+3,m[y*6+3]=y*4+1,m[y*6+4]=y*4+2,m[y*6+5]=y*4+3,g[y*4+0]={pos:new X(w-a.x,E-a.y),uv:new X(v.x,v.y),color:e.color||pe.WHITE,opacity:e.opacity||1},g[y*4+1]={pos:new X(w+R-a.x,E-a.y),uv:new X(v.x+v.w,v.y),color:e.color||pe.WHITE,opacity:e.opacity||1},g[y*4+2]={pos:new X(w+R-a.x,E+b-a.y),uv:new X(v.x+v.w,v.y+v.h),color:e.color||pe.WHITE,opacity:e.opacity||1},g[y*4+3]={pos:new X(w-a.x,E+b-a.y),uv:new X(v.x,v.y+v.h),color:e.color||pe.WHITE,opacity:e.opacity||1},y++};for(let w=0;w<f;w++){for(let E=0;E<d;E++)A(E*n,w*r,n,r,t);u&&A(d*n,w*r,n*u,r,new Ie(t.x,t.y,t.w*u,t.h))}if(h){for(let w=0;w<d;w++)A(w*n,f*r,n,r*h,new Ie(t.x,t.y,t.w,t.h*h));u&&A(d*n,f*r,n*u,r*h,new Ie(t.x,t.y,t.w*u,t.h*h))}En(g,m,e.fixed,e.tex,e.shader,e.uniform??void 0)}else e.width&&e.height?(o.x=e.width/n,o.y=e.height/r):e.width?(o.x=e.width/n,o.y=o.x):e.height&&(o.y=e.height/r,o.x=o.y),No(Object.assign({},e,{scale:o.scale(e.scale||new X(1)),tex:e.tex,quad:t,width:n,height:r}))}function oC(e){if(!e.sprite)throw new Error('drawSprite() requires property "sprite"');let t=Es(e.sprite);if(!t||!t.data)return;let n=t.data.frames[e.frame??0];if(!n)throw new Error(`Frame not found: ${e.frame??0}`);Js(Object.assign({},e,{tex:t.data.tex,quad:n.scale(e.quad??new Ie(0,0,1,1))}))}function sC(e,t){let n=M.gfx.ggl.gl;Vp(e,t,n.NOTEQUAL)}function gd(e){Gn($n(e))}var iC=(e,t)=>{let n=oc(t,el,tl),r=e.pixelDensity??1,o=e.scale??1,{gl:s}=t,i=gn.fromImage(t,new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1)),a=e.width&&e.height?new Zs(t,e.width*r*o,e.height*r*o):new Zs(t,s.drawingBufferWidth,s.drawingBufferHeight),l=null,c=1;e.background&&(typeof e.background=="string"?l=we(e.background):(l=we(...e.background),c=e.background[3]??1),s.clearColor(l.r/255,l.g/255,l.b/255,c??1)),s.enable(s.BLEND),s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);let d=new ZM(t,Jl,ES,SS),f=gn.fromImage(t,new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,190,190,255,128,128,128,255]),2,2),{wrap:"repeat",filter:"nearest"});return{lastDrawCalls:0,ggl:t,defShader:n,defTex:i,frameBuffer:a,postShader:null,postShaderUniform:null,renderer:d,transform:new jt,transformStack:[],bgTex:f,bgColor:l,bgAlpha:c,width:e.width??s.drawingBufferWidth/r/o,height:e.height??s.drawingBufferHeight/r/o,viewport:{x:0,y:0,width:s.drawingBufferWidth,height:s.drawingBufferHeight,scale:1},fixed:!1}};function Fn(e){return e.fixed?!0:e.parent?Fn(e.parent):!1}function Kn(e){return{color:e.color,opacity:e.opacity,anchor:e.anchor,outline:e.outline,shader:e.shader,uniform:e.uniform}}function aC(e,t={}){return{id:"circle",radius:e,draw(){Fr(Object.assign(Kn(this),{radius:this.radius,fill:t.fill}))},renderArea(){return new Ee(new X(this.anchor?0:-this.radius),this.radius*2,this.radius*2)},inspect(){return`radius: ${Math.ceil(this.radius)}`}}}function Up(...e){return{id:"color",color:we(...e),inspect(){return`color: ${this.color.toString()}`}}}function lC(e){return{add(){this.canvas=e}}}function cC(e=1){let t,n=0,r=!1;return{require:["opacity"],add(){t=this.opacity,this.opacity=0},update(){r||(n+=qe(),this.opacity=Lt(n,0,e,0,t),n>=e&&(this.opacity=t,r=!0))}}}function uC(e="intersect"){return{id:"mask",mask:e}}function $p(e){return{id:"opacity",opacity:e??1,fadeIn(t=1,n=M.k.easings.linear){return M.game.root.tween(0,this.opacity,t,r=>this.opacity=r,n)},fadeOut(t=1,n=M.k.easings.linear){return M.game.root.tween(this.opacity,0,t,r=>this.opacity=r,n)},inspect(){return`opacity: ${nl(this.opacity,1)}`}}}function dC(e=1,t=we(0,0,0),n=1,r="miter",o=10,s="butt"){return{id:"outline",outline:{width:e,color:t,opacity:n,join:r,miterLimit:o,cap:s},inspect(){return`outline: ${this.outline.width}px, ${this.outline.color}`}}}var fC=class{constructor(){H(this,"pos",$(0));H(this,"vel",$(0));H(this,"acc",$(0));H(this,"angle",0);H(this,"angularVelocity",0);H(this,"damping",0);H(this,"t");H(this,"lt",null);H(this,"gc");this.t=0,this.gc=!0}get progress(){return this.lt?this.t/this.lt:this.t}};function hC(e,t){let n=t.lifetime,r=[],o=e.colors||[pe.WHITE],s=e.opacities||[1],i=e.quads||[new Ie(0,0,1,1)],a=e.scales||[1],l=e.lifeTime,c=t.direction,d=t.spread,f=e.speed||[0,0],u=e.angle||[0,0],h=e.angularVelocity||[0,0],p=e.acceleration||[$(0),$(0)],m=e.damping||[0,0],g=[],y=new Array(e.max),A=0,w=0;for(let b=0;b<e.max;b++){g[b*6+0]=b*4+0,g[b*6+1]=b*4+1,g[b*6+2]=b*4+3,g[b*6+3]=b*4+1,g[b*6+4]=b*4+2,g[b*6+5]=b*4+3;for(let v=0;v<4;v++)y[b*4+v]={pos:new X(0,0),uv:new X(0,0),color:we(255,255,255),opacity:1};r[b]=new fC}let E=new We;function R(b=0){for(;b<e.max;){if(r[b].gc)return b;b++}return null}return{id:"particles",emit(b){let v=0;for(let C=0;C<b;C++){if(v=R(v),v==null)return;let T=je(c-d,c+d),k=X.fromAngle(T).scale(je(f[0],f[1])),D=je(u[0],u[1]),B=je(h[0],h[1]),j=$(je(p[0].x,p[1].x),je(p[0].y,p[1].y)),P=je(m[0],m[1]),O=l?je(l[0],l[1]):null,I=t.shape?t.shape.random():$(),_=r[v];_.lt=O,_.pos=I,_.vel=k,_.acc=j,_.angle=D,_.angularVelocity=B,_.damping=P,_.angularVelocity=B,_.gc=!1}A+=b},update(){if(n!==void 0&&n<=0)return;let b=qe();for(let v of r)if(!v.gc){if(v.t+=b,v.lt&&v.t>=v.lt){v.gc=!0,A--;continue}v.vel=v.vel.add(v.acc.scale(b)).scale(1-v.damping*b),v.pos=v.pos.add(v.vel.scale(b)),v.angle+=v.angularVelocity*b}for(n!==void 0&&(n-=b,n<=0&&E.trigger()),w+=b;A<e.max&&t.rate&&w>t.rate;)this.emit(1),A++,w-=t.rate},draw(){if(!(n!==void 0&&n<=0)){for(let b=0;b<r.length;b++){let v=r[b];if(v.gc)continue;let C=v.progress,T=Math.floor(v.progress*o.length),k=T<o.length-1?nt(o[T],o[T+1],Lt(C,T/o.length,(T+1)/o.length,0,1)):o[T],D=Math.floor(v.progress*s.length),B=D<s.length-1?nt(s[D],s[D+1],Lt(C,D/s.length,(D+1)/s.length,0,1)):s[D],j=Math.floor(v.progress*i.length),P=i[j],O=Math.floor(v.progress*a.length),I=a[O],_=Math.cos(v.angle*Math.PI/180),F=Math.sin(v.angle*Math.PI/180),N=(e.texture?e.texture.width:10)*P.w/2,z=(e.texture?e.texture.height:10)*P.h/2,V=b*4,U=y[V];U.pos.x=v.pos.x+-N*I*_- -z*I*F,U.pos.y=v.pos.y+-N*I*F+-z*I*_,U.uv.x=P.x,U.uv.y=P.y,U.color.r=k.r,U.color.g=k.g,U.color.b=k.b,U.opacity=B,U=y[V+1],U.pos.x=v.pos.x+N*I*_- -z*I*F,U.pos.y=v.pos.y+N*I*F+-z*I*_,U.uv.x=P.x+P.w,U.uv.y=P.y,U.color.r=k.r,U.color.g=k.g,U.color.b=k.b,U.opacity=B,U=y[V+2],U.pos.x=v.pos.x+N*I*_-z*I*F,U.pos.y=v.pos.y+N*I*F+z*I*_,U.uv.x=P.x+P.w,U.uv.y=P.y+P.h,U.color.r=k.r,U.color.g=k.g,U.color.b=k.b,U.opacity=B,U=y[V+3],U.pos.x=v.pos.x+-N*I*_-z*I*F,U.pos.y=v.pos.y+-N*I*F+z*I*_,U.uv.x=P.x,U.uv.y=P.y+P.h,U.color.r=k.r,U.color.g=k.g,U.color.b=k.b,U.opacity=B}En(y,g,this.fixed,e.texture,this.shader,this.uniform)}},onEnd(b){return E.add(b)},inspect(){return`count: ${A}/${e.max}`}}}function pC(e,t={}){if(e.length<3)throw new Error(`Polygon's need more than two points, ${e.length} points provided`);return{id:"polygon",pts:e,colors:t.colors,uv:t.uv,tex:t.tex,radius:t.radius,draw(){pn(Object.assign(Kn(this),{pts:this.pts,colors:this.colors,uv:this.uv,tex:this.tex,radius:this.radius,fill:t.fill,triangulate:t.triangulate}))},renderArea(){return new Ye(this.pts)},inspect(){return`polygon: ${this.pts.map(n=>`[${n.x},${n.y}]`).join(",")}`}}}function Gp(e,t,n){let r;return M.game.root.get("area").forEach(o=>{if(n&&n.some(i=>o.is(i)))return;let s=o.worldArea().raycast(e,t);s&&(r?s.fraction<r.fraction&&(r=s,r.object=o):(r=s,r.object=o))}),r}function Kp(e,t,n={}){return{id:"rect",width:e,height:t,radius:n.radius||0,draw(){ht(Object.assign(Kn(this),{width:this.width,height:this.height,radius:this.radius,fill:n.fill}))},renderArea(){return new Ee($(0),this.width,this.height)},inspect(){return`rect: (${Math.ceil(this.width)}w, ${Math.ceil(this.height)}h)`}}}function gC(e,t){return{id:"shader",shader:e,...typeof t=="function"?{uniform:t(),update(){this.uniform=t()}}:{uniform:t},inspect(){return`shader: ${e}`}}}function mC(e,t){if(!t.tileWidth||!t.tileHeight)throw new Error("Must provide tileWidth and tileHeight.");let n=M.game.root.add([ei(t.pos??$(0))]),r=e.length,o=0,s=null,i=null,a=null,l=null,c=b=>b.x+b.y*o,d=b=>$(Math.floor(b%o),Math.floor(b/o)),f=()=>{s=[];for(let b of n.children)u(b)},u=b=>{let v=c(b.tilePos);s[v]?s[v].push(b):s[v]=[b]},h=b=>{let v=c(b.tilePos);if(s[v]){let C=s[v].indexOf(b);C>=0&&s[v].splice(C,1)}},p=()=>{let b=!1;for(let v of n.children){let C=n.pos2Tile(v.pos);(v.tilePos.x!=C.x||v.tilePos.y!=C.y)&&(b=!0,h(v),v.tilePos.x=C.x,v.tilePos.y=C.y,u(v))}b&&n.trigger("spatialMapChanged")},m=()=>{let b=n.getSpatialMap(),v=n.numRows()*n.numColumns();i?i.length=v:i=new Array(v),i.fill(1,0,v);for(let C=0;C<b.length;C++){let T=b[C];if(T){let k=0;for(let D of T)if(D.isObstacle){k=1/0;break}else k+=D.cost;i[C]=k||1}}},g=()=>{let b=n.getSpatialMap(),v=n.numRows()*n.numColumns();a?a.length=v:a=new Array(v),a.fill(15,0,v);for(let C=0;C<b.length;C++){let T=b[C];if(T){let k=T.length,D=15;for(let B=0;B<k;B++)D|=T[B].edgeMask;a[C]=D}}},y=()=>{let b=n.numRows()*n.numColumns(),v=(T,k)=>{let D=[];for(D.push(T);D.length>0;){let B=D.pop();E(B).forEach(j=>{l[j]<0&&(l[j]=k,D.push(j))})}};l?l.length=b:l=new Array(b),l.fill(-1,0,b);let C=0;for(let T=0;T<i.length;T++){if(l[T]>=0){C++;continue}v(T,C),C++}},A=(b,v)=>i[v],w=(b,v)=>{let C=d(b),T=d(v);return C.dist(T)},E=(b,v)=>{let C=[],T=Math.floor(b%o),k=T>0&&a[b]&1&&i[b-1]!==1/0,D=b>=o&&a[b]&2&&i[b-o]!==1/0,B=T<o-1&&a[b]&4&&i[b+1]!==1/0,j=b<o*r-o-1&&a[b]&8&&i[b+o]!==1/0;return v?(k&&(D&&C.push(b-o-1),C.push(b-1),j&&C.push(b+o-1)),D&&C.push(b-o),B&&(D&&C.push(b-o+1),C.push(b+1),j&&C.push(b+o+1)),j&&C.push(b+o)):(k&&C.push(b-1),D&&C.push(b-o),B&&C.push(b+1),j&&C.push(b+o)),C},R={id:"level",tileWidth(){return t.tileWidth},tileHeight(){return t.tileHeight},spawn(b,...v){let C=$(...v),T=(()=>{if(typeof b=="string"){if(t.tiles[b]){if(typeof t.tiles[b]!="function")throw new Error("Level symbol def must be a function returning a component list");return t.tiles[b](C)}else if(t.wildcardTile)return t.wildcardTile(b,C)}else{if(Array.isArray(b))return b;throw new Error("Expected a symbol or a component list")}})();if(!T)return null;let k=!1,D=!1;for(let j of T)j.id==="tile"&&(D=!0),j.id==="pos"&&(k=!0);k||T.push(ei(this.tile2Pos(C))),D||T.push(dg());let B=n.add(T);return k&&(B.tilePosOffset=B.pos.clone()),B.tilePos=C,B.transform=co(B),s&&(u(B),this.trigger("spatialMapChanged"),this.trigger("navigationMapInvalid")),B},numColumns(){return o},numRows(){return r},levelWidth(){return o*this.tileWidth()},levelHeight(){return r*this.tileHeight()},tile2Pos(...b){return $(...b).scale(this.tileWidth(),this.tileHeight())},pos2Tile(...b){let v=$(...b);return $(Math.floor(v.x/this.tileWidth()),Math.floor(v.y/this.tileHeight()))},getSpatialMap(){return s||f(),s},removeFromSpatialMap:h,insertIntoSpatialMap:u,onSpatialMapChanged(b){return this.on("spatialMapChanged",b)},onNavigationMapInvalid(b){return this.on("navigationMapInvalid",b)},getAt(b){s||f();let v=c(b);return s[v]||[]},raycast(b,v){let C=this.toWorld(b),T=this.toWorld(b.add(v)).sub(C),k=1/this.tileWidth(),D=b.scale(k),B=XE(D,v,j=>{let P=this.getAt(j);if(P.some(I=>I.isObstacle))return!0;let O=null;for(let I of P)if(I.has("area")){let _=I.worldArea().raycast(C,T);_&&(O?_.fraction<O.fraction&&(O=_,O.object=I):(O=_,O.object=I))}return O&&(O.point=this.fromWorld(O.point).scale(k)),O||!1},64);return B&&(B.point=B.point.scale(this.tileWidth())),B},update(){s&&p()},invalidateNavigationMap(){i=null,a=null,l=null},onNavigationMapChanged(b){return this.on("navigationMapChanged",b)},getTilePath(b,v,C={}){var _;if(i||m(),a||g(),l||y(),b.x<0||b.x>=o||b.y<0||b.y>=r||v.x<0||v.x>=o||v.y<0||v.y>=r)return null;let T=c(b),k=c(v);if(i[k]===1/0)return null;if(T===k)return[];if(l[T]!=-1&&l[T]!==l[k])return null;let D=new Sp((F,N)=>F.cost<N.cost);D.insert({cost:0,node:T});let B=new Map;B.set(T,T);let j=new Map;for(j.set(T,0);D.length!==0;){let F=(_=D.remove())==null?void 0:_.node;if(F===k)break;let N=E(F,C.allowDiagonals);for(let z of N){let V=(j.get(F)||0)+A(F,z)+w(z,k);(!j.has(z)||V<j.get(z))&&(j.set(z,V),D.insert({cost:V,node:z}),B.set(z,F))}}let P=[],O=k,I=d(O);for(P.push(I);O!==T;){let F=B.get(O);if(F===void 0)throw new Error("Bug in pathfinding algorithm");O=F;let N=d(O);P.push(N)}return P.reverse()},getPath(b,v,C={}){let T=this.tileWidth(),k=this.tileHeight(),D=this.getTilePath(this.pos2Tile(b),this.pos2Tile(v),C);return D?[b,...D.slice(1,-1).map(B=>B.scale(T,k).add(T/2,k/2)),v]:null}};return n.use(R),n.onNavigationMapInvalid(()=>{n.invalidateNavigationMap(),n.trigger("navigationMapChanged")}),e.forEach((b,v)=>{let C=b.split("");o=Math.max(C.length,o),C.forEach((T,k)=>{n.spawn(T,$(k,v))})}),n}function at(e,t,n){return M.game.objEvents.registers[e]||(M.game.objEvents.registers[e]=new Ap),M.game.objEvents.on(e,(r,...o)=>{r.is(t)&&n(r,...o)})}var yC=(e,t,...n)=>{for(let r of M.game.root.children)r.is(t)&&r.trigger(e,n)},wC=Me(e=>{let t=M.game.root.add([{fixedUpdate:e}]);return{get paused(){return t.paused},set paused(n){t.paused=n},cancel:()=>t.destroy()}},(e,t)=>at("fixedUpdate",e,t)),Wp=Me(e=>{let t=M.game.root.add([{update:e}]);return{get paused(){return t.paused},set paused(n){t.paused=n},cancel:()=>t.destroy()}},(e,t)=>at("update",e,t)),xC=Me(e=>{let t=M.game.root.add([{draw:e}]);return{get paused(){return t.hidden},set paused(n){t.hidden=n},cancel:()=>t.destroy()}},(e,t)=>at("draw",e,t)),Yp=Me(e=>M.game.events.on("add",e),(e,t)=>at("add",e,t)),vC=Me(e=>M.game.events.on("destroy",e),(e,t)=>at("destroy",e,t)),bC=Me(e=>M.game.events.on("use",e),(e,t)=>at("use",e,t)),AC=Me(e=>M.game.events.on("unuse",e),(e,t)=>at("unuse",e,t)),Xp=Me(e=>M.game.events.on("tag",e),(e,t)=>at("tag",e,t)),EC=Me(e=>M.game.events.on("untag",e),(e,t)=>at("untag",e,t));function SC(e,t,n){return at("collide",e,(r,o,s)=>o.is(t)&&n(r,o,s))}function MC(e,t,n){return at("collideUpdate",e,(r,o,s)=>o.is(t)&&n(r,o,s))}function CC(e,t,n){return at("collideEnd",e,(r,o,s)=>o.is(t)&&n(r,o,s))}function _i(e,t){M.game.root.get(e,{recursive:!0}).forEach(t),Yp(e,t),Xp((n,r)=>{r===e&&t(n)})}var PC=Me(e=>M.app.onMousePress(e),(e,t)=>{let n=[];return _i(e,r=>{if(!r.area)throw new Error("onClick() requires the object to have area() component");n.push(r.onClick(()=>t(r)))}),Zn.join(n)});function RC(e,t){let n=[];return _i(e,r=>{if(!r.area)throw new Error("onHover() requires the object to have area() component");n.push(r.onHover(()=>t(r)))}),Zn.join(n)}function IC(e,t){let n=[];return _i(e,r=>{if(!r.area)throw new Error("onHoverUpdate() requires the object to have area() component");n.push(r.onHoverUpdate(()=>t(r)))}),Zn.join(n)}function NC(e,t){let n=[];return _i(e,r=>{if(!r.area)throw new Error("onHoverEnd() requires the object to have area() component");n.push(r.onHoverEnd(()=>t(r)))}),Zn.join(n)}function TC(e){M.game.events.on("loading",e)}function kC(e){M.app.onResize(e)}function _C(e){M.game.events.on("error",e)}function ic(e){M.assets.loaded?e():M.game.events.on("load",e)}function DC(e){if(M.assets.loaded)Np().forEach(t=>e(...t));else return M.game.events.on("loadError",e)}function Qp(...e){M.game.cam.pos=$(...e)}function Zp(){return M.game.cam.pos?M.game.cam.pos.clone():Qs()}function Jp(...e){M.game.cam.scale=$(...e)}function eg(){return M.game.cam.scale.clone()}function tg(e){M.game.cam.angle=e}function ng(){return M.game.cam.angle}function OC(){return M.game.cam.transform.clone()}function rg(e=we(255,255,255),t=1){let n=M.game.root.add([Kp(He(),Ue()),Up(e),$p(1),pg()]),r=n.fadeOut(t);return r.onEnd(()=>ug(n)),r}function LC(){return M.game.cam.transform.clone()}function BC(e=12){M.game.cam.shake+=e}function ll(e){return M.game.cam.transform.multVec2(e)}function og(e){return M.game.cam.transform.invert().multVec2(e)}function FC(...e){return Lr("camPos","setCamPos / getCamPos"),e.length>0&&Qp(...e),Zp()}function jC(...e){return Lr("camScale","setCamScale / getCamScale"),e.length>0&&Jp(...e),eg()}function qC(e){return Lr("camRot","setCamRot / getCamRot"),e!==void 0&&tg(e),ng()}function zC(e=we(255,255,255),t=1){return Lr("camFlash","flash"),rg(e,t)}function ac(e=[]){let t=new Map,n=[],r={},o=new Co,s=[],i=new Set("*"),a=M.globalOpt.tagsAsComponents,l=null,c=!1,d={id:QS(),hidden:!1,transform:new jt,children:[],parent:null,set paused(u){if(u!==c){c=u;for(let h of s)h.paused=u}},get paused(){return c},get tags(){return Array.from(i)},add(u){let h=Array.isArray(u)?ac(u):u;if(h.parent)throw new Error("Cannot add a game obj that already has a parent.");return h.parent=this,h.transform=co(h),this.children.push(h),h.trigger("add",h),M.game.events.trigger("add",h),h},readd(u){let h=this.children.indexOf(u);return h!==-1&&(this.children.splice(h,1),this.children.push(u)),u},remove(u){let h=this.children.indexOf(u);if(h!==-1){u.parent=null,this.children.splice(h,1);let p=m=>{m.trigger("destroy"),M.game.events.trigger("destroy",m),m.children.forEach(g=>p(g))};p(u)}},removeAll(u){if(u)this.get(u).forEach(h=>this.remove(h));else for(let h of[...this.children])this.remove(h)},fixedUpdate(){this.paused||(this.children.forEach(u=>u.fixedUpdate()),this.trigger("fixedUpdate"))},update(){this.paused||(this.children.forEach(u=>u.update()),this.trigger("update"))},draw(){if(this.hidden)return;this.canvas&&(ft(),this.canvas.bind());let u=M.gfx.fixed;this.fixed&&(M.gfx.fixed=!0),dt(),Te(this.pos),Ro(this.scale),kr(this.angle);let h=this.children.sort((p,m)=>{let g=p.layerIndex??M.game.defaultLayerIndex,y=m.layerIndex??M.game.defaultLayerIndex;return g-y||(p.z??0)-(m.z??0)});if(this.mask){let p={intersect:M.k.drawMasked,subtract:M.k.drawSubtracted}[this.mask];if(!p)throw new Error(`Invalid mask func: "${this.mask}"`);p(()=>{h.forEach(m=>m.draw())},()=>{this.trigger("draw")})}else this.trigger("draw"),h.forEach(p=>p.draw());tt(),M.gfx.fixed=u,this.canvas&&(ft(),this.canvas.unbind())},drawInspect(){this.hidden||(dt(),Te(this.pos),Ro(this.scale),kr(this.angle),this.children.forEach(u=>u.drawInspect()),this.trigger("drawInspect"),tt())},use(u){var m;if(typeof u=="string")return i.add(u);if(!u||typeof u!="object")throw new Error(`You can only pass a component or a string to .use(), you passed a "${typeof u}"`);let h=[];u.id?(this.unuse(u.id),r[u.id]=[],h=r[u.id],t.set(u.id,u),a&&i.add(u.id)):n.push(u);for(let g in u){if(PS.has(g))continue;let y=Object.getOwnPropertyDescriptor(u,g);if(y)if(typeof y.value=="function"&&(u[g]=u[g].bind(this)),y.set&&Object.defineProperty(u,g,{set:y.set.bind(this)}),y.get&&Object.defineProperty(u,g,{get:y.get.bind(this)}),RS.has(g)){let A=g==="add"?()=>{var w;l=E=>h.push(E),(w=u[g])==null||w.call(u),l=null}:u[g];h.push(this.on(g,A).cancel)}else if(this[g]===void 0)Object.defineProperty(this,g,{get:()=>u[g],set:A=>u[g]=A,configurable:!0,enumerable:!0}),h.push(()=>delete this[g]);else{let A=(m=t.values().find(w=>w[g]!==void 0))==null?void 0:m.id;throw new Error(`Duplicate component property: "${g}" while adding component "${u.id}"`+(A?` (originally added by "${A}")`:""))}}let p=()=>{if(u.require){for(let g of u.require)if(!this.c(g))throw new Error(`Component "${u.id}" requires component "${g}"`)}};u.destroy&&h.push(u.destroy.bind(this)),this.exists()?(p(),u.add&&(l=g=>h.push(g),u.add.call(this),l=null),u.id&&(this.trigger("use",u.id),M.game.events.trigger("use",this,u.id))):u.require&&h.push(this.on("add",p).cancel)},unuse(u){if(t.has(u)){for(let h of t.values())if(h.require&&h.require.includes(u))throw new Error(`Can't unuse. Component "${h.id}" requires component "${u}"`);t.delete(u),this.trigger("unuse",u),M.game.events.trigger("unuse",this,u)}else a&&i.has(u)&&i.delete(u);r[u]&&(r[u].forEach(h=>h()),delete r[u])},c(u){return t.get(u)??null},get(u,h={}){let p=(g,y)=>h.only==="comps"?g.has(y):h.only==="tags"?g.is(y):g.is(y)||g.has(y),m=h.recursive?this.children.flatMap(function g(y){return[y,...y.children.flatMap(g)]}):this.children;if(m=m.filter(g=>u?p(g,u):!0),h.liveUpdate){let g=A=>h.recursive?this.isAncestorOf(A):A.parent===this,y=[];y.push(M.k.onAdd(A=>{g(A)&&p(A,u)&&m.push(A)})),y.push(M.k.onDestroy(A=>{if(g(A)&&p(A,u)){let w=m.findIndex(E=>E.id===A.id);w!==-1&&m.splice(w,1)}})),this.onDestroy(()=>{for(let A of y)A.cancel()})}return m},query(u){let h=u.hierarchy||"children",p=u.include,m=u.exclude,g=[];switch(h){case"children":g=this.children;break;case"siblings":g=this.parent?this.parent.children.filter(A=>A!==this):[];break;case"ancestors":let y=this.parent;for(;y;)g.push(y),y=y.parent;break;case"descendants":g=this.children.flatMap(function A(w){return[w,...w.children.flatMap(A)]});break}if(p&&((u.includeOp||"and")==="and"||!Array.isArray(u.include)?g=g.filter(y=>y.is(p)):g=g.filter(y=>u.include.some(A=>y.is(A)))),m&&((u.includeOp||"and")==="and"||!Array.isArray(u.include)?g=g.filter(y=>!y.is(m)):g=g.filter(y=>!u.exclude.some(A=>y.is(A)))),u.visible===!0&&(g=g.filter(y=>y.visible)),u.distance){if(!this.pos)throw Error("Can't do a distance query from an object without pos");let y=u.distanceOp||"near",A=u.distance*u.distance;y==="near"?g=g.filter(w=>w.pos&&this.pos.sdist(w.pos)<=A):g=g.filter(w=>w.pos&&this.pos.sdist(w.pos)>A)}return u.name&&(g=g.filter(y=>y.name===u.name)),g},isAncestorOf(u){return u.parent?u.parent===this||this.isAncestorOf(u.parent):!1},exists(){return M.game.root.isAncestorOf(this)},is(u,h="and"){return Array.isArray(u)?h==="and"?u.every(p=>i.has(p)):u.some(p=>i.has(p)):i.has(u)},tag(u){if(Array.isArray(u))for(let h of u)i.add(h),this.trigger("tag",h),M.game.events.trigger("tag",this,h);else i.add(u),this.trigger("tag",u),M.game.events.trigger("tag",this,u)},untag(u){if(Array.isArray(u))for(let h of u)i.delete(h),this.trigger("untag",h),M.game.events.trigger("untag",this,h);else i.delete(u),this.trigger("untag",u),M.game.events.trigger("untag",this,u)},has(u,h="and"){return Array.isArray(u)?h==="and"?u.every(p=>t.has(p)):u.some(p=>t.has(p)):t.has(u)},on(u,h){let p=o.on(u,h.bind(this));return l&&l(()=>p.cancel()),p},trigger(u,...h){o.trigger(u,...h),M.game.objEvents.trigger(u,this,...h)},destroy(){this.parent&&this.parent.remove(this)},inspect(){var h;let u={};for(let[p,m]of t)u[p]=((h=m.inspect)==null?void 0:h.call(m))??null;for(let[p,m]of n.entries()){if(m.inspect){u[p]=m.inspect();continue}for(let[g,y]of Object.entries(m))typeof y!="function"&&(u[g]=`${g}: ${y}`)}return u},onAdd(u){return this.on("add",u)},onFixedUpdate(u){return this.on("fixedUpdate",u)},onUpdate(u){return this.on("update",u)},onDraw(u){return this.on("draw",u)},onDestroy(u){return this.on("destroy",u)},onUse(u){return this.on("use",u)},onUnuse(u){return this.on("unuse",u)},clearEvents(){o.clear()}},f=["onKeyPress","onKeyPressRepeat","onKeyDown","onKeyRelease","onMousePress","onMouseDown","onMouseRelease","onMouseMove","onCharInput","onMouseMove","onTouchStart","onTouchMove","onTouchEnd","onScroll","onGamepadButtonPress","onGamepadButtonDown","onGamepadButtonRelease","onGamepadStick","onButtonPress","onButtonDown","onButtonRelease"];for(let u of f)d[u]=(...h)=>{var m,g;let p=(g=(m=M.app)[u])==null?void 0:g.call(m,...h);return s.push(p),d.onDestroy(()=>p.cancel()),d.on("sceneEnter",()=>{var A,w;s.splice(s.indexOf(p),1);let y=(w=(A=M.app)[u])==null?void 0:w.call(A,...h);Zn.replace(p,y),s.push(p)}),p};for(let u of e)d.use(u);return d}var HC=()=>({events:new Co,objEvents:new Co,root:ac([]),gravity:null,scenes:{},currentScene:null,layers:null,defaultLayerIndex:0,logs:[],cam:{pos:null,scale:new X(1),angle:0,shake:0,transform:new jt}});function VC(e){M.game.gravity=e?(M.game.gravity||$(0,1)).unit().scale(e):null}function UC(){return M.game.gravity?M.game.gravity.len():0}function $C(e){M.game.gravity=e.unit().scale(M.game.gravity?M.game.gravity.len():1)}function fo(){return M.game.gravity?M.game.gravity.unit():$(0,1)}var GC=PE("//uUBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAATAAAeAAANDQ0NDRoaGhoaKCgoKCg1NTU1NTVDQ0NDQ1BQUFBQXl5eXl5ra2tra2t5eXl5eYaGhoaGlJSUlJShoaGhoaGvr6+vr7y8vLy8ysrKysrX19fX19fl5eXl5fLy8vLy//////8AAAA5TEFNRTMuMTAwAaoAAAAAAAAAABSAJAOPhgAAgAAAHgBaqIlmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uUBAAP8h1kPIABR4BEDGeQAEbkSb2RAACBFMEyMiAAASJw4xjgwAGyRvfIoZT2QKGV5YNw/tKID9+X93qXtBQUFBQ/e+EFKTQUT/dy3f5dK/3d04rkXHpufCClDAaH7jDMgFAQEGfPt+jI352U9vU4GLRpzkUDeeeTQggQe2ggF3d7/3j697DnhCH5iGf38//iNj9oy2Jk71oj+CBAABGNB4RJNMwgCABCB//8//l////1z6XEGd73az07sOkwZD9VYgjzjmQ6j4EMfZM86OJ7GUWwvFw3ZPcdVEtczf9RNf6xMyxLjZZgjMQ7KDkLSU8g2E12UDUWrf//////9LdtFdeeqKwSitW9SJL59VM5pyUGiBNiK0jIGO0j7p3pUpWpaeqi1nTvqP3b43mGmM6HeXFjIlRwiFiIDQRRAGgkDQhxMMv//+f1//6XM/PfMvysJa3993MjDjhaRkrV3cRPXjGptDDGTHtFKUeMHU0K5STvVfMtVX/UXHctt1Z1//uUBB0AgnZkQAAgRTBMzIgAACiqCdB9E1QRgAFuIuGmhjABPZRJRCHi4etY2gcEYRwFw5KFBMMRV/////z6kX2ppnJszEzKbkZKEumm+pBRUDBg9IsgXGXrazn1QhmGjBrLVjT5Xvir0HT7d//HSZh18IZdji2N5JZgbA3DwQAahogSDqUhQuNtpJmBTwAGMY2QP3c/dy4EKsAABoXEJEFmlf/c4TgYtwcAbwfD4gOOoS1QIH7jDnNzYVe1x4mNFyD2jMVaaykjV29ePMARwXcUOgAFr+UjhVz4jhwMDFxPKgYs3cDFpohVgAAYAIO7u8eAAjRNA7hBFAwN3ACDvu7nETkLMrnyIj8v/9fNwhF9vKRfm82P5zPPmLV/WKs9G3d16n/v3rubEN0zgs7RdWrHne9brdv5bI4EwEAM6lj7aVdTKtXQHgLdzCKQ2kcihe4FyMcD1r3nR4TWxuax5EOZJEs3DEQnjyqyB8cSfrI6GEcoJxiHBDEfrTOFYrO1//uUBCgAA406ym5hgAB1R1ktzDwACxDBZzj0gAFhGrA3HoACypAXH9HY4umZan4ZlZKldajczMzMzOTnzMvnb77f/1IuSzHIbnJLJdapWmwUAQBXqWPtqV1OyqVqXhB9abR90OyKEsM51pIJK/nXplbDPtKz2dH+oVWeZSm8z7nvAZ19bneqhk3qeBhrhZiLbCc8sRnXb520RnPFd61/AgSR4f8CVlfWpD/////+N6/jv8v4f/6Ln///06c8YYcQIaGmAJ9VhMHEZYc9Kn0TOOYKv2cibDoZieAaGy4Cd6AfGkxQQr+agomAw+dC7AkjOxklIZEpUgmHxXP7/znl/4qT9Z/8+T2a0WF9/lvpv39if/KZnV6Gp1vQRmN1rYDAADfLGQxVR2d49LQLXdImm5n40smwjQ4aIYKMeKCOEw0OBV5cHA8cFV8mB5LyIIeksHspy79/iTv9SH+v66f2Wn/i+Lt//x9y//5MohgAAXiTCVBil4RUZ7XUvPRCD9Uc//uUBAoAAro3Wzc9AABXRutm56AACrUhc6eYT0FWpC508wnoO35hs9j6x7PQOB0PF0JWIkYwigNPoXUBA0cKA6JwDB7lRKDm/93r/mb6iEqL5lv3Vq//6YgYd1AgECi4xACCYbHyukYAAF4kwlQYpeEVGe11Lz0Qg/VHDt+YbPY+sez0DgdDxdCViJGMIoDT6F1AQNHCgOicAwe5USg5v/d6/5m+ohKi+Zb91av/+mIGHdQIBAouMQAgmGx8rptmoLKSACTuBBUPFsH6RlCz+UhoKeVfJy/eqOspBG4PScFOnOxYJJcf/nVzmyfR42Zwxy//hfSUrPq1SzFnO7q/SzNUzst+GQpnZ/kLwzVZ9xJ2lVa02zUFlJABJ3AgqHi2D9IyhZ/KQ0FPKvk5fvVHWUgjcHpOCnTnYsEkuP/zq5zZPo8bM4Y5f/wvpKVn1apZiznd1fpZmqZ2W/DIUzs/yF4Zqs+4k7SqtaYkWgEGMgppYQlMVdKcos2bWFZbFIJp//uUBAsAAr0wWe1hAABXpgs9rCAACwS5azj0gAFgly1nHpAAVgWmZa3LaUWCcGh5HgOEYkViyQUjrX+G5FUr5Dla1ZhtXDf7ckpazXwzeusqq+zXwUePSw8NYzlZKWfbyzod4dCRItAIMZBTSwhKYq6U5RZs2sKy2KQTSrAtMy1uW0osE4NDyPAcIxIrFkgpHWv8NyKpXyHK1qzDauG/25JS1mvhm9dZVV9mvgo8elh4axnKyUs+3lnQ7w6EkIEIIZFKlBSAGwRMrEIEuM658s5gvyVtFDrQtgTY2YSPlAJcgwlXLmokM8sUQJYJOm3eaW04jWVsoghX+ZBt3SHFZOypVez//VONpL+du6U+4WLXBC79cuhAhBDIpUoKQA2CJlYhAlxnXPlnMF+StoodaFsCbGzCR8oBLkGEq5c1EhnliiBLBJ027zS2nEaytlEEK/zINu6Q4rJ2VKr2f/6pxtJfzt3Sn3Cxa4IXfrl6IGEh4icUSUDRZk/k88VFEmCy//uUBAkAAociWgZh4ABQ5EtAzDwAC6zBXBmXgAF1mCuDMvAART7WmhWQ9QwYJexoKJ+z1bcQqfEFmtDtXH8lUg2omFi2b/4+UhW/j+bHgwAM8SqMAQFxYj9wqAwhlftf//sSQMJDxE4okoGizJ/J54qKJMFkin2tNCsh6hgwS9jQUT9nq24hU+ILNaHauP5KpBtRMLFs3/x8pCt/H82PBgAZ4lUYAgLixH7hUBhDK/a///YmHznKbibgJd0lEi0TfuHXCfhZ0faHA6GL3GuUpLTgTwnd/upcFAbo+BGMfzKxWE9PNg+sbrEwwRLn6uFElWTc/zN8Yvf5V3xV29///8OO/f7j3cT0mgMTPP9uPEwIQ+c5TcTcBLukokWib9w64T8LOj7Q4HQxe41ylJacCeE7v91LgoDdHwIxj+ZWKwnp5sH1jdYmGCJc/Vwokqybn+ZvjF7/Ku+Ku3v///hx37/ce7iek0BiZ5/tx4mBCmI5QXQAgigG+j0P8fdg2Xjs//uUBAiAAqwlWwY94ABVhKtgx7wACoilZ7z0AAFUlOz3noAAii2PkO1AMBYBIssJqQ5PtEdSQ2WE3xIF22b19axY89F5QQmWCwxJrf51h5mt74jRvBahCxQkS0MgJxY15ITjX3sb+vlGI5QXQAgigG+j0P8fdg2Xjsii2PkO1AMBYBIssJqQ5PtEdSQ2WE3xIF22b19axY89F5QQmWCwxJrf51h5mt74jRvBahCxQkS0MgJxY15ITjX3sb+vlEBsAgCSkHfwmFY/MMKQyg4tjhHeuR2mpSZWstSwEQAw00wZaogwgZL3PPVWw9vuB51zUXf3Df/ytV917DjxQEGA+0mbu4YYg4TnkRcMGQsxH/Ioc1AbAIAkpB38JhWPzDCkMoOLY4R3rkdpqUmVrLUsBEAMNNMGWqIMIGS9zz1VsPb7gedc1F39w3/8rVfdew48UQIFwus29HKDIAW8tcsSGAOKXK/jHmF1AkIAAC8ZUaEFwTHUylbannoarv7HwxH8//uUBAwEAtAx18sMQuBVJisaYSJeCmhnX6eZLQFZJy208wmidE7zXIRk0ZLYCqc1eg1sKc3HZuweFNeSCHHGg+JyhTcd8RE3/+rJXIdH6UpI2qUdVtHGRCOewEOXGUfKG2/v+RIoA0MAAAByh2gABL0EpLTwNTz0qzjM2ER8SF2lsSRLESGiqG5JXMCauo+aTB1GQKTyJd6SDnG6Iv8rkaoYeRihQbVGzJSSQ4sOghQh7vhkf+T0agMeCYAcAABBO40gsg/gOpfIiHoQgldEIGLVK9EaTFmFH9jkkvLA41VT/4q0XDJLUopJkJmWHAqZyRAPJOvBUS+NYSLC4FFjoJkUfGP/La3XNJCMJPep5CkIaRQCSTuM4ikUepPHAnZLEErtHuqs1EWDizBAvsdVeWBxqqn9aiS9FK24Z0KUhvVkY7ZbylKV/SrKiK0yrKqFkPe3/sZ//8xt6t2dajIDpFMRf6tSU9FIlJJKChTJIgq2hhZlrTlNcpaB/Xv5rDOU//uUBA2AAoQl1lVgwARQxLrKrBgAjCyVTrmngAGFkqnXNPAAg4ANdH9PKxIijn/xmvyjW2ZISnLe5yUtyv2ufSTfVJUGyoFiU6s6Crgyd2PEyn5Ul/85kUElPRSJSSSgoUySIKtoYWZa05TXKWgf17+awzlIOADXR/TxLEiKOf/GZ/KNbZkhKct7nJS3K/a59JN9UlQbKgWJTqzoKuDJ3Y8TKflSX/zmRQSCs10kCQCFAcBJCZCbl2c0bF5RBELfoQBmp3G2m3m3lgZoN0/BmhutukeGPbe/GtGj9jtiXNZdfDjIwYiYvnePS27ebO75y/Edksl4SONB/PlBrg6dNh8h+pW2//lktFhYcFZrpIEgEKA4CSEyE3Ls5o2LyiCIW/QgDNTuNtNvNvLAzQbp+DNDdbdI8Me29+NaNH7HbEuay6+HGRgxExfO8elt282d3zl+I7JZLwkcaD+fKDXB06bD5D9Stt//LJaLCw4AhAEAACKEywIJz0PRwTBn6tS2//uUBAmAAmUjVNdhAABMpGqa7CAACWiNUay8pYEtEao1l5SwsvqET9LUv/TIpAROYdsSHIoHxzccjRUPRZmVQnHLH7FYdB9rF8Q11yOCAKeHZHyIhMO///lWz0JPcAQgCAABFCZYEE56Ho4Jgz9WpbWX1CJ+lqX/pkUgInMO2JDkUD45uORoqHoszKoTjlj9isOg+1i+Ia65HBAFPDsj5EQmHf//yrZ6EnuACgcjEAKT2Dfl0wUuCCDwOHgDLjMYs6OLViO840e/fHfBZmadNu+NYYNVT84fPkYRCJ/K5V3vsq0Gh0H0YgBP+moubbodw+IHr/kgAoHIxACk9g35dMFLggg8Dh4Ay4zGLOji1YjvONHv3x3wWZmnTbvjWGDVU/OHz5GEQifyuVd77KtBodB9GIAT/pqLm26HcPiB6/5KAE6OeESRRgDMViF4jCI2bT5fbThs6iKGQfPTVaYtXdjMROEbiIqKlZk1KJAzpcWEnNs6FapfKXq1jerLEhaS//uUBB+BAmUqVWsMKrhMpUqtYYVXCTSlTzWSgAE0lKp2sFAAqcgRPyRHxKsBPAQVtIgCdHPCJIowBmKxC8RhEbNp8vtpw2dRFDIPnpqtMWruxmInCNxEVFSsyalEgZ0uLCTm2dCtUvlL1axvVliQtJVOQIn5Ij4lWAngIK2kQCHQhVnhkMD1BlLGveBt13z8bjbsI+MtfqdjdaAQiJFeBGV0AQFB2Qr8QDBc8iiATM25R8+fqp/Izn9CHGC7CEg5BTqd6jM4IBoADCiIYSTWAeAwKIoGBRr+EfZ3bjcbhhdDLX6nY3WgEIiRXgRloICoOyFfiA4+RRAJmbco+fP1U/kZz+hDjBdhCQcgp1O9QZnAQAbiCQAm485bonLdZ5NLqAAAEaPfiGAJsDpfUrAhC8wIZFkkEsiX6UBGvscp3FQfN5VNjWCnQ6AGqvk/UqZBbG3rpCt0gR7qtiNBxOfSeTupa6fMjXaMuYTclIn9ZIVayP2pYMiVUajtVYufukCu//uUBDWABAw9Uu5p4AKDx9qdzLwAiiyjShmngAFFlGlDNPAAm9bW7Vct6q61jNa/e6f/0cL33T31CoACacjUkabckdbjkoAAQ2Pe5fJoCshU+EXmCMRGkCbpN6UCNfKFHfcVB8kSOgSgDsuTAAtXyfqVMgtjb10hW6QI91XCQyZP85jl1K90+ZGuz5Ewl0gGT+skKsGAr0weA/JVRqO1Vi5+6QK6b1tbtFct6q61jNa+26fG/RwvfdPeIpm6BswQctcoCeIAYEYf1mWXRGbxQSwlUiCoY91ytUSo4mqDAgHrhQ3Y/4l2ptfeDG/xHfQXlda18S59aW+rZz8/Gtf7vXU0aFeJUKxkREA+tA5tnJGCDlrlATxADAjD+syy6IzeKCWEqkQVDHuuVqiVHE1QYEA9cKG7H/Eu1Nr7wY3+I76C8rrWviXPrS31bOfn41r/d66mjQrxKhWMiIgH1oHNs5Iw4nNwugqcGVUIoOnFryq5YBVMFyLPEAM4rxNXgSVW//uUBA+AAtkszwZtgABapZngzbAACxyZTzmkgAljkynnNJABzA8PYTFvx2VIR78NqPytscLolrRXGbLUv3rfHNp37BGU77n4xv9NNmu7larWfrk294JgJMNJQ9k6Z//3mHE5uF0FTgyqhFB04teVXLAKpguRZ4gBnFeJq8CSq2YHh7CYt+OypCPfhtR+VtjhdEtaK4zZal+9b45tO/YIynfc/GN/pps13crVaz9cm3vBMBJhpKLJ0z//vAA/m9Y8//8wALImAAl3wUQQSnfKuPXkDS5Ql5I8JfOufQG0twDlAxToCFKYarEoVqWFNJ6nNVd9fnX5/O72D/GEfeJf1TBIwjlyh7XHDg+dW/e///9oGG0YAH83rHn//mABZEwAEu+CiCCU75Vx68gaXKEvJHhL51z6A2luAcoGKdAQpTDVYlCtSwppPU5qrvr86/P53ewf4wj7xL+qYJGEcuUPa44cHzq373///tAw2joy5iMKijE5A82dFg4+liKoGBQF//uUBAmAAqobToZt4ABVI2nQzbwAClBrX7j0gBFKDWv3HpACuAcKpXhYKYZtV8OtethxIYxrF3onBiRVg0Z5VNJHjodV8sWdI031RiPzue4vQ9IA5zgUawg6s0J1ixM4H0rkVfR6DLmIwqKMTkDzZ0WDj6WIqgYFAW4BwqleFgphm1Xw6162HEhjGsXeicGJFWDRnlU2I8dDqvlizpGm+qMR+dz3F6HpAHOcCjWEHVmhOsWJnA+lcir6PQCI3I43G43HIxGIwIABFJObxBmwXEYYlhzHKcYl4ccyEKlyI6ONNnSpVx1pORjqKXEvGgpRqN/VI1tIQnEAogesbyZtJhhEj7rQutav+WB4ClRCCI3I43G43HIxGIwIABFJObxBmwXEYYlhzHKcYl4ccyEKlyI6ONNnSpVx1pORjqKXEvGgpRqN/VI1tIQnEAogesbyZtJhhEj7rQutav+WB4ClRDWAElxIBP/fgA5BRsQaBJEcORBgUrqXzDOmyQ7B8Js0//uUBA+AAnIbz+9swABNA3nq7ZgACYxbKSxpgQEzi6UljTAh0ph0igLRRPKosl/+21oMFkUfTMlPbu5vLWMhsIpBoJlEBWacSYwqxs0adkSycpqwAugFfb4AMMU0BUCAJUc6VBAkwaXzDlPhDsnkNmmlMVAKAOiieBJHkv/22tBkzUfXZJ+37zy1jILgmkGjpRAVmnCVjCrGzRozkSydWoAAhAKsACEHAmDZAyOJvjXlQsCbLAhfALBGnDuUyMsKxSWoyN41Ma1yzl81ldaycS4FmOc/HeG0F0EouNMvOJY8wRknQ2MHFgo50O9wABCAVYAEIOBMGyBkcTfGvKhYE2WBC+AWCNOHcpkZYViktRkbxqY1rlnL5rK61k4lwLMc5+Od4vceyz2aZfD2t6Yf1T8VpbBUmvyf/6WSCIaFJmBQHBBPnChjBCJpALOEZzWEOoXAjEVcJwU6QNMnCQemw5lYr1wP4Yrd7Kh813KsJITdZtDZdO/Nb/EeIEOq6mn9//uUBCMMglwayou4eTBKg1lRdw8mCRxbKCzswxEuGGWdow2oj0ziXaKZIIhoUmYFAcEE+cKGMEImkAs4RnNYQ6hcCMRVwnBTpA0ycJB6bDmVivXA/hit3sqHzXcqwkhN1m0Nl0781v8R4gQ3qup/2PTcl2geDKLS0Dlz62OeezARhAXGxQHQWEYYrFAT3TZw4FCwS4JDTF8AkaliQVaJoBk2ZlkiTQ2GgZmiQ1TzBSo+AA7JnYoKkVD1ZLuX4AtuEAwAFeAsHNMiPlXBIxSunQZU2GQTJoCe6bOHAoWCXBIaYvkUWljkvhpGS5mWFUrqaky+ZUivDyLT+PkTH9Nf5Jc8MPCT5LS5agFKBGvwAEGuOYUBgViPhKwULrvceUN2EYE5cfjEPVa76oYHc8iajBh079LyeBx+8xsatjP5+f/v9moz085O0y92c1/TLeIQBc5iarAMAtQBhIDsHMLAswKiDlZBMLgFd7jyhuwXBjO4/GIeq131ERQsohipJqEF//uUBDuAAl4rSc1swABNpWkWriAAT6S1N7msABH4Fqa3NYACK3Y2lxKnyqWlj4I9evjntWStpWltoH3a1c9wPfBQe51tv4QIRW5JWpHY2wmAQCAA3Ez8JQ0wQP/M2RNaIDhCYutAAONBBkAlvb4j4+qi40CU4Bh3bhxXygTVd/7vSq0iY6iSWWXrsXQ29eVJCqUsoXWy7X/vdWvP1JZg/tBEovFId////7rne699onXkM9DUl/+GAZBQDf8JEQCKo//+ogQCRyuRRuRthMAgEABkJp6CMpiBP+aMybcYnwznWkEqoAuaC5GfvF8HZFWg/FXSa8blglIwmKgd/7XpVaYZFGTZZe5DuQPushJSpXIpuwbX/vdWvL6kswcmPQFF4Ef3////LXO917pQHTyGedqP//DAMgoD3/CREAiqP/2eqv////////3dk90KlpVV3eUWVjHLZSMUp5hxnpOcO1WpXVXu4ijKYTSd3IJ7Kzt6Wp7FWiGQUEGFRgdCgpRM//uUBB8P8lRjwIcAoABJLFgQ4BQASJmNAgAFHEkIsiAAAaegRMowxhYVZBMOCoAh7/////////79CTkvIITTqZkZjVGEMPHvEBE7IZXMpGVFYqsKyOYw5jjmOZkFDdkZLkW+9NjEIZxbiYixXO5QkcoRVQoYBgYPlK+XmRGbwXaEFZGvWIpZLWEizxltQ9uELQV7E73d3HESrONG7w3dTdpF6Skf/zNT3I6rIKxJy1oKCtGGjj5FDxcKB+HpYd/3//i3rZFOT0N05+QpgWZYZ3pi5biJNCj4fRQQwYK8p48BQUTWPDTbNjkPn8+1VXKvJ7dJ5Gb2mESWLjnHOYNH07r6//////////icK81KXqTXuvQEteLGdY0DKwrjQVTIMKbgE0b41Egi1KxtuNwUpf9X+bNqTUlXbDClWgIlS4wMVc1F0QZc3/N/yto/7eUShjGUstRgIUZXKUrFYwU5SgKOxgYE+krfVkf6St/VpnMaYwpwoCjoZwoCZwqFC4LH//uUBD+P4jNjPwAjN8I7THfwAEnqR8mAugCAcQkHsheEERr40LUwj//hIzL//9k/9rJZ9lks+yyVDL/////81YHZUMj//yZZLHIy7/5qwMHHIyZZL/sslQyNWt/I1DBQYRxPYaxS/////5kn///6on0VEVP/6on/7OVFVO5QwUGEOzyhgaoqKhQwMGCUjt////8qaLdr/qTiyzLxaJxpRTt6RBhIhDZMQU1FMy4xMDCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"),KC=()=>(()=>{let e=new(window.AudioContext||window.webkitAudioContext),t=e.createGain();t.connect(e.destination);let n=new Io(yM(e));return e.decodeAudioData(GC.buffer.slice(0)).then(r=>{n.buf=r}).catch(r=>{console.error("Failed to load burp: ",r)}),{ctx:e,masterNode:t,burpSnd:n}})();function WC(e,t={}){let n=new We,r=new Audio(e);r.crossOrigin="anonymous",r.loop=!!t.loop,M.audio.ctx.createMediaElementSource(r).connect(M.audio.masterNode);function o(){M.debug.paused||M.app.isHidden()&&!M.globalOpt.backgroundAudio||M.audio.ctx.resume()}function s(){o(),r.play()}return t.paused||s(),r.onended=()=>n.trigger(),{play(){s()},seek(i){r.currentTime=i},stop(){r.pause(),this.seek(0)},set loop(i){r.loop=i},get loop(){return r.loop},set paused(i){i?r.pause():s()},get paused(){return r.paused},time(){return r.currentTime},duration(){return r.duration},set volume(i){r.volume=Ft(i,0,1)},get volume(){return r.volume},set speed(i){r.playbackRate=Math.max(i,0)},get speed(){return r.playbackRate},set detune(i){},get detune(){return 0},onEnd(i){return n.add(i)},then(i){return this.onEnd(i)}}}function YC(e,t={}){if(typeof e=="string"&&M.assets.music[e])return WC(M.assets.music[e],t);let n=M.audio.ctx,r=t.paused??!1,o=n.createBufferSource(),s=new We,i=n.createGain(),a=n.createStereoPanner(),l=t.seek??0,c=0,d=0,f=!1;o.loop=!!t.loop,o.detune.value=t.detune??0,o.playbackRate.value=t.speed??1,o.connect(a),o.onended=()=>{var g;p()>=(((g=o.buffer)==null?void 0:g.duration)??Number.POSITIVE_INFINITY)&&s.trigger()},a.pan.value=t.pan??0,a.connect(i),i.connect(M.audio.masterNode),i.gain.value=t.volume??1;let u=g=>{o.buffer=g.buf,r||(c=n.currentTime,o.start(0,l),f=!0)},h=$M(e);h instanceof yt&&h.onLoad(u);let p=()=>{if(!o.buffer)return 0;let g=r?d-c:n.currentTime-c,y=o.buffer.duration;return o.loop?g%y:Math.min(g,y)},m=g=>{let y=n.createBufferSource();return y.buffer=g.buffer,y.loop=g.loop,y.playbackRate.value=g.playbackRate.value,y.detune.value=g.detune.value,y.onended=g.onended,y.connect(a),y};return{stop(){this.paused=!0,this.seek(0)},set paused(g){if(r!==g)if(r=g,g)f&&(o.stop(),f=!1),d=n.currentTime;else{o=m(o);let y=d-c;o.start(0,y),f=!0,c=n.currentTime-y,d=0}},get paused(){return r},play(g=0){this.seek(g),this.paused=!1},seek(g){var y;(y=o.buffer)!=null&&y.duration&&(g>o.buffer.duration||(r?(o=m(o),c=d-g):(o.stop(),o=m(o),c=n.currentTime-g,o.start(0,g),f=!0,d=0)))},set speed(g){o.playbackRate.value=g},get speed(){return o.playbackRate.value},set detune(g){o.detune.value=g},get detune(){return o.detune.value},set volume(g){i.gain.value=Math.max(g,0)},get volume(){return i.gain.value},set pan(g){a.pan.value=g},get pan(){return a.pan.value},set loop(g){o.loop=g},get loop(){return o.loop},duration(){var g;return((g=o.buffer)==null?void 0:g.duration)??0},time(){return p()%this.duration()},onEnd(g){return s.add(g)},then(g){return this.onEnd(g)}}}function sg(e){return M.k.play(M.audio.burpSnd,e)}function ig(e){M.audio.masterNode.gain.value=e}function ag(){return M.audio.masterNode.gain.value}function XC(e){return Lr("volume","setVolume / getVolume"),e!==void 0&&ig(e),ag()}function lg(){M.app.onHide(()=>{M.globalOpt.backgroundAudio||M.audio.ctx.suspend()}),M.app.onShow(()=>{!M.globalOpt.backgroundAudio&&!M.debug.paused&&M.audio.ctx.resume()}),M.app.onResize(()=>{if(M.app.isFullscreen())return;let e=M.globalOpt.width&&M.globalOpt.height;e&&!M.globalOpt.stretch&&!M.globalOpt.letterbox||(M.canvas.width=M.canvas.offsetWidth*M.pixelDensity,M.canvas.height=M.canvas.offsetHeight*M.pixelDensity,Pp(),e||(M.gfx.frameBuffer.free(),M.gfx.frameBuffer=new Zs(M.gfx.ggl,M.gfx.ggl.gl.drawingBufferWidth,M.gfx.ggl.gl.drawingBufferHeight),M.gfx.width=M.gfx.ggl.gl.drawingBufferWidth/M.pixelDensity/M.gscale,M.gfx.height=M.gfx.ggl.gl.drawingBufferHeight/M.pixelDensity/M.gscale))}),M.globalOpt.debug!==!1&&(M.app.onKeyPress(M.globalOpt.debugKey??"f1",()=>M.debug.inspect=!M.debug.inspect),M.app.onKeyPress("f2",()=>M.debug.clearLog()),M.app.onKeyPress("f8",()=>M.debug.paused=!M.debug.paused),M.app.onKeyPress("f7",()=>{M.debug.timeScale=nl(Ft(M.debug.timeScale-.2,0,2),1)}),M.app.onKeyPress("f9",()=>{M.debug.timeScale=nl(Ft(M.debug.timeScale+.2,0,2),1)}),M.app.onKeyPress("f10",()=>M.debug.stepFrame())),M.globalOpt.burp&&M.app.onKeyPress("b",()=>sg())}function QC(e,t={}){let n=M.game.root.add([ei(e),hg()]),r=(t.speed||1)*5,o=t.scale||1;n.add([cl(M.boomSprite),ti(0),fl("center"),yd(r,o),...t.comps??[]]);let s=n.add([cl(M.kaSprite),ti(0),fl("center"),ul(),...t.comps??[]]);return s.wait(.4/r,()=>s.use(yd(r,o))),s.onDestroy(()=>n.destroy()),n}function cg(e,t){if(M.game.layers)throw Error("Layers can only be assigned once.");let n=e.indexOf(t);if(n==-1)throw Error("The default layer name should be present in the layers list.");M.game.layers=e,M.game.defaultLayerIndex=n}function ZC(){return M.game.layers}function JC(){var e;return((e=M.game.layers)==null?void 0:e[M.game.defaultLayerIndex])??null}function e2(e,t){Lr("layers","setLayers"),cg(e,t)}function ug(e){e.destroy()}function t2(){return M.game.root}function n2(e,t){M.game.scenes[e]=t}function r2(e,...t){if(!M.game.scenes[e])throw new Error(`Scene not found: ${e}`);M.game.events.onOnce("frameEnd",()=>{M.game.events.trigger("sceneLeave",e),M.app.events.clear(),M.game.events.clear(),M.game.objEvents.clear(),[...M.game.root.children].forEach(n=>{!n.stay||n.scenesToStay&&!n.scenesToStay.includes(e)?M.game.root.remove(n):n.trigger("sceneEnter",e)}),M.game.root.clearEvents(),lg(),M.game.cam={pos:null,scale:$(1),angle:0,shake:0,transform:new jt},M.game.scenes[e](...t)}),M.game.currentScene=e}function o2(e){return M.game.events.on("sceneLeave",e)}function s2(){return M.game.currentScene}function cl(e,t={}){let n=null,r=null,o=null,s=new We;if(!e)throw new Error("Please pass the resource name or data to sprite()");let i=(c,d,f,u)=>{let h=$(1,1);return f&&u?(h.x=f/(c.width*d.w),h.y=u/(c.height*d.h)):f?(h.x=f/(c.width*d.w),h.y=h.x):u&&(h.y=u/(c.height*d.h),h.x=h.y),h},a=(c,d)=>{if(!d)return;let f=d.frames[0].clone();t.quad&&(f=f.scale(t.quad));let u=i(d.tex,f,t.width,t.height);if(c.width=d.tex.width*f.w*u.x,c.height=d.tex.height*f.h*u.y,d.anims)for(let h in d.anims){let p=d.anims[h];typeof p!="number"&&(p.frames=l(p))}n=d,s.trigger(n),t.anim&&c.play(t.anim)},l=c=>{if(c.frames)return c.frames;let d=[];if(c.from===void 0||c.to===void 0)throw new Error("Sprite anim 'from' and 'to' must be defined if 'frames' is not defined");let f=Math.abs(c.to-c.from)+1;for(let u=0;u<f;u++)d.push(c.from+u*Math.sign(c.to-c.from));if(c.pingpong)for(let u=f-2;u>0;u--)d.push(d[u]);return d};return{id:"sprite",width:0,height:0,frame:t.frame||0,quad:t.quad||new Ie(0,0,1,1),animSpeed:t.animSpeed??1,flipX:t.flipX??!1,flipY:t.flipY??!1,get sprite(){return e.toString()},set sprite(c){let d=Es(c);d&&d.onLoad(f=>a(this,f))},get animFrame(){if(!n||!r||o===null)return this.frame;let c=n.anims[r.name];return typeof c=="number"?c:c.from===void 0||c.to===void 0?r.frameIndex:this.frame-Math.min(c.from,c.to)},draw(){if(!n)return;let c=n.frames[this.frame??0];if(!c)throw new Error(`Frame not found: ${this.frame??0}`);if(n.slice9){let{left:d,right:f,top:u,bottom:h}=n.slice9,p=n.tex.width*c.w,m=n.tex.height*c.h,g=this.width-d-f,y=this.height-u-h,A=d/p,w=f/p,E=1-A-w,R=u/m,b=h/m,v=1-R-b,C=[_e(0,0,A,R),_e(A,0,E,R),_e(A+E,0,w,R),_e(0,R,A,v),_e(A,R,E,v),_e(A+E,R,w,v),_e(0,R+v,A,b),_e(A,R+v,E,b),_e(A+E,R+v,w,b),_e(0,0,d,u),_e(d,0,g,u),_e(d+g,0,f,u),_e(0,u,d,y),_e(d,u,g,y),_e(d+g,u,f,y),_e(0,u+y,d,h),_e(d,u+y,g,h),_e(d+g,u+y,f,h)];for(let T=0;T<9;T++){let k=C[T],D=C[T+9];Js(Object.assign(Kn(this),{pos:D.pos(),tex:n.tex,quad:c.scale(k),flipX:this.flipX,flipY:this.flipY,tiled:t.tiled,width:D.w,height:D.h}))}}else Js(Object.assign(Kn(this),{tex:n.tex,quad:c.scale(this.quad??new Ie(0,0,1,1)),flipX:this.flipX,flipY:this.flipY,tiled:t.tiled,width:this.width,height:this.height}))},add(){let c=Es(e);c?c.onLoad(d=>a(this,d)):ic(()=>a(this,Es(e).data))},update(){if(!n||!r||o===null)return;let c=n.anims[r.name];if(typeof c=="number"){this.frame=c;return}if(c.speed===0)throw new Error("Sprite anim speed cannot be 0");if(r.timer+=qe()*this.animSpeed,r.timer>=1/r.speed){r.timer=0,r.frameIndex+=o;let d=c.frames;if(r.frameIndex>=d.length)if(r.pingpong&&!c.pingpong)o=-1,r.frameIndex=d.length-2;else if(r.loop)r.frameIndex=0;else{this.frame=d.at(-1),r.onEnd(),this.stop();return}else if(r.frameIndex<0)if(r.pingpong&&r.loop)o=1,r.frameIndex=1;else if(r.loop)r.frameIndex=d.length-1;else{this.frame=d[0],r.onEnd(),this.stop();return}this.frame=d[r.frameIndex]}},play(c,d={}){if(!n){s.add(()=>this.play(c,d));return}let f=n.anims[c];if(f===void 0)throw new Error(`Anim not found: ${c}`);r&&this.stop(),r=typeof f=="number"?{name:c,timer:0,loop:!1,pingpong:!1,speed:0,frameIndex:0,onEnd:()=>{}}:{name:c,timer:0,loop:d.loop??f.loop??!1,pingpong:d.pingpong??f.pingpong??!1,speed:d.speed??f.speed??10,frameIndex:0,onEnd:d.onEnd??(()=>{})},o=typeof f=="number"?null:1,this.frame=typeof f=="number"?f:f.frames[0],this.trigger("animStart",c)},stop(){if(!r)return;let c=r.name;r=null,this.trigger("animEnd",c)},numFrames(){return(n==null?void 0:n.frames.length)??0},getCurAnim(){return r},curAnim(){return r==null?void 0:r.name},getAnim(c){return(n==null?void 0:n.anims[c])??null},hasAnim(c){return!!this.getAnim(c)},onAnimEnd(c){return this.on("animEnd",c)},onAnimStart(c){return this.on("animStart",c)},renderArea(){return new Ee($(0),this.width,this.height)},inspect(){return typeof e=="string"?`sprite: "${e}"`:null}}}function i2(e,t={}){function n(o){var i,a;let s=$n(Object.assign(Kn(o),{text:o.text+"",size:o.textSize,font:o.font,width:t.width&&o.width,align:o.align,letterSpacing:o.letterSpacing,lineSpacing:o.lineSpacing,transform:o.textTransform,styles:o.textStyles,indentAll:t.indentAll}));return t.width||(o.width=s.width/(((i=o.scale)==null?void 0:i.x)||1)),o.height=s.height/(((a=o.scale)==null?void 0:a.y)||1),s}let r={id:"text",set text(o){e=o,n(this),this.renderedText=il(e).text},get text(){return e},textSize:t.size??36,font:t.font,width:t.width??0,height:0,align:t.align,lineSpacing:t.lineSpacing,letterSpacing:t.letterSpacing,textTransform:t.transform,textStyles:t.styles,renderedText:e?il(e).text:"",add(){ic(()=>n(this))},draw(){Gn(n(this))},renderArea(){return new Ee($(0),this.width,this.height)}};return n(r),r}function a2(e,t){return{id:"rect",width:e,height:t,draw(){No(Object.assign(Kn(this),{width:this.width,height:this.height}))},renderArea(){return new Ee($(0),this.width,this.height)},inspect(){return`uvquad: (${Math.ceil(this.width)}w, ${Math.ceil(this.height)})h`}}}function l2(e={}){let t=null,n=null,r=null,o=null;return{id:"agent",require:["pos","tile"],agentSpeed:e.speed??100,allowDiagonals:e.allowDiagonals??!0,getDistanceToTarget(){return t?this.pos.dist(t):0},getNextLocation(){return n&&r?n[r]:null},getPath(){return n?n.slice():null},getTarget(){return t},isNavigationFinished(){return n?r===null:!0},isTargetReachable(){return n!==null},isTargetReached(){return t?this.pos.eq(t):!0},setTarget(s){t=s,n=this.getLevel().getPath(this.pos,t,{allowDiagonals:this.allowDiagonals}),r=n?0:null,n&&r!==null?(o||(o=this.getLevel().onNavigationMapChanged(()=>{t&&n&&r!==null&&(n=this.getLevel().getPath(this.pos,t,{allowDiagonals:this.allowDiagonals}),n?(r=0,this.trigger("navigationNext",this,n[r])):(r=null,this.trigger("navigationEnded",this)))}),this.onDestroy(()=>o==null?void 0:o.cancel())),this.trigger("navigationStarted",this),this.trigger("navigationNext",this,n[r])):this.trigger("navigationEnded",this)},update(){if(t&&n&&r!==null){if(this.pos.sdist(n[r])<2)if(r===n.length-1){this.pos=t.clone(),r=null,this.trigger("navigationEnded",this),this.trigger("targetReached",this);return}else r++,this.trigger("navigationNext",this,n[r]);this.moveTo(n[r],this.agentSpeed)}},onNavigationStarted(s){return this.on("navigationStarted",s)},onNavigationNext(s){return this.on("navigationNext",s)},onNavigationEnded(s){return this.on("navigationEnded",s)},onTargetReached(s){return this.on("targetReached",s)},inspect(){return"agent: "+JSON.stringify({target:JSON.stringify(t),path:JSON.stringify(n)})}}}function c2(e){let t=e.graph;return{id:"pathfinder",require:["pos"],navigateTo(n){var r;return(r=this.graph)==null?void 0:r.getWaypointPath(this.pos,n,e.navigationOpt)},get graph(){if(t)return t;let n=this.parent;for(;n;){if(n.has("pathfinderMap"))return n.graph;n=n.parent}},set graph(n){t=n}}}function u2(e={}){let t=e.waypoints,n=e.speed||100,r=e.endBehavior||"stop",o=0,s=t!=null;return{id:"patrol",require:["pos"],get patrolSpeed(){return n},set patrolSpeed(i){n=i},get waypoints(){return t},set waypoints(i){t=i,o=0,s=!1},get nextLocation(){return t?t[o]:void 0},update(){let i=this.nextLocation;if(!(!t||!i||s)&&(this.moveTo(i,n),this.pos.sdist(i)<9))switch(r){case"loop":o=(o+1)%t.length;break;case"ping-pong":o=o+1,o==t.length&&(t.reverse(),o=0);break;case"stop":o=Math.min(o+1,t.length-1),o==t.length-1&&(s=!0,this.trigger("patrolFinished"));break}},onPatrolFinished(i){return this.on("patrolFinished",i)}}}function d2(e,t={}){let n=typeof e=="function"?e:()=>M.game.root.query(e),r=t.checkFrequency||1,o=typeof t.direction=="number"?X.fromAngle(t.direction):t.direction,s=0;return{id:"sentry",require:["pos"],direction:typeof t.direction=="number"?X.fromAngle(t.direction):t.direction,spotted:[],set directionAngle(i){this.direction=i!==void 0?X.fromAngle(i):void 0},get directionAngle(){return this.direction?this.direction.angle():void 0},fieldOfView:t.fieldOfView||200,isWithinFieldOfView(i,a,l){let c=(typeof a=="number"?X.fromAngle(a):a)||o,d=l||t.fieldOfView;if(!c||!d||d>=360)return!0;let f=d/2;return i.pos&&c.angleBetween(i.pos.sub(this.pos))<=f},hasLineOfSight(i){let a=Gp(this.pos,i.pos.sub(this.pos),t.raycastExclude);return a!=null&&a.object===i},update(){if(s+=qe(),s>r){s-=r;let i=n();if(i.length&&o&&this.fieldOfView&&this.fieldOfView<360){let a=this.fieldOfView/2;i=i.filter(l=>l.pos&&o.angleBetween(l.pos.sub(this.pos))<=a)}i.length&&t.lineOfSight&&(i=i.filter(a=>a.pos&&this.hasLineOfSight(a))),i.length>0&&(this.spotted=i,this.trigger("objectSpotted",i))}},onObjectsSpotted(i){return this.on("objectSpotted",i)}}}function dg(e={}){let t=$(0),n=e.isObstacle??!1,r=e.cost??0,o=e.edges??[],s=()=>{let a={left:1,top:2,right:4,bottom:8};return o.map(l=>a[l]||0).reduce((l,c)=>l|c,0)},i=s();return{id:"tile",tilePosOffset:e.offset??$(0),set tilePos(a){let l=this.getLevel();t=a.clone(),this.pos=$(this.tilePos.x*l.tileWidth(),this.tilePos.y*l.tileHeight()).add(this.tilePosOffset)},get tilePos(){return t},set isObstacle(a){n!==a&&(n=a,this.getLevel().invalidateNavigationMap())},get isObstacle(){return n},set cost(a){r!==a&&(r=a,this.getLevel().invalidateNavigationMap())},get cost(){return r},set edges(a){o=a,i=s(),this.getLevel().invalidateNavigationMap()},get edges(){return o},get edgeMask(){return i},getLevel(){return this.parent},tileMove(a){let l=this.getLevel();l.removeFromSpatialMap(this),this.tilePos=this.tilePos.add(a),l.insertIntoSpatialMap(this),l.trigger("spatialMapChanged")},moveLeft(){this.tileMove($(-1,0))},moveRight(){this.tileMove($(1,0))},moveUp(){this.tileMove($(0,-1))},moveDown(){this.tileMove($(0,1))}}}var lc=class{constructor(e,t,n){H(this,"name");H(this,"duration");H(this,"loops");H(this,"direction");H(this,"easing");H(this,"interpolation");H(this,"isFinished");H(this,"timing");H(this,"easings");H(this,"relative");this.name=e,this.duration=t.duration,this.loops=t.loops||0,this.direction=t.direction||"forward",this.easing=t.easing||Po.linear,this.interpolation=t.interpolation||"linear",this.isFinished=!1,this.timing=t.timing,this.easings=t.easings,this.relative=n}update(e,t){return!0}getLowerKeyIndexAndRelativeTime(e,t,n){let r=t-1,o=e/this.duration;if(this.loops!==0&&o>=this.loops)return[r,0,!0];let s=Math.trunc(o);if(o-=s,(this.direction=="reverse"||this.direction=="ping-pong"&&s&1)&&(o=1-o),n){let i=0;for(;n[i+1]!==void 0&&n[i+1]<o;)i++;return i>=r?[r,0,!0]:[i,(o-n[i])/(n[i+1]-n[i]),!1]}else{let i=Math.floor((t-1)*o);return[i,(o-i/r)*r,!1]}}setValue(e,t,n){if(this.relative)switch(t){case"pos":e.pos=e.base.pos.add(n);break;case"angle":e.angle=e.base.angle+n;break;case"scale":e.scale=e.base.scale.scale(n);break;case"opacity":e.opacity=e.base.opacity*n;break;default:e[t]=n}else e[t]=n}serialize(){let e={duration:this.duration,keys:[]};return this.loops&&(e.loops=this.loops),this.direction!=="forward"&&(e.direction=this.direction),this.easing!=Po.linear&&(e.easing=this.easing.name),this.interpolation!=="linear"&&(e.interpolation=this.interpolation),this.timing&&(e.timing=this.timing),this.easings&&(e.easings=this.easings.map(t=>this.easing.name)),e}};function md(e,t){return t.add(t.sub(e))}var f2=class extends lc{constructor(t,n,r,o){super(t,r,o);H(this,"keys");this.keys=n}update(t,n){let[r,o,s]=this.getLowerKeyIndexAndRelativeTime(n,this.keys.length,this.timing);if(o==0||this.interpolation==="none")this.setValue(t,this.name,this.keys[r]);else{let i=this.easings?this.easings[r]:this.easing;this.setValue(t,this.name,nt(this.keys[r],this.keys[r+1],i(o)))}return s}serialize(){return Object.assign(super.serialize(),{keys:this.keys})}},h2=class extends lc{constructor(t,n,r,o,s){var i;super(t,r,o);H(this,"keys");H(this,"curves");H(this,"dcurves");if(this.keys=n,this.interpolation==="spline"){this.curves=[],s&&(this.dcurves=[]);for(let a=0;a<this.keys.length-1;a++){let l=this.keys[a],c=a+1,d=this.keys[c],f=a>0?this.keys[a-1]:md(d,l),u=c<this.keys.length-1?this.keys[c+1]:md(l,d);this.curves.push(Ys(f,l,d,u)),s&&((i=this.dcurves)==null||i.push(Ys(f,l,d,u,cS)))}}}update(t,n){let[r,o,s]=this.getLowerKeyIndexAndRelativeTime(n,this.keys.length,this.timing);if(o==0||this.interpolation==="none")this.setValue(t,this.name,this.keys[r]);else{let i=this.easings?this.easings[r]:this.easing;switch(this.interpolation){case"linear":this.setValue(t,this.name,this.keys[r].lerp(this.keys[r+1],i(o)));break;case"slerp":this.setValue(t,this.name,this.keys[r].slerp(this.keys[r+1],i(o)));break;case"spline":if(this.curves){this.setValue(t,this.name,this.curves[r](i(o))),this.dcurves&&this.setValue(t,"angle",this.dcurves[r](i(o)).angle());break}}}return s}serialize(){return Object.assign(super.serialize(),{keys:this.keys.map(t=>[t.x,t.y])})}},p2=class extends lc{constructor(t,n,r,o){super(t,r,o);H(this,"keys");this.keys=n}update(t,n){let[r,o,s]=this.getLowerKeyIndexAndRelativeTime(n,this.keys.length,this.timing);if(o==0||this.interpolation=="none")this.setValue(t,this.name,this.keys[r]);else{let i=this.easings?this.easings[r]:this.easing;this.setValue(t,this.name,this.keys[r].lerp(this.keys[r+1],i(o)))}return s}serialize(){return Object.assign(super.serialize(),{keys:this.keys})}};function g2(e={}){let t=[],n=0,r=!1;return{id:"animate",require:e.followMotion?["rotate"]:void 0,base:{pos:$(0,0),angle:0,scale:$(1,1),opacity:1},animation:{paused:!1,seek(o){n=Ft(o,0,this.duration),t.forEach(s=>{s.isFinished=!1}),r=!1},get duration(){return t.reduce((o,s)=>Math.max(s.duration,o),0)}},add(){e.relative&&(this.has("pos")&&(this.base.pos=this.pos.clone()),this.has("rotate")&&(this.base.angle=this.angle),this.has("scale")&&(this.base.scale=this.scale),this.has("opacity")&&(this.base.opacity=this.opacity))},update(){if(this.animation.paused)return;let o=!0,s;n+=qe();for(let i of t)s=i.update(this,n),s&&!i.isFinished&&(i.isFinished=!0,this.trigger("animateChannelFinished",i.name)),o&&(o=s);o&&!r&&(r=!0,this.trigger("animateFinished"))},animate(o,s,i){r=!1,this.unanimate(o),typeof s[0]=="number"?t.push(new f2(o,s,i,e.relative||!1)):s[0]instanceof X?t.push(new h2(o,s,i,e.relative||!1,o==="pos"&&(e.followMotion||!1))):s[0]instanceof pe&&t.push(new p2(o,s,i,e.relative||!1))},unanimate(o){let s=t.findIndex(i=>i.name===o);s>=0&&t.splice(s,1)},unanimateAll(){t.splice(0,t.length)},onAnimateFinished(o){return this.on("animateFinished",o)},onAnimateChannelFinished(o){return this.on("animateChannelFinished",o)},serializeAnimationChannels(){return t.reduce((o,s)=>(o[s.name]=s.serialize(),o),{})},serializeAnimationOptions(){let o={};return e.followMotion&&(o.followMotion=!0),e.relative&&(o.relative=!0),o}}}function fg(e,t){let n={name:e.name};return e.has("animate")&&(n.channels=e.serializeAnimationChannels(),Object.assign(n,e.serializeAnimationOptions())),e.children.length>0&&(n.children=e.children.filter(r=>r.has("named")).map(r=>fg(r,r.name))),n}function yd(e=2,t=1){let n=0;return{require:["scale"],update(){let r=Math.sin(n*e)*t;r<0&&this.destroy(),this.scale=$(r),n+=qe()}}}function m2(e,t){if(e==null)throw new Error("health() requires the initial amount of hp");return{id:"health",hurt(n=1){this.setHP(e-n),this.trigger("hurt",n)},heal(n=1){let r=e;this.setHP(e+n),this.trigger("heal",e-r)},hp(){return e},maxHP(){return t??null},setMaxHP(n){t=n},setHP(n){e=t?Math.min(t,n):n,e<=0&&this.trigger("death")},onHurt(n){return this.on("hurt",n)},onHeal(n){return this.on("heal",n)},onDeath(n){return this.on("death",n)},inspect(){return`health: ${e}`}}}function y2(e,t={}){if(e==null)throw new Error("lifespan() requires time");let n=t.fade??0;return{id:"lifespan",require:["opacity"],add(){M.game.root.wait(e,()=>{this.opacity=this.opacity??1,n>0?M.game.root.tween(this.opacity,0,n,r=>this.opacity=r,Po.linear).onEnd(()=>{this.destroy()}):this.destroy()})}}}function w2(e){return{id:"named",name:e}}function x2(e,t,n){if(!e)throw new Error("state() requires an initial state");let r={};function o(l){r[l]||(r[l]={enter:new We,end:new We,update:new We,draw:new We})}function s(l,c,d){return o(c),r[c][l].add(d)}function i(l,c,...d){o(c),r[c][l].trigger(...d)}let a=!1;return{id:"state",state:e,enterState(l,...c){if(a=!0,t&&!t.includes(l))throw new Error(`State not found: ${l}`);let d=this.state;if(n){if(!(n!=null&&n[d]))return;let f=typeof n[d]=="string"?[n[d]]:n[d];if(!f.includes(l))throw new Error(`Cannot transition state from "${d}" to "${l}". Available transitions: ${f.map(u=>`"${u}"`).join(", ")}`)}i("end",d,...c),this.state=l,i("enter",l,...c),i("enter",`${d} -> ${l}`,...c)},onStateTransition(l,c,d){return s("enter",`${l} -> ${c}`,d)},onStateEnter(l,c){return s("enter",l,c)},onStateUpdate(l,c){return s("update",l,c)},onStateDraw(l,c){return s("draw",l,c)},onStateEnd(l,c){return s("end",l,c)},update(){a||(i("enter",e),a=!0),i("update",this.state)},draw(){i("draw",this.state)},inspect(){return`state: ${this.state}`}}}function hg(e){return{id:"stay",stay:!0,scenesToStay:e}}function v2(e=!0,t){let n,r;return{id:"textInput",hasFocus:e,require:["text"],typedText:"",add(){let o=()=>{this.text=this.typedText.replace(/([\[\\])/g,"\\$1")};n=M.k.onCharInput(s=>{this.hasFocus&&(!t||this.typedText.length<t)&&(M.k.isKeyDown("shift")?this.typedText+=s.toUpperCase():this.typedText+=s,o())}),r=M.k.onKeyPressRepeat("backspace",()=>{this.hasFocus&&(this.typedText=this.typedText.slice(0,-1)),o()})},destroy(){n.cancel(),r.cancel()}}}function ul(e=1e3){return{id:"timer",maxLoopsPerFrame:e,loop(t,n,r=1/0,o=!1){let s=o?0:t,i=new We,a=this.onUpdate(()=>{s+=M.app.state.dt;for(let l=0;s>=t&&l<this.maxLoopsPerFrame;l++)if(r--,n(),s-=t,r<=0){a.cancel(),i.trigger();return}});return{get paused(){return a.paused},set paused(l){a.paused=l},cancel:a.cancel,onEnd(l){i.add(l)},then(l){return i.add(l),this}}},wait(t,n){return this.loop(t,n??(()=>{}),1,!0)},tween(t,n,r,o,s=Po.linear){let i=0,a=[],l=this.onUpdate(()=>{i+=M.app.state.dt;let c=Math.min(i/r,1);o(nt(t,n,s(c))),c===1&&(l.cancel(),o(n),a.forEach(d=>d()))});return{get paused(){return l.paused},set paused(c){l.paused=c},onEnd(c){a.push(c)},then(c){return this.onEnd(c),this},cancel(){l.cancel()},finish(){l.cancel(),o(n),a.forEach(c=>c())}}}}}var dl=0;function b2(){return dl>0}function A2(e={}){let t={},n=new Set,r=[];return{id:"area",collisionIgnore:e.collisionIgnore??[],add(){dl++,this.area.cursor&&r.push(this.onHover(()=>M.app.setCursor(this.area.cursor))),r.push(this.onCollideUpdate((o,s)=>{if(!o.id)throw new Error("area() requires the object to have an id");t[o.id]||this.trigger("collide",o,s),s&&(t[o.id]=s,n.add(o.id))}))},destroy(){dl--;for(let o of r)o.cancel()},fixedUpdate(){for(let o in t)n.has(Number(o))||(this.trigger("collideEnd",t[o].target),delete t[o]);n.clear()},drawInspect(){let o=this.localArea();dt(),Te(this.area.offset);let s={outline:{width:4/Rp(),color:we(0,0,255)},anchor:this.anchor,fill:!1,fixed:Fn(this)};o instanceof Ee?ht({...s,pos:o.pos,width:o.width*this.area.scale.x,height:o.height*this.area.scale.y}):o instanceof Ye?pn({...s,pts:o.pts,scale:this.area.scale}):o instanceof st&&Fr({...s,pos:o.center,radius:o.radius}),tt()},area:{shape:e.shape??null,scale:e.scale?$(e.scale):$(1),offset:e.offset??$(0),cursor:e.cursor??null},isClicked(){return M.app.isMousePressed()&&this.isHovering()},isHovering(){let o=Fn(this)?M.k.mousePos():M.k.toWorld(M.k.mousePos());return this.hasPoint(o)},checkCollision(o){if(!o.id)throw new Error("checkCollision() requires the object to have an id");return t[o.id]??null},getCollisions(){return Object.values(t)},isColliding(o){if(!o.id)throw new Error("isColliding() requires the object to have an id");return!!t[o.id]},isOverlapping(o){if(!o.id)throw new Error("isOverlapping() requires the object to have an id");let s=t[o.id];return s&&s.hasOverlap()},onClick(o,s="left"){let i=M.app.onMousePress(s,()=>{this.isHovering()&&o()});return r.push(i),i},onHover(o){let s=!1;return this.onUpdate(()=>{s?s=this.isHovering():this.isHovering()&&(s=!0,o())})},onHoverUpdate(o){return this.onUpdate(()=>{this.isHovering()&&o()})},onHoverEnd(o){let s=!1;return this.onUpdate(()=>{s?this.isHovering()||(s=!1,o()):s=this.isHovering()})},onCollide(o,s){if(typeof o=="function"&&s===void 0)return this.on("collide",o);if(typeof o=="string")return this.onCollide((i,a)=>{i.is(o)&&(s==null||s(i,a))});throw new Error("onCollide() requires either a function or a tag")},onCollideUpdate(o,s){if(typeof o=="function"&&s===void 0)return this.on("collideUpdate",o);if(typeof o=="string")return this.on("collideUpdate",(i,a)=>i.is(o)&&(s==null?void 0:s(i,a)));throw new Error("onCollideUpdate() requires either a function or a tag")},onCollideEnd(o,s){if(typeof o=="function"&&s===void 0)return this.on("collideEnd",o);if(typeof o=="string")return this.on("collideEnd",i=>i.is(o)&&(s==null?void 0:s(i)));throw new Error("onCollideEnd() requires either a function or a tag")},hasPoint(o){return wn(this.worldArea(),o)},resolveCollision(o){let s=this.checkCollision(o);s&&!s.resolved&&(this.pos=this.pos.add(s.displacement),s.resolved=!0)},localArea(){return this.area.shape?this.area.shape:this.renderArea()},worldArea(){let o=this.localArea();if(!(o instanceof Ye||o instanceof Ee))throw new Error("Only support polygon and rect shapes for now");let s=this.transform.clone().translate(this.area.offset).scale($(this.area.scale??1));if(o instanceof Ee){let i=Br(this.anchor||Ni).add(1,1).scale(-.5).scale(o.width,o.height);s.translate(i)}return o.transform(s)},screenArea(){let o=this.worldArea();return Fn(this)?o:o.transform(M.game.cam.transform)},inspect(){var o,s,i,a,l,c,d;return((o=this.area.scale)==null?void 0:o.x)==((s=this.area.scale)==null?void 0:s.y)?`area: ${(a=(i=this.area.scale)==null?void 0:i.x)==null?void 0:a.toFixed(1)}x`:`area: (${(c=(l=this.area.scale)==null?void 0:l.x)==null?void 0:c.toFixed(1)}x, ${(d=this.area.scale.y)==null?void 0:d.toFixed(1)}y)`}}}function E2(e={}){let t=null,n=null,r=!1,o=$(0),s=null,i=null,a;return{id:"body",require:["pos"],vel:$(0),drag:e.drag??0,jumpForce:e.jumpForce??IS,gravityScale:e.gravityScale??1,isStatic:e.isStatic??!1,mass:e.mass??1,add(){if(s=this.pos.clone(),i=this.pos.clone(),a=this.pos.clone(),this.mass===0)throw new Error("Can't set body mass to 0");this.has("area")&&(this.onCollideUpdate((l,c)=>{if(!c||!l.has("body")||c.resolved)return;this.trigger("beforePhysicsResolve",c);let d=c.reverse();if(l.trigger("beforePhysicsResolve",d),!(c.resolved||d.resolved)&&!(this.isStatic&&l.isStatic)){if(!this.isStatic&&!l.isStatic){let f=this.mass+l.mass;this.pos=this.pos.add(c.displacement.scale(l.mass/f)),l.pos=l.pos.add(c.displacement.scale(-this.mass/f)),this.transform=co(this),l.transform=co(l)}else{let f=!this.isStatic&&l.isStatic?c:c.reverse();f.source.pos=f.source.pos.add(f.displacement),f.source.transform=co(f.source)}c.resolved=!0,this.trigger("physicsResolve",c),l.trigger("physicsResolve",c.reverse())}}),this.onPhysicsResolve(l=>{if(M.game.gravity)if(l.isBottom()&&this.isFalling()){this.vel=this.vel.reject(M.game.gravity.unit());let c=t;t=l.target,c!=t&&(n=l.target.pos),r?r=!1:c||(this.trigger("ground",t),l.target.trigger("land",this))}else l.isTop()&&this.isJumping()&&(this.vel=this.vel.reject(M.game.gravity.unit()),this.trigger("headbutt",l.target),l.target.trigger("headbutted",this))}))},update(){t&&this.isColliding(t)&&t.exists()&&t.has("body")&&(n&&!t.pos.eq(n)&&e.stickToPlatform!==!1&&this.moveBy(t.pos.sub(n)),n=t.pos);let l=ol();l&&(this.pos.x==a.x&&(this.pos.x=nt(s.x,i.x,l/rl()),a.x=this.pos.x),this.pos.y==a.y&&(this.pos.y=nt(s.y,i.y,l/rl()),a.y=this.pos.y))},fixedUpdate(){if(s&&(this.pos.x==a.x&&(this.pos.x=s.x),this.pos.y==a.y&&(this.pos.y=s.y),s=null),M.game.gravity&&!this.isStatic){r&&(t=null,n=null,this.trigger("fallOff"),r=!1),t&&(!this.isColliding(t)||!t.exists()||!t.has("body"))&&(r=!0);let l=this.vel.clone();this.vel=this.vel.add(M.game.gravity.scale(this.gravityScale*qe()));let c=e.maxVelocity??NS;this.vel.slen()>c*c&&(this.vel=this.vel.unit().scale(c)),l.dot(M.game.gravity)<0&&this.vel.dot(M.game.gravity)>=0&&this.trigger("fall")}if(this.vel.x+=o.x*qe(),this.vel.y+=o.y*qe(),this.vel.x*=1-this.drag*qe(),this.vel.y*=1-this.drag*qe(),this.move(this.vel),ol()){s=this.pos.clone();let l=this.vel.add(o.scale(qe()));i=this.pos.add(l.scale(qe())),a=this.pos.clone()}o.x=0,o.y=0},onPhysicsResolve(l){return this.on("physicsResolve",l)},onBeforePhysicsResolve(l){return this.on("beforePhysicsResolve",l)},curPlatform(){return t},isGrounded(){return t!==null},isFalling(){return this.vel.dot(fo())>0},isJumping(){return this.vel.dot(fo())<0},applyImpulse(l){this.isStatic||(this.vel=this.vel.add(l))},addForce(l){this.isStatic||(o.x+=l.x/this.mass,o.y+=l.y/this.mass)},jump(l){this.isStatic||(t=null,n=null,this.vel=fo().scale(-l||-this.jumpForce))},onGround(l){return this.on("ground",l)},onFall(l){return this.on("fall",l)},onFallOff(l){return this.on("fallOff",l)},onHeadbutt(l){return this.on("headbutt",l)},onLand(l){return this.on("land",l)},onHeadbutted(l){return this.on("headbutted",l)},inspect(){return`gravityScale: ${this.gravityScale}x`}}}function S2(e=2){let t=e;return{id:"doubleJump",require:["body"],numJumps:e,add(){this.onGround(()=>{t=this.numJumps})},doubleJump(n){t<=0||(t<this.numJumps&&this.trigger("doubleJump"),t--,this.jump(n))},onDoubleJump(n){return this.on("doubleJump",n)},inspect(){return`jumpsLeft: ${t}`}}}function M2(e){return{id:"surfaceEffector",require:["area"],speed:e.speed,speedVariation:e.speedVariation??0,forceScale:e.speedVariation??.9,add(){this.onCollideUpdate("body",(t,n)=>{var i;let r=n==null?void 0:n.normal.normal(),o=t.vel.project(r),s=(i=r==null?void 0:r.scale(this.speed))==null?void 0:i.sub(o);t.addForce(s==null?void 0:s.scale(t.mass*this.forceScale))})}}}function C2(e){return{id:"areaEffector",require:["area"],useGlobalAngle:e.useGlobalAngle||!1,forceAngle:e.forceAngle,forceMagnitude:e.forceMagnitude,forceVariation:e.forceVariation??0,linearDrag:e.linearDrag??0,add(){this.onCollideUpdate("body",(t,n)=>{if(!t.has("body"))return;let r=X.fromAngle(this.forceAngle).scale(this.forceMagnitude);t.addForce(r),this.linearDrag&&t.addForce(t.vel.scale(-this.linearDrag))})}}}function P2(e){return{id:"pointEffector",require:["area","pos"],forceMagnitude:e.forceMagnitude,forceVariation:e.forceVariation??0,distanceScale:e.distanceScale??1,forceMode:e.forceMode||"inverseLinear",linearDrag:e.linearDrag??0,add(){this.onCollideUpdate("body",(t,n)=>{let r=this.pos.sub(t.pos),o=r.len(),s=o*this.distanceScale/10,i=this.forceMode==="constant"?1:this.forceMode==="inverseLinear"?1/s:1/s**2,a=r.scale(this.forceMagnitude*i/o);t.addForce(a),this.linearDrag&&t.addForce(t.vel.scale(-this.linearDrag))})}}}function R2(e){return{id:"constantForce",require:["body"],force:e.force,update(){this.force&&this.addForce(this.force)}}}function I2(e){return{id:"platformEffector",require:["area","body"],surfaceArc:e.surfaceArc??180,useOneWay:e.useOneWay??!1,add(){this.onBeforePhysicsResolve(t=>{let n=t.target.vel,r=fo().scale(-1).angleBetween(n);Math.abs(r)>this.surfaceArc/2&&t.preventResolution()})}}}function N2(e){return{id:"buoyancyEffector",require:["area"],surfaceLevel:e.surfaceLevel,density:e.density??1,linearDrag:e.linearDrag??1,angularDrag:e.angularDrag??.2,flowAngle:e.flowAngle??0,flowMagnitude:e.flowMagnitude??0,flowVariation:e.flowVariation??0,add(){this.onCollideUpdate("body",(t,n)=>{let r=t,o=r.worldArea(),[s,i]=o.cut($(-100,this.surfaceLevel),$(100,this.surfaceLevel));s&&(this.applyBuoyancy(r,s),this.applyDrag(r,s)),this.flowMagnitude&&r.addForce(X.fromAngle(this.flowAngle).scale(this.flowMagnitude))})},applyBuoyancy(t,n){let r=this.density*n.area(),o=$(0,1).scale(-r);t.addForce(o)},applyDrag(t,n){let r=t.vel,o=this.density*this.linearDrag,s=r.scale(-o);t.addForce(s)}}}function fl(e){if(!e)throw new Error("Please define an anchor");return{id:"anchor",anchor:e,inspect(){return typeof this.anchor=="string"?"anchor: "+this.anchor:"anchor: "+this.anchor.toString()}}}function pg(){return{id:"fixed",fixed:!0}}function T2(e,t){return{id:"follow",require:["pos"],follow:{obj:e,offset:t??$(0)},add(){e.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))},update(){e.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))}}}function k2(e){var n;let t=(n=M.game.layers)==null?void 0:n.indexOf(e);return{id:"layer",get layerIndex(){return t??null},get layer(){var r;return t?((r=M.game.layers)==null?void 0:r[t])??null:null},set layer(r){var o;if(t=(o=M.game.layers)==null?void 0:o.indexOf(r),t==-1)throw Error("Invalid layer name")},inspect(){return`layer: ${this.layer}`}}}function _2(e,t){let n=typeof e=="number"?X.fromAngle(e):e.unit();return{id:"move",require:["pos"],update(){this.move(n.scale(t))}}}function D2(e={}){let t=!1,n=new Ee($(0),He(),Ue()),r=new Ee($(0),0,0),o=s=>{s.isOffScreen()?(t||(s.trigger("exitView"),t=!0),e.hide&&(s.hidden=!0),e.pause&&(s.paused=!0),e.destroy&&s.destroy()):(t&&(s.trigger("enterView"),t=!1),e.hide&&(s.hidden=!1),e.pause&&(s.paused=!1))};return{id:"offscreen",require:["pos"],offscreenDistance:e.distance??od,isOffScreen(){let s=this.screenPos();if(!s)return!1;if(n.width=He(),n.height=Ue(),!this.offscreenDistance&&this.width&&this.height)return r.width=this.width,r.height=this.height,r.pos=this.pos,r.collides(n);let i=this.offscreenDistance?this.offscreenDistance:od;return!Pi(n,s)&&n.sdistToPoint(s)>i*i},onExitScreen(s){return this.on("exitView",s)},onEnterScreen(s){return this.on("enterView",s)},add(){e.pause&&e.unpause?Wp(()=>o(this)):this.onUpdate(()=>o(this))}}}function ei(...e){return{id:"pos",pos:$(...e),moveBy(...t){this.pos=this.pos.add($(...t))},move(...t){this.moveBy($(...t).scale(qe()))},moveTo(...t){if(typeof t[0]=="number"&&typeof t[1]=="number")return this.moveTo($(t[0],t[1]),t[2]);let n=t[0],r=t[1];if(r===void 0){this.pos=$(n);return}let o=n.sub(this.pos);if(o.len()<=r*qe()){this.pos=$(n);return}this.move(o.unit().scale(r))},worldPos(t=null){return t?(this.pos=this.pos.add(this.fromWorld(t)),null):this.parent?this.parent.transform.multVec2(this.pos):this.pos},toWorld(t){return this.parent?this.parent.transform.multVec2(this.pos.add(t)):this.pos.add(t)},fromWorld(t){return this.parent?this.parent.transform.invert().multVec2(t).sub(this.pos):t.sub(this.pos)},screenPos(t=null){if(t)return this.pos=this.pos.add(this.fromScreen(t)),null;{let n=this.worldPos();return n?Fn(this)?n:ll(n):null}},toScreen(t){let n=this.toWorld(t);return Fn(this)?n:ll(n)},fromScreen(t){return Fn(this)?this.fromWorld(t):this.fromWorld(og(t))},toOther(t,n){return t.fromWorld(this.toWorld(n))},fromOther(t,n){return t.toOther(this,n)},inspect(){return`pos: (${Math.round(this.pos.x)}x, ${Math.round(this.pos.y)}y)`},drawInspect(){Fr({color:we(255,0,0),radius:4/Rp()})}}}function O2(e){return{id:"rotate",angle:e??0,rotateBy(t){this.angle+=t},rotateTo(t){this.angle=t},inspect(){return`angle: ${Math.round(this.angle)}`}}}function ti(...e){if(e.length===0)return ti(1);let t=$(...e);return{id:"scale",set scale(n){if(!(n instanceof X))throw Error("The scale property on scale is a vector. Use scaleTo or scaleBy to set the scale with a number.");t=$(n)},get scale(){return t},scaleTo(...n){t=$(...n)},scaleBy(...n){t=t.scale($(...n))},inspect(){return t.x==t.y?`scale: ${t.x.toFixed(1)}x`:`scale: (${t.x.toFixed(1)}x, ${t.y.toFixed(1)}y)`}}}function L2(e){return{id:"z",z:e,inspect(){return`z: ${this.z}`}}}var B2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAACDCAYAAAB2kQxsAAAAAXNSR0IArs4c6QAABqxJREFUeJztnU1yFDkQRtMEB+AG7Fk6fBPO6ZsQLGc/N5gbMAtosJvqKv2kpPxS763A0W5XSXqVqZ+SngzgF58/fflx/7N///vnacW1gBkFD2Z2LOYNBF3Dx9UXAGs5kxLWwhNxU2qlJHrOhwLfkNZoiaBzIa3dCFJYLXgSboKXmETPeVDQyamR8vX55fe/v37/9vBzCDoH0tqktEpZ+t0IOh4KOBm16euZmETPtVDAiRgRLRF0HRRuEkrFrE1hzR4Lipxj+bD6AqCPz5++/Bgp5tXfdv1CeAdPPmFmSkn0nE+a0drdFm6XiOkdKWEuKRptTXqlLuqqFNaM6Dkb+T5nbb+npo8WjZVinqFantFJk9bWojaRThq7HzKN8wiPJ7aCoJHEZN5zHvJp7RE1DTV6SnZ1fa/PL1MjJtF5HmnT2tJF3GZ/BIj05I8ULUtR6ypER7ogjxpw61rRGxEal4KYjNyORzatbUlHSxr06tFcBTHPiN5NUEJWzlZKG/aKRqYk5tl1IKgPafucZ7w+vxSluLP6olHnL6MQQfYV6bpk/+BRZXm+cXHEiApSipZHlE6tRBDMkxmyysl5VsmtjXiFoJmiZU35ZWK0oNv1OY+omSv0GDDKJCaMI42cHg25dvFCi6QZxVS6ViVSpLUz38A4oiS9ySjlW2althGWKZrN6XNuOVpbwq0ReIzqZhfTrHwE/PZZuEYqcnqO0tZQGxVqRylprLGIEDXNkLOKEakbYsYiiphmiQaEZuD9BghixiKSmGYJIueqBt4TRZEyHtHENCNyNtMaRREzHhHFNBOKnKv7myVcVXKka4WfRBXTjMjpypl8iBmP6MsOmed0Bgk1UHjxXlpORIAWIqeybyGtha1QEdNMRM5s7wLCGpTENBORE6AXNTHNkBM2QFFMM4F5ToX5TYiLqphmRE7YmMhimiEnJEb9XBdJOUlp4Qp1Mc1E5QQ4I/qyvFJCy8n8JnijEjXNAi3fQ0TwIEM6e2OqnAgII8kkptkgOZEQZlN6BquZjqhVFxlBOkZq4Z6WASAFQQ8jZwQJ70FK8CTiaeb3fDSLJyMiwiwiS/q0SkwEBE+85jYjSTpcTiSE2WQRtVlOpAMVemVdtjXmlZxICFlQk/TJjHcmYS96JJ0p6KmcZggKeWmVdPopYwgKuxJVUuQE+EU0Sd99KYICxJH0ry9DUIA/rFy3WyWnGYLCnqyQ9PCXERTgmJmSPvwlBAU4p1bUWklPP1yytA9JYWdGRtLLDyEowDUjomiRwQgKUIZnJC3OgREUoByPSDpkDyEkBfhJj6RNQ7xEUYA6aiS9Cdo8SUoUBaijVtCuFQwICtBGiajdawARFKCNK0HdVtEjKUAd0+Q0q9v/FklhJ1rmP4e8JEoUBejfq2jYNgtEUdgJzwN7u6dSSkBQyMSME7O7FyHUQpoLCqw8rv5o+d6Uw3NvfzjagUkAZvOlLH1lLMyx8wCzWBEhW3ZDmLZ7NTsrwCpmyui5A1+IPidigjcjhZy14/vytBYxwRsPMVcf/2c2QU72wQUVIgj5lqFyIiZEJ5qQb1me1gLMJLKM93wY9cVETYiGkphmg+RETFhJljY2LHICQB/uchI1AXxwlRMxAfwgrYVtUHvxwk1OoiaAL8MjJ2ICtOEip1q6APnJEBS6VwiRzp4vtM5YBvf3m/EeI8DyvUZK33z4+v1bqsZ7dN+3n2W6zwgMO44hY0X1vIqkXh419x7lXh9ds8oyviFyRqmcXrxf2FUtF89ymFkG6nI2p7WZB4FGvUWfLcVt4ahsdy+TR7ifz6lc0F5v0GfalmXldpE3esrr6PrTR84sjNjS4kpQhQhaUi4lD6KR1xK9DHupfoKoR02vSFDy9FWNoKVivv1/lG7OfZkqR043OZUbWgmtFaomaGl51ZTHCnFv5bqNnFGjZvRtEFUEHSHmI1ZHWgVBXZ5+sxvX7ANlPChpjKsknSllKaPlRU4nZo0Yjq6wiIJGFPMML2mj3M8ZRRe4QkzF6FhCJEFbBn4i0iKswn11yenZiLLKeMRqQdWiZSmlkqrcV9d0gPfksAcqBW+2ZqAoq5gZGSrnTtGwlVmCIqUepxWxerj7iIyNZ7SgiKmJhJw7NJpRgiKmLuHl3KnReA4UIaU+y+WkcbzHQ1DEzMGQ9aJH0BDK6RE0y9wlTDp2HuppERQxc0FFBaZGUMTMB5UlQG/fHyk1odJEaBUUMXWh4oSoFRQxtaHyxMi2uBseQwUKciUoYuaAShTlkaCImQcqUph7QREzF/8DSS/2GZ2/N/sAAAAASUVORK5CYII=",F2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAACDCAYAAAB2kQxsAAAAAXNSR0IArs4c6QAABdRJREFUeJzt3d3N3TYMgGG16ADdoAhyl7UyV9bqXRB0g2zQXgRGDcOWSIoUaX3vAwQBknMk/4gWLcnHrQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACDEb9kb8FH99eeXf6Wf/efn35ynDyj1pEsb6G6NUxOYZ7sdB/QtPdnWRnn29gbKMYDUspPs0SgPb22cHANo/JG9AZF6wWBp3JLgeir36bvff3x9LOvzp2/dbSFA97bk5I4a9VMD7TXOUcP0uJ+d6emu5d6V1QvMs5nj8FZPx37X/b2TFpzShtnafeP0DipJMFnLnN3/w1OQ7tZgP+pA4VVKcHo0TG36KNULKGt5XsHZmi1APS5WM2Vqg0i7vbsG6YcIznN9vRTxXHavgdxtv6Tc3vc1pAHqdaG6ipwKYprpf1sFp6aH0gRTrxxLubPB2avHu+c/l3mICvqnsr//+Cq+qGrK1Xw/wzbBaRkNvSv3yew9cq+cu89L6nu6F/cMzCgzF1ftANlbe+Otp1IkDVxyVfbo6Z481f3507dhvXfbrk3HpdtjKTNqKuio8678c7mzF6ns6arfMyrVNoA75wMfNU2hKSeCx3Fq7dc+SPfDc39H9Vqn2CT//4bsYeT1PecOJyGSJdh6PZOlbElPZz2PHtlD1cUeS4LT4z5IOihwfNaD5ERm9qxH/dZ7Vmt9M999CtCZbdLUP/p3r2zFQ0paG8lr4Eb6+ZWBcSeq/qhyK6bXUfXOSgtO7/tOb9eT1NveqKttpYbiyXu/euV51JV16/T6e86zyF5TUp731V5Sp+Z7M71h9QvFNWWuvr0Sy4LzLfNvrel6zRX1e+hN2VzrnNlfaYD0xhCs++851lDh3vNV95xe6YvHgb8bwbNcuc+f09wbaUj2dzYgjz93//5kh94t0quCM8OKK6glKKuM0EYHfhUZWd8WwenZa0rLsp6s2YY66o0k9WUvS4NManBaGuo1eDIHgUZ1ePdkntsfFaCz5VZJdStsxyt7ziMNXHEAK5yk1mqmhrMPf1fcp57Vqe3SqZTMEduZhqAZyaywFne0DVHngHTZ11bznE88l/1lBZ9meP8851plWkBCO7drmQvWnL/sY/fKtFaqN3iy6iofsQxNktJnTMgfPXJUz3w3VaP5vOQ7Iyszvy2DczSi+aYFET2jINUEqFcAS4+rV480WlwRWXe07dLa0YGvfl9kmbTvPZJ1TXGvn4t4yuRp+2aMgk27wkm63DIztU3vOVfueC8wK4zKWtK0M+nvJXmOdlt65MgFFCva06qsKz044SvjIiN5TjLaaHxhtNyyouXBGZ1WSn66Ivt+M7pRZAWoZsDq+t2emeM1am/WtHxFG9runrO1/n1CxLK7CilxJM/H4bwuTJJBvWtgvm0gcNu01uvpd8la1soLE7xkpYDea4Ot6W3GOSzRc3o/qHw2M9qmXWA+uw+jbd0hyO9Yz0+vJ9QGcO/8ZV2YUqYVPN8dImXp3aJ/w1XTGGYfKZN+P7IXiXqO1uINLzFOm/Pz+BV4C03PNEqpZl//ELXP1ro8nhLyKLPHMyAiXyvh4cMFZ2uyAJXc62gzgJl1nhrSLMEzcLx+5qQnIhgqv6qhTHC2Zmus1tUuowCVDkRU6j0jgiJqhLPSSq2q7wMtMSBkdbcQWjNCq2nMlRrTnajAPP/t+c5Sj3K8VNueQ+pGzaa2MyOb2sZseW2dpL6ZnjMzfeQFt/Fe3XP2WIfGvRY6a569jCJ9TaIlcCS9KQE5p1TP2VrMbwLNDlZEvpE5AkGxh9f2nLO/QOetytIwAnMf6SfS2ns+jaZ6B4i2sWvSvF0HWOAj/aRGNFAaPXbw2rS2Rzr0T/ChshKNM3qd4135BCaqK9VAKy+lAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/4DBC0k0jFtF9wAAAAASUVORK5CYII=",j2=RE.version,M={k:null,globalOpt:null,gfx:null,game:null,app:null,assets:null,fontCacheCanvas:null,fontCacheC2d:null,debug:null,audio:null,pixelDensity:null,canvas:null,gscale:null,kaSprite:null,boomSprite:null},q2=(e={tagsAsComponents:!0})=>{M.k&&(console.warn("KAPLAY already initialized, you are calling kaplay() multiple times, it may lead bugs!"),M.k.quit()),M.globalOpt=e;let t=e.root??document.body;t===document.body&&(document.body.style.width="100%",document.body.style.height="100%",document.body.style.margin="0px",document.documentElement.style.width="100%",document.documentElement.style.height="100%");let n=e.canvas??t.appendChild(document.createElement("canvas"));M.canvas=n;let r=e.scale??1;M.gscale=r;let o=e.width&&e.height&&!e.stretch&&!e.letterbox;o?(n.width=e.width*r,n.height=e.height*r):(n.width=n.parentElement.offsetWidth,n.height=n.parentElement.offsetHeight);let s=["outline: none","cursor: default"];if(o){let J=n.width,re=n.height;s.push(`width: ${J}px`),s.push(`height: ${re}px`)}else s.push("width: 100%"),s.push("height: 100%");e.crisp&&(s.push("image-rendering: pixelated"),s.push("image-rendering: crisp-edges")),n.style.cssText=s.join(";");let i=e.pixelDensity||1;M.pixelDensity=i,n.width*=i,n.height*=i,n.tabIndex=0;let a=document.createElement("canvas");a.width=256,a.height=256,M.fontCacheCanvas=a;let l=a.getContext("2d",{willReadFrequently:!0});M.fontCacheC2d=l;let c=iM({canvas:n,touchToMouse:e.touchToMouse,gamepads:e.gamepads,pixelDensity:e.pixelDensity,maxFPS:e.maxFPS,buttons:e.buttons});M.app=c;let d=[],f=c.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0});if(!f)throw new Error("WebGL not supported");let u=f,h=JM(u,{texFilter:e.texFilter}),p=iC(e,h);M.gfx=p;let m=KC();M.audio=m;let g=_M(h,e.spriteAtlasPadding??0);M.assets=g;let y=HC();M.game=y,y.root.use(ul());function A(J,re){let le=new Zs(h,J,re);return{clear:()=>le.clear(),free:()=>le.free(),toDataURL:()=>le.toDataURL(),toImageData:()=>le.toImageData(),width:le.width,height:le.height,draw:ce=>{ft(),le.bind(),ce(),ft(),le.unbind()},get fb(){return le}}}function w(){u.clear(u.COLOR_BUFFER_BIT),p.frameBuffer.bind(),u.clear(u.COLOR_BUFFER_BIT),p.bgColor||fn(()=>{No({width:He(),height:Ue(),quad:new Ie(0,0,He()/64,Ue()/64),tex:p.bgTex,fixed:!0})}),p.renderer.numDraws=0,p.fixed=!1,p.transformStack.length=0,p.transform=new jt}function E(J,re){p.postShader=J,p.postShaderUniform=re??null}function R(){ft(),p.lastDrawCalls=p.renderer.numDraws,p.frameBuffer.unbind(),u.viewport(0,0,u.drawingBufferWidth,u.drawingBufferHeight);let J=p.width,re=p.height;p.width=u.drawingBufferWidth/i,p.height=u.drawingBufferHeight/i,Js({flipY:!0,tex:p.frameBuffer.tex,pos:new X(p.viewport.x,p.viewport.y),width:p.viewport.width,height:p.viewport.height,shader:p.postShader,uniform:typeof p.postShaderUniform=="function"?p.postShaderUniform():p.postShaderUniform,fixed:!0}),ft(),p.width=J,p.height=re}let b=!1,v={inspect:!1,set timeScale(J){M.app.state.timeScale=J},get timeScale(){return M.app.state.timeScale},showLog:!0,fps:()=>c.fps(),numFrames:()=>c.numFrames(),stepFrame:Y,drawCalls:()=>p.lastDrawCalls,clearLog:()=>y.logs=[],log:(...J)=>{let re=e.logMax??8,le=J.length>1?J.concat(" ").join(" "):J[0];y.logs.unshift({msg:le,time:c.time()}),y.logs.length>re&&(y.logs=y.logs.slice(0,re))},error:J=>v.log(new Error(J.toString?J.toString():J)),curRecording:null,numObjects:()=>I("*",{recursive:!0}).length,get paused(){return b},set paused(J){b=J,J?m.ctx.suspend():m.ctx.resume()}};M.debug=v;function C(J,re){try{return JSON.parse(window.localStorage[J])}catch{return re?(T(J,re),re):null}}function T(J,re){window.localStorage[J]=JSON.stringify(re)}function k(J,...re){let le=J(oe),ce;typeof le=="function"?ce=le(...re)(oe):ce=le;for(let me in ce)oe[me]=ce[me],e.global!==!1&&(window[me]=ce[me]);return oe}function D(J){let re=c.canvas.captureStream(J),le=m.ctx.createMediaStreamDestination();m.masterNode.connect(le);let ce=new MediaRecorder(re),me=[];return ce.ondataavailable=de=>{de.data.size>0&&me.push(de.data)},ce.onerror=()=>{m.masterNode.disconnect(le),re.getTracks().forEach(de=>de.stop())},ce.start(),{resume(){ce.resume()},pause(){ce.pause()},stop(){return ce.stop(),m.masterNode.disconnect(le),re.getTracks().forEach(de=>de.stop()),new Promise(de=>{ce.onstop=()=>{de(new Blob(me,{type:"video/mp4"}))}})},download(de="kaboom.mp4"){this.stop().then(be=>sd(de,be))}}}function B(){return document.activeElement===c.canvas}let j=y.root.add.bind(y.root),P=y.root.readd.bind(y.root),O=y.root.removeAll.bind(y.root),I=y.root.get.bind(y.root),_=y.root.wait.bind(y.root),F=y.root.loop.bind(y.root),N=y.root.query.bind(y.root),z=y.root.tween.bind(y.root),V=uo(null,F2),U=uo(null,B2);M.kaSprite=V,M.boomSprite=U;function K(){y.root.fixedUpdate()}function Y(){y.root.update()}class ee{constructor(re,le,ce,me,de=!1){H(this,"source");H(this,"target");H(this,"normal");H(this,"distance");H(this,"resolved",!1);this.source=re,this.target=le,this.normal=ce,this.distance=me,this.resolved=de}get displacement(){return this.normal.scale(this.distance)}reverse(){return new ee(this.target,this.source,this.normal.scale(-1),this.distance,this.resolved)}hasOverlap(){return!this.displacement.isZero()}isLeft(){return this.displacement.cross(y.gravity||$(0,1))>0}isRight(){return this.displacement.cross(y.gravity||$(0,1))<0}isTop(){return this.displacement.dot(y.gravity||$(0,1))>0}isBottom(){return this.displacement.dot(y.gravity||$(0,1))<0}preventResolution(){this.resolved=!0}}function Z(){if(!b2())return;let J={},re=e.hashGridSize||64,le=new jt,ce=[];function me(de){if(ce.push(le.clone()),de.pos&&le.translate(de.pos),de.scale&&le.scale(de.scale),de.angle&&le.rotate(de.angle),de.transform=le.clone(),de.c("area")&&!de.paused){let be=de,ze=be.worldArea().bbox(),Xe=Math.floor(ze.pos.x/re),lt=Math.floor(ze.pos.y/re),wt=Math.ceil((ze.pos.x+ze.width)/re),Pn=Math.ceil((ze.pos.y+ze.height)/re),xt=new Set;for(let Le=Xe;Le<=wt;Le++)for(let Qe=lt;Qe<=Pn;Qe++)if(!J[Le])J[Le]={},J[Le][Qe]=[be];else if(!J[Le][Qe])J[Le][Qe]=[be];else{let nr=J[Le][Qe];e:for(let Be of nr){if(Be.paused||!Be.exists()||xt.has(Be.id))continue;for(let vt of be.collisionIgnore)if(Be.is(vt))continue e;for(let vt of Be.collisionIgnore)if(be.is(vt))continue e;let Rn=gS(be.worldArea(),Be.worldArea());if(Rn){let vt=new ee(be,Be,Rn.normal,Rn.distance);be.trigger("collideUpdate",Be,vt);let rr=vt.reverse();rr.resolved=vt.resolved,Be.trigger("collideUpdate",be,rr)}xt.add(Be.id)}nr.push(be)}}de.children.forEach(me),le=ce.pop()}me(y.root)}function q(J){console.error(J),m.ctx.suspend();let re=J.message??String(J)??"Unknown error, check console for more info";c.run(()=>{},()=>{w(),fn(()=>{let le=He(),ce=Ue(),me={size:36,width:le-32*2,letterSpacing:4,lineSpacing:4,font:Xs,fixed:!0};ht({width:le,height:ce,color:we(0,0,255),fixed:!0});let de=$n({...me,text:"Error",pos:$(32),color:we(255,128,0),fixed:!0});Gn(de),gd({...me,text:re,pos:$(32,32+de.height+16),fixed:!0}),tt(),y.events.trigger("error",J)}),R()})}function W(J){d.push(J)}function te(){y.events.onOnce("frameEnd",()=>{c.quit(),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT|u.STENCIL_BUFFER_BIT);let J=u.getParameter(u.MAX_TEXTURE_IMAGE_UNITS);for(let re=0;re<J;re++)u.activeTexture(u.TEXTURE0+re),u.bindTexture(u.TEXTURE_2D,null),u.bindTexture(u.TEXTURE_CUBE_MAP,null);u.bindBuffer(u.ARRAY_BUFFER,null),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,null),u.bindRenderbuffer(u.RENDERBUFFER,null),u.bindFramebuffer(u.FRAMEBUFFER,null),h.destroy(),d.forEach(re=>re())})}let se=!0;c.run(()=>{try{g.loaded&&(v.paused||K(),Z())}catch(J){q(J)}},(J,re)=>{try{J(),g.loaded||Un()===1&&!se&&(g.loaded=!0,Np().forEach(le=>y.events.trigger("loadError",...le)),y.events.trigger("load")),!g.loaded&&e.loadingScreen!==!1||se?(w(),nC(),R()):(v.paused||Y(),Z(),w(),tC(),e.debug!==!1&&eC(),R()),se&&(se=!1),y.events.trigger("frameEnd"),re()}catch(le){q(le)}}),Pp(),lg();let oe={_k:M,VERSION:j2,loadRoot:NM,loadProgress:Un,loadSprite:uo,loadSpriteAtlas:Fp,loadSound:GM,loadMusic:KM,loadBitmapFont:jM,loadFont:BM,loadShader:VM,loadShaderURL:UM,loadAseprite:LM,loadPedit:qM,loadBean:OM,loadJSON:TM,load:sl,getSound:Bp,getFont:Dp,getBitmapFont:Op,getSprite:Tp,getShader:Lp,getAsset:kM,Asset:yt,SpriteData:xn,SoundData:Io,width:He,height:Ue,center:Qs,dt:qe,fixedDt:rl,restDt:ol,time:c.time,screenshot:c.screenshot,record:D,isFocused:B,setCursor:c.setCursor,getCursor:c.getCursor,setCursorLocked:c.setCursorLocked,isCursorLocked:c.isCursorLocked,setFullscreen:c.setFullscreen,isFullscreen:c.isFullscreen,isTouchscreen:c.isTouchscreen,onLoad:ic,onLoadError:DC,onLoading:TC,onResize:kC,onGamepadConnect:c.onGamepadConnect,onGamepadDisconnect:c.onGamepadDisconnect,onError:_C,onCleanup:W,flash:rg,setCamPos:Qp,getCamPos:Zp,setCamRot:tg,getCamRot:ng,setCamScale:Jp,getCamScale:eg,getCamTransform:OC,camPos:FC,camScale:jC,camFlash:zC,camRot:qC,camTransform:LC,shake:BC,toScreen:ll,toWorld:og,setGravity:VC,getGravity:UC,setGravityDirection:$C,getGravityDirection:fo,setBackground:SM,getBackground:MM,getGamepads:c.getGamepads,getTreeRoot:t2,add:j,make:ac,destroy:ug,destroyAll:O,get:I,query:N,readd:P,pos:ei,scale:ti,rotate:O2,color:Up,opacity:$p,anchor:fl,area:A2,sprite:cl,text:i2,polygon:pC,rect:Kp,circle:aC,uvquad:a2,outline:dC,particles:hC,body:E2,platformEffector:I2,surfaceEffector:M2,areaEffector:C2,pointEffector:P2,buoyancyEffector:N2,constantForce:R2,doubleJump:S2,shader:gC,textInput:v2,timer:ul,fixed:pg,stay:hg,health:m2,lifespan:y2,named:w2,state:x2,z:L2,layer:k2,move:_2,offscreen:D2,follow:T2,fadeIn:cC,mask:uC,drawon:lC,raycast:Gp,tile:dg,animate:g2,serializeAnimation:fg,agent:l2,sentry:d2,patrol:u2,pathfinder:c2,trigger:yC,on:at,onFixedUpdate:wC,onUpdate:Wp,onDraw:xC,onAdd:Yp,onDestroy:vC,onTag:Xp,onUntag:EC,onUse:bC,onUnuse:AC,onClick:PC,onCollide:SC,onCollideUpdate:MC,onCollideEnd:CC,onHover:RC,onHoverUpdate:IC,onHoverEnd:NC,onKeyDown:c.onKeyDown,onKeyPress:c.onKeyPress,onKeyPressRepeat:c.onKeyPressRepeat,onKeyRelease:c.onKeyRelease,onMouseDown:c.onMouseDown,onMousePress:c.onMousePress,onMouseRelease:c.onMouseRelease,onMouseMove:c.onMouseMove,onCharInput:c.onCharInput,onTouchStart:c.onTouchStart,onTouchMove:c.onTouchMove,onTouchEnd:c.onTouchEnd,onScroll:c.onScroll,onHide:c.onHide,onShow:c.onShow,onGamepadButtonDown:c.onGamepadButtonDown,onGamepadButtonPress:c.onGamepadButtonPress,onGamepadButtonRelease:c.onGamepadButtonRelease,onGamepadStick:c.onGamepadStick,onButtonPress:c.onButtonPress,onButtonDown:c.onButtonDown,onButtonRelease:c.onButtonRelease,mousePos:c.mousePos,mouseDeltaPos:c.mouseDeltaPos,isKeyDown:c.isKeyDown,isKeyPressed:c.isKeyPressed,isKeyPressedRepeat:c.isKeyPressedRepeat,isKeyReleased:c.isKeyReleased,isMouseDown:c.isMouseDown,isMousePressed:c.isMousePressed,isMouseReleased:c.isMouseReleased,isMouseMoved:c.isMouseMoved,isGamepadButtonPressed:c.isGamepadButtonPressed,isGamepadButtonDown:c.isGamepadButtonDown,isGamepadButtonReleased:c.isGamepadButtonReleased,getGamepadStick:c.getGamepadStick,isButtonPressed:c.isButtonPressed,isButtonDown:c.isButtonDown,isButtonReleased:c.isButtonReleased,setButton:c.setButton,getButton:c.getButton,pressButton:c.pressButton,releaseButton:c.releaseButton,getLastInputDeviceType:c.getLastInputDeviceType,charInputted:c.charInputted,loop:F,wait:_,play:YC,setVolume:ig,getVolume:ag,volume:XC,burp:sg,audioCtx:m.ctx,Line:it,Rect:Ee,Circle:st,Ellipse:on,Point:QE,Polygon:Ye,Vec2:X,Color:pe,Mat4:jt,Quad:Ie,RNG:rp,rand:je,randi:op,randSeed:_E,vec2:$,rgb:we,hsl2rgb:IE,quad:_e,choose:LE,chooseMultiple:OE,shuffle:sp,chance:DE,lerp:nt,tween:z,easings:Po,map:Lt,mapc:NE,wave:np,deg2rad:De,rad2deg:Vn,clamp:Ft,evaluateQuadratic:JE,evaluateQuadraticFirstDerivative:eS,evaluateQuadraticSecondDerivative:tS,evaluateBezier:Zl,evaluateBezierFirstDerivative:nS,evaluateBezierSecondDerivative:rS,evaluateCatmullRom:oS,evaluateCatmullRomFirstDerivative:sS,curveLengthApproximation:gp,normalizedCurve:iS,hermite:Ho,cardinal:mp,catmullRom:Ys,bezier:aS,kochanekBartels:lS,easingSteps:pS,easingLinear:fS,easingCubicBezier:hS,testLineLine:Gl,testRectRect:ip,testRectLine:Kl,testRectPoint:Pi,testCirclePolygon:Ii,testLinePoint:Wl,testLineCircle:zo,isConvex:vS,triangulate:wp,NavMesh:AM,drawSprite:oC,drawText:gd,formatText:$n,drawRect:ht,drawLine:ro,drawLines:sc,drawTriangle:Hp,drawCircle:Fr,drawEllipse:jp,drawUVQuad:No,drawPolygon:pn,drawCurve:qp,drawBezier:QM,drawFormattedText:Gn,drawMasked:rC,drawSubtracted:sC,pushTransform:dt,popTransform:tt,pushTranslate:Te,pushScale:Ro,pushRotate:kr,pushMatrix:CM,usePostEffect:E,makeCanvas:A,debug:v,scene:n2,getSceneName:s2,go:r2,onSceneLeave:o2,layers:e2,getLayers:ZC,setLayers:cg,getDefaultLayer:JC,addLevel:mC,getData:C,setData:T,download:ec,downloadJSON:LS,downloadText:Mp,downloadBlob:sd,plug:k,ASCII_CHARS:xp,canvas:c.canvas,addKaboom:QC,LEFT:X.LEFT,RIGHT:X.RIGHT,UP:X.UP,DOWN:X.DOWN,RED:pe.RED,GREEN:pe.GREEN,BLUE:pe.BLUE,YELLOW:pe.YELLOW,MAGENTA:pe.MAGENTA,CYAN:pe.CYAN,WHITE:pe.WHITE,BLACK:pe.BLACK,quit:te,KEvent:We,KEventHandler:Co,KEventController:Zn,cancel:()=>bp};M.k=oe;let ne=e.plugins;if(ne&&ne.forEach(k),e.global!==!1)for(let J in oe)window[J]=oe[J];return e.focus!==!1&&c.canvas.focus(),oe},z2=q2;let ds;function cc(e){return ds||(ds=z2({global:!1,pixelDensity:2,touchToMouse:!0,debug:!1,debugKey:"f1",canvas:e}),ds)}const br=qo(e=>({isPaused:!1,pause:()=>e({isPaused:!0}),play:()=>e({isPaused:!1})}));let wd=!0;function H2(e){if(!wd)return;wd=!1;const t=cc(e);$s.getState().setKeyDownFunction(o=>t.isKeyDown(o)),$s.getState().setKeyPressedFunction(o=>t.isKeyPressed(o));const n=Gs.getState().setTime,r=Gs.getState().setDeltaTime;return t.onUpdate(()=>{if(br.getState().isPaused)return;const o=t.time(),s=t.dt();n(o),r(s),yr.getState().compute()}),t}const Qt="input-handle-x",mn="input-handle-y",wa="input-handle-z",It="output-handle-x",xd="output-handle-y",yn=qo(e=>({nodeData:new Map([["xpos",{handleId:Qt,value:0}],["ypos",{handleId:mn,value:0}]]),gameData:new Map,setNodeData:(t,n,r)=>e(o=>(o.nodeData.set(t,{handleId:n,value:r}),o)),transferData:()=>e(t=>({gameData:new Map(t.nodeData)}))})),V2=()=>{const e=cc();e.loadBean();const t=e.add([e.sprite("bean"),e.color(0,0,255),e.pos(100,e.height()-100)]);e.add([e.rect(e.width(),5),e.pos(0,e.height()-5),e.color(255,200,200),e.area(),e.body({isStatic:!0}),"floor"]),e.onUpdate(()=>{var o,s;if(br.getState().isPaused)return;const n=((o=yn.getState().nodeData.get("xpos"))==null?void 0:o.value)??0,r=((s=yn.getState().nodeData.get("ypos"))==null?void 0:s.value)??0;t.pos.x=n,t.pos.y=r,yn.getState().transferData()})},U2=3e3,$2=()=>{const e=cc();e.loadBean();const t=e.add([e.sprite("bean"),e.pos(20,130)]),n=e.add([e.sprite("bean"),e.color(0,0,0),e.pos(400,400),e.scale(.5),e.area()]);n.tag("trashCan"),e.add([e.sprite("bean"),e.color(255,0,0),e.pos(600,100),e.scale(4,.5),e.area()]).tag("finishLine"),e.onCollide("trashCan","finishLine",(o,s)=>{console.log("Collided with finish line")}),e.onUpdate(()=>{var i,a;if(br.getState().isPaused)return;t.move(U2*e.dt(),0);const o=((i=yn.getState().nodeData.get("xpos"))==null?void 0:i.value)??0,s=((a=yn.getState().nodeData.get("ypos"))==null?void 0:a.value)??0;n.pos.x=o,n.pos.y=s,yn.getState().transferData()})},vd={playground:{name:"Playground",description:"This is a playground level where you can test your game mechanics.",category:"Sandbox",image:"",nodes:[],edges:[],initialState:V2,solution:{nodes:[],edges:[]},hints:[]},"1.1":{name:"Level 1.1",description:"This is the first level of the game. It introduces the basic mechanics and objectives.",category:"Introduction",image:"",nodes:[],edges:[],initialState:$2,solution:{nodes:[],edges:[]},hints:[]}},G2=e=>{if(!(e in vd))throw new Error(`Level ${e} not found`);vd[e].initialState()},Fe=[];for(let e=0;e<256;++e)Fe.push((e+256).toString(16).slice(1));function K2(e,t=0){return(Fe[e[t+0]]+Fe[e[t+1]]+Fe[e[t+2]]+Fe[e[t+3]]+"-"+Fe[e[t+4]]+Fe[e[t+5]]+"-"+Fe[e[t+6]]+Fe[e[t+7]]+"-"+Fe[e[t+8]]+Fe[e[t+9]]+"-"+Fe[e[t+10]]+Fe[e[t+11]]+Fe[e[t+12]]+Fe[e[t+13]]+Fe[e[t+14]]+Fe[e[t+15]]).toLowerCase()}let xa;const W2=new Uint8Array(16);function Y2(){if(!xa){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");xa=crypto.getRandomValues.bind(crypto)}return xa(W2)}const X2=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),bd={randomUUID:X2};function Zt(e,t,n){var o;if(bd.randomUUID&&!e)return bd.randomUUID();e=e||{};const r=e.random??((o=e.rng)==null?void 0:o.call(e))??Y2();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,K2(r)}const _r=({id:e,position:t})=>{const n=Mo({handleId:e,handleType:"target"});if(t==ae.Right)return S.jsx(Tr,{id:e,type:"source",position:ae.Right,className:"!static float-right mt-3 flex !h-3 !w-3 items-baseline justify-center !rounded-[2px] !border-emerald-300 text-[8px]"});if(t==ae.Left)return S.jsx(Tr,{id:e,type:"target",position:ae.Left,isConnectable:n.length<1,className:"!static float-left mt-3 flex !h-3 !w-3 items-baseline justify-center !rounded-[2px] !border-emerald-300 text-[8px]"})},zt=({id:e,position:t,label:n})=>{if(t==ae.Right)return S.jsxs("div",{className:"text-right",children:[n,S.jsx(_r,{id:e,position:t})]});if(t==ae.Left)return S.jsxs("div",{className:"text-left",children:[n,S.jsx(_r,{id:e,position:t})]})},Sn=({label:e,type:t,active:n=!1,children:r})=>S.jsxs("div",{className:Is("flex flex-col justify-around rounded-sm border-1 pb-3 font-mono text-white",n?"border-emerald-400 outline-2 outline-emerald-400":"border-blue-300"),children:[S.jsxs("div",{className:"flex items-start justify-between p-3",children:[S.jsxs("div",{children:[S.jsx("h2",{className:"font-bold",children:e}),S.jsx("p",{className:"text-xs italic",children:t})]}),e!=="Select Math Type"&&S.jsx(V0,{target:"_blank",to:`/docs/nodes/${e.toLowerCase()}`,children:S.jsx(U0,{className:"cursor-pointer text-slate-400"})})]}),r]}),jn=(e,t,n)=>{const r=e.get(t);return(r==null?void 0:r.sourceNode.getResult(r.sourceHandleId))??n},Q2=x.memo(({id:e})=>{const{updateNodeData:t}=$e(),[n,r]=x.useState(0);return x.useEffect(()=>{t(e,{compute:(o,s)=>{r(jn(o,Qt,0))}})},[]),S.jsx("div",{className:"min-w-48",children:S.jsx(Sn,{label:"Debug-Display",type:"float",children:S.jsxs("div",{className:"flex gap-2",children:[S.jsx(zt,{id:Qt,position:ae.Left}),S.jsx("p",{children:n})]})})})}),Z2=x.memo(({id:e})=>{const t=yn(r=>r.gameData),{updateNodeData:n}=$e();return x.useEffect(()=>{n(e,{compute:(r,o)=>{t.forEach(({handleId:s,value:i})=>{o.set(s,i)})}})},[t]),S.jsx("div",{className:"min-w-48",children:S.jsx(Sn,{label:"XPOS TEST",type:"float",children:Array.from(t).map(([r,{handleId:o}])=>S.jsx(zt,{id:o,position:ae.Right,label:r},o))})})}),Wn=({value:e,setValue:t,defaultValue:n,disabled:r=!1,type:o="float",...s})=>{const[i,a]=x.useState(String(n)),l=d=>{if(r&&e)return;const f=d.target.value.replace(",",".");/^(-?)\d*\.?\d*$/.test(f)&&a(f);const u=Number(f);isNaN(u)||t(u)},c=d=>{if(r&&e)return;const f=d.target.value;/^(-?)\d*$/.test(f)&&(a(f),t(Number(f)))};return S.jsx("input",{type:"text",inputMode:"decimal",onChange:d=>{switch(o){case"float":l(d);break;case"int":c(d);break}},className:"nodrag ml-3 w-12 rounded-sm border-1 border-slate-700 bg-slate-900 px-1 focus:border-slate-500 focus:outline-none disabled:text-slate-500",value:e&&r?e:i,disabled:r,...s})},J2=x.memo(({id:e})=>{const{updateNodeData:t}=$e(),n=Gs(o=>o.time),r=Gs(o=>o.deltaTime);return x.useEffect(()=>{t(e,{compute:(o,s)=>{s.set(It,n),s.set(xd,r)}})},[n]),S.jsx("div",{className:"min-w-48",children:S.jsxs(Sn,{label:"Time",type:"float",children:[S.jsxs("div",{className:"flex w-full justify-end gap-2",children:[S.jsx(Wn,{value:n,setValue:()=>{},defaultValue:0,disabled:!0}),S.jsx(zt,{id:It,position:ae.Right,label:"Time"})]}),S.jsxs("div",{className:"flex w-full justify-end gap-2",children:[S.jsx(Wn,{value:r,setValue:()=>{},defaultValue:0,disabled:!0}),S.jsx(zt,{id:xd,position:ae.Right,label:"Delta time"})]})]})})}),eP=x.memo(({id:e})=>{const{updateNodeData:t}=$e(),[n,r]=x.useState(""),[o,s]=x.useState(new Map([["xpos",Qt],["ypos",mn]])),i=yn(a=>a.setNodeData);return x.useEffect(()=>{t(e,{compute:(a,l)=>{o.forEach((c,d)=>{i(d,c,jn(a,c,0))})}})},[o]),S.jsx("div",{children:S.jsxs(Sn,{label:"Export To Gameobject",type:"export",children:[Array.from(o).map(([a,l])=>S.jsx(zt,{id:l,position:ae.Left,label:a},l)),S.jsxs("div",{children:[S.jsx("input",{type:"text",className:"nodrag ml-3 w-12 rounded-sm border-1 border-slate-700 bg-slate-900 px-1 focus:border-slate-500 focus:outline-none disabled:text-slate-500",onChange:a=>{r(a.target.value)}}),S.jsx("button",{className:"ml-2 hover:cursor-pointer",onClick:()=>{if(o.has(n))return;const a=new Map(o);a.set(n,Zt()),s(a)},children:"+"})]})]})})});function Ad(e,[t,n]){return Math.min(n,Math.max(t,e))}function uc(e){const t=e+"CollectionProvider",[n,r]=Or(t),[o,s]=n(t,{collectionRef:{current:null},itemMap:new Map}),i=m=>{const{scope:g,children:y}=m,A=St.useRef(null),w=St.useRef(new Map).current;return S.jsx(o,{scope:g,itemMap:w,collectionRef:A,children:y})};i.displayName=t;const a=e+"CollectionSlot",l=Ns(a),c=St.forwardRef((m,g)=>{const{scope:y,children:A}=m,w=s(a,y),E=Ce(g,w.collectionRef);return S.jsx(l,{ref:E,children:A})});c.displayName=a;const d=e+"CollectionItemSlot",f="data-radix-collection-item",u=Ns(d),h=St.forwardRef((m,g)=>{const{scope:y,children:A,...w}=m,E=St.useRef(null),R=Ce(g,E),b=s(d,y);return St.useEffect(()=>(b.itemMap.set(E,{ref:E,...w}),()=>void b.itemMap.delete(E))),S.jsx(u,{[f]:"",ref:R,children:A})});h.displayName=d;function p(m){const g=s(e+"CollectionConsumer",m);return St.useCallback(()=>{const A=g.collectionRef.current;if(!A)return[];const w=Array.from(A.querySelectorAll(`[${f}]`));return Array.from(g.itemMap.values()).sort((b,v)=>w.indexOf(b.ref.current)-w.indexOf(v.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:i,Slot:c,ItemSlot:h},p,r]}var tP=x.createContext(void 0);function dc(e){const t=x.useContext(tP);return e||t||"ltr"}function Ht(e){const t=x.useRef(e);return x.useEffect(()=>{t.current=e}),x.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function nP(e,t=globalThis==null?void 0:globalThis.document){const n=Ht(e);x.useEffect(()=>{const r=o=>{o.key==="Escape"&&n(o)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var rP="DismissableLayer",hl="dismissableLayer.update",oP="dismissableLayer.pointerDownOutside",sP="dismissableLayer.focusOutside",Ed,gg=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),fc=x.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:s,onInteractOutside:i,onDismiss:a,...l}=e,c=x.useContext(gg),[d,f]=x.useState(null),u=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=x.useState({}),p=Ce(t,v=>f(v)),m=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=m.indexOf(g),A=d?m.indexOf(d):-1,w=c.layersWithOutsidePointerEventsDisabled.size>0,E=A>=y,R=lP(v=>{const C=v.target,T=[...c.branches].some(k=>k.contains(C));!E||T||(o==null||o(v),i==null||i(v),v.defaultPrevented||a==null||a())},u),b=cP(v=>{const C=v.target;[...c.branches].some(k=>k.contains(C))||(s==null||s(v),i==null||i(v),v.defaultPrevented||a==null||a())},u);return nP(v=>{A===c.layers.size-1&&(r==null||r(v),!v.defaultPrevented&&a&&(v.preventDefault(),a()))},u),x.useEffect(()=>{if(d)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(Ed=u.body.style.pointerEvents,u.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),Sd(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(u.body.style.pointerEvents=Ed)}},[d,u,n,c]),x.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),Sd())},[d,c]),x.useEffect(()=>{const v=()=>h({});return document.addEventListener(hl,v),()=>document.removeEventListener(hl,v)},[]),S.jsx(xe.div,{...l,ref:p,style:{pointerEvents:w?E?"auto":"none":void 0,...e.style},onFocusCapture:ue(e.onFocusCapture,b.onFocusCapture),onBlurCapture:ue(e.onBlurCapture,b.onBlurCapture),onPointerDownCapture:ue(e.onPointerDownCapture,R.onPointerDownCapture)})});fc.displayName=rP;var iP="DismissableLayerBranch",aP=x.forwardRef((e,t)=>{const n=x.useContext(gg),r=x.useRef(null),o=Ce(t,r);return x.useEffect(()=>{const s=r.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),S.jsx(xe.div,{...e,ref:o})});aP.displayName=iP;function lP(e,t=globalThis==null?void 0:globalThis.document){const n=Ht(e),r=x.useRef(!1),o=x.useRef(()=>{});return x.useEffect(()=>{const s=a=>{if(a.target&&!r.current){let l=function(){mg(oP,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",o.current),o.current=l,t.addEventListener("click",o.current,{once:!0})):l()}else t.removeEventListener("click",o.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",s),t.removeEventListener("click",o.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function cP(e,t=globalThis==null?void 0:globalThis.document){const n=Ht(e),r=x.useRef(!1);return x.useEffect(()=>{const o=s=>{s.target&&!r.current&&mg(sP,n,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",o),()=>t.removeEventListener("focusin",o)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Sd(){const e=new CustomEvent(hl);document.dispatchEvent(e)}function mg(e,t,n,{discrete:r}){const o=n.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?Kd(o,s):o.dispatchEvent(s)}var va=0;function yg(){x.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Md()),document.body.insertAdjacentElement("beforeend",e[1]??Md()),va++,()=>{va===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),va--}},[])}function Md(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var ba="focusScope.autoFocusOnMount",Aa="focusScope.autoFocusOnUnmount",Cd={bubbles:!1,cancelable:!0},uP="FocusScope",hc=x.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:s,...i}=e,[a,l]=x.useState(null),c=Ht(o),d=Ht(s),f=x.useRef(null),u=Ce(t,m=>l(m)),h=x.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;x.useEffect(()=>{if(r){let m=function(w){if(h.paused||!a)return;const E=w.target;a.contains(E)?f.current=E:ln(f.current,{select:!0})},g=function(w){if(h.paused||!a)return;const E=w.relatedTarget;E!==null&&(a.contains(E)||ln(f.current,{select:!0}))},y=function(w){if(document.activeElement===document.body)for(const R of w)R.removedNodes.length>0&&ln(a)};document.addEventListener("focusin",m),document.addEventListener("focusout",g);const A=new MutationObserver(y);return a&&A.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",g),A.disconnect()}}},[r,a,h.paused]),x.useEffect(()=>{if(a){Rd.add(h);const m=document.activeElement;if(!a.contains(m)){const y=new CustomEvent(ba,Cd);a.addEventListener(ba,c),a.dispatchEvent(y),y.defaultPrevented||(dP(mP(wg(a)),{select:!0}),document.activeElement===m&&ln(a))}return()=>{a.removeEventListener(ba,c),setTimeout(()=>{const y=new CustomEvent(Aa,Cd);a.addEventListener(Aa,d),a.dispatchEvent(y),y.defaultPrevented||ln(m??document.body,{select:!0}),a.removeEventListener(Aa,d),Rd.remove(h)},0)}}},[a,c,d,h]);const p=x.useCallback(m=>{if(!n&&!r||h.paused)return;const g=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,y=document.activeElement;if(g&&y){const A=m.currentTarget,[w,E]=fP(A);w&&E?!m.shiftKey&&y===E?(m.preventDefault(),n&&ln(w,{select:!0})):m.shiftKey&&y===w&&(m.preventDefault(),n&&ln(E,{select:!0})):y===A&&m.preventDefault()}},[n,r,h.paused]);return S.jsx(xe.div,{tabIndex:-1,...i,ref:u,onKeyDown:p})});hc.displayName=uP;function dP(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(ln(r,{select:t}),document.activeElement!==n)return}function fP(e){const t=wg(e),n=Pd(t,e),r=Pd(t.reverse(),e);return[n,r]}function wg(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Pd(e,t){for(const n of e)if(!hP(n,{upTo:t}))return n}function hP(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function pP(e){return e instanceof HTMLInputElement&&"select"in e}function ln(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&pP(e)&&t&&e.select()}}var Rd=gP();function gP(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=Id(e,t),e.unshift(t)},remove(t){var n;e=Id(e,t),(n=e[0])==null||n.resume()}}}function Id(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function mP(e){return e.filter(t=>t.tagName!=="A")}const yP=["top","right","bottom","left"],vn=Math.min,Je=Math.max,ni=Math.round,fs=Math.floor,qt=e=>({x:e,y:e}),wP={left:"right",right:"left",bottom:"top",top:"bottom"},xP={start:"end",end:"start"};function pl(e,t,n){return Je(e,vn(t,n))}function en(e,t){return typeof e=="function"?e(t):e}function tn(e){return e.split("-")[0]}function jr(e){return e.split("-")[1]}function pc(e){return e==="x"?"y":"x"}function gc(e){return e==="y"?"height":"width"}function bn(e){return["top","bottom"].includes(tn(e))?"y":"x"}function mc(e){return pc(bn(e))}function vP(e,t,n){n===void 0&&(n=!1);const r=jr(e),o=mc(e),s=gc(o);let i=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(i=ri(i)),[i,ri(i)]}function bP(e){const t=ri(e);return[gl(e),t,gl(t)]}function gl(e){return e.replace(/start|end/g,t=>xP[t])}function AP(e,t,n){const r=["left","right"],o=["right","left"],s=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?o:r:t?r:o;case"left":case"right":return t?s:i;default:return[]}}function EP(e,t,n,r){const o=jr(e);let s=AP(tn(e),n==="start",r);return o&&(s=s.map(i=>i+"-"+o),t&&(s=s.concat(s.map(gl)))),s}function ri(e){return e.replace(/left|right|bottom|top/g,t=>wP[t])}function SP(e){return{top:0,right:0,bottom:0,left:0,...e}}function xg(e){return typeof e!="number"?SP(e):{top:e,right:e,bottom:e,left:e}}function oi(e){const{x:t,y:n,width:r,height:o}=e;return{width:r,height:o,top:n,left:t,right:t+r,bottom:n+o,x:t,y:n}}function Nd(e,t,n){let{reference:r,floating:o}=e;const s=bn(t),i=mc(t),a=gc(i),l=tn(t),c=s==="y",d=r.x+r.width/2-o.width/2,f=r.y+r.height/2-o.height/2,u=r[a]/2-o[a]/2;let h;switch(l){case"top":h={x:d,y:r.y-o.height};break;case"bottom":h={x:d,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:f};break;case"left":h={x:r.x-o.width,y:f};break;default:h={x:r.x,y:r.y}}switch(jr(t)){case"start":h[i]-=u*(n&&c?-1:1);break;case"end":h[i]+=u*(n&&c?-1:1);break}return h}const MP=async(e,t,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:s=[],platform:i}=n,a=s.filter(Boolean),l=await(i.isRTL==null?void 0:i.isRTL(t));let c=await i.getElementRects({reference:e,floating:t,strategy:o}),{x:d,y:f}=Nd(c,r,l),u=r,h={},p=0;for(let m=0;m<a.length;m++){const{name:g,fn:y}=a[m],{x:A,y:w,data:E,reset:R}=await y({x:d,y:f,initialPlacement:r,placement:u,strategy:o,middlewareData:h,rects:c,platform:i,elements:{reference:e,floating:t}});d=A??d,f=w??f,h={...h,[g]:{...h[g],...E}},R&&p<=50&&(p++,typeof R=="object"&&(R.placement&&(u=R.placement),R.rects&&(c=R.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:o}):R.rects),{x:d,y:f}=Nd(c,u,l)),m=-1)}return{x:d,y:f,placement:u,strategy:o,middlewareData:h}};async function To(e,t){var n;t===void 0&&(t={});const{x:r,y:o,platform:s,rects:i,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:f="floating",altBoundary:u=!1,padding:h=0}=en(t,e),p=xg(h),g=a[u?f==="floating"?"reference":"floating":f],y=oi(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(g)))==null||n?g:g.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:d,strategy:l})),A=f==="floating"?{x:r,y:o,width:i.floating.width,height:i.floating.height}:i.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),E=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},R=oi(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:A,offsetParent:w,strategy:l}):A);return{top:(y.top-R.top+p.top)/E.y,bottom:(R.bottom-y.bottom+p.bottom)/E.y,left:(y.left-R.left+p.left)/E.x,right:(R.right-y.right+p.right)/E.x}}const CP=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:o,rects:s,platform:i,elements:a,middlewareData:l}=t,{element:c,padding:d=0}=en(e,t)||{};if(c==null)return{};const f=xg(d),u={x:n,y:r},h=mc(o),p=gc(h),m=await i.getDimensions(c),g=h==="y",y=g?"top":"left",A=g?"bottom":"right",w=g?"clientHeight":"clientWidth",E=s.reference[p]+s.reference[h]-u[h]-s.floating[p],R=u[h]-s.reference[h],b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c));let v=b?b[w]:0;(!v||!await(i.isElement==null?void 0:i.isElement(b)))&&(v=a.floating[w]||s.floating[p]);const C=E/2-R/2,T=v/2-m[p]/2-1,k=vn(f[y],T),D=vn(f[A],T),B=k,j=v-m[p]-D,P=v/2-m[p]/2+C,O=pl(B,P,j),I=!l.arrow&&jr(o)!=null&&P!==O&&s.reference[p]/2-(P<B?k:D)-m[p]/2<0,_=I?P<B?P-B:P-j:0;return{[h]:u[h]+_,data:{[h]:O,centerOffset:P-O-_,...I&&{alignmentOffset:_}},reset:I}}}),PP=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:o,middlewareData:s,rects:i,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:d=!0,crossAxis:f=!0,fallbackPlacements:u,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=en(e,t);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const y=tn(o),A=bn(a),w=tn(a)===a,E=await(l.isRTL==null?void 0:l.isRTL(c.floating)),R=u||(w||!m?[ri(a)]:bP(a)),b=p!=="none";!u&&b&&R.push(...EP(a,m,p,E));const v=[a,...R],C=await To(t,g),T=[];let k=((r=s.flip)==null?void 0:r.overflows)||[];if(d&&T.push(C[y]),f){const P=vP(o,i,E);T.push(C[P[0]],C[P[1]])}if(k=[...k,{placement:o,overflows:T}],!T.every(P=>P<=0)){var D,B;const P=(((D=s.flip)==null?void 0:D.index)||0)+1,O=v[P];if(O)return{data:{index:P,overflows:k},reset:{placement:O}};let I=(B=k.filter(_=>_.overflows[0]<=0).sort((_,F)=>_.overflows[1]-F.overflows[1])[0])==null?void 0:B.placement;if(!I)switch(h){case"bestFit":{var j;const _=(j=k.filter(F=>{if(b){const N=bn(F.placement);return N===A||N==="y"}return!0}).map(F=>[F.placement,F.overflows.filter(N=>N>0).reduce((N,z)=>N+z,0)]).sort((F,N)=>F[1]-N[1])[0])==null?void 0:j[0];_&&(I=_);break}case"initialPlacement":I=a;break}if(o!==I)return{reset:{placement:I}}}return{}}}};function Td(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function kd(e){return yP.some(t=>e[t]>=0)}const RP=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...o}=en(e,t);switch(r){case"referenceHidden":{const s=await To(t,{...o,elementContext:"reference"}),i=Td(s,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:kd(i)}}}case"escaped":{const s=await To(t,{...o,altBoundary:!0}),i=Td(s,n.floating);return{data:{escapedOffsets:i,escaped:kd(i)}}}default:return{}}}}};async function IP(e,t){const{placement:n,platform:r,elements:o}=e,s=await(r.isRTL==null?void 0:r.isRTL(o.floating)),i=tn(n),a=jr(n),l=bn(n)==="y",c=["left","top"].includes(i)?-1:1,d=s&&l?-1:1,f=en(t,e);let{mainAxis:u,crossAxis:h,alignmentAxis:p}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),l?{x:h*d,y:u*c}:{x:u*c,y:h*d}}const NP=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:o,y:s,placement:i,middlewareData:a}=t,l=await IP(t,e);return i===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:o+l.x,y:s+l.y,data:{...l,placement:i}}}}},TP=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,{mainAxis:s=!0,crossAxis:i=!1,limiter:a={fn:g=>{let{x:y,y:A}=g;return{x:y,y:A}}},...l}=en(e,t),c={x:n,y:r},d=await To(t,l),f=bn(tn(o)),u=pc(f);let h=c[u],p=c[f];if(s){const g=u==="y"?"top":"left",y=u==="y"?"bottom":"right",A=h+d[g],w=h-d[y];h=pl(A,h,w)}if(i){const g=f==="y"?"top":"left",y=f==="y"?"bottom":"right",A=p+d[g],w=p-d[y];p=pl(A,p,w)}const m=a.fn({...t,[u]:h,[f]:p});return{...m,data:{x:m.x-n,y:m.y-r,enabled:{[u]:s,[f]:i}}}}}},kP=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:o,rects:s,middlewareData:i}=t,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=en(e,t),d={x:n,y:r},f=bn(o),u=pc(f);let h=d[u],p=d[f];const m=en(a,t),g=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const w=u==="y"?"height":"width",E=s.reference[u]-s.floating[w]+g.mainAxis,R=s.reference[u]+s.reference[w]-g.mainAxis;h<E?h=E:h>R&&(h=R)}if(c){var y,A;const w=u==="y"?"width":"height",E=["top","left"].includes(tn(o)),R=s.reference[f]-s.floating[w]+(E&&((y=i.offset)==null?void 0:y[f])||0)+(E?0:g.crossAxis),b=s.reference[f]+s.reference[w]+(E?0:((A=i.offset)==null?void 0:A[f])||0)-(E?g.crossAxis:0);p<R?p=R:p>b&&(p=b)}return{[u]:h,[f]:p}}}},_P=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:o,rects:s,platform:i,elements:a}=t,{apply:l=()=>{},...c}=en(e,t),d=await To(t,c),f=tn(o),u=jr(o),h=bn(o)==="y",{width:p,height:m}=s.floating;let g,y;f==="top"||f==="bottom"?(g=f,y=u===(await(i.isRTL==null?void 0:i.isRTL(a.floating))?"start":"end")?"left":"right"):(y=f,g=u==="end"?"top":"bottom");const A=m-d.top-d.bottom,w=p-d.left-d.right,E=vn(m-d[g],A),R=vn(p-d[y],w),b=!t.middlewareData.shift;let v=E,C=R;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(C=w),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(v=A),b&&!u){const k=Je(d.left,0),D=Je(d.right,0),B=Je(d.top,0),j=Je(d.bottom,0);h?C=p-2*(k!==0||D!==0?k+D:Je(d.left,d.right)):v=m-2*(B!==0||j!==0?B+j:Je(d.top,d.bottom))}await l({...t,availableWidth:C,availableHeight:v});const T=await i.getDimensions(a.floating);return p!==T.width||m!==T.height?{reset:{rects:!0}}:{}}}};function Di(){return typeof window<"u"}function qr(e){return vg(e)?(e.nodeName||"").toLowerCase():"#document"}function rt(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function $t(e){var t;return(t=(vg(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function vg(e){return Di()?e instanceof Node||e instanceof rt(e).Node:!1}function Tt(e){return Di()?e instanceof Element||e instanceof rt(e).Element:!1}function Vt(e){return Di()?e instanceof HTMLElement||e instanceof rt(e).HTMLElement:!1}function _d(e){return!Di()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof rt(e).ShadowRoot}function Vo(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=kt(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(o)}function DP(e){return["table","td","th"].includes(qr(e))}function Oi(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function yc(e){const t=wc(),n=Tt(e)?kt(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function OP(e){let t=An(e);for(;Vt(t)&&!Dr(t);){if(yc(t))return t;if(Oi(t))return null;t=An(t)}return null}function wc(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Dr(e){return["html","body","#document"].includes(qr(e))}function kt(e){return rt(e).getComputedStyle(e)}function Li(e){return Tt(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function An(e){if(qr(e)==="html")return e;const t=e.assignedSlot||e.parentNode||_d(e)&&e.host||$t(e);return _d(t)?t.host:t}function bg(e){const t=An(e);return Dr(t)?e.ownerDocument?e.ownerDocument.body:e.body:Vt(t)&&Vo(t)?t:bg(t)}function ko(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=bg(e),s=o===((r=e.ownerDocument)==null?void 0:r.body),i=rt(o);if(s){const a=ml(i);return t.concat(i,i.visualViewport||[],Vo(o)?o:[],a&&n?ko(a):[])}return t.concat(o,ko(o,[],n))}function ml(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Ag(e){const t=kt(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=Vt(e),s=o?e.offsetWidth:n,i=o?e.offsetHeight:r,a=ni(n)!==s||ni(r)!==i;return a&&(n=s,r=i),{width:n,height:r,$:a}}function xc(e){return Tt(e)?e:e.contextElement}function Ar(e){const t=xc(e);if(!Vt(t))return qt(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:s}=Ag(t);let i=(s?ni(n.width):n.width)/r,a=(s?ni(n.height):n.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!a||!Number.isFinite(a))&&(a=1),{x:i,y:a}}const LP=qt(0);function Eg(e){const t=rt(e);return!wc()||!t.visualViewport?LP:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function BP(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==rt(e)?!1:t}function Yn(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const o=e.getBoundingClientRect(),s=xc(e);let i=qt(1);t&&(r?Tt(r)&&(i=Ar(r)):i=Ar(e));const a=BP(s,n,r)?Eg(s):qt(0);let l=(o.left+a.x)/i.x,c=(o.top+a.y)/i.y,d=o.width/i.x,f=o.height/i.y;if(s){const u=rt(s),h=r&&Tt(r)?rt(r):r;let p=u,m=ml(p);for(;m&&r&&h!==p;){const g=Ar(m),y=m.getBoundingClientRect(),A=kt(m),w=y.left+(m.clientLeft+parseFloat(A.paddingLeft))*g.x,E=y.top+(m.clientTop+parseFloat(A.paddingTop))*g.y;l*=g.x,c*=g.y,d*=g.x,f*=g.y,l+=w,c+=E,p=rt(m),m=ml(p)}}return oi({width:d,height:f,x:l,y:c})}function vc(e,t){const n=Li(e).scrollLeft;return t?t.left+n:Yn($t(e)).left+n}function Sg(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),o=r.left+t.scrollLeft-(n?0:vc(e,r)),s=r.top+t.scrollTop;return{x:o,y:s}}function FP(e){let{elements:t,rect:n,offsetParent:r,strategy:o}=e;const s=o==="fixed",i=$t(r),a=t?Oi(t.floating):!1;if(r===i||a&&s)return n;let l={scrollLeft:0,scrollTop:0},c=qt(1);const d=qt(0),f=Vt(r);if((f||!f&&!s)&&((qr(r)!=="body"||Vo(i))&&(l=Li(r)),Vt(r))){const h=Yn(r);c=Ar(r),d.x=h.x+r.clientLeft,d.y=h.y+r.clientTop}const u=i&&!f&&!s?Sg(i,l,!0):qt(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+d.x+u.x,y:n.y*c.y-l.scrollTop*c.y+d.y+u.y}}function jP(e){return Array.from(e.getClientRects())}function qP(e){const t=$t(e),n=Li(e),r=e.ownerDocument.body,o=Je(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),s=Je(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+vc(e);const a=-n.scrollTop;return kt(r).direction==="rtl"&&(i+=Je(t.clientWidth,r.clientWidth)-o),{width:o,height:s,x:i,y:a}}function zP(e,t){const n=rt(e),r=$t(e),o=n.visualViewport;let s=r.clientWidth,i=r.clientHeight,a=0,l=0;if(o){s=o.width,i=o.height;const c=wc();(!c||c&&t==="fixed")&&(a=o.offsetLeft,l=o.offsetTop)}return{width:s,height:i,x:a,y:l}}function HP(e,t){const n=Yn(e,!0,t==="fixed"),r=n.top+e.clientTop,o=n.left+e.clientLeft,s=Vt(e)?Ar(e):qt(1),i=e.clientWidth*s.x,a=e.clientHeight*s.y,l=o*s.x,c=r*s.y;return{width:i,height:a,x:l,y:c}}function Dd(e,t,n){let r;if(t==="viewport")r=zP(e,n);else if(t==="document")r=qP($t(e));else if(Tt(t))r=HP(t,n);else{const o=Eg(e);r={x:t.x-o.x,y:t.y-o.y,width:t.width,height:t.height}}return oi(r)}function Mg(e,t){const n=An(e);return n===t||!Tt(n)||Dr(n)?!1:kt(n).position==="fixed"||Mg(n,t)}function VP(e,t){const n=t.get(e);if(n)return n;let r=ko(e,[],!1).filter(a=>Tt(a)&&qr(a)!=="body"),o=null;const s=kt(e).position==="fixed";let i=s?An(e):e;for(;Tt(i)&&!Dr(i);){const a=kt(i),l=yc(i);!l&&a.position==="fixed"&&(o=null),(s?!l&&!o:!l&&a.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||Vo(i)&&!l&&Mg(e,i))?r=r.filter(d=>d!==i):o=a,i=An(i)}return t.set(e,r),r}function UP(e){let{element:t,boundary:n,rootBoundary:r,strategy:o}=e;const i=[...n==="clippingAncestors"?Oi(t)?[]:VP(t,this._c):[].concat(n),r],a=i[0],l=i.reduce((c,d)=>{const f=Dd(t,d,o);return c.top=Je(f.top,c.top),c.right=vn(f.right,c.right),c.bottom=vn(f.bottom,c.bottom),c.left=Je(f.left,c.left),c},Dd(t,a,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function $P(e){const{width:t,height:n}=Ag(e);return{width:t,height:n}}function GP(e,t,n){const r=Vt(t),o=$t(t),s=n==="fixed",i=Yn(e,!0,s,t);let a={scrollLeft:0,scrollTop:0};const l=qt(0);if(r||!r&&!s)if((qr(t)!=="body"||Vo(o))&&(a=Li(t)),r){const u=Yn(t,!0,s,t);l.x=u.x+t.clientLeft,l.y=u.y+t.clientTop}else o&&(l.x=vc(o));const c=o&&!r&&!s?Sg(o,a):qt(0),d=i.left+a.scrollLeft-l.x-c.x,f=i.top+a.scrollTop-l.y-c.y;return{x:d,y:f,width:i.width,height:i.height}}function Ea(e){return kt(e).position==="static"}function Od(e,t){if(!Vt(e)||kt(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return $t(e)===n&&(n=n.ownerDocument.body),n}function Cg(e,t){const n=rt(e);if(Oi(e))return n;if(!Vt(e)){let o=An(e);for(;o&&!Dr(o);){if(Tt(o)&&!Ea(o))return o;o=An(o)}return n}let r=Od(e,t);for(;r&&DP(r)&&Ea(r);)r=Od(r,t);return r&&Dr(r)&&Ea(r)&&!yc(r)?n:r||OP(e)||n}const KP=async function(e){const t=this.getOffsetParent||Cg,n=this.getDimensions,r=await n(e.floating);return{reference:GP(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function WP(e){return kt(e).direction==="rtl"}const YP={convertOffsetParentRelativeRectToViewportRelativeRect:FP,getDocumentElement:$t,getClippingRect:UP,getOffsetParent:Cg,getElementRects:KP,getClientRects:jP,getDimensions:$P,getScale:Ar,isElement:Tt,isRTL:WP};function Pg(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function XP(e,t){let n=null,r;const o=$t(e);function s(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function i(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const c=e.getBoundingClientRect(),{left:d,top:f,width:u,height:h}=c;if(a||t(),!u||!h)return;const p=fs(f),m=fs(o.clientWidth-(d+u)),g=fs(o.clientHeight-(f+h)),y=fs(d),w={rootMargin:-p+"px "+-m+"px "+-g+"px "+-y+"px",threshold:Je(0,vn(1,l))||1};let E=!0;function R(b){const v=b[0].intersectionRatio;if(v!==l){if(!E)return i();v?i(!1,v):r=setTimeout(()=>{i(!1,1e-7)},1e3)}v===1&&!Pg(c,e.getBoundingClientRect())&&i(),E=!1}try{n=new IntersectionObserver(R,{...w,root:o.ownerDocument})}catch{n=new IntersectionObserver(R,w)}n.observe(e)}return i(!0),s}function QP(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:s=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=xc(e),d=o||s?[...c?ko(c):[],...ko(t)]:[];d.forEach(y=>{o&&y.addEventListener("scroll",n,{passive:!0}),s&&y.addEventListener("resize",n)});const f=c&&a?XP(c,n):null;let u=-1,h=null;i&&(h=new ResizeObserver(y=>{let[A]=y;A&&A.target===c&&h&&(h.unobserve(t),cancelAnimationFrame(u),u=requestAnimationFrame(()=>{var w;(w=h)==null||w.observe(t)})),n()}),c&&!l&&h.observe(c),h.observe(t));let p,m=l?Yn(e):null;l&&g();function g(){const y=Yn(e);m&&!Pg(m,y)&&n(),m=y,p=requestAnimationFrame(g)}return n(),()=>{var y;d.forEach(A=>{o&&A.removeEventListener("scroll",n),s&&A.removeEventListener("resize",n)}),f==null||f(),(y=h)==null||y.disconnect(),h=null,l&&cancelAnimationFrame(p)}}const ZP=NP,JP=TP,eR=PP,tR=_P,nR=RP,Ld=CP,rR=kP,oR=(e,t,n)=>{const r=new Map,o={platform:YP,...n},s={...o.platform,_c:r};return MP(e,t,{...o,platform:s})};var Cs=typeof document<"u"?x.useLayoutEffect:x.useEffect;function si(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!si(e[r],t[r]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,o[r]))return!1;for(r=n;r--!==0;){const s=o[r];if(!(s==="_owner"&&e.$$typeof)&&!si(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function Rg(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Bd(e,t){const n=Rg(e);return Math.round(t*n)/n}function Sa(e){const t=x.useRef(e);return Cs(()=>{t.current=e}),t}function sR(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:s,floating:i}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[d,f]=x.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[u,h]=x.useState(r);si(u,r)||h(r);const[p,m]=x.useState(null),[g,y]=x.useState(null),A=x.useCallback(F=>{F!==b.current&&(b.current=F,m(F))},[]),w=x.useCallback(F=>{F!==v.current&&(v.current=F,y(F))},[]),E=s||p,R=i||g,b=x.useRef(null),v=x.useRef(null),C=x.useRef(d),T=l!=null,k=Sa(l),D=Sa(o),B=Sa(c),j=x.useCallback(()=>{if(!b.current||!v.current)return;const F={placement:t,strategy:n,middleware:u};D.current&&(F.platform=D.current),oR(b.current,v.current,F).then(N=>{const z={...N,isPositioned:B.current!==!1};P.current&&!si(C.current,z)&&(C.current=z,Cl.flushSync(()=>{f(z)}))})},[u,t,n,D,B]);Cs(()=>{c===!1&&C.current.isPositioned&&(C.current.isPositioned=!1,f(F=>({...F,isPositioned:!1})))},[c]);const P=x.useRef(!1);Cs(()=>(P.current=!0,()=>{P.current=!1}),[]),Cs(()=>{if(E&&(b.current=E),R&&(v.current=R),E&&R){if(k.current)return k.current(E,R,j);j()}},[E,R,j,k,T]);const O=x.useMemo(()=>({reference:b,floating:v,setReference:A,setFloating:w}),[A,w]),I=x.useMemo(()=>({reference:E,floating:R}),[E,R]),_=x.useMemo(()=>{const F={position:n,left:0,top:0};if(!I.floating)return F;const N=Bd(I.floating,d.x),z=Bd(I.floating,d.y);return a?{...F,transform:"translate("+N+"px, "+z+"px)",...Rg(I.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:N,top:z}},[n,a,I.floating,d.x,d.y]);return x.useMemo(()=>({...d,update:j,refs:O,elements:I,floatingStyles:_}),[d,j,O,I,_])}const iR=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:o}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?Ld({element:r.current,padding:o}).fn(n):{}:r?Ld({element:r,padding:o}).fn(n):{}}}},aR=(e,t)=>({...ZP(e),options:[e,t]}),lR=(e,t)=>({...JP(e),options:[e,t]}),cR=(e,t)=>({...rR(e),options:[e,t]}),uR=(e,t)=>({...eR(e),options:[e,t]}),dR=(e,t)=>({...tR(e),options:[e,t]}),fR=(e,t)=>({...nR(e),options:[e,t]}),hR=(e,t)=>({...iR(e),options:[e,t]});var pR="Arrow",Ig=x.forwardRef((e,t)=>{const{children:n,width:r=10,height:o=5,...s}=e;return S.jsx(xe.svg,{...s,ref:t,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:S.jsx("polygon",{points:"0,0 30,0 15,10"})})});Ig.displayName=pR;var gR=Ig;function mR(e){const[t,n]=x.useState(void 0);return gt(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const s=o[0];let i,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;i=c.inlineSize,a=c.blockSize}else i=e.offsetWidth,a=e.offsetHeight;n({width:i,height:a})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var bc="Popper",[Ng,Bi]=Or(bc),[yR,Tg]=Ng(bc),kg=e=>{const{__scopePopper:t,children:n}=e,[r,o]=x.useState(null);return S.jsx(yR,{scope:t,anchor:r,onAnchorChange:o,children:n})};kg.displayName=bc;var _g="PopperAnchor",Dg=x.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...o}=e,s=Tg(_g,n),i=x.useRef(null),a=Ce(t,i);return x.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:S.jsx(xe.div,{...o,ref:a})});Dg.displayName=_g;var Ac="PopperContent",[wR,xR]=Ng(Ac),Og=x.forwardRef((e,t)=>{var q,W,te,se,oe,ne;const{__scopePopper:n,side:r="bottom",sideOffset:o=0,align:s="center",alignOffset:i=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:d=0,sticky:f="partial",hideWhenDetached:u=!1,updatePositionStrategy:h="optimized",onPlaced:p,...m}=e,g=Tg(Ac,n),[y,A]=x.useState(null),w=Ce(t,J=>A(J)),[E,R]=x.useState(null),b=mR(E),v=(b==null?void 0:b.width)??0,C=(b==null?void 0:b.height)??0,T=r+(s!=="center"?"-"+s:""),k=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},D=Array.isArray(c)?c:[c],B=D.length>0,j={padding:k,boundary:D.filter(bR),altBoundary:B},{refs:P,floatingStyles:O,placement:I,isPositioned:_,middlewareData:F}=sR({strategy:"fixed",placement:T,whileElementsMounted:(...J)=>QP(...J,{animationFrame:h==="always"}),elements:{reference:g.anchor},middleware:[aR({mainAxis:o+C,alignmentAxis:i}),l&&lR({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?cR():void 0,...j}),l&&uR({...j}),dR({...j,apply:({elements:J,rects:re,availableWidth:le,availableHeight:ce})=>{const{width:me,height:de}=re.reference,be=J.floating.style;be.setProperty("--radix-popper-available-width",`${le}px`),be.setProperty("--radix-popper-available-height",`${ce}px`),be.setProperty("--radix-popper-anchor-width",`${me}px`),be.setProperty("--radix-popper-anchor-height",`${de}px`)}}),E&&hR({element:E,padding:a}),AR({arrowWidth:v,arrowHeight:C}),u&&fR({strategy:"referenceHidden",...j})]}),[N,z]=Fg(I),V=Ht(p);gt(()=>{_&&(V==null||V())},[_,V]);const U=(q=F.arrow)==null?void 0:q.x,K=(W=F.arrow)==null?void 0:W.y,Y=((te=F.arrow)==null?void 0:te.centerOffset)!==0,[ee,Z]=x.useState();return gt(()=>{y&&Z(window.getComputedStyle(y).zIndex)},[y]),S.jsx("div",{ref:P.setFloating,"data-radix-popper-content-wrapper":"",style:{...O,transform:_?O.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ee,"--radix-popper-transform-origin":[(se=F.transformOrigin)==null?void 0:se.x,(oe=F.transformOrigin)==null?void 0:oe.y].join(" "),...((ne=F.hide)==null?void 0:ne.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:S.jsx(wR,{scope:n,placedSide:N,onArrowChange:R,arrowX:U,arrowY:K,shouldHideArrow:Y,children:S.jsx(xe.div,{"data-side":N,"data-align":z,...m,ref:w,style:{...m.style,animation:_?void 0:"none"}})})})});Og.displayName=Ac;var Lg="PopperArrow",vR={top:"bottom",right:"left",bottom:"top",left:"right"},Bg=x.forwardRef(function(t,n){const{__scopePopper:r,...o}=t,s=xR(Lg,r),i=vR[s.placedSide];return S.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:S.jsx(gR,{...o,ref:n,style:{...o.style,display:"block"}})})});Bg.displayName=Lg;function bR(e){return e!==null}var AR=e=>({name:"transformOrigin",options:e,fn(t){var g,y,A;const{placement:n,rects:r,middlewareData:o}=t,i=((g=o.arrow)==null?void 0:g.centerOffset)!==0,a=i?0:e.arrowWidth,l=i?0:e.arrowHeight,[c,d]=Fg(n),f={start:"0%",center:"50%",end:"100%"}[d],u=(((y=o.arrow)==null?void 0:y.x)??0)+a/2,h=(((A=o.arrow)==null?void 0:A.y)??0)+l/2;let p="",m="";return c==="bottom"?(p=i?f:`${u}px`,m=`${-l}px`):c==="top"?(p=i?f:`${u}px`,m=`${r.floating.height+l}px`):c==="right"?(p=`${-l}px`,m=i?f:`${h}px`):c==="left"&&(p=`${r.floating.width+l}px`,m=i?f:`${h}px`),{data:{x:p,y:m}}}});function Fg(e){const[t,n="center"]=e.split("-");return[t,n]}var jg=kg,qg=Dg,zg=Og,Hg=Bg,ER="Portal",Ec=x.forwardRef((e,t)=>{var a;const{container:n,...r}=e,[o,s]=x.useState(!1);gt(()=>s(!0),[]);const i=n||o&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return i?Z0.createPortal(S.jsx(xe.div,{...r,ref:t}),i):null});Ec.displayName=ER;function SR(e){const t=x.useRef({value:e,previous:e});return x.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Vg=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),MR="VisuallyHidden",CR=x.forwardRef((e,t)=>S.jsx(xe.span,{...e,ref:t,style:{...Vg,...e.style}}));CR.displayName=MR;var PR=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},lr=new WeakMap,hs=new WeakMap,ps={},Ma=0,Ug=function(e){return e&&(e.host||Ug(e.parentNode))},RR=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=Ug(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},IR=function(e,t,n,r){var o=RR(t,Array.isArray(e)?e:[e]);ps[n]||(ps[n]=new WeakMap);var s=ps[n],i=[],a=new Set,l=new Set(o),c=function(f){!f||a.has(f)||(a.add(f),c(f.parentNode))};o.forEach(c);var d=function(f){!f||l.has(f)||Array.prototype.forEach.call(f.children,function(u){if(a.has(u))d(u);else try{var h=u.getAttribute(r),p=h!==null&&h!=="false",m=(lr.get(u)||0)+1,g=(s.get(u)||0)+1;lr.set(u,m),s.set(u,g),i.push(u),m===1&&p&&hs.set(u,!0),g===1&&u.setAttribute(n,"true"),p||u.setAttribute(r,"true")}catch(y){console.error("aria-hidden: cannot operate on ",u,y)}})};return d(t),a.clear(),Ma++,function(){i.forEach(function(f){var u=lr.get(f)-1,h=s.get(f)-1;lr.set(f,u),s.set(f,h),u||(hs.has(f)||f.removeAttribute(r),hs.delete(f)),h||f.removeAttribute(n)}),Ma--,Ma||(lr=new WeakMap,lr=new WeakMap,hs=new WeakMap,ps={})}},$g=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),o=PR(e);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),IR(r,o,n,"aria-hidden")):function(){return null}},Ot=function(){return Ot=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ot.apply(this,arguments)};function Gg(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}function NR(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,s;r<o;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}var Ps="right-scroll-bar-position",Rs="width-before-scroll-bar",TR="with-scroll-bars-hidden",kR="--removed-body-scroll-bar-size";function Ca(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function _R(e,t){var n=x.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var o=n.value;o!==r&&(n.value=r,n.callback(r,o))}}}})[0];return n.callback=t,n.facade}var DR=typeof window<"u"?x.useLayoutEffect:x.useEffect,Fd=new WeakMap;function OR(e,t){var n=_R(null,function(r){return e.forEach(function(o){return Ca(o,r)})});return DR(function(){var r=Fd.get(n);if(r){var o=new Set(r),s=new Set(e),i=n.current;o.forEach(function(a){s.has(a)||Ca(a,null)}),s.forEach(function(a){o.has(a)||Ca(a,i)})}Fd.set(n,e)},[e]),n}function LR(e){return e}function BR(e,t){t===void 0&&(t=LR);var n=[],r=!1,o={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(s){var i=t(s,r);return n.push(i),function(){n=n.filter(function(a){return a!==i})}},assignSyncMedium:function(s){for(r=!0;n.length;){var i=n;n=[],i.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){r=!0;var i=[];if(n.length){var a=n;n=[],a.forEach(s),i=n}var l=function(){var d=i;i=[],d.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(d){i.push(d),c()},filter:function(d){return i=i.filter(d),n}}}};return o}function FR(e){e===void 0&&(e={});var t=BR(null);return t.options=Ot({async:!0,ssr:!1},e),t}var Kg=function(e){var t=e.sideCar,n=Gg(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return x.createElement(r,Ot({},n))};Kg.isSideCarExport=!0;function jR(e,t){return e.useMedium(t),Kg}var Wg=FR(),Pa=function(){},Fi=x.forwardRef(function(e,t){var n=x.useRef(null),r=x.useState({onScrollCapture:Pa,onWheelCapture:Pa,onTouchMoveCapture:Pa}),o=r[0],s=r[1],i=e.forwardProps,a=e.children,l=e.className,c=e.removeScrollBar,d=e.enabled,f=e.shards,u=e.sideCar,h=e.noIsolation,p=e.inert,m=e.allowPinchZoom,g=e.as,y=g===void 0?"div":g,A=e.gapMode,w=Gg(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),E=u,R=OR([n,t]),b=Ot(Ot({},w),o);return x.createElement(x.Fragment,null,d&&x.createElement(E,{sideCar:Wg,removeScrollBar:c,shards:f,noIsolation:h,inert:p,setCallbacks:s,allowPinchZoom:!!m,lockRef:n,gapMode:A}),i?x.cloneElement(x.Children.only(a),Ot(Ot({},b),{ref:R})):x.createElement(y,Ot({},b,{className:l,ref:R}),a))});Fi.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Fi.classNames={fullWidth:Rs,zeroRight:Ps};var qR=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function zR(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=qR();return t&&e.setAttribute("nonce",t),e}function HR(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function VR(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var UR=function(){var e=0,t=null;return{add:function(n){e==0&&(t=zR())&&(HR(t,n),VR(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},$R=function(){var e=UR();return function(t,n){x.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Yg=function(){var e=$R(),t=function(n){var r=n.styles,o=n.dynamic;return e(r,o),null};return t},GR={left:0,top:0,right:0,gap:0},Ra=function(e){return parseInt(e||"",10)||0},KR=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],o=t[e==="padding"?"paddingRight":"marginRight"];return[Ra(n),Ra(r),Ra(o)]},WR=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return GR;var t=KR(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},YR=Yg(),Er="data-scroll-locked",XR=function(e,t,n,r){var o=e.left,s=e.top,i=e.right,a=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(TR,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(Er,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ps,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Rs,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Ps," .").concat(Ps,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Rs," .").concat(Rs,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Er,`] {
    `).concat(kR,": ").concat(a,`px;
  }
`)},jd=function(){var e=parseInt(document.body.getAttribute(Er)||"0",10);return isFinite(e)?e:0},QR=function(){x.useEffect(function(){return document.body.setAttribute(Er,(jd()+1).toString()),function(){var e=jd()-1;e<=0?document.body.removeAttribute(Er):document.body.setAttribute(Er,e.toString())}},[])},ZR=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,o=r===void 0?"margin":r;QR();var s=x.useMemo(function(){return WR(o)},[o]);return x.createElement(YR,{styles:XR(s,!t,o,n?"":"!important")})},yl=!1;if(typeof window<"u")try{var gs=Object.defineProperty({},"passive",{get:function(){return yl=!0,!0}});window.addEventListener("test",gs,gs),window.removeEventListener("test",gs,gs)}catch{yl=!1}var cr=yl?{passive:!1}:!1,JR=function(e){return e.tagName==="TEXTAREA"},Xg=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!JR(e)&&n[t]==="visible")},eI=function(e){return Xg(e,"overflowY")},tI=function(e){return Xg(e,"overflowX")},qd=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var o=Qg(e,r);if(o){var s=Zg(e,r),i=s[1],a=s[2];if(i>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},nI=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},rI=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Qg=function(e,t){return e==="v"?eI(t):tI(t)},Zg=function(e,t){return e==="v"?nI(t):rI(t)},oI=function(e,t){return e==="h"&&t==="rtl"?-1:1},sI=function(e,t,n,r,o){var s=oI(e,window.getComputedStyle(t).direction),i=s*r,a=n.target,l=t.contains(a),c=!1,d=i>0,f=0,u=0;do{var h=Zg(e,a),p=h[0],m=h[1],g=h[2],y=m-g-s*p;(p||y)&&Qg(e,a)&&(f+=y,u+=p),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(t.contains(a)||t===a));return(d&&Math.abs(f)<1||!d&&Math.abs(u)<1)&&(c=!0),c},ms=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},zd=function(e){return[e.deltaX,e.deltaY]},Hd=function(e){return e&&"current"in e?e.current:e},iI=function(e,t){return e[0]===t[0]&&e[1]===t[1]},aI=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},lI=0,ur=[];function cI(e){var t=x.useRef([]),n=x.useRef([0,0]),r=x.useRef(),o=x.useState(lI++)[0],s=x.useState(Yg)[0],i=x.useRef(e);x.useEffect(function(){i.current=e},[e]),x.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var m=NR([e.lockRef.current],(e.shards||[]).map(Hd),!0).filter(Boolean);return m.forEach(function(g){return g.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),m.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var a=x.useCallback(function(m,g){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var y=ms(m),A=n.current,w="deltaX"in m?m.deltaX:A[0]-y[0],E="deltaY"in m?m.deltaY:A[1]-y[1],R,b=m.target,v=Math.abs(w)>Math.abs(E)?"h":"v";if("touches"in m&&v==="h"&&b.type==="range")return!1;var C=qd(v,b);if(!C)return!0;if(C?R=v:(R=v==="v"?"h":"v",C=qd(v,b)),!C)return!1;if(!r.current&&"changedTouches"in m&&(w||E)&&(r.current=R),!R)return!0;var T=r.current||R;return sI(T,g,m,T==="h"?w:E)},[]),l=x.useCallback(function(m){var g=m;if(!(!ur.length||ur[ur.length-1]!==s)){var y="deltaY"in g?zd(g):ms(g),A=t.current.filter(function(R){return R.name===g.type&&(R.target===g.target||g.target===R.shadowParent)&&iI(R.delta,y)})[0];if(A&&A.should){g.cancelable&&g.preventDefault();return}if(!A){var w=(i.current.shards||[]).map(Hd).filter(Boolean).filter(function(R){return R.contains(g.target)}),E=w.length>0?a(g,w[0]):!i.current.noIsolation;E&&g.cancelable&&g.preventDefault()}}},[]),c=x.useCallback(function(m,g,y,A){var w={name:m,delta:g,target:y,should:A,shadowParent:uI(y)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(E){return E!==w})},1)},[]),d=x.useCallback(function(m){n.current=ms(m),r.current=void 0},[]),f=x.useCallback(function(m){c(m.type,zd(m),m.target,a(m,e.lockRef.current))},[]),u=x.useCallback(function(m){c(m.type,ms(m),m.target,a(m,e.lockRef.current))},[]);x.useEffect(function(){return ur.push(s),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:u}),document.addEventListener("wheel",l,cr),document.addEventListener("touchmove",l,cr),document.addEventListener("touchstart",d,cr),function(){ur=ur.filter(function(m){return m!==s}),document.removeEventListener("wheel",l,cr),document.removeEventListener("touchmove",l,cr),document.removeEventListener("touchstart",d,cr)}},[]);var h=e.removeScrollBar,p=e.inert;return x.createElement(x.Fragment,null,p?x.createElement(s,{styles:aI(o)}):null,h?x.createElement(ZR,{gapMode:e.gapMode}):null)}function uI(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const dI=jR(Wg,cI);var Sc=x.forwardRef(function(e,t){return x.createElement(Fi,Ot({},e,{ref:t,sideCar:dI}))});Sc.classNames=Fi.classNames;var fI=[" ","Enter","ArrowUp","ArrowDown"],hI=[" ","Enter"],Xn="Select",[ji,qi,pI]=uc(Xn),[zr,CT]=Or(Xn,[pI,Bi]),zi=Bi(),[gI,Mn]=zr(Xn),[mI,yI]=zr(Xn),Jg=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:o,onOpenChange:s,value:i,defaultValue:a,onValueChange:l,dir:c,name:d,autoComplete:f,disabled:u,required:h,form:p}=e,m=zi(t),[g,y]=x.useState(null),[A,w]=x.useState(null),[E,R]=x.useState(!1),b=dc(c),[v,C]=Ts({prop:r,defaultProp:o??!1,onChange:s,caller:Xn}),[T,k]=Ts({prop:i,defaultProp:a,onChange:l,caller:Xn}),D=x.useRef(null),B=g?p||!!g.closest("form"):!0,[j,P]=x.useState(new Set),O=Array.from(j).map(I=>I.props.value).join(";");return S.jsx(jg,{...m,children:S.jsxs(gI,{required:h,scope:t,trigger:g,onTriggerChange:y,valueNode:A,onValueNodeChange:w,valueNodeHasChildren:E,onValueNodeHasChildrenChange:R,contentId:Sr(),value:T,onValueChange:k,open:v,onOpenChange:C,dir:b,triggerPointerDownPosRef:D,disabled:u,children:[S.jsx(ji.Provider,{scope:t,children:S.jsx(mI,{scope:e.__scopeSelect,onNativeOptionAdd:x.useCallback(I=>{P(_=>new Set(_).add(I))},[]),onNativeOptionRemove:x.useCallback(I=>{P(_=>{const F=new Set(_);return F.delete(I),F})},[]),children:n})}),B?S.jsxs(Am,{"aria-hidden":!0,required:h,tabIndex:-1,name:d,autoComplete:f,value:T,onChange:I=>k(I.target.value),disabled:u,form:p,children:[T===void 0?S.jsx("option",{value:""}):null,Array.from(j)]},O):null]})})};Jg.displayName=Xn;var em="SelectTrigger",tm=x.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...o}=e,s=zi(n),i=Mn(em,n),a=i.disabled||r,l=Ce(t,i.onTriggerChange),c=qi(n),d=x.useRef("touch"),[f,u,h]=Sm(m=>{const g=c().filter(w=>!w.disabled),y=g.find(w=>w.value===i.value),A=Mm(g,m,y);A!==void 0&&i.onValueChange(A.value)}),p=m=>{a||(i.onOpenChange(!0),h()),m&&(i.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return S.jsx(qg,{asChild:!0,...s,children:S.jsx(xe.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":Em(i.value)?"":void 0,...o,ref:l,onClick:ue(o.onClick,m=>{m.currentTarget.focus(),d.current!=="mouse"&&p(m)}),onPointerDown:ue(o.onPointerDown,m=>{d.current=m.pointerType;const g=m.target;g.hasPointerCapture(m.pointerId)&&g.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(p(m),m.preventDefault())}),onKeyDown:ue(o.onKeyDown,m=>{const g=f.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&u(m.key),!(g&&m.key===" ")&&fI.includes(m.key)&&(p(),m.preventDefault())})})})});tm.displayName=em;var nm="SelectValue",rm=x.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:o,children:s,placeholder:i="",...a}=e,l=Mn(nm,n),{onValueNodeHasChildrenChange:c}=l,d=s!==void 0,f=Ce(t,l.onValueNodeChange);return gt(()=>{c(d)},[c,d]),S.jsx(xe.span,{...a,ref:f,style:{pointerEvents:"none"},children:Em(l.value)?S.jsx(S.Fragment,{children:i}):s})});rm.displayName=nm;var wI="SelectIcon",om=x.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...o}=e;return S.jsx(xe.span,{"aria-hidden":!0,...o,ref:t,children:r||""})});om.displayName=wI;var xI="SelectPortal",sm=e=>S.jsx(Ec,{asChild:!0,...e});sm.displayName=xI;var Qn="SelectContent",im=x.forwardRef((e,t)=>{const n=Mn(Qn,e.__scopeSelect),[r,o]=x.useState();if(gt(()=>{o(new DocumentFragment)},[]),!n.open){const s=r;return s?Cl.createPortal(S.jsx(am,{scope:e.__scopeSelect,children:S.jsx(ji.Slot,{scope:e.__scopeSelect,children:S.jsx("div",{children:e.children})})}),s):null}return S.jsx(lm,{...e,ref:t})});im.displayName=Qn;var Et=10,[am,Cn]=zr(Qn),vI="SelectContentImpl",bI=Ns("SelectContent.RemoveScroll"),lm=x.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:s,onPointerDownOutside:i,side:a,sideOffset:l,align:c,alignOffset:d,arrowPadding:f,collisionBoundary:u,collisionPadding:h,sticky:p,hideWhenDetached:m,avoidCollisions:g,...y}=e,A=Mn(Qn,n),[w,E]=x.useState(null),[R,b]=x.useState(null),v=Ce(t,q=>E(q)),[C,T]=x.useState(null),[k,D]=x.useState(null),B=qi(n),[j,P]=x.useState(!1),O=x.useRef(!1);x.useEffect(()=>{if(w)return $g(w)},[w]),yg();const I=x.useCallback(q=>{const[W,...te]=B().map(ne=>ne.ref.current),[se]=te.slice(-1),oe=document.activeElement;for(const ne of q)if(ne===oe||(ne==null||ne.scrollIntoView({block:"nearest"}),ne===W&&R&&(R.scrollTop=0),ne===se&&R&&(R.scrollTop=R.scrollHeight),ne==null||ne.focus(),document.activeElement!==oe))return},[B,R]),_=x.useCallback(()=>I([C,w]),[I,C,w]);x.useEffect(()=>{j&&_()},[j,_]);const{onOpenChange:F,triggerPointerDownPosRef:N}=A;x.useEffect(()=>{if(w){let q={x:0,y:0};const W=se=>{var oe,ne;q={x:Math.abs(Math.round(se.pageX)-(((oe=N.current)==null?void 0:oe.x)??0)),y:Math.abs(Math.round(se.pageY)-(((ne=N.current)==null?void 0:ne.y)??0))}},te=se=>{q.x<=10&&q.y<=10?se.preventDefault():w.contains(se.target)||F(!1),document.removeEventListener("pointermove",W),N.current=null};return N.current!==null&&(document.addEventListener("pointermove",W),document.addEventListener("pointerup",te,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",W),document.removeEventListener("pointerup",te,{capture:!0})}}},[w,F,N]),x.useEffect(()=>{const q=()=>F(!1);return window.addEventListener("blur",q),window.addEventListener("resize",q),()=>{window.removeEventListener("blur",q),window.removeEventListener("resize",q)}},[F]);const[z,V]=Sm(q=>{const W=B().filter(oe=>!oe.disabled),te=W.find(oe=>oe.ref.current===document.activeElement),se=Mm(W,q,te);se&&setTimeout(()=>se.ref.current.focus())}),U=x.useCallback((q,W,te)=>{const se=!O.current&&!te;(A.value!==void 0&&A.value===W||se)&&(T(q),se&&(O.current=!0))},[A.value]),K=x.useCallback(()=>w==null?void 0:w.focus(),[w]),Y=x.useCallback((q,W,te)=>{const se=!O.current&&!te;(A.value!==void 0&&A.value===W||se)&&D(q)},[A.value]),ee=r==="popper"?wl:cm,Z=ee===wl?{side:a,sideOffset:l,align:c,alignOffset:d,arrowPadding:f,collisionBoundary:u,collisionPadding:h,sticky:p,hideWhenDetached:m,avoidCollisions:g}:{};return S.jsx(am,{scope:n,content:w,viewport:R,onViewportChange:b,itemRefCallback:U,selectedItem:C,onItemLeave:K,itemTextRefCallback:Y,focusSelectedItem:_,selectedItemText:k,position:r,isPositioned:j,searchRef:z,children:S.jsx(Sc,{as:bI,allowPinchZoom:!0,children:S.jsx(hc,{asChild:!0,trapped:A.open,onMountAutoFocus:q=>{q.preventDefault()},onUnmountAutoFocus:ue(o,q=>{var W;(W=A.trigger)==null||W.focus({preventScroll:!0}),q.preventDefault()}),children:S.jsx(fc,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:q=>q.preventDefault(),onDismiss:()=>A.onOpenChange(!1),children:S.jsx(ee,{role:"listbox",id:A.contentId,"data-state":A.open?"open":"closed",dir:A.dir,onContextMenu:q=>q.preventDefault(),...y,...Z,onPlaced:()=>P(!0),ref:v,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:ue(y.onKeyDown,q=>{const W=q.ctrlKey||q.altKey||q.metaKey;if(q.key==="Tab"&&q.preventDefault(),!W&&q.key.length===1&&V(q.key),["ArrowUp","ArrowDown","Home","End"].includes(q.key)){let se=B().filter(oe=>!oe.disabled).map(oe=>oe.ref.current);if(["ArrowUp","End"].includes(q.key)&&(se=se.slice().reverse()),["ArrowUp","ArrowDown"].includes(q.key)){const oe=q.target,ne=se.indexOf(oe);se=se.slice(ne+1)}setTimeout(()=>I(se)),q.preventDefault()}})})})})})})});lm.displayName=vI;var AI="SelectItemAlignedPosition",cm=x.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...o}=e,s=Mn(Qn,n),i=Cn(Qn,n),[a,l]=x.useState(null),[c,d]=x.useState(null),f=Ce(t,v=>d(v)),u=qi(n),h=x.useRef(!1),p=x.useRef(!0),{viewport:m,selectedItem:g,selectedItemText:y,focusSelectedItem:A}=i,w=x.useCallback(()=>{if(s.trigger&&s.valueNode&&a&&c&&m&&g&&y){const v=s.trigger.getBoundingClientRect(),C=c.getBoundingClientRect(),T=s.valueNode.getBoundingClientRect(),k=y.getBoundingClientRect();if(s.dir!=="rtl"){const oe=k.left-C.left,ne=T.left-oe,J=v.left-ne,re=v.width+J,le=Math.max(re,C.width),ce=window.innerWidth-Et,me=Ad(ne,[Et,Math.max(Et,ce-le)]);a.style.minWidth=re+"px",a.style.left=me+"px"}else{const oe=C.right-k.right,ne=window.innerWidth-T.right-oe,J=window.innerWidth-v.right-ne,re=v.width+J,le=Math.max(re,C.width),ce=window.innerWidth-Et,me=Ad(ne,[Et,Math.max(Et,ce-le)]);a.style.minWidth=re+"px",a.style.right=me+"px"}const D=u(),B=window.innerHeight-Et*2,j=m.scrollHeight,P=window.getComputedStyle(c),O=parseInt(P.borderTopWidth,10),I=parseInt(P.paddingTop,10),_=parseInt(P.borderBottomWidth,10),F=parseInt(P.paddingBottom,10),N=O+I+j+F+_,z=Math.min(g.offsetHeight*5,N),V=window.getComputedStyle(m),U=parseInt(V.paddingTop,10),K=parseInt(V.paddingBottom,10),Y=v.top+v.height/2-Et,ee=B-Y,Z=g.offsetHeight/2,q=g.offsetTop+Z,W=O+I+q,te=N-W;if(W<=Y){const oe=D.length>0&&g===D[D.length-1].ref.current;a.style.bottom="0px";const ne=c.clientHeight-m.offsetTop-m.offsetHeight,J=Math.max(ee,Z+(oe?K:0)+ne+_),re=W+J;a.style.height=re+"px"}else{const oe=D.length>0&&g===D[0].ref.current;a.style.top="0px";const J=Math.max(Y,O+m.offsetTop+(oe?U:0)+Z)+te;a.style.height=J+"px",m.scrollTop=W-Y+m.offsetTop}a.style.margin=`${Et}px 0`,a.style.minHeight=z+"px",a.style.maxHeight=B+"px",r==null||r(),requestAnimationFrame(()=>h.current=!0)}},[u,s.trigger,s.valueNode,a,c,m,g,y,s.dir,r]);gt(()=>w(),[w]);const[E,R]=x.useState();gt(()=>{c&&R(window.getComputedStyle(c).zIndex)},[c]);const b=x.useCallback(v=>{v&&p.current===!0&&(w(),A==null||A(),p.current=!1)},[w,A]);return S.jsx(SI,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:h,onScrollButtonChange:b,children:S.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:E},children:S.jsx(xe.div,{...o,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});cm.displayName=AI;var EI="SelectPopperPosition",wl=x.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:o=Et,...s}=e,i=zi(n);return S.jsx(zg,{...i,...s,ref:t,align:r,collisionPadding:o,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});wl.displayName=EI;var[SI,Mc]=zr(Qn,{}),xl="SelectViewport",um=x.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...o}=e,s=Cn(xl,n),i=Mc(xl,n),a=Ce(t,s.onViewportChange),l=x.useRef(0);return S.jsxs(S.Fragment,{children:[S.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),S.jsx(ji.Slot,{scope:n,children:S.jsx(xe.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:ue(o.onScroll,c=>{const d=c.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:u}=i;if(u!=null&&u.current&&f){const h=Math.abs(l.current-d.scrollTop);if(h>0){const p=window.innerHeight-Et*2,m=parseFloat(f.style.minHeight),g=parseFloat(f.style.height),y=Math.max(m,g);if(y<p){const A=y+h,w=Math.min(p,A),E=A-w;f.style.height=w+"px",f.style.bottom==="0px"&&(d.scrollTop=E>0?E:0,f.style.justifyContent="flex-end")}}}l.current=d.scrollTop})})})]})});um.displayName=xl;var dm="SelectGroup",[MI,CI]=zr(dm),fm=x.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,o=Sr();return S.jsx(MI,{scope:n,id:o,children:S.jsx(xe.div,{role:"group","aria-labelledby":o,...r,ref:t})})});fm.displayName=dm;var hm="SelectLabel",PI=x.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,o=CI(hm,n);return S.jsx(xe.div,{id:o.id,...r,ref:t})});PI.displayName=hm;var ii="SelectItem",[RI,pm]=zr(ii),gm=x.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:o=!1,textValue:s,...i}=e,a=Mn(ii,n),l=Cn(ii,n),c=a.value===r,[d,f]=x.useState(s??""),[u,h]=x.useState(!1),p=Ce(t,A=>{var w;return(w=l.itemRefCallback)==null?void 0:w.call(l,A,r,o)}),m=Sr(),g=x.useRef("touch"),y=()=>{o||(a.onValueChange(r),a.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return S.jsx(RI,{scope:n,value:r,disabled:o,textId:m,isSelected:c,onItemTextChange:x.useCallback(A=>{f(w=>w||((A==null?void 0:A.textContent)??"").trim())},[]),children:S.jsx(ji.ItemSlot,{scope:n,value:r,disabled:o,textValue:d,children:S.jsx(xe.div,{role:"option","aria-labelledby":m,"data-highlighted":u?"":void 0,"aria-selected":c&&u,"data-state":c?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...i,ref:p,onFocus:ue(i.onFocus,()=>h(!0)),onBlur:ue(i.onBlur,()=>h(!1)),onClick:ue(i.onClick,()=>{g.current!=="mouse"&&y()}),onPointerUp:ue(i.onPointerUp,()=>{g.current==="mouse"&&y()}),onPointerDown:ue(i.onPointerDown,A=>{g.current=A.pointerType}),onPointerMove:ue(i.onPointerMove,A=>{var w;g.current=A.pointerType,o?(w=l.onItemLeave)==null||w.call(l):g.current==="mouse"&&A.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ue(i.onPointerLeave,A=>{var w;A.currentTarget===document.activeElement&&((w=l.onItemLeave)==null||w.call(l))}),onKeyDown:ue(i.onKeyDown,A=>{var E;((E=l.searchRef)==null?void 0:E.current)!==""&&A.key===" "||(hI.includes(A.key)&&y(),A.key===" "&&A.preventDefault())})})})})});gm.displayName=ii;var oo="SelectItemText",mm=x.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:o,...s}=e,i=Mn(oo,n),a=Cn(oo,n),l=pm(oo,n),c=yI(oo,n),[d,f]=x.useState(null),u=Ce(t,y=>f(y),l.onItemTextChange,y=>{var A;return(A=a.itemTextRefCallback)==null?void 0:A.call(a,y,l.value,l.disabled)}),h=d==null?void 0:d.textContent,p=x.useMemo(()=>S.jsx("option",{value:l.value,disabled:l.disabled,children:h},l.value),[l.disabled,l.value,h]),{onNativeOptionAdd:m,onNativeOptionRemove:g}=c;return gt(()=>(m(p),()=>g(p)),[m,g,p]),S.jsxs(S.Fragment,{children:[S.jsx(xe.span,{id:l.textId,...s,ref:u}),l.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Cl.createPortal(s.children,i.valueNode):null]})});mm.displayName=oo;var ym="SelectItemIndicator",wm=x.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return pm(ym,n).isSelected?S.jsx(xe.span,{"aria-hidden":!0,...r,ref:t}):null});wm.displayName=ym;var vl="SelectScrollUpButton",xm=x.forwardRef((e,t)=>{const n=Cn(vl,e.__scopeSelect),r=Mc(vl,e.__scopeSelect),[o,s]=x.useState(!1),i=Ce(t,r.onScrollButtonChange);return gt(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollTop>0;s(c)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),o?S.jsx(bm,{...e,ref:i,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});xm.displayName=vl;var bl="SelectScrollDownButton",vm=x.forwardRef((e,t)=>{const n=Cn(bl,e.__scopeSelect),r=Mc(bl,e.__scopeSelect),[o,s]=x.useState(!1),i=Ce(t,r.onScrollButtonChange);return gt(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollHeight-l.clientHeight,d=Math.ceil(l.scrollTop)<c;s(d)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),o?S.jsx(bm,{...e,ref:i,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});vm.displayName=bl;var bm=x.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...o}=e,s=Cn("SelectScrollButton",n),i=x.useRef(null),a=qi(n),l=x.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return x.useEffect(()=>()=>l(),[l]),gt(()=>{var d;const c=a().find(f=>f.ref.current===document.activeElement);(d=c==null?void 0:c.ref.current)==null||d.scrollIntoView({block:"nearest"})},[a]),S.jsx(xe.div,{"aria-hidden":!0,...o,ref:t,style:{flexShrink:0,...o.style},onPointerDown:ue(o.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:ue(o.onPointerMove,()=>{var c;(c=s.onItemLeave)==null||c.call(s),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:ue(o.onPointerLeave,()=>{l()})})}),II="SelectSeparator",NI=x.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return S.jsx(xe.div,{"aria-hidden":!0,...r,ref:t})});NI.displayName=II;var Al="SelectArrow",TI=x.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,o=zi(n),s=Mn(Al,n),i=Cn(Al,n);return s.open&&i.position==="popper"?S.jsx(Hg,{...o,...r,ref:t}):null});TI.displayName=Al;var kI="SelectBubbleInput",Am=x.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const o=x.useRef(null),s=Ce(r,o),i=SR(t);return x.useEffect(()=>{const a=o.current;if(!a)return;const l=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(l,"value").set;if(i!==t&&d){const f=new Event("change",{bubbles:!0});d.call(a,t),a.dispatchEvent(f)}},[i,t]),S.jsx(xe.select,{...n,style:{...Vg,...n.style},ref:s,defaultValue:t})});Am.displayName=kI;function Em(e){return e===""||e===void 0}function Sm(e){const t=Ht(e),n=x.useRef(""),r=x.useRef(0),o=x.useCallback(i=>{const a=n.current+i;t(a),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(a)},[t]),s=x.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return x.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,o,s]}function Mm(e,t,n){const o=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=n?e.indexOf(n):-1;let i=_I(e,Math.max(s,0));o.length===1&&(i=i.filter(c=>c!==n));const l=i.find(c=>c.textValue.toLowerCase().startsWith(o.toLowerCase()));return l!==n?l:void 0}function _I(e,t){return e.map((n,r)=>e[(t+r)%e.length])}const DI=({children:e,category:t="",...n})=>{const[r,o]=x.useState(!1);return S.jsxs("div",{className:"h-fit transition-all duration-200 ease-in-out",...n,children:[S.jsxs("button",{onClick:()=>o(!r),className:"text-s flex w-full justify-between rounded-sm px-2 py-1 text-left font-mono font-bold text-white hover:bg-slate-800 focus:bg-slate-800 focus:outline-none",children:[t,S.jsx(Ta,{})]}),S.jsx("div",{className:"flex flex-col items-start justify-start rounded-sm bg-slate-900 text-white transition-all duration-200 ease-in-out"+(r?" h-fit border-1 border-slate-700 p-2":" h-0 overflow-hidden border-1 border-transparent p-0"),children:S.jsx("div",{className:"flex w-full flex-col",children:e})})]})},Cm=({setSelected:e,items:t,defaultValue:n=""})=>S.jsxs(Jg,{onValueChange:r=>e(r),defaultValue:n,children:[S.jsxs(tm,{className:"nodrag text-md mx-3 flex flex-1 items-baseline rounded-sm border border-slate-700 bg-slate-900 px-1 text-white focus:border-slate-500 focus:outline-none","aria-label":"Key",children:[S.jsx(rm,{placeholder:"..."}),S.jsx(om,{className:"ml-auto text-white",children:S.jsx(Ta,{})})]}),S.jsx(sm,{children:S.jsxs(im,{className:"overflow-hidden rounded-md border border-slate-700 bg-slate-900 shadow-md",children:[S.jsx(xm,{className:"flex h-[25px] items-center justify-center bg-slate-900 text-white",children:S.jsx(G0,{})}),S.jsx(um,{className:"p-1",children:S.jsx(fm,{children:Object.entries(t).map(([r,o])=>S.jsx(DI,{category:r,children:o.map(s=>S.jsx(OI,{value:s,className:"w-full",children:s},s))},r))})}),S.jsx(vm,{className:"flex h-[25px] items-center justify-center bg-slate-900 text-white",children:S.jsx(Ta,{})})]})})]}),OI=St.forwardRef(({className:e,children:t,...n},r)=>S.jsxs(gm,{className:Is("text-md relative flex h-[25px] items-center justify-between rounded px-1 font-mono leading-none text-white select-none data-[disabled]:pointer-events-none data-[disabled]:text-slate-500 data-[highlighted]:bg-slate-800 data-[highlighted]:outline-none",e),...n,ref:r,children:[S.jsx(mm,{children:t}),S.jsx(wm,{className:"absolute right-0 inline-flex w-[25px] items-center justify-center",children:S.jsx($0,{})})]})),LI=x.memo(({id:e})=>{const{updateNodeData:t}=$e(),[n,r]=x.useState(""),[o,s]=x.useState("down"),i=$s(d=>d.isKeyDown),a=$s(d=>d.isKeyPressed),[l,c]=x.useState(!1);return x.useEffect(()=>{t(e,{compute:(d,f)=>{let u=!1;switch(o){case"down":u=i(n),f.set(It,+u);break;case"press":u=a(n),f.set(It,+u);break}c(u)}})},[n,o]),S.jsx("div",{className:"min-w-48",children:S.jsxs(Sn,{label:"KeyPress",type:"float",active:l,children:[S.jsxs("div",{className:"mb-2 flex w-full flex-row",children:[S.jsx("button",{className:Is("nodrag m-auto rounded px-2 hover:cursor-pointer",o=="down"?"bg-slate-600":"bg-slate-900"),onClick:()=>{s("down")},children:"Down"}),S.jsx("button",{className:Is("nodrag m-auto rounded px-2 hover:cursor-pointer",o=="press"?"bg-slate-600":"bg-slate-900"),onClick:()=>{s("press")},children:"Press"})]}),S.jsxs("div",{className:"flex w-full justify-end gap-2",children:[S.jsx(Cm,{setSelected:r,items:{keys:["w","a","s","d"],other:["space","enter"]}}),S.jsx(zt,{id:It,position:ae.Right,label:"Value"})]})]})})}),BI=x.memo(({id:e})=>{const{updateNodeData:t}=$e(),[n,r]=x.useState(0),[o,s]=x.useState(0),[i,a]=x.useState(0),[l,c]=x.useState(0),d=Mo({handleId:mn,handleType:"target"}),f=Mo({handleId:wa,handleType:"target"});return x.useEffect(()=>{t(e,{compute:(u,h)=>{const p=jn(u,Qt,0),m=jn(u,mn,i),g=jn(u,wa,l);r(m),s(g),h.set(It,p==0?m:g)}})},[i,l]),S.jsx("div",{className:"min-w-3xs",children:S.jsxs(Sn,{label:"Switch",type:"float",children:[S.jsx(zt,{id:It,position:ae.Right,label:"Result"}),S.jsx(zt,{label:"bool",id:Qt,position:ae.Left}),S.jsxs("div",{className:"text-left",children:["False",S.jsx(Wn,{value:n,setValue:a,defaultValue:0,disabled:!!d.length}),S.jsx(_r,{id:mn,position:ae.Left})]}),S.jsxs("div",{className:"text-left",children:["True",S.jsx(Wn,{value:o,setValue:c,defaultValue:0,disabled:!!f.length}),S.jsx(_r,{id:wa,position:ae.Left})]})]})})}),FI=x.memo(({id:e,data:t})=>{const{updateNodeData:n}=$e(),[r,o]=x.useState(t.initialComputeType??null),[s,i]=x.useState(Vd[r??"Addition"]),[a,l]=x.useState(0),[c,d]=x.useState(0);function f(A){o(A),i(Vd[A])}const[u,h]=x.useState(0),[p,m]=x.useState(0),g=Mo({handleId:Qt,handleType:"target"}),y=Mo({handleId:mn,handleType:"target"});return x.useEffect(()=>{r&&n(e,{compute:(A,w)=>{const E=jn(A,Qt,u),R=jn(A,mn,p);l(E),d(R),w.set(It,jI[r](E,R))}})},[u,p,r]),S.jsx("div",{className:"min-w-3xs",children:S.jsxs(Sn,{label:r??"Select Math Type",type:"float",children:[S.jsx(Cm,{items:Pm,setSelected:f,defaultValue:r??""}),r&&S.jsxs(S.Fragment,{children:[S.jsx("br",{}),S.jsx(zt,{id:It,position:ae.Right,label:"Result"}),s[0].enable&&S.jsxs("div",{className:"text-left",children:[s[0].label,S.jsx(Wn,{value:a,setValue:h,defaultValue:0,disabled:!!g.length,type:s[0].type}),S.jsx(_r,{id:Qt,position:ae.Left})]}),s[1].enable&&S.jsxs("div",{className:"text-left",children:[s[1].label,S.jsx(Wn,{value:c,setValue:m,defaultValue:0,disabled:!!y.length,type:s[1].type}),S.jsx(_r,{id:mn,position:ae.Left})]})]})]})})}),Pm={Functions:["Addition","Substraction","Multiply","Divide","Power","Logarithm","Absolute"],Rounding:["Round","Floor","Ceil","Modulo"],Trigonometric:["Sine","Cosine","Tangent"],Conversion:["To Radians","To Degrees"],Compare:["Equals","Greater Than","Less Than"]},Vd={Addition:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],Substraction:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],Multiply:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],Divide:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],Power:[{enable:!0,type:"float",label:"base"},{enable:!0,type:"float",label:"exponent"}],Logarithm:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],Absolute:[{enable:!0,type:"float",label:"x"},{enable:!1,type:void 0,label:""}],Round:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"int",label:"decimal places"}],Floor:[{enable:!0,type:"float",label:"x"},{enable:!1,type:void 0,label:""}],Ceil:[{enable:!0,type:"float",label:"x"},{enable:!1,type:void 0,label:""}],Modulo:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],Sine:[{enable:!0,type:"float",label:"t"},{enable:!1,type:void 0,label:""}],Cosine:[{enable:!0,type:"float",label:"t"},{enable:!1,type:void 0,label:""}],Tangent:[{enable:!0,type:"float",label:"t"},{enable:!1,type:void 0,label:""}],"To Radians":[{enable:!0,type:"float",label:"deg"},{enable:!1,type:void 0,label:""}],"To Degrees":[{enable:!0,type:"float",label:"rad"},{enable:!1,type:void 0,label:""}],Equals:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],"Greater Than":[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],"Less Than":[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}]},jI={Addition:(e,t)=>e+t,Substraction:(e,t)=>e-t,Multiply:(e,t)=>e*t,Divide:(e,t)=>e/t,Power:(e,t)=>Math.pow(e,t),Logarithm:(e,t)=>Math.log(e)/Math.log(t),Absolute:(e,t)=>Math.abs(e),Round:(e,t)=>Math.round((e+Number.EPSILON)*Math.pow(10,t))/Math.pow(10,t),Floor:(e,t)=>Math.floor(e),Ceil:(e,t)=>Math.ceil(e),Modulo:(e,t)=>e%t,Sine:(e,t)=>Math.sin(e),Cosine:(e,t)=>Math.cos(e),Tangent:(e,t)=>Math.tan(e),"To Radians":(e,t)=>e*(Math.PI/180),"To Degree":(e,t)=>e*(180/Math.PI),Equals:(e,t)=>+(e==t),"Greater Than":(e,t)=>+(e>t),"Less Than":(e,t)=>+(e<t)},qI=x.memo(({id:e})=>{const{updateNodeData:t}=$e(),[n,r]=x.useState(0);return x.useEffect(()=>{t(e,{compute:(o,s)=>{s.set(It,n)}})},[n]),S.jsx("div",{className:"min-w-48",children:S.jsx(Sn,{label:"Value",type:"float",children:S.jsxs("div",{className:"flex w-full justify-end gap-2",children:[S.jsx(Wn,{setValue:r,defaultValue:0}),S.jsx(zt,{id:It,position:ae.Right,label:"Value"})]})})})}),ai={Value:qI,Display:Q2,Time:J2,KeyPress:LI,MathFloat:FI,ExportToGameobject:eP,GetFromGameobject:Z2,Switch:BI},Uo=new Map;Uo.set("Game Get",{nodes:[{name:"Key Press",type:"KeyPress",description:"Get key press events."},{name:"Time",type:"Time",description:"Get time-related information."},{name:"Get From Gameobject",type:"GetFromGameobject",description:"Get data from a game object."}]});Uo.set("Game Set",{nodes:[{name:"Export To Gameobject",type:"ExportToGameobject",description:"Export data to a game object."}]});Uo.set("Math Float",{nodes:[{name:"Math Float",type:"MathFloat",description:"Perform mathematical operations on float values."},{name:"Value",type:"Value",description:"Output a float value."}]});Uo.set("Logic",{nodes:[{name:"Switch",type:"Switch",description:"Conditional logic node."}]});Uo.set("Debug",{nodes:[{name:"Display",type:"Display",description:"Display a value on the screen."}]});const zI=({nodeId:e,x:t,y:n,onClose:r})=>{const{getNode:o,setNodes:s,addNodes:i,setEdges:a}=$e(),l=x.useCallback(()=>{const d=o(e);if(!d)return;const f={x:d.position.x+50,y:d.position.y+50};i({...d,selected:!1,dragging:!1,id:Zt(),position:f}),r()},[e,o,i]),c=x.useCallback(()=>{s(d=>d.filter(f=>f.id!==e)),a(d=>d.filter(f=>f.source!==e)),r()},[e,s,a]);return S.jsx("div",{style:{position:"absolute",top:n,left:t,zIndex:1e3},children:S.jsxs(rn,{className:"w-65 space-y-2 rounded bg-slate-800 p-2 pt-2 pb-2 shadow-lg outline-1 outline-slate-700 outline-solid",children:[S.jsx("button",{className:"w-full rounded p-2 text-left text-sm text-white hover:bg-slate-700",onClick:l,children:"Duplicate"}),S.jsx("button",{className:"w-full rounded p-2 text-left text-sm text-white hover:bg-slate-700",onClick:c,children:"Delete"})]})})},HI=({x:e,y:t,onClose:n})=>{const r=Object.values(Pm).flat(),{addNodes:o}=$e(),s=x.useRef(null),[i,a]=x.useState(""),[l,c,d]=ge(u=>u.transform);x.useEffect(()=>{var u;(u=s.current)==null||u.focus()},[]);const f=(u,h)=>{const p=document.getElementById("node-editor");if(!p){console.error("Canvas element with ID 'node-editor' not found.");return}const m=p.getBoundingClientRect(),g=(e-l)/d-m.left/d,y=(t-c)/d-m.top/d;o({id:Zt(),type:u,position:{x:g,y},data:{initialComputeType:h}}),n()};return S.jsx("div",{style:{position:"absolute",top:t,left:e,zIndex:1e3},children:S.jsxs(rn,{className:"w-65 space-y-2 rounded bg-slate-800 p-2 py-2 font-mono shadow-lg outline-1 outline-slate-700 outline-solid",children:[S.jsx("div",{className:"w-64 pr-4 shadow",children:S.jsx("input",{ref:s,type:"text",placeholder:"Search",className:"w-full rounded bg-slate-900 p-2 text-sm text-white focus:border-gray-300 focus:ring-0 focus:outline-none",onChange:u=>a(u.target.value),onKeyDown:u=>{if(u.key==="Enter"){const h=Object.keys(ai).filter(p=>p.toLowerCase().includes(i.toLowerCase()));if(h.length>0)f(h[0]);else{const p=r.find(m=>m.toLowerCase()===i.toLowerCase());p&&f("MathFloat",p)}}}})}),S.jsx("div",{children:Object.keys(ai).filter(u=>u.toLowerCase().includes(i.toLowerCase())).map((u,h)=>S.jsx("button",{className:"w-full rounded px-2 py-1 text-left text-sm text-white hover:bg-slate-700",onClick:()=>f(u),children:u},`add_node_${u}_${h}`))})]})})};var Ia="rovingFocusGroup.onEntryFocus",VI={bubbles:!1,cancelable:!0},$o="RovingFocusGroup",[El,Rm,UI]=uc($o),[$I,Im]=Or($o,[UI]),[GI,KI]=$I($o),Nm=x.forwardRef((e,t)=>S.jsx(El.Provider,{scope:e.__scopeRovingFocusGroup,children:S.jsx(El.Slot,{scope:e.__scopeRovingFocusGroup,children:S.jsx(WI,{...e,ref:t})})}));Nm.displayName=$o;var WI=x.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:o=!1,dir:s,currentTabStopId:i,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:d=!1,...f}=e,u=x.useRef(null),h=Ce(t,u),p=dc(s),[m,g]=Ts({prop:i,defaultProp:a??null,onChange:l,caller:$o}),[y,A]=x.useState(!1),w=Ht(c),E=Rm(n),R=x.useRef(!1),[b,v]=x.useState(0);return x.useEffect(()=>{const C=u.current;if(C)return C.addEventListener(Ia,w),()=>C.removeEventListener(Ia,w)},[w]),S.jsx(GI,{scope:n,orientation:r,dir:p,loop:o,currentTabStopId:m,onItemFocus:x.useCallback(C=>g(C),[g]),onItemShiftTab:x.useCallback(()=>A(!0),[]),onFocusableItemAdd:x.useCallback(()=>v(C=>C+1),[]),onFocusableItemRemove:x.useCallback(()=>v(C=>C-1),[]),children:S.jsx(xe.div,{tabIndex:y||b===0?-1:0,"data-orientation":r,...f,ref:h,style:{outline:"none",...e.style},onMouseDown:ue(e.onMouseDown,()=>{R.current=!0}),onFocus:ue(e.onFocus,C=>{const T=!R.current;if(C.target===C.currentTarget&&T&&!y){const k=new CustomEvent(Ia,VI);if(C.currentTarget.dispatchEvent(k),!k.defaultPrevented){const D=E().filter(I=>I.focusable),B=D.find(I=>I.active),j=D.find(I=>I.id===m),O=[B,j,...D].filter(Boolean).map(I=>I.ref.current);_m(O,d)}}R.current=!1}),onBlur:ue(e.onBlur,()=>A(!1))})})}),Tm="RovingFocusGroupItem",km=x.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:o=!1,tabStopId:s,children:i,...a}=e,l=Sr(),c=s||l,d=KI(Tm,n),f=d.currentTabStopId===c,u=Rm(n),{onFocusableItemAdd:h,onFocusableItemRemove:p,currentTabStopId:m}=d;return x.useEffect(()=>{if(r)return h(),()=>p()},[r,h,p]),S.jsx(El.ItemSlot,{scope:n,id:c,focusable:r,active:o,children:S.jsx(xe.span,{tabIndex:f?0:-1,"data-orientation":d.orientation,...a,ref:t,onMouseDown:ue(e.onMouseDown,g=>{r?d.onItemFocus(c):g.preventDefault()}),onFocus:ue(e.onFocus,()=>d.onItemFocus(c)),onKeyDown:ue(e.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){d.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const y=QI(g,d.orientation,d.dir);if(y!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let w=u().filter(E=>E.focusable).map(E=>E.ref.current);if(y==="last")w.reverse();else if(y==="prev"||y==="next"){y==="prev"&&w.reverse();const E=w.indexOf(g.currentTarget);w=d.loop?ZI(w,E+1):w.slice(E+1)}setTimeout(()=>_m(w))}}),children:typeof i=="function"?i({isCurrentTabStop:f,hasTabStop:m!=null}):i})})});km.displayName=Tm;var YI={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function XI(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function QI(e,t,n){const r=XI(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return YI[r]}function _m(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function ZI(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var JI=Nm,eN=km,Sl=["Enter"," "],tN=["ArrowDown","PageUp","Home"],Dm=["ArrowUp","PageDown","End"],nN=[...tN,...Dm],rN={ltr:[...Sl,"ArrowRight"],rtl:[...Sl,"ArrowLeft"]},oN={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Go="Menu",[_o,sN,iN]=uc(Go),[er,Om]=Or(Go,[iN,Bi,Im]),Hi=Bi(),Lm=Im(),[aN,tr]=er(Go),[lN,Ko]=er(Go),Bm=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:o,onOpenChange:s,modal:i=!0}=e,a=Hi(t),[l,c]=x.useState(null),d=x.useRef(!1),f=Ht(s),u=dc(o);return x.useEffect(()=>{const h=()=>{d.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>d.current=!1;return document.addEventListener("keydown",h,{capture:!0}),()=>{document.removeEventListener("keydown",h,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),S.jsx(jg,{...a,children:S.jsx(aN,{scope:t,open:n,onOpenChange:f,content:l,onContentChange:c,children:S.jsx(lN,{scope:t,onClose:x.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:d,dir:u,modal:i,children:r})})})};Bm.displayName=Go;var cN="MenuAnchor",Cc=x.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,o=Hi(n);return S.jsx(qg,{...o,...r,ref:t})});Cc.displayName=cN;var Pc="MenuPortal",[uN,Fm]=er(Pc,{forceMount:void 0}),jm=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:o}=e,s=tr(Pc,t);return S.jsx(uN,{scope:t,forceMount:n,children:S.jsx(ui,{present:n||s.open,children:S.jsx(Ec,{asChild:!0,container:o,children:r})})})};jm.displayName=Pc;var pt="MenuContent",[dN,Rc]=er(pt),qm=x.forwardRef((e,t)=>{const n=Fm(pt,e.__scopeMenu),{forceMount:r=n.forceMount,...o}=e,s=tr(pt,e.__scopeMenu),i=Ko(pt,e.__scopeMenu);return S.jsx(_o.Provider,{scope:e.__scopeMenu,children:S.jsx(ui,{present:r||s.open,children:S.jsx(_o.Slot,{scope:e.__scopeMenu,children:i.modal?S.jsx(fN,{...o,ref:t}):S.jsx(hN,{...o,ref:t})})})})}),fN=x.forwardRef((e,t)=>{const n=tr(pt,e.__scopeMenu),r=x.useRef(null),o=Ce(t,r);return x.useEffect(()=>{const s=r.current;if(s)return $g(s)},[]),S.jsx(Ic,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ue(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),hN=x.forwardRef((e,t)=>{const n=tr(pt,e.__scopeMenu);return S.jsx(Ic,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),pN=Ns("MenuContent.ScrollLock"),Ic=x.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:o,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:f,onInteractOutside:u,onDismiss:h,disableOutsideScroll:p,...m}=e,g=tr(pt,n),y=Ko(pt,n),A=Hi(n),w=Lm(n),E=sN(n),[R,b]=x.useState(null),v=x.useRef(null),C=Ce(t,v,g.onContentChange),T=x.useRef(0),k=x.useRef(""),D=x.useRef(0),B=x.useRef(null),j=x.useRef("right"),P=x.useRef(0),O=p?Sc:x.Fragment,I=p?{as:pN,allowPinchZoom:!0}:void 0,_=N=>{var q,W;const z=k.current+N,V=E().filter(te=>!te.disabled),U=document.activeElement,K=(q=V.find(te=>te.ref.current===U))==null?void 0:q.textValue,Y=V.map(te=>te.textValue),ee=CN(Y,z,K),Z=(W=V.find(te=>te.textValue===ee))==null?void 0:W.ref.current;(function te(se){k.current=se,window.clearTimeout(T.current),se!==""&&(T.current=window.setTimeout(()=>te(""),1e3))})(z),Z&&setTimeout(()=>Z.focus())};x.useEffect(()=>()=>window.clearTimeout(T.current),[]),yg();const F=x.useCallback(N=>{var V,U;return j.current===((V=B.current)==null?void 0:V.side)&&RN(N,(U=B.current)==null?void 0:U.area)},[]);return S.jsx(dN,{scope:n,searchRef:k,onItemEnter:x.useCallback(N=>{F(N)&&N.preventDefault()},[F]),onItemLeave:x.useCallback(N=>{var z;F(N)||((z=v.current)==null||z.focus(),b(null))},[F]),onTriggerLeave:x.useCallback(N=>{F(N)&&N.preventDefault()},[F]),pointerGraceTimerRef:D,onPointerGraceIntentChange:x.useCallback(N=>{B.current=N},[]),children:S.jsx(O,{...I,children:S.jsx(hc,{asChild:!0,trapped:o,onMountAutoFocus:ue(s,N=>{var z;N.preventDefault(),(z=v.current)==null||z.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:S.jsx(fc,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:f,onInteractOutside:u,onDismiss:h,children:S.jsx(JI,{asChild:!0,...w,dir:y.dir,orientation:"vertical",loop:r,currentTabStopId:R,onCurrentTabStopIdChange:b,onEntryFocus:ue(l,N=>{y.isUsingKeyboardRef.current||N.preventDefault()}),preventScrollOnEntryFocus:!0,children:S.jsx(zg,{role:"menu","aria-orientation":"vertical","data-state":n0(g.open),"data-radix-menu-content":"",dir:y.dir,...A,...m,ref:C,style:{outline:"none",...m.style},onKeyDown:ue(m.onKeyDown,N=>{const V=N.target.closest("[data-radix-menu-content]")===N.currentTarget,U=N.ctrlKey||N.altKey||N.metaKey,K=N.key.length===1;V&&(N.key==="Tab"&&N.preventDefault(),!U&&K&&_(N.key));const Y=v.current;if(N.target!==Y||!nN.includes(N.key))return;N.preventDefault();const Z=E().filter(q=>!q.disabled).map(q=>q.ref.current);Dm.includes(N.key)&&Z.reverse(),SN(Z)}),onBlur:ue(e.onBlur,N=>{N.currentTarget.contains(N.target)||(window.clearTimeout(T.current),k.current="")}),onPointerMove:ue(e.onPointerMove,Do(N=>{const z=N.target,V=P.current!==N.clientX;if(N.currentTarget.contains(z)&&V){const U=N.clientX>P.current?"right":"left";j.current=U,P.current=N.clientX}}))})})})})})})});qm.displayName=pt;var gN="MenuGroup",Nc=x.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return S.jsx(xe.div,{role:"group",...r,ref:t})});Nc.displayName=gN;var mN="MenuLabel",zm=x.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return S.jsx(xe.div,{...r,ref:t})});zm.displayName=mN;var li="MenuItem",Ud="menu.itemSelect",Vi=x.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...o}=e,s=x.useRef(null),i=Ko(li,e.__scopeMenu),a=Rc(li,e.__scopeMenu),l=Ce(t,s),c=x.useRef(!1),d=()=>{const f=s.current;if(!n&&f){const u=new CustomEvent(Ud,{bubbles:!0,cancelable:!0});f.addEventListener(Ud,h=>r==null?void 0:r(h),{once:!0}),Kd(f,u),u.defaultPrevented?c.current=!1:i.onClose()}};return S.jsx(Hm,{...o,ref:l,disabled:n,onClick:ue(e.onClick,d),onPointerDown:f=>{var u;(u=e.onPointerDown)==null||u.call(e,f),c.current=!0},onPointerUp:ue(e.onPointerUp,f=>{var u;c.current||(u=f.currentTarget)==null||u.click()}),onKeyDown:ue(e.onKeyDown,f=>{const u=a.searchRef.current!=="";n||u&&f.key===" "||Sl.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});Vi.displayName=li;var Hm=x.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:o,...s}=e,i=Rc(li,n),a=Lm(n),l=x.useRef(null),c=Ce(t,l),[d,f]=x.useState(!1),[u,h]=x.useState("");return x.useEffect(()=>{const p=l.current;p&&h((p.textContent??"").trim())},[s.children]),S.jsx(_o.ItemSlot,{scope:n,disabled:r,textValue:o??u,children:S.jsx(eN,{asChild:!0,...a,focusable:!r,children:S.jsx(xe.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...s,ref:c,onPointerMove:ue(e.onPointerMove,Do(p=>{r?i.onItemLeave(p):(i.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ue(e.onPointerLeave,Do(p=>i.onItemLeave(p))),onFocus:ue(e.onFocus,()=>f(!0)),onBlur:ue(e.onBlur,()=>f(!1))})})})}),yN="MenuCheckboxItem",Vm=x.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...o}=e;return S.jsx(Wm,{scope:e.__scopeMenu,checked:n,children:S.jsx(Vi,{role:"menuitemcheckbox","aria-checked":ci(n)?"mixed":n,...o,ref:t,"data-state":kc(n),onSelect:ue(o.onSelect,()=>r==null?void 0:r(ci(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Vm.displayName=yN;var Um="MenuRadioGroup",[wN,xN]=er(Um,{value:void 0,onValueChange:()=>{}}),$m=x.forwardRef((e,t)=>{const{value:n,onValueChange:r,...o}=e,s=Ht(r);return S.jsx(wN,{scope:e.__scopeMenu,value:n,onValueChange:s,children:S.jsx(Nc,{...o,ref:t})})});$m.displayName=Um;var Gm="MenuRadioItem",Km=x.forwardRef((e,t)=>{const{value:n,...r}=e,o=xN(Gm,e.__scopeMenu),s=n===o.value;return S.jsx(Wm,{scope:e.__scopeMenu,checked:s,children:S.jsx(Vi,{role:"menuitemradio","aria-checked":s,...r,ref:t,"data-state":kc(s),onSelect:ue(r.onSelect,()=>{var i;return(i=o.onValueChange)==null?void 0:i.call(o,n)},{checkForDefaultPrevented:!1})})})});Km.displayName=Gm;var Tc="MenuItemIndicator",[Wm,vN]=er(Tc,{checked:!1}),Ym=x.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...o}=e,s=vN(Tc,n);return S.jsx(ui,{present:r||ci(s.checked)||s.checked===!0,children:S.jsx(xe.span,{...o,ref:t,"data-state":kc(s.checked)})})});Ym.displayName=Tc;var bN="MenuSeparator",Xm=x.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return S.jsx(xe.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});Xm.displayName=bN;var AN="MenuArrow",Qm=x.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,o=Hi(n);return S.jsx(Hg,{...o,...r,ref:t})});Qm.displayName=AN;var EN="MenuSub",[PT,Zm]=er(EN),so="MenuSubTrigger",Jm=x.forwardRef((e,t)=>{const n=tr(so,e.__scopeMenu),r=Ko(so,e.__scopeMenu),o=Zm(so,e.__scopeMenu),s=Rc(so,e.__scopeMenu),i=x.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=s,c={__scopeMenu:e.__scopeMenu},d=x.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return x.useEffect(()=>d,[d]),x.useEffect(()=>{const f=a.current;return()=>{window.clearTimeout(f),l(null)}},[a,l]),S.jsx(Cc,{asChild:!0,...c,children:S.jsx(Hm,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":o.contentId,"data-state":n0(n.open),...e,ref:Gd(t,o.onTriggerChange),onClick:f=>{var u;(u=e.onClick)==null||u.call(e,f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ue(e.onPointerMove,Do(f=>{s.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(s.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:ue(e.onPointerLeave,Do(f=>{var h,p;d();const u=(h=n.content)==null?void 0:h.getBoundingClientRect();if(u){const m=(p=n.content)==null?void 0:p.dataset.side,g=m==="right",y=g?-5:5,A=u[g?"left":"right"],w=u[g?"right":"left"];s.onPointerGraceIntentChange({area:[{x:f.clientX+y,y:f.clientY},{x:A,y:u.top},{x:w,y:u.top},{x:w,y:u.bottom},{x:A,y:u.bottom}],side:m}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(f),f.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:ue(e.onKeyDown,f=>{var h;const u=s.searchRef.current!=="";e.disabled||u&&f.key===" "||rN[r.dir].includes(f.key)&&(n.onOpenChange(!0),(h=n.content)==null||h.focus(),f.preventDefault())})})})});Jm.displayName=so;var e0="MenuSubContent",t0=x.forwardRef((e,t)=>{const n=Fm(pt,e.__scopeMenu),{forceMount:r=n.forceMount,...o}=e,s=tr(pt,e.__scopeMenu),i=Ko(pt,e.__scopeMenu),a=Zm(e0,e.__scopeMenu),l=x.useRef(null),c=Ce(t,l);return S.jsx(_o.Provider,{scope:e.__scopeMenu,children:S.jsx(ui,{present:r||s.open,children:S.jsx(_o.Slot,{scope:e.__scopeMenu,children:S.jsx(Ic,{id:a.contentId,"aria-labelledby":a.triggerId,...o,ref:c,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var f;i.isUsingKeyboardRef.current&&((f=l.current)==null||f.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:ue(e.onFocusOutside,d=>{d.target!==a.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:ue(e.onEscapeKeyDown,d=>{i.onClose(),d.preventDefault()}),onKeyDown:ue(e.onKeyDown,d=>{var h;const f=d.currentTarget.contains(d.target),u=oN[i.dir].includes(d.key);f&&u&&(s.onOpenChange(!1),(h=a.trigger)==null||h.focus(),d.preventDefault())})})})})})});t0.displayName=e0;function n0(e){return e?"open":"closed"}function ci(e){return e==="indeterminate"}function kc(e){return ci(e)?"indeterminate":e?"checked":"unchecked"}function SN(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function MN(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function CN(e,t,n){const o=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=n?e.indexOf(n):-1;let i=MN(e,Math.max(s,0));o.length===1&&(i=i.filter(c=>c!==n));const l=i.find(c=>c.toLowerCase().startsWith(o.toLowerCase()));return l!==n?l:void 0}function PN(e,t){const{x:n,y:r}=e;let o=!1;for(let s=0,i=t.length-1;s<t.length;i=s++){const a=t[s],l=t[i],c=a.x,d=a.y,f=l.x,u=l.y;d>r!=u>r&&n<(f-c)*(r-d)/(u-d)+c&&(o=!o)}return o}function RN(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return PN(n,t)}function Do(e){return t=>t.pointerType==="mouse"?e(t):void 0}var IN=Bm,NN=Cc,TN=jm,kN=qm,_N=Nc,DN=zm,ON=Vi,LN=Vm,BN=$m,FN=Km,jN=Ym,qN=Xm,zN=Qm,HN=Jm,VN=t0,Ui="DropdownMenu",[UN,RT]=Or(Ui,[Om]),Ge=Om(),[$N,r0]=UN(Ui),o0=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:o,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,l=Ge(t),c=x.useRef(null),[d,f]=Ts({prop:o,defaultProp:s??!1,onChange:i,caller:Ui});return S.jsx($N,{scope:t,triggerId:Sr(),triggerRef:c,contentId:Sr(),open:d,onOpenChange:f,onOpenToggle:x.useCallback(()=>f(u=>!u),[f]),modal:a,children:S.jsx(IN,{...l,open:d,onOpenChange:f,dir:r,modal:a,children:n})})};o0.displayName=Ui;var s0="DropdownMenuTrigger",i0=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...o}=e,s=r0(s0,n),i=Ge(n);return S.jsx(NN,{asChild:!0,...i,children:S.jsx(xe.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...o,ref:Gd(t,s.triggerRef),onPointerDown:ue(e.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(s.onOpenToggle(),s.open||a.preventDefault())}),onKeyDown:ue(e.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&s.onOpenToggle(),a.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});i0.displayName=s0;var GN="DropdownMenuPortal",a0=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Ge(t);return S.jsx(TN,{...r,...n})};a0.displayName=GN;var l0="DropdownMenuContent",c0=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=r0(l0,n),s=Ge(n),i=x.useRef(!1);return S.jsx(kN,{id:o.contentId,"aria-labelledby":o.triggerId,...s,...r,ref:t,onCloseAutoFocus:ue(e.onCloseAutoFocus,a=>{var l;i.current||(l=o.triggerRef.current)==null||l.focus(),i.current=!1,a.preventDefault()}),onInteractOutside:ue(e.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;(!o.modal||d)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});c0.displayName=l0;var KN="DropdownMenuGroup",WN=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(_N,{...o,...r,ref:t})});WN.displayName=KN;var YN="DropdownMenuLabel",XN=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(DN,{...o,...r,ref:t})});XN.displayName=YN;var QN="DropdownMenuItem",Ml=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(ON,{...o,...r,ref:t})});Ml.displayName=QN;var ZN="DropdownMenuCheckboxItem",JN=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(LN,{...o,...r,ref:t})});JN.displayName=ZN;var eT="DropdownMenuRadioGroup",tT=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(BN,{...o,...r,ref:t})});tT.displayName=eT;var nT="DropdownMenuRadioItem",rT=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(FN,{...o,...r,ref:t})});rT.displayName=nT;var oT="DropdownMenuItemIndicator",sT=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(jN,{...o,...r,ref:t})});sT.displayName=oT;var iT="DropdownMenuSeparator",u0=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(qN,{...o,...r,ref:t})});u0.displayName=iT;var aT="DropdownMenuArrow",lT=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(zN,{...o,...r,ref:t})});lT.displayName=aT;var cT="DropdownMenuSubTrigger",uT=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(HN,{...o,...r,ref:t})});uT.displayName=cT;var dT="DropdownMenuSubContent",fT=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(VN,{...o,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});fT.displayName=dT;const hT=x.memo(()=>{const{addNodes:e}=$e(),t=yr(n=>n.debugPrint);return S.jsxs(rn,{position:"top-center",className:"!right-0 flex flex-col items-end justify-center gap-2",children:[S.jsxs(o0,{children:[S.jsx(i0,{asChild:!0,children:S.jsx("button",{className:"cursor-pointer rounded bg-slate-800 p-2 outline outline-slate-500 hover:bg-slate-900 data-[state=open]:rounded-b-none data-[state=open]:bg-slate-800 data-[state=open]:text-white","aria-label":"Customise options",children:S.jsx(K0,{className:"text-white"})})}),S.jsx(a0,{children:S.jsx(c0,{className:"flex w-65 flex-col items-center space-y-2 rounded rounded-tl-none bg-slate-800 p-2 pt-2 pb-2 shadow-lg outline-5 outline-slate-700 outline-solid",sideOffset:0,align:"start",children:Object.keys(ai).map((n,r)=>r===0?[S.jsx(Ml,{className:"w-62 rounded pr-4 pl-2 hover:bg-slate-700",children:S.jsx("button",{className:"text-left text-sm text-white",onClick:()=>{e({id:Zt(),type:n,position:{x:0,y:0},data:{}})},children:n})},"add_node_dropdown_"+r)]:[S.jsx(u0,{className:"h-px w-[95%] bg-slate-700"},`sep-${r}`),S.jsx(Ml,{className:"w-62 rounded pr-4 pl-2 hover:bg-slate-700",children:S.jsx("button",{className:"text-left text-sm text-white",onClick:()=>{e({id:Zt(),type:n,position:{x:0,y:0},data:{}})},children:n})},"add_node_dropdown_"+r)])})})]}),S.jsx("button",{onClick:t,className:"cursor-pointer rounded bg-slate-800 p-2 text-white outline outline-slate-500 hover:bg-slate-900",children:"Print Map"})]})}),pT=({nodeIds:e,x:t,y:n,onClose:r})=>{const{getNodes:o,getEdges:s,addNodes:i,addEdges:a,setNodes:l,setEdges:c}=$e(),d=x.useCallback(()=>{const u=o().filter(y=>e.includes(y.id)),h=s(),p=new Map,m=u.map(y=>{const A=Zt();return p.set(y.id,A),{...y,id:A,position:{x:y.position.x+50,y:y.position.y+50},selected:!1,dragging:!1}}),g=h.filter(y=>p.has(y.source)&&p.has(y.target)).map(y=>{const A=p.get(y.source),w=p.get(y.target);return{...y,id:"xy-edge__"+A+y.sourceHandle+"-"+w+y.targetHandle,source:A,target:w,selected:!1}});i(m),a(g),l(y=>y.map(A=>({...A,selected:m.some(w=>w.id===A.id)}))),r()},[e,o,s,i,a,l,r]),f=x.useCallback(()=>{l(u=>u.filter(h=>!e.includes(h.id))),c(u=>u.filter(h=>!e.includes(h.source)&&!e.includes(h.target))),r()},[e,l,c,r]);return S.jsx("div",{style:{position:"absolute",top:n,left:t,zIndex:1e3},children:S.jsxs(rn,{className:"w-65 space-y-2 rounded bg-slate-800 p-2 shadow-lg",children:[S.jsxs("button",{className:"w-full rounded p-2 text-left text-sm text-white hover:bg-slate-700",onClick:d,children:["Duplicate ",e.length," nodes"]}),S.jsxs("button",{className:"w-full rounded p-2 text-left text-sm text-white hover:bg-slate-700",onClick:f,children:["Delete ",e.length," nodes"]})]})})},gT=[{id:Zt(),type:"Value",position:{x:0,y:0},data:{value:0}},{id:Zt(),type:"MathFloat",position:{x:0,y:200},data:{initialComputeType:"Addition"}},{id:Zt(),type:"Display",position:{x:0,y:500},data:{}}],mT=[],yT=()=>{const e=br(r=>r.isPaused),t=br(r=>r.play),n=br(r=>r.pause);return S.jsxs(rn,{position:"top-left",className:"flex flex-col items-center justify-center gap-2",children:[S.jsx("button",{onClick:()=>{e?t():n()},className:"cursor-pointer rounded bg-slate-800 p-2 outline outline-slate-500 hover:bg-slate-900",children:e?S.jsx(W0,{className:"text-white"}):S.jsx(Y0,{className:"text-white"})}),S.jsx("button",{className:"cursor-pointer rounded bg-slate-800 p-2 outline outline-slate-500 hover:bg-slate-900",children:S.jsx(X0,{className:"text-white"})})]})},wT=({level:e})=>{const[t,n]=x.useState(gT),[r,o]=x.useState(mT),[s,i]=x.useState(null),[a,l]=x.useState(null),[c,d]=x.useState(null),f=yr(b=>b.replaceNode),u=yr(b=>b.removeNode),h=yr(b=>b.addEdge),p=yr(b=>b.removeEdge),m=x.useCallback(b=>{b.forEach(v=>{switch(v.type){case"add":f(v.item);break;case"remove":u(v.id);break;case"replace":f(v.item);break}}),n(v=>Ch(b,v))},[n]),g=x.useCallback(b=>{b.forEach(v=>{switch(v.type){case"remove":p(v.id);break;case"add":h(v.item);break}}),o(v=>Ph(b,v))},[o]),y=x.useCallback(b=>{h(b),o(v=>lh(b,v))},[o]),A=x.useCallback(b=>{b.preventDefault();const v=Na(b);i({x:v.x,y:v.y})},[i]),w=x.useCallback((b,v)=>{b.preventDefault();const C=Na(b);l({nodeId:v.id,x:C.x,y:C.y})},[l]),E=x.useCallback((b,v)=>{if(b.preventDefault(),v.length===0)return;const C=Na(b);d({nodeIds:v.map(T=>T.id),x:C.x,y:C.y})},[d]),R=x.useCallback(()=>{i(null),l(null),d(null)},[s,a,c]);return S.jsxs(Qh,{children:[S.jsxs(WA,{id:"node-editor",nodeTypes:ai,nodes:t,edges:r,onNodesChange:m,onEdgesChange:g,onPaneContextMenu:A,onNodeContextMenu:w,onSelectionContextMenu:E,onConnect:y,onPaneClick:R,fitView:!0,proOptions:{hideAttribution:!0},deleteKeyCode:["Delete","Backspace"],children:[S.jsx(eE,{bgColor:"#14141d",color:"#a7abc2"}),S.jsx(hT,{}),S.jsx(yT,{})]}),s&&S.jsx(HI,{x:s.x,y:s.y,onClose:()=>i(null)}),a&&S.jsx(zI,{nodeId:a.nodeId,x:a.x,y:a.y,onClose:()=>l(null)}),c&&S.jsx(pT,{nodeIds:c.nodeIds,x:c.x,y:c.y,onClose:()=>d(null)})]})};function Na(e){const t=e.clientX>window.innerWidth-274?window.innerWidth-274:e.clientX,n=e.clientY>window.innerHeight-284?window.innerHeight-284:e.clientY;return{x:t-15,y:n-15}}const xT=({params:e})=>{const t=x.useRef(null),n=e.id||"playground";return x.useEffect(()=>{t.current&&(H2(t.current),G2(n))},[t.current]),S.jsxs(hf,{direction:"horizontal",children:[S.jsx(ka,{id:"game-panel",minSize:25,order:1,children:S.jsx("canvas",{id:"game-canvas",ref:t,className:"w-1/2"})}),S.jsx(pf,{className:"flex w-2 items-center justify-center bg-slate-800",children:S.jsx(Q0,{width:32,height:32,className:"scale-125 text-slate-400"})}),S.jsx(ka,{id:"nodes-panel",minSize:25,order:2,children:S.jsx(wT,{level:n})})]})},IT=q0(xT);export{IT as default};
