import{m as D,n as S,o as K,p as P,b as G,M as F,u as d}from"./time-CzW7D6xC.js";const R="/dumpster/assets/alley_one-Ch0po_m1.jpg",j="/dumpster/assets/alley_two-D6HTRiqu.png",z="/dumpster/assets/house-BZR3Z7t1.png",h=5,p=300,r=D(e=>({isPaused:!1,pause:()=>e({isPaused:!0}),play:()=>e({isPaused:!1}),currentLevel:"playground",setCurrentLevel:t=>e({currentLevel:t}),levelCompleteDialogOpen:!1,setLevelCompleteDialogOpen:t=>e({levelCompleteDialogOpen:t}),levelCompleted:!1,setLevelCompleted:t=>e({levelCompleted:t}),reset:()=>e({isPaused:!1,currentLevel:"playground",levelCompleteDialogOpen:!1,levelCompleted:!1})})),m=new Set,y=new Set,b=new Set;let v=!1,w,k;function x(e){const t=e.toLowerCase();return t==="space"?" ":t==="enter"?"Enter":e}function Y(){v||(v=!0,w=e=>{const t=e.key;m.has(t)||y.add(t),m.add(t)},k=e=>{const t=e.key;m.delete(t),b.add(t)},window.addEventListener("keydown",w),window.addEventListener("keyup",k))}function _(){v&&(window.removeEventListener("keydown",w),window.removeEventListener("keyup",k),v=!1,m.clear(),y.clear(),b.clear())}function M(e){return m.has(x(e))}function N(e){return y.has(x(e))}function H(e){return b.has(x(e))}function I(){y.clear(),b.clear()}const f={init:Y,cleanup:_,isKeyDown:M,isKeyPressed:N,isKeyReleased:H,clearPressedAndReleased:I},C={first:!0};function B(e){if(!C.first)return;C.first=!1;let t=0,o=0;const{k:s,game:a}=u(e);return S.getState().setKeyDownFunction(f.isKeyDown),S.getState().setKeyPressedFunction(f.isKeyPressed),S.getState().setKeyReleasedFunction(f.isKeyReleased),K.getState().setMousePosFunction(()=>s.mousePos()),P.getState().setTimeFunction(()=>s.time()-o),P.getState().setDeltaTimeFunction(()=>s.dt()),s.onUpdate(()=>{if(r.getState().isPaused){a.paused||(t=s.time()),a.paused=!0;return}a.paused&&(o+=s.time()-t,t=0,a.paused=!1),G.getState().compute(),f.clearPressedAndReleased()}),s}let g;function u(e){if(g)return g;const t=F({global:!1,pixelDensity:2,touchToMouse:!0,debug:!1,debugKey:"f1",canvas:e,background:"#2b292f"}),o=t.add([t.timer()]);return g={k:t,game:o},g}function Z(){if(!g)return;const{game:e,app:t}=g.k._k;e.events.onOnce("frameEnd",()=>{t.quit()}),g=void 0,C.first=!0}function T(e){const{k:t,game:o}=u(),s={};if(e.includes("raccoon")){t.loadSprite("raccoon","/game/sprites/raccoon_spritesheet.png",{sliceX:4,sliceY:4,anims:{idle:{from:0,to:0,loop:!1},idleHolding:{from:1,to:1,loop:!1},walk:{from:2,to:7,loop:!0},walkHolding:{from:8,to:13,loop:!0}}});const a=o.add([t.sprite("raccoon",{anim:"walkHolding"}),t.pos(0,0),t.scale(h),t.anchor("bot"),t.z(2),"raccoon",t.state("idle",["idle","walkLeft","walkRight"])]);a.onStateEnter("idle",()=>{a.play("idle")}),a.onStateEnter("walkLeft",()=>{a.play("walk"),a.scaleTo(t.vec2(-5,h))}),a.onStateEnter("walkRight",()=>{a.play("walk"),a.scaleTo(t.vec2(h,h))}),s.raccoon=a}if(e.includes("trashcan")){t.loadSprite("trashcan","/game/sprites/trashcan_spritesheet.png",{sliceX:2,sliceY:1,anims:{empty:{from:0,to:0,loop:!1},filled:{from:1,to:1,loop:!1}}});const a=o.add([t.sprite("trashcan",{anim:"filled"}),t.anchor("bot"),t.pos(0,0),t.scale(5),t.z(1),"trashcan"]);s.trashcan=a}if(e.includes("goalFlag")){t.loadSprite("flag","/game/sprites/flag_spritesheet.png",{sliceX:2,sliceY:2,anims:{default:{from:0,to:3,loop:!0}}});const a=o.add([t.sprite("flag",{anim:"default"}),t.anchor("bot"),t.pos(200,0),t.scale(5),t.z(1)]);s.goalFlag=a}return s}function L(e){const{k:t,game:o}=u();e.includes("background1")&&(t.loadSprite("background1","/game/backgrounds/background1.png"),t.loadSprite("background1light","/game/backgrounds/background1_light.png"),o.add([t.sprite("background1"),t.anchor("bot"),t.scale(8),t.pos(0,p),t.z(0)]),o.add([t.sprite("background1light"),t.anchor("bot"),t.scale(8),t.pos(0,p),t.z(100),t.opacity(.75)]))}function E(e,t){var l,n,i,c;const o=e.pos.x;e.pos.x=((n=(l=d.getState().gameObjects.get("raccoon"))==null?void 0:l.get("xpos"))==null?void 0:n.value)??0,e.pos.y=((c=(i=d.getState().gameObjects.get("raccoon"))==null?void 0:i.get("ypos"))==null?void 0:c.value)??0,t.setCamPos(t.lerp(t.getCamPos(),e.pos.add(0,-t.height()/2+p),.1));const s=e.pos.x-o,a=s===0?"idle":s<0?"walkLeft":"walkRight";e.state!==a&&e.enterState(a)}const X=()=>{const{k:e,game:t}=u();L(["background1"]);const{raccoon:o}=T(["raccoon"]);e.setCamPos(o.pos.add(0,-e.height()/2+p));const s="7 + 5 * 2 - 3 / 3 = ?",a=16;t.add([e.text(s,{size:32}),e.pos(0,100),e.anchor("center"),e.scale(2),"text"]),t.onUpdate(()=>{var n,i;if(e.setCamPos(o.pos.add(0,-e.height()/2+p)),r.getState().isPaused)return;(((i=(n=d.getState().gameObjects.get("raccoon"))==null?void 0:n.get("value"))==null?void 0:i.value)??0)==a&&(r.getState().setLevelCompleteDialogOpen(!0),r.getState().setLevelCompleted(!0))})},A=()=>{const{k:e,game:t}=u();e.loadSprite("raccoon","/game/sprites/raccoon_spritesheet.png",{sliceX:4,sliceY:4,anims:{idle:{from:0,to:0,loop:!1},idleHolding:{from:1,to:1,loop:!1},walk:{from:2,to:7,loop:!0},walkHolding:{from:8,to:13,loop:!0}}}),e.loadSprite("trashcan","/game/sprites/trashcan_spritesheet.png",{sliceX:2,sliceY:1,anims:{empty:{from:0,to:0,loop:!1},filled:{from:1,to:1,loop:!1}}}),e.loadSprite("flag","/game/sprites/flag_spritesheet.png",{sliceX:2,sliceY:2,anims:{default:{from:0,to:3,loop:!0}}}),e.setGravity(2e3);const o=t.add([e.sprite("raccoon",{anim:"walkHolding"}),e.pos(100,e.height()-100),e.scale(5),e.area(),e.body(),"raccoon"]);t.add([e.sprite("flag",{anim:"default"}),e.pos(800,125),e.scale(5),e.area(),"flag"]),t.add([e.rect(e.width(),5),e.pos(0,e.height()-5),e.color(255,200,200),e.area(),e.body({isStatic:!0}),"floor"]);const s=t.add([e.rect(100,300),e.pos(e.width()-200,e.height()-325),e.color(50,50,50),e.area(),"ladderRight"]);t.add([e.rect(e.width()-50,40),e.pos(25,e.height()-345),e.color(100,100,100),e.area(),e.body({isStatic:!0}),e.platformEffector(),"platformMiddle"]);const a=t.add([e.rect(100,300),e.pos(50,e.height()-665),e.color(50,50,50),e.area(),"ladderLeft"]);t.add([e.rect(e.width()-50,40),e.pos(25,e.height()-690),e.color(100,100,100),e.area(),e.body({isStatic:!0}),e.platformEffector(),"platformTop"]),e.onCollide("raccoon","flag",(l,n)=>{l.pos.x=100,l.pos.y=e.height()-100,l.vel.x=0,l.vel.y=0,console.log("Collided with finish line")}),t.onUpdate(()=>{var i,c;if(r.getState().isPaused)return;o.isOverlapping(s||a)?o.gravityScale=0:o.gravityScale=1;const l=((c=(i=d.getState().gameObjects.get("raccoon"))==null?void 0:i.get("value"))==null?void 0:c.value)??0,n=r.getState().levelCompleted;l==24&&!n&&(o.pos.x=.5*e.width(),r.getState().setLevelCompleteDialogOpen(!0),r.getState().setLevelCompleted(!0))})},q=()=>{const{k:e,game:t}=u();L(["background1"]);const{raccoon:o,trashcan:s,goalFlag:a}=T(["raccoon","trashcan","goalFlag"]);e.setCamPos(o.pos.add(0,-e.height()/2+p)),t.onUpdate(()=>{var l,n,i,c;E(o,e),s.pos.x=((n=(l=d.getState().gameObjects.get("trashcan"))==null?void 0:l.get("xpos"))==null?void 0:n.value)??0,s.pos.y=((c=(i=d.getState().gameObjects.get("trashcan"))==null?void 0:i.get("ypos"))==null?void 0:c.value)??0})},U=()=>{const{k:e,game:t}=u();L(["background1"]);const{raccoon:o,trashcan:s}=T(["raccoon","trashcan"]);e.setCamPos(o.pos.add(0,-e.height()/2+p)),s.z=3,o.pos.x=-200,e.onCollide("raccoon","trashcan",(a,l)=>{r.getState().setLevelCompleteDialogOpen(!0),r.getState().setLevelCompleted(!0),console.log("Raccoon collided with trashcan")}),t.onUpdate(()=>{var a,l,n,i,c,O;((l=(a=d.getState().gameObjects.get("raccoon"))==null?void 0:a.get("setTo1ActivateNode"))==null?void 0:l.value)==1?E(o,e):o.pos.x=-200,s.pos.x=((i=(n=d.getState().gameObjects.get("trashcan"))==null?void 0:n.get("xpos"))==null?void 0:i.value)??0,s.pos.y=((O=(c=d.getState().gameObjects.get("trashcan"))==null?void 0:c.get("ypos"))==null?void 0:O.value)??0})},J={playground:{name:"Playground",description:"This is a sandbox level where you can freely test game mechanics.",dialog:["This is a playground level where you can freely implement game mechanics.","You are allowed to use all available nodes."],goals:["No goals, this level is designed for experimentation and testing."],success:"How did you complete a sandbox level?",category:"Sandbox",image:R,nodes:[],edges:[],initialState:q,hints:["This is a playground level","You don't need hints here","stop clicking there is nothing coming","42"],modifiableGameObjects:[{id:"raccoon",connections:[{label:"xpos",access:"all"},{label:"ypos",access:"all"}]},{id:"trashcan",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]}],availableNodes:["Value","Display","Time","KeyPress","MathFloat","ExportToGameobject","ImportFromGameobject","Switch","Group","ForLoop","MousePosition"]},calculator:{name:"Calculator",description:"This is the first level of the game, introducing basic mechanics.",dialog:["This is the first level of the game. It introduces the basic mechanics and objectives.","You will learn how to create nodes and solve simple equations."],goals:["Create your first nodes.","Solve the equation."],success:"You solved the equation!",category:"Introduction",image:j,nodes:[],edges:[],initialState:X,hints:[],modifiableGameObjects:[{id:"raccoon",connections:[{label:"value",access:"set"}]}],availableNodes:["Value","Display","MathFloat","ExportToGameobject"]},sitting:{name:"Sitting",description:"This is the second level of the game, introducing position of game objects.",dialog:["This is the second level of the game. Complete level 1.1 first, If you haven't done yet.","You will learn how to manipulate the position of game objects."],goals:["Make the position of the raccoon and the trashcan match."],success:"Yay!",category:"Introduction",image:j,nodes:[],edges:[],initialState:U,hints:[],modifiableGameObjects:[{id:"raccoon",connections:[{label:"setTo1ActivateNode",access:"set"},{label:"xpos",access:"set"}]},{id:"trashcan",connections:[{label:"xpos",access:"set"}]}],availableNodes:["Value","ExportToGameobject"]},move:{name:"Move",description:"This is the second level of the game, building upon Level 1.1.",dialog:["This is the second level of the game. It builds upon the mechanics introduced in Level 1.1."],goals:["No goals defined yet."],success:"Yay!",category:"Introduction",image:z,nodes:[],edges:[],initialState:A,hints:[],modifiableGameObjects:[{id:"raccoon",connections:[{label:"value",access:"set"},{label:"xpos",access:"get"},{label:"xpos",access:"set"}]},{id:"trashcan",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]}],availableNodes:["Display","ExportToGameobject"]}};export{J as L,Z as c,f as g,B as i,r as u};
