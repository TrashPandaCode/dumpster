var L0=Object.defineProperty;var B0=(e,t,n)=>t in e?L0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var H=(e,t,n)=>B0(e,typeof t!="symbol"?t+"":t,n);import{w as F0}from"./with-props-D5gvZ7XN.js";import{a as x,s as j0,r as Hd,t as q0,v as St,o as S,N as z0}from"./chunk-AYJ5UCUI-BvwBlbwa.js";import{u as Ce,c as Rs,a as Vd,b as Ud,Q as H0,C as Ra,d as V0,e as U0,H as $0,D as G0}from"./index-Dr-yIR4o.js";import{a as Al,R as K0}from"./index-DYq_FHE1.js";import{c as Dr,P as xe,a as ue,d as $d,u as gt,b as Er,e as Ps,f as si}from"./index-BaRoOxmz.js";const ii=x.createContext(null);ii.displayName="PanelGroupContext";const Pe={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},El=10,Dn=x.useLayoutEffect,Lc=j0.useId,W0=typeof Lc=="function"?Lc:()=>null;let Y0=0;function Sl(e=null){const t=W0(),n=x.useRef(e||t||null);return n.current===null&&(n.current=""+Y0++),e??n.current}function Gd({children:e,className:t="",collapsedSize:n,collapsible:r,defaultSize:o,forwardedRef:s,id:i,maxSize:a,minSize:l,onCollapse:c,onExpand:d,onResize:f,order:u,style:h,tagName:p="div",...m}){const g=x.useContext(ii);if(g===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:y,expandPanel:b,getPanelSize:w,getPanelStyle:E,groupId:P,isPanelCollapsed:A,reevaluatePanelConstraints:v,registerPanel:M,resizePanel:N,unregisterPanel:_}=g,D=Sl(i),B=x.useRef({callbacks:{onCollapse:c,onExpand:d,onResize:f},constraints:{collapsedSize:n,collapsible:r,defaultSize:o,maxSize:a,minSize:l},id:D,idIsFromProps:i!==void 0,order:u});x.useRef({didLogMissingDefaultSizeWarning:!1}),Dn(()=>{const{callbacks:R,constraints:O}=B.current,I={...O};B.current.id=D,B.current.idIsFromProps=i!==void 0,B.current.order=u,R.onCollapse=c,R.onExpand=d,R.onResize=f,O.collapsedSize=n,O.collapsible=r,O.defaultSize=o,O.maxSize=a,O.minSize=l,(I.collapsedSize!==O.collapsedSize||I.collapsible!==O.collapsible||I.maxSize!==O.maxSize||I.minSize!==O.minSize)&&v(B.current,I)}),Dn(()=>{const R=B.current;return M(R),()=>{_(R)}},[u,D,M,_]),x.useImperativeHandle(s,()=>({collapse:()=>{y(B.current)},expand:R=>{b(B.current,R)},getId(){return D},getSize(){return w(B.current)},isCollapsed(){return A(B.current)},isExpanded(){return!A(B.current)},resize:R=>{N(B.current,R)}}),[y,b,w,A,D,N]);const j=E(B.current,o);return x.createElement(p,{...m,children:e,className:t,id:D,style:{...j,...h},[Pe.groupId]:P,[Pe.panel]:"",[Pe.panelCollapsible]:r||void 0,[Pe.panelId]:D,[Pe.panelSize]:parseFloat(""+j.flexGrow).toFixed(1)})}const Pa=x.forwardRef((e,t)=>x.createElement(Gd,{...e,forwardedRef:t}));Gd.displayName="Panel";Pa.displayName="forwardRef(Panel)";let Ia=null,gs=-1,cn=null;function X0(e,t){if(t){const n=(t&Qd)!==0,r=(t&Zd)!==0,o=(t&Jd)!==0,s=(t&ef)!==0;if(n)return o?"se-resize":s?"ne-resize":"e-resize";if(r)return o?"sw-resize":s?"nw-resize":"w-resize";if(o)return"s-resize";if(s)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function Q0(){cn!==null&&(document.head.removeChild(cn),Ia=null,cn=null,gs=-1)}function Ki(e,t){var n,r;const o=X0(e,t);if(Ia!==o){if(Ia=o,cn===null&&(cn=document.createElement("style"),document.head.appendChild(cn)),gs>=0){var s;(s=cn.sheet)===null||s===void 0||s.removeRule(gs)}gs=(n=(r=cn.sheet)===null||r===void 0?void 0:r.insertRule(`*{cursor: ${o} !important;}`))!==null&&n!==void 0?n:-1}}function Kd(e){return e.type==="keydown"}function Wd(e){return e.type.startsWith("pointer")}function Yd(e){return e.type.startsWith("mouse")}function ai(e){if(Wd(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(Yd(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}function Z0(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function J0(e,t,n){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function ey(e,t){if(e===t)throw new Error("Cannot compare node with itself");const n={a:jc(e),b:jc(t)};let r;for(;n.a.at(-1)===n.b.at(-1);)e=n.a.pop(),t=n.b.pop(),r=e;he(r,"Stacking order can only be calculated for elements with a common ancestor");const o={a:Fc(Bc(n.a)),b:Fc(Bc(n.b))};if(o.a===o.b){const s=r.childNodes,i={a:n.a.at(-1),b:n.b.at(-1)};let a=s.length;for(;a--;){const l=s[a];if(l===i.a)return 1;if(l===i.b)return-1}}return Math.sign(o.a-o.b)}const ty=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function ny(e){var t;const n=getComputedStyle((t=Xd(e))!==null&&t!==void 0?t:e).display;return n==="flex"||n==="inline-flex"}function ry(e){const t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||ny(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||ty.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function Bc(e){let t=e.length;for(;t--;){const n=e[t];if(he(n,"Missing node"),ry(n))return n}return null}function Fc(e){return e&&Number(getComputedStyle(e).zIndex)||0}function jc(e){const t=[];for(;e;)t.push(e),e=Xd(e);return t}function Xd(e){const{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}const Qd=1,Zd=2,Jd=4,ef=8,oy=Z0()==="coarse";let Pt=[],wr=!1,Tn=new Map,li=new Map;const fo=new Set;function sy(e,t,n,r,o){var s;const{ownerDocument:i}=t,a={direction:n,element:t,hitAreaMargins:r,setResizeHandlerState:o},l=(s=Tn.get(i))!==null&&s!==void 0?s:0;return Tn.set(i,l+1),fo.add(a),Is(),function(){var d;li.delete(e),fo.delete(a);const f=(d=Tn.get(i))!==null&&d!==void 0?d:1;if(Tn.set(i,f-1),Is(),f===1&&Tn.delete(i),Pt.includes(a)){const u=Pt.indexOf(a);u>=0&&Pt.splice(u,1),Cl(),o("up",!0,null)}}}function iy(e){const{target:t}=e,{x:n,y:r}=ai(e);wr=!0,Ml({target:t,x:n,y:r}),Is(),Pt.length>0&&(Ns("down",e),e.preventDefault(),tf(t)||e.stopImmediatePropagation())}function Wi(e){const{x:t,y:n}=ai(e);if(wr&&e.buttons===0&&(wr=!1,Ns("up",e)),!wr){const{target:r}=e;Ml({target:r,x:t,y:n})}Ns("move",e),Cl(),Pt.length>0&&e.preventDefault()}function Yi(e){const{target:t}=e,{x:n,y:r}=ai(e);li.clear(),wr=!1,Pt.length>0&&(e.preventDefault(),tf(t)||e.stopImmediatePropagation()),Ns("up",e),Ml({target:t,x:n,y:r}),Cl(),Is()}function tf(e){let t=e;for(;t;){if(t.hasAttribute(Pe.resizeHandle))return!0;t=t.parentElement}return!1}function Ml({target:e,x:t,y:n}){Pt.splice(0);let r=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(r=e),fo.forEach(o=>{const{element:s,hitAreaMargins:i}=o,a=s.getBoundingClientRect(),{bottom:l,left:c,right:d,top:f}=a,u=oy?i.coarse:i.fine;if(t>=c-u&&t<=d+u&&n>=f-u&&n<=l+u){if(r!==null&&document.contains(r)&&s!==r&&!s.contains(r)&&!r.contains(s)&&ey(r,s)>0){let p=r,m=!1;for(;p&&!p.contains(s);){if(J0(p.getBoundingClientRect(),a)){m=!0;break}p=p.parentElement}if(m)return}Pt.push(o)}})}function Xi(e,t){li.set(e,t)}function Cl(){let e=!1,t=!1;Pt.forEach(r=>{const{direction:o}=r;o==="horizontal"?e=!0:t=!0});let n=0;li.forEach(r=>{n|=r}),e&&t?Ki("intersection",n):e?Ki("horizontal",n):t?Ki("vertical",n):Q0()}let Qi=new AbortController;function Is(){Qi.abort(),Qi=new AbortController;const e={capture:!0,signal:Qi.signal};fo.size&&(wr?(Pt.length>0&&Tn.forEach((t,n)=>{const{body:r}=n;t>0&&(r.addEventListener("contextmenu",Yi,e),r.addEventListener("pointerleave",Wi,e),r.addEventListener("pointermove",Wi,e))}),window.addEventListener("pointerup",Yi,e),window.addEventListener("pointercancel",Yi,e)):Tn.forEach((t,n)=>{const{body:r}=n;t>0&&(r.addEventListener("pointerdown",iy,e),r.addEventListener("pointermove",Wi,e))}))}function Ns(e,t){fo.forEach(n=>{const{setResizeHandlerState:r}=n,o=Pt.includes(n);r(e,o,t)})}function ay(){const[e,t]=x.useState(0);return x.useCallback(()=>t(n=>n+1),[])}function he(e,t){if(!e)throw console.error(t),Error(t)}function qn(e,t,n=El){return e.toFixed(n)===t.toFixed(n)?0:e>t?1:-1}function Wt(e,t,n=El){return qn(e,t,n)===0}function Ze(e,t,n){return qn(e,t,n)===0}function ly(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){const o=e[r],s=t[r];if(!Ze(o,s,n))return!1}return!0}function gr({panelConstraints:e,panelIndex:t,size:n}){const r=e[t];he(r!=null,`Panel constraints not found for index ${t}`);let{collapsedSize:o=0,collapsible:s,maxSize:i=100,minSize:a=0}=r;if(qn(n,a)<0)if(s){const l=(o+a)/2;qn(n,l)<0?n=o:n=a}else n=a;return n=Math.min(i,n),n=parseFloat(n.toFixed(El)),n}function Kr({delta:e,initialLayout:t,panelConstraints:n,pivotIndices:r,prevLayout:o,trigger:s}){if(Ze(e,0))return t;const i=[...t],[a,l]=r;he(a!=null,"Invalid first pivot index"),he(l!=null,"Invalid second pivot index");let c=0;if(s==="keyboard"){{const f=e<0?l:a,u=n[f];he(u,`Panel constraints not found for index ${f}`);const{collapsedSize:h=0,collapsible:p,minSize:m=0}=u;if(p){const g=t[f];if(he(g!=null,`Previous layout not found for panel index ${f}`),Ze(g,h)){const y=m-g;qn(y,Math.abs(e))>0&&(e=e<0?0-y:y)}}}{const f=e<0?a:l,u=n[f];he(u,`No panel constraints found for index ${f}`);const{collapsedSize:h=0,collapsible:p,minSize:m=0}=u;if(p){const g=t[f];if(he(g!=null,`Previous layout not found for panel index ${f}`),Ze(g,m)){const y=g-h;qn(y,Math.abs(e))>0&&(e=e<0?0-y:y)}}}}{const f=e<0?1:-1;let u=e<0?l:a,h=0;for(;;){const m=t[u];he(m!=null,`Previous layout not found for panel index ${u}`);const y=gr({panelConstraints:n,panelIndex:u,size:100})-m;if(h+=y,u+=f,u<0||u>=n.length)break}const p=Math.min(Math.abs(e),Math.abs(h));e=e<0?0-p:p}{let u=e<0?a:l;for(;u>=0&&u<n.length;){const h=Math.abs(e)-Math.abs(c),p=t[u];he(p!=null,`Previous layout not found for panel index ${u}`);const m=p-h,g=gr({panelConstraints:n,panelIndex:u,size:m});if(!Ze(p,g)&&(c+=p-g,i[u]=g,c.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?u--:u++}}if(ly(o,i))return o;{const f=e<0?l:a,u=t[f];he(u!=null,`Previous layout not found for panel index ${f}`);const h=u+c,p=gr({panelConstraints:n,panelIndex:f,size:h});if(i[f]=p,!Ze(p,h)){let m=h-p,y=e<0?l:a;for(;y>=0&&y<n.length;){const b=i[y];he(b!=null,`Previous layout not found for panel index ${y}`);const w=b+m,E=gr({panelConstraints:n,panelIndex:y,size:w});if(Ze(b,E)||(m-=E-b,i[y]=E),Ze(m,0))break;e>0?y--:y++}}}const d=i.reduce((f,u)=>u+f,0);return Ze(d,100)?i:o}function cy({layout:e,panelsArray:t,pivotIndices:n}){let r=0,o=100,s=0,i=0;const a=n[0];he(a!=null,"No pivot index found"),t.forEach((f,u)=>{const{constraints:h}=f,{maxSize:p=100,minSize:m=0}=h;u===a?(r=m,o=p):(s+=m,i+=p)});const l=Math.min(o,100-s),c=Math.max(r,100-i),d=e[a];return{valueMax:l,valueMin:c,valueNow:d}}function ho(e,t=document){return Array.from(t.querySelectorAll(`[${Pe.resizeHandleId}][data-panel-group-id="${e}"]`))}function nf(e,t,n=document){const o=ho(e,n).findIndex(s=>s.getAttribute(Pe.resizeHandleId)===t);return o??null}function rf(e,t,n){const r=nf(e,t,n);return r!=null?[r,r+1]:[-1,-1]}function of(e,t=document){var n;if(t instanceof HTMLElement&&(t==null||(n=t.dataset)===null||n===void 0?void 0:n.panelGroupId)==e)return t;const r=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return r||null}function ci(e,t=document){const n=t.querySelector(`[${Pe.resizeHandleId}="${e}"]`);return n||null}function uy(e,t,n,r=document){var o,s,i,a;const l=ci(t,r),c=ho(e,r),d=l?c.indexOf(l):-1,f=(o=(s=n[d])===null||s===void 0?void 0:s.id)!==null&&o!==void 0?o:null,u=(i=(a=n[d+1])===null||a===void 0?void 0:a.id)!==null&&i!==void 0?i:null;return[f,u]}function dy({committedValuesRef:e,eagerValuesRef:t,groupId:n,layout:r,panelDataArray:o,panelGroupElement:s,setLayout:i}){x.useRef({didWarnAboutMissingResizeHandle:!1}),Dn(()=>{if(!s)return;const a=ho(n,s);for(let l=0;l<o.length-1;l++){const{valueMax:c,valueMin:d,valueNow:f}=cy({layout:r,panelsArray:o,pivotIndices:[l,l+1]}),u=a[l];if(u!=null){const h=o[l];he(h,`No panel data found for index "${l}"`),u.setAttribute("aria-controls",h.id),u.setAttribute("aria-valuemax",""+Math.round(c)),u.setAttribute("aria-valuemin",""+Math.round(d)),u.setAttribute("aria-valuenow",f!=null?""+Math.round(f):"")}}return()=>{a.forEach((l,c)=>{l.removeAttribute("aria-controls"),l.removeAttribute("aria-valuemax"),l.removeAttribute("aria-valuemin"),l.removeAttribute("aria-valuenow")})}},[n,r,o,s]),x.useEffect(()=>{if(!s)return;const a=t.current;he(a,"Eager values not found");const{panelDataArray:l}=a,c=of(n,s);he(c!=null,`No group found for id "${n}"`);const d=ho(n,s);he(d,`No resize handles found for group id "${n}"`);const f=d.map(u=>{const h=u.getAttribute(Pe.resizeHandleId);he(h,"Resize handle element has no handle id attribute");const[p,m]=uy(n,h,l,s);if(p==null||m==null)return()=>{};const g=y=>{if(!y.defaultPrevented)switch(y.key){case"Enter":{y.preventDefault();const b=l.findIndex(w=>w.id===p);if(b>=0){const w=l[b];he(w,`No panel data found for index ${b}`);const E=r[b],{collapsedSize:P=0,collapsible:A,minSize:v=0}=w.constraints;if(E!=null&&A){const M=Kr({delta:Ze(E,P)?v-P:P-E,initialLayout:r,panelConstraints:l.map(N=>N.constraints),pivotIndices:rf(n,h,s),prevLayout:r,trigger:"keyboard"});r!==M&&i(M)}}break}}};return u.addEventListener("keydown",g),()=>{u.removeEventListener("keydown",g)}});return()=>{f.forEach(u=>u())}},[s,e,t,n,r,o,i])}function qc(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function sf(e,t){const n=e==="horizontal",{x:r,y:o}=ai(t);return n?r:o}function fy(e,t,n,r,o){const s=n==="horizontal",i=ci(t,o);he(i,`No resize handle element found for id "${t}"`);const a=i.getAttribute(Pe.groupId);he(a,"Resize handle element has no group id attribute");let{initialCursorPosition:l}=r;const c=sf(n,e),d=of(a,o);he(d,`No group element found for id "${a}"`);const f=d.getBoundingClientRect(),u=s?f.width:f.height;return(c-l)/u*100}function hy(e,t,n,r,o,s){if(Kd(e)){const i=n==="horizontal";let a=0;e.shiftKey?a=100:o!=null?a=o:a=10;let l=0;switch(e.key){case"ArrowDown":l=i?0:a;break;case"ArrowLeft":l=i?-a:0;break;case"ArrowRight":l=i?a:0;break;case"ArrowUp":l=i?0:-a;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return r==null?0:fy(e,t,n,r,s)}function py({panelDataArray:e}){const t=Array(e.length),n=e.map(s=>s.constraints);let r=0,o=100;for(let s=0;s<e.length;s++){const i=n[s];he(i,`Panel constraints not found for index ${s}`);const{defaultSize:a}=i;a!=null&&(r++,t[s]=a,o-=a)}for(let s=0;s<e.length;s++){const i=n[s];he(i,`Panel constraints not found for index ${s}`);const{defaultSize:a}=i;if(a!=null)continue;const l=e.length-r,c=o/l;r++,t[s]=c,o-=c}return t}function sr(e,t,n){t.forEach((r,o)=>{const s=e[o];he(s,`Panel data not found for index ${o}`);const{callbacks:i,constraints:a,id:l}=s,{collapsedSize:c=0,collapsible:d}=a,f=n[l];if(f==null||r!==f){n[l]=r;const{onCollapse:u,onExpand:h,onResize:p}=i;p&&p(r,f),d&&(u||h)&&(h&&(f==null||Wt(f,c))&&!Wt(r,c)&&h(),u&&(f==null||!Wt(f,c))&&Wt(r,c)&&u())}})}function Qo(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function gy({defaultSize:e,dragState:t,layout:n,panelData:r,panelIndex:o,precision:s=3}){const i=n[o];let a;return i==null?a=e!=null?e.toPrecision(s):"1":r.length===1?a="1":a=i.toPrecision(s),{flexBasis:0,flexGrow:a,flexShrink:1,overflow:"hidden",pointerEvents:t!==null?"none":void 0}}function my(e,t=10){let n=null;return(...o)=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{e(...o)},t)}}function zc(e){try{if(typeof localStorage<"u")e.getItem=t=>localStorage.getItem(t),e.setItem=(t,n)=>{localStorage.setItem(t,n)};else throw new Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function af(e){return`react-resizable-panels:${e}`}function lf(e){return e.map(t=>{const{constraints:n,id:r,idIsFromProps:o,order:s}=t;return o?r:s?`${s}:${JSON.stringify(n)}`:JSON.stringify(n)}).sort((t,n)=>t.localeCompare(n)).join(",")}function cf(e,t){try{const n=af(e),r=t.getItem(n);if(r){const o=JSON.parse(r);if(typeof o=="object"&&o!=null)return o}}catch{}return null}function yy(e,t,n){var r,o;const s=(r=cf(e,n))!==null&&r!==void 0?r:{},i=lf(t);return(o=s[i])!==null&&o!==void 0?o:null}function wy(e,t,n,r,o){var s;const i=af(e),a=lf(t),l=(s=cf(e,o))!==null&&s!==void 0?s:{};l[a]={expandToSizes:Object.fromEntries(n.entries()),layout:r};try{o.setItem(i,JSON.stringify(l))}catch(c){console.error(c)}}function Hc({layout:e,panelConstraints:t}){const n=[...e],r=n.reduce((s,i)=>s+i,0);if(n.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${n.map(s=>`${s}%`).join(", ")}`);if(!Ze(r,100)&&n.length>0)for(let s=0;s<t.length;s++){const i=n[s];he(i!=null,`No layout data found for index ${s}`);const a=100/r*i;n[s]=a}let o=0;for(let s=0;s<t.length;s++){const i=n[s];he(i!=null,`No layout data found for index ${s}`);const a=gr({panelConstraints:t,panelIndex:s,size:i});i!=a&&(o+=i-a,n[s]=a)}if(!Ze(o,0))for(let s=0;s<t.length;s++){const i=n[s];he(i!=null,`No layout data found for index ${s}`);const a=i+o,l=gr({panelConstraints:t,panelIndex:s,size:a});if(i!==l&&(o-=l-i,n[s]=l,Ze(o,0)))break}return n}const xy=100,Wr={getItem:e=>(zc(Wr),Wr.getItem(e)),setItem:(e,t)=>{zc(Wr),Wr.setItem(e,t)}},Vc={};function uf({autoSaveId:e=null,children:t,className:n="",direction:r,forwardedRef:o,id:s=null,onLayout:i=null,keyboardResizeBy:a=null,storage:l=Wr,style:c,tagName:d="div",...f}){const u=Sl(s),h=x.useRef(null),[p,m]=x.useState(null),[g,y]=x.useState([]),b=ay(),w=x.useRef({}),E=x.useRef(new Map),P=x.useRef(0),A=x.useRef({autoSaveId:e,direction:r,dragState:p,id:u,keyboardResizeBy:a,onLayout:i,storage:l}),v=x.useRef({layout:g,panelDataArray:[],panelDataArrayChanged:!1});x.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),x.useImperativeHandle(o,()=>({getId:()=>A.current.id,getLayout:()=>{const{layout:K}=v.current;return K},setLayout:K=>{const{onLayout:Y}=A.current,{layout:ee,panelDataArray:Z}=v.current,q=Hc({layout:K,panelConstraints:Z.map(W=>W.constraints)});qc(ee,q)||(y(q),v.current.layout=q,Y&&Y(q),sr(Z,q,w.current))}}),[]),Dn(()=>{A.current.autoSaveId=e,A.current.direction=r,A.current.dragState=p,A.current.id=u,A.current.onLayout=i,A.current.storage=l}),dy({committedValuesRef:A,eagerValuesRef:v,groupId:u,layout:g,panelDataArray:v.current.panelDataArray,setLayout:y,panelGroupElement:h.current}),x.useEffect(()=>{const{panelDataArray:K}=v.current;if(e){if(g.length===0||g.length!==K.length)return;let Y=Vc[e];Y==null&&(Y=my(wy,xy),Vc[e]=Y);const ee=[...K],Z=new Map(E.current);Y(e,ee,Z,g,l)}},[e,g,l]),x.useEffect(()=>{});const M=x.useCallback(K=>{const{onLayout:Y}=A.current,{layout:ee,panelDataArray:Z}=v.current;if(K.constraints.collapsible){const q=Z.map(oe=>oe.constraints),{collapsedSize:W=0,panelSize:te,pivotIndices:se}=Pn(Z,K,ee);if(he(te!=null,`Panel size not found for panel "${K.id}"`),!Wt(te,W)){E.current.set(K.id,te);const ne=dr(Z,K)===Z.length-1?te-W:W-te,J=Kr({delta:ne,initialLayout:ee,panelConstraints:q,pivotIndices:se,prevLayout:ee,trigger:"imperative-api"});Qo(ee,J)||(y(J),v.current.layout=J,Y&&Y(J),sr(Z,J,w.current))}}},[]),N=x.useCallback((K,Y)=>{const{onLayout:ee}=A.current,{layout:Z,panelDataArray:q}=v.current;if(K.constraints.collapsible){const W=q.map(re=>re.constraints),{collapsedSize:te=0,panelSize:se=0,minSize:oe=0,pivotIndices:ne}=Pn(q,K,Z),J=Y??oe;if(Wt(se,te)){const re=E.current.get(K.id),le=re!=null&&re>=J?re:J,me=dr(q,K)===q.length-1?se-le:le-se,de=Kr({delta:me,initialLayout:Z,panelConstraints:W,pivotIndices:ne,prevLayout:Z,trigger:"imperative-api"});Qo(Z,de)||(y(de),v.current.layout=de,ee&&ee(de),sr(q,de,w.current))}}},[]),_=x.useCallback(K=>{const{layout:Y,panelDataArray:ee}=v.current,{panelSize:Z}=Pn(ee,K,Y);return he(Z!=null,`Panel size not found for panel "${K.id}"`),Z},[]),D=x.useCallback((K,Y)=>{const{panelDataArray:ee}=v.current,Z=dr(ee,K);return gy({defaultSize:Y,dragState:p,layout:g,panelData:ee,panelIndex:Z})},[p,g]),B=x.useCallback(K=>{const{layout:Y,panelDataArray:ee}=v.current,{collapsedSize:Z=0,collapsible:q,panelSize:W}=Pn(ee,K,Y);return he(W!=null,`Panel size not found for panel "${K.id}"`),q===!0&&Wt(W,Z)},[]),j=x.useCallback(K=>{const{layout:Y,panelDataArray:ee}=v.current,{collapsedSize:Z=0,collapsible:q,panelSize:W}=Pn(ee,K,Y);return he(W!=null,`Panel size not found for panel "${K.id}"`),!q||qn(W,Z)>0},[]),R=x.useCallback(K=>{const{panelDataArray:Y}=v.current;Y.push(K),Y.sort((ee,Z)=>{const q=ee.order,W=Z.order;return q==null&&W==null?0:q==null?-1:W==null?1:q-W}),v.current.panelDataArrayChanged=!0,b()},[b]);Dn(()=>{if(v.current.panelDataArrayChanged){v.current.panelDataArrayChanged=!1;const{autoSaveId:K,onLayout:Y,storage:ee}=A.current,{layout:Z,panelDataArray:q}=v.current;let W=null;if(K){const se=yy(K,q,ee);se&&(E.current=new Map(Object.entries(se.expandToSizes)),W=se.layout)}W==null&&(W=py({panelDataArray:q}));const te=Hc({layout:W,panelConstraints:q.map(se=>se.constraints)});qc(Z,te)||(y(te),v.current.layout=te,Y&&Y(te),sr(q,te,w.current))}}),Dn(()=>{const K=v.current;return()=>{K.layout=[]}},[]);const O=x.useCallback(K=>{let Y=!1;const ee=h.current;return ee&&window.getComputedStyle(ee,null).getPropertyValue("direction")==="rtl"&&(Y=!0),function(q){q.preventDefault();const W=h.current;if(!W)return()=>null;const{direction:te,dragState:se,id:oe,keyboardResizeBy:ne,onLayout:J}=A.current,{layout:re,panelDataArray:le}=v.current,{initialLayout:ce}=se??{},me=rf(oe,K,W);let de=hy(q,K,te,se,ne,W);const be=te==="horizontal";be&&Y&&(de=-de);const ze=le.map(wt=>wt.constraints),Xe=Kr({delta:de,initialLayout:ce??re,panelConstraints:ze,pivotIndices:me,prevLayout:re,trigger:Kd(q)?"keyboard":"mouse-or-touch"}),lt=!Qo(re,Xe);(Wd(q)||Yd(q))&&P.current!=de&&(P.current=de,!lt&&de!==0?be?Xi(K,de<0?Qd:Zd):Xi(K,de<0?Jd:ef):Xi(K,0)),lt&&(y(Xe),v.current.layout=Xe,J&&J(Xe),sr(le,Xe,w.current))}},[]),I=x.useCallback((K,Y)=>{const{onLayout:ee}=A.current,{layout:Z,panelDataArray:q}=v.current,W=q.map(re=>re.constraints),{panelSize:te,pivotIndices:se}=Pn(q,K,Z);he(te!=null,`Panel size not found for panel "${K.id}"`);const ne=dr(q,K)===q.length-1?te-Y:Y-te,J=Kr({delta:ne,initialLayout:Z,panelConstraints:W,pivotIndices:se,prevLayout:Z,trigger:"imperative-api"});Qo(Z,J)||(y(J),v.current.layout=J,ee&&ee(J),sr(q,J,w.current))},[]),k=x.useCallback((K,Y)=>{const{layout:ee,panelDataArray:Z}=v.current,{collapsedSize:q=0,collapsible:W}=Y,{collapsedSize:te=0,collapsible:se,maxSize:oe=100,minSize:ne=0}=K.constraints,{panelSize:J}=Pn(Z,K,ee);J!=null&&(W&&se&&Wt(J,q)?Wt(q,te)||I(K,te):J<ne?I(K,ne):J>oe&&I(K,oe))},[I]),F=x.useCallback((K,Y)=>{const{direction:ee}=A.current,{layout:Z}=v.current;if(!h.current)return;const q=ci(K,h.current);he(q,`Drag handle element not found for id "${K}"`);const W=sf(ee,Y);m({dragHandleId:K,dragHandleRect:q.getBoundingClientRect(),initialCursorPosition:W,initialLayout:Z})},[]),T=x.useCallback(()=>{m(null)},[]),z=x.useCallback(K=>{const{panelDataArray:Y}=v.current,ee=dr(Y,K);ee>=0&&(Y.splice(ee,1),delete w.current[K.id],v.current.panelDataArrayChanged=!0,b())},[b]),V=x.useMemo(()=>({collapsePanel:M,direction:r,dragState:p,expandPanel:N,getPanelSize:_,getPanelStyle:D,groupId:u,isPanelCollapsed:B,isPanelExpanded:j,reevaluatePanelConstraints:k,registerPanel:R,registerResizeHandle:O,resizePanel:I,startDragging:F,stopDragging:T,unregisterPanel:z,panelGroupElement:h.current}),[M,p,r,N,_,D,u,B,j,k,R,O,I,F,T,z]),U={display:"flex",flexDirection:r==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return x.createElement(ii.Provider,{value:V},x.createElement(d,{...f,children:t,className:n,id:s,ref:h,style:{...U,...c},[Pe.group]:"",[Pe.groupDirection]:r,[Pe.groupId]:u}))}const df=x.forwardRef((e,t)=>x.createElement(uf,{...e,forwardedRef:t}));uf.displayName="PanelGroup";df.displayName="forwardRef(PanelGroup)";function dr(e,t){return e.findIndex(n=>n===t||n.id===t.id)}function Pn(e,t,n){const r=dr(e,t),s=r===e.length-1?[r-1,r]:[r,r+1],i=n[r];return{...t.constraints,panelSize:i,pivotIndices:s}}function vy({disabled:e,handleId:t,resizeHandler:n,panelGroupElement:r}){x.useEffect(()=>{if(e||n==null||r==null)return;const o=ci(t,r);if(o==null)return;const s=i=>{if(!i.defaultPrevented)switch(i.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{i.preventDefault(),n(i);break}case"F6":{i.preventDefault();const a=o.getAttribute(Pe.groupId);he(a,`No group element found for id "${a}"`);const l=ho(a,r),c=nf(a,t,r);he(c!==null,`No resize element found for id "${t}"`);const d=i.shiftKey?c>0?c-1:l.length-1:c+1<l.length?c+1:0;l[d].focus();break}}};return o.addEventListener("keydown",s),()=>{o.removeEventListener("keydown",s)}},[r,e,t,n])}function ff({children:e=null,className:t="",disabled:n=!1,hitAreaMargins:r,id:o,onBlur:s,onClick:i,onDragging:a,onFocus:l,onPointerDown:c,onPointerUp:d,style:f={},tabIndex:u=0,tagName:h="div",...p}){var m,g;const y=x.useRef(null),b=x.useRef({onClick:i,onDragging:a,onPointerDown:c,onPointerUp:d});x.useEffect(()=>{b.current.onClick=i,b.current.onDragging=a,b.current.onPointerDown=c,b.current.onPointerUp=d});const w=x.useContext(ii);if(w===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:E,groupId:P,registerResizeHandle:A,startDragging:v,stopDragging:M,panelGroupElement:N}=w,_=Sl(o),[D,B]=x.useState("inactive"),[j,R]=x.useState(!1),[O,I]=x.useState(null),k=x.useRef({state:D});Dn(()=>{k.current.state=D}),x.useEffect(()=>{if(n)I(null);else{const V=A(_);I(()=>V)}},[n,_,A]);const F=(m=r==null?void 0:r.coarse)!==null&&m!==void 0?m:15,T=(g=r==null?void 0:r.fine)!==null&&g!==void 0?g:5;x.useEffect(()=>{if(n||O==null)return;const V=y.current;he(V,"Element ref not attached");let U=!1;return sy(_,V,E,{coarse:F,fine:T},(Y,ee,Z)=>{if(!ee){B("inactive");return}switch(Y){case"down":{B("drag"),U=!1,he(Z,'Expected event to be defined for "down" action'),v(_,Z);const{onDragging:q,onPointerDown:W}=b.current;q==null||q(!0),W==null||W();break}case"move":{const{state:q}=k.current;U=!0,q!=="drag"&&B("hover"),he(Z,'Expected event to be defined for "move" action'),O(Z);break}case"up":{B("hover"),M();const{onClick:q,onDragging:W,onPointerUp:te}=b.current;W==null||W(!1),te==null||te(),U||q==null||q();break}}})},[F,E,n,T,A,_,O,v,M]),vy({disabled:n,handleId:_,resizeHandler:O,panelGroupElement:N});const z={touchAction:"none",userSelect:"none"};return x.createElement(h,{...p,children:e,className:t,id:o,onBlur:()=>{R(!1),s==null||s()},onFocus:()=>{R(!0),l==null||l()},ref:y,role:"separator",style:{...z,...f},tabIndex:u,[Pe.groupDirection]:E,[Pe.groupId]:P,[Pe.resizeHandle]:"",[Pe.resizeHandleActive]:D==="drag"?"pointer":j?"keyboard":void 0,[Pe.resizeHandleEnabled]:!n,[Pe.resizeHandleId]:_,[Pe.resizeHandleState]:D})}ff.displayName="PanelResizeHandle";function _e(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=_e(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var by={value:()=>{}};function ui(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new ms(n)}function ms(e){this._=e}function Ay(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}ms.prototype=ui.prototype={constructor:ms,on:function(e,t){var n=this._,r=Ay(e+"",n),o,s=-1,i=r.length;if(arguments.length<2){for(;++s<i;)if((o=(e=r[s]).type)&&(o=Ey(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(o=(e=r[s]).type)n[o]=Uc(n[o],e.name,t);else if(t==null)for(o in n)n[o]=Uc(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ms(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,s;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,o=s.length;r<o;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,s=r.length;o<s;++o)r[o].value.apply(t,n)}};function Ey(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function Uc(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=by,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Na="http://www.w3.org/1999/xhtml";const $c={svg:"http://www.w3.org/2000/svg",xhtml:Na,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function di(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),$c.hasOwnProperty(t)?{space:$c[t],local:e}:e}function Sy(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Na&&t.documentElement.namespaceURI===Na?t.createElement(e):t.createElementNS(n,e)}}function My(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function hf(e){var t=di(e);return(t.local?My:Sy)(t)}function Cy(){}function Rl(e){return e==null?Cy:function(){return this.querySelector(e)}}function Ry(e){typeof e!="function"&&(e=Rl(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=new Array(i),l,c,d=0;d<i;++d)(l=s[d])&&(c=e.call(l,l.__data__,d,s))&&("__data__"in l&&(c.__data__=l.__data__),a[d]=c);return new ot(r,this._parents)}function Py(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Iy(){return[]}function pf(e){return e==null?Iy:function(){return this.querySelectorAll(e)}}function Ny(e){return function(){return Py(e.apply(this,arguments))}}function Ty(e){typeof e=="function"?e=Ny(e):e=pf(e);for(var t=this._groups,n=t.length,r=[],o=[],s=0;s<n;++s)for(var i=t[s],a=i.length,l,c=0;c<a;++c)(l=i[c])&&(r.push(e.call(l,l.__data__,c,i)),o.push(l));return new ot(r,o)}function gf(e){return function(){return this.matches(e)}}function mf(e){return function(t){return t.matches(e)}}var _y=Array.prototype.find;function ky(e){return function(){return _y.call(this.children,e)}}function Dy(){return this.firstElementChild}function Oy(e){return this.select(e==null?Dy:ky(typeof e=="function"?e:mf(e)))}var Ly=Array.prototype.filter;function By(){return Array.from(this.children)}function Fy(e){return function(){return Ly.call(this.children,e)}}function jy(e){return this.selectAll(e==null?By:Fy(typeof e=="function"?e:mf(e)))}function qy(e){typeof e!="function"&&(e=gf(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],l,c=0;c<i;++c)(l=s[c])&&e.call(l,l.__data__,c,s)&&a.push(l);return new ot(r,this._parents)}function yf(e){return new Array(e.length)}function zy(){return new ot(this._enter||this._groups.map(yf),this._parents)}function Ts(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ts.prototype={constructor:Ts,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Hy(e){return function(){return e}}function Vy(e,t,n,r,o,s){for(var i=0,a,l=t.length,c=s.length;i<c;++i)(a=t[i])?(a.__data__=s[i],r[i]=a):n[i]=new Ts(e,s[i]);for(;i<l;++i)(a=t[i])&&(o[i]=a)}function Uy(e,t,n,r,o,s,i){var a,l,c=new Map,d=t.length,f=s.length,u=new Array(d),h;for(a=0;a<d;++a)(l=t[a])&&(u[a]=h=i.call(l,l.__data__,a,t)+"",c.has(h)?o[a]=l:c.set(h,l));for(a=0;a<f;++a)h=i.call(e,s[a],a,s)+"",(l=c.get(h))?(r[a]=l,l.__data__=s[a],c.delete(h)):n[a]=new Ts(e,s[a]);for(a=0;a<d;++a)(l=t[a])&&c.get(u[a])===l&&(o[a]=l)}function $y(e){return e.__data__}function Gy(e,t){if(!arguments.length)return Array.from(this,$y);var n=t?Uy:Vy,r=this._parents,o=this._groups;typeof e!="function"&&(e=Hy(e));for(var s=o.length,i=new Array(s),a=new Array(s),l=new Array(s),c=0;c<s;++c){var d=r[c],f=o[c],u=f.length,h=Ky(e.call(d,d&&d.__data__,c,r)),p=h.length,m=a[c]=new Array(p),g=i[c]=new Array(p),y=l[c]=new Array(u);n(d,f,m,g,y,h,t);for(var b=0,w=0,E,P;b<p;++b)if(E=m[b]){for(b>=w&&(w=b+1);!(P=g[w])&&++w<p;);E._next=P||null}}return i=new ot(i,r),i._enter=a,i._exit=l,i}function Ky(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Wy(){return new ot(this._exit||this._groups.map(yf),this._parents)}function Yy(e,t,n){var r=this.enter(),o=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?s.remove():n(s),r&&o?r.merge(o).order():o}function Xy(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,s=r.length,i=Math.min(o,s),a=new Array(o),l=0;l<i;++l)for(var c=n[l],d=r[l],f=c.length,u=a[l]=new Array(f),h,p=0;p<f;++p)(h=c[p]||d[p])&&(u[p]=h);for(;l<o;++l)a[l]=n[l];return new ot(a,this._parents)}function Qy(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,s=r[o],i;--o>=0;)(i=r[o])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function Zy(e){e||(e=Jy);function t(f,u){return f&&u?e(f.__data__,u.__data__):!f-!u}for(var n=this._groups,r=n.length,o=new Array(r),s=0;s<r;++s){for(var i=n[s],a=i.length,l=o[s]=new Array(a),c,d=0;d<a;++d)(c=i[d])&&(l[d]=c);l.sort(t)}return new ot(o,this._parents).order()}function Jy(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ew(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function tw(){return Array.from(this)}function nw(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length;o<s;++o){var i=r[o];if(i)return i}return null}function rw(){let e=0;for(const t of this)++e;return e}function ow(){return!this.node()}function sw(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],s=0,i=o.length,a;s<i;++s)(a=o[s])&&e.call(a,a.__data__,s,o);return this}function iw(e){return function(){this.removeAttribute(e)}}function aw(e){return function(){this.removeAttributeNS(e.space,e.local)}}function lw(e,t){return function(){this.setAttribute(e,t)}}function cw(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function uw(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function dw(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function fw(e,t){var n=di(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?aw:iw:typeof t=="function"?n.local?dw:uw:n.local?cw:lw)(n,t))}function wf(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function hw(e){return function(){this.style.removeProperty(e)}}function pw(e,t,n){return function(){this.style.setProperty(e,t,n)}}function gw(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function mw(e,t,n){return arguments.length>1?this.each((t==null?hw:typeof t=="function"?gw:pw)(e,t,n??"")):Sr(this.node(),e)}function Sr(e,t){return e.style.getPropertyValue(t)||wf(e).getComputedStyle(e,null).getPropertyValue(t)}function yw(e){return function(){delete this[e]}}function ww(e,t){return function(){this[e]=t}}function xw(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function vw(e,t){return arguments.length>1?this.each((t==null?yw:typeof t=="function"?xw:ww)(e,t)):this.node()[e]}function xf(e){return e.trim().split(/^|\s+/)}function Pl(e){return e.classList||new vf(e)}function vf(e){this._node=e,this._names=xf(e.getAttribute("class")||"")}vf.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function bf(e,t){for(var n=Pl(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function Af(e,t){for(var n=Pl(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function bw(e){return function(){bf(this,e)}}function Aw(e){return function(){Af(this,e)}}function Ew(e,t){return function(){(t.apply(this,arguments)?bf:Af)(this,e)}}function Sw(e,t){var n=xf(e+"");if(arguments.length<2){for(var r=Pl(this.node()),o=-1,s=n.length;++o<s;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?Ew:t?bw:Aw)(n,t))}function Mw(){this.textContent=""}function Cw(e){return function(){this.textContent=e}}function Rw(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Pw(e){return arguments.length?this.each(e==null?Mw:(typeof e=="function"?Rw:Cw)(e)):this.node().textContent}function Iw(){this.innerHTML=""}function Nw(e){return function(){this.innerHTML=e}}function Tw(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function _w(e){return arguments.length?this.each(e==null?Iw:(typeof e=="function"?Tw:Nw)(e)):this.node().innerHTML}function kw(){this.nextSibling&&this.parentNode.appendChild(this)}function Dw(){return this.each(kw)}function Ow(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Lw(){return this.each(Ow)}function Bw(e){var t=typeof e=="function"?e:hf(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Fw(){return null}function jw(e,t){var n=typeof e=="function"?e:hf(e),r=t==null?Fw:typeof t=="function"?t:Rl(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function qw(){var e=this.parentNode;e&&e.removeChild(this)}function zw(){return this.each(qw)}function Hw(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Vw(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Uw(e){return this.select(e?Vw:Hw)}function $w(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Gw(e){return function(t){e.call(this,t,this.__data__)}}function Kw(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Ww(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,s;n<o;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function Yw(e,t,n){return function(){var r=this.__on,o,s=Gw(t);if(r){for(var i=0,a=r.length;i<a;++i)if((o=r[i]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=s,o.options=n),o.value=t;return}}this.addEventListener(e.type,s,n),o={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(o):this.__on=[o]}}function Xw(e,t,n){var r=Kw(e+""),o,s=r.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,d;l<c;++l)for(o=0,d=a[l];o<s;++o)if((i=r[o]).type===d.type&&i.name===d.name)return d.value}return}for(a=t?Yw:Ww,o=0;o<s;++o)this.each(a(r[o],t,n));return this}function Ef(e,t,n){var r=wf(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Qw(e,t){return function(){return Ef(this,e,t)}}function Zw(e,t){return function(){return Ef(this,e,t.apply(this,arguments))}}function Jw(e,t){return this.each((typeof t=="function"?Zw:Qw)(e,t))}function*ex(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length,i;o<s;++o)(i=r[o])&&(yield i)}var Sf=[null];function ot(e,t){this._groups=e,this._parents=t}function Do(){return new ot([[document.documentElement]],Sf)}function tx(){return this}ot.prototype=Do.prototype={constructor:ot,select:Ry,selectAll:Ty,selectChild:Oy,selectChildren:jy,filter:qy,data:Gy,enter:zy,exit:Wy,join:Yy,merge:Xy,selection:tx,order:Qy,sort:Zy,call:ew,nodes:tw,node:nw,size:rw,empty:ow,each:sw,attr:fw,style:mw,property:vw,classed:Sw,text:Pw,html:_w,raise:Dw,lower:Lw,append:Bw,insert:jw,remove:zw,clone:Uw,datum:$w,on:Xw,dispatch:Jw,[Symbol.iterator]:ex};function et(e){return typeof e=="string"?new ot([[document.querySelector(e)]],[document.documentElement]):new ot([[e]],Sf)}function nx(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Mt(e,t){if(e=nx(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const rx={passive:!1},po={capture:!0,passive:!1};function Zi(e){e.stopImmediatePropagation()}function xr(e){e.preventDefault(),e.stopImmediatePropagation()}function Mf(e){var t=e.document.documentElement,n=et(e).on("dragstart.drag",xr,po);"onselectstart"in t?n.on("selectstart.drag",xr,po):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Cf(e,t){var n=e.document.documentElement,r=et(e).on("dragstart.drag",null);t&&(r.on("click.drag",xr,po),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Zo=e=>()=>e;function Ta(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:s,x:i,y:a,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}Ta.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function ox(e){return!e.ctrlKey&&!e.button}function sx(){return this.parentNode}function ix(e,t){return t??{x:e.x,y:e.y}}function ax(){return navigator.maxTouchPoints||"ontouchstart"in this}function Rf(){var e=ox,t=sx,n=ix,r=ax,o={},s=ui("start","drag","end"),i=0,a,l,c,d,f=0;function u(E){E.on("mousedown.drag",h).filter(r).on("touchstart.drag",g).on("touchmove.drag",y,rx).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(E,P){if(!(d||!e.call(this,E,P))){var A=w(this,t.call(this,E,P),E,P,"mouse");A&&(et(E.view).on("mousemove.drag",p,po).on("mouseup.drag",m,po),Mf(E.view),Zi(E),c=!1,a=E.clientX,l=E.clientY,A("start",E))}}function p(E){if(xr(E),!c){var P=E.clientX-a,A=E.clientY-l;c=P*P+A*A>f}o.mouse("drag",E)}function m(E){et(E.view).on("mousemove.drag mouseup.drag",null),Cf(E.view,c),xr(E),o.mouse("end",E)}function g(E,P){if(e.call(this,E,P)){var A=E.changedTouches,v=t.call(this,E,P),M=A.length,N,_;for(N=0;N<M;++N)(_=w(this,v,E,P,A[N].identifier,A[N]))&&(Zi(E),_("start",E,A[N]))}}function y(E){var P=E.changedTouches,A=P.length,v,M;for(v=0;v<A;++v)(M=o[P[v].identifier])&&(xr(E),M("drag",E,P[v]))}function b(E){var P=E.changedTouches,A=P.length,v,M;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),v=0;v<A;++v)(M=o[P[v].identifier])&&(Zi(E),M("end",E,P[v]))}function w(E,P,A,v,M,N){var _=s.copy(),D=Mt(N||A,P),B,j,R;if((R=n.call(E,new Ta("beforestart",{sourceEvent:A,target:u,identifier:M,active:i,x:D[0],y:D[1],dx:0,dy:0,dispatch:_}),v))!=null)return B=R.x-D[0]||0,j=R.y-D[1]||0,function O(I,k,F){var T=D,z;switch(I){case"start":o[M]=O,z=i++;break;case"end":delete o[M],--i;case"drag":D=Mt(F||k,P),z=i;break}_.call(I,E,new Ta(I,{sourceEvent:k,subject:R,target:u,identifier:M,active:z,x:D[0]+B,y:D[1]+j,dx:D[0]-T[0],dy:D[1]-T[1],dispatch:_}),v)}}return u.filter=function(E){return arguments.length?(e=typeof E=="function"?E:Zo(!!E),u):e},u.container=function(E){return arguments.length?(t=typeof E=="function"?E:Zo(E),u):t},u.subject=function(E){return arguments.length?(n=typeof E=="function"?E:Zo(E),u):n},u.touchable=function(E){return arguments.length?(r=typeof E=="function"?E:Zo(!!E),u):r},u.on=function(){var E=s.on.apply(s,arguments);return E===s?u:E},u.clickDistance=function(E){return arguments.length?(f=(E=+E)*E,u):Math.sqrt(f)},u}function Il(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Pf(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Oo(){}var go=.7,_s=1/go,vr="\\s*([+-]?\\d+)\\s*",mo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Lt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",lx=/^#([0-9a-f]{3,8})$/,cx=new RegExp(`^rgb\\(${vr},${vr},${vr}\\)$`),ux=new RegExp(`^rgb\\(${Lt},${Lt},${Lt}\\)$`),dx=new RegExp(`^rgba\\(${vr},${vr},${vr},${mo}\\)$`),fx=new RegExp(`^rgba\\(${Lt},${Lt},${Lt},${mo}\\)$`),hx=new RegExp(`^hsl\\(${mo},${Lt},${Lt}\\)$`),px=new RegExp(`^hsla\\(${mo},${Lt},${Lt},${mo}\\)$`),Gc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Il(Oo,yo,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Kc,formatHex:Kc,formatHex8:gx,formatHsl:mx,formatRgb:Wc,toString:Wc});function Kc(){return this.rgb().formatHex()}function gx(){return this.rgb().formatHex8()}function mx(){return If(this).formatHsl()}function Wc(){return this.rgb().formatRgb()}function yo(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=lx.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Yc(t):n===3?new Ke(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Jo(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Jo(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=cx.exec(e))?new Ke(t[1],t[2],t[3],1):(t=ux.exec(e))?new Ke(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=dx.exec(e))?Jo(t[1],t[2],t[3],t[4]):(t=fx.exec(e))?Jo(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=hx.exec(e))?Zc(t[1],t[2]/100,t[3]/100,1):(t=px.exec(e))?Zc(t[1],t[2]/100,t[3]/100,t[4]):Gc.hasOwnProperty(e)?Yc(Gc[e]):e==="transparent"?new Ke(NaN,NaN,NaN,0):null}function Yc(e){return new Ke(e>>16&255,e>>8&255,e&255,1)}function Jo(e,t,n,r){return r<=0&&(e=t=n=NaN),new Ke(e,t,n,r)}function yx(e){return e instanceof Oo||(e=yo(e)),e?(e=e.rgb(),new Ke(e.r,e.g,e.b,e.opacity)):new Ke}function _a(e,t,n,r){return arguments.length===1?yx(e):new Ke(e,t,n,r??1)}function Ke(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Il(Ke,_a,Pf(Oo,{brighter(e){return e=e==null?_s:Math.pow(_s,e),new Ke(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?go:Math.pow(go,e),new Ke(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ke(On(this.r),On(this.g),On(this.b),ks(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xc,formatHex:Xc,formatHex8:wx,formatRgb:Qc,toString:Qc}));function Xc(){return`#${kn(this.r)}${kn(this.g)}${kn(this.b)}`}function wx(){return`#${kn(this.r)}${kn(this.g)}${kn(this.b)}${kn((isNaN(this.opacity)?1:this.opacity)*255)}`}function Qc(){const e=ks(this.opacity);return`${e===1?"rgb(":"rgba("}${On(this.r)}, ${On(this.g)}, ${On(this.b)}${e===1?")":`, ${e})`}`}function ks(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function On(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function kn(e){return e=On(e),(e<16?"0":"")+e.toString(16)}function Zc(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ct(e,t,n,r)}function If(e){if(e instanceof Ct)return new Ct(e.h,e.s,e.l,e.opacity);if(e instanceof Oo||(e=yo(e)),!e)return new Ct;if(e instanceof Ct)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),s=Math.max(t,n,r),i=NaN,a=s-o,l=(s+o)/2;return a?(t===s?i=(n-r)/a+(n<r)*6:n===s?i=(r-t)/a+2:i=(t-n)/a+4,a/=l<.5?s+o:2-s-o,i*=60):a=l>0&&l<1?0:i,new Ct(i,a,l,e.opacity)}function xx(e,t,n,r){return arguments.length===1?If(e):new Ct(e,t,n,r??1)}function Ct(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Il(Ct,xx,Pf(Oo,{brighter(e){return e=e==null?_s:Math.pow(_s,e),new Ct(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?go:Math.pow(go,e),new Ct(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new Ke(Ji(e>=240?e-240:e+120,o,r),Ji(e,o,r),Ji(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new Ct(Jc(this.h),es(this.s),es(this.l),ks(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ks(this.opacity);return`${e===1?"hsl(":"hsla("}${Jc(this.h)}, ${es(this.s)*100}%, ${es(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Jc(e){return e=(e||0)%360,e<0?e+360:e}function es(e){return Math.max(0,Math.min(1,e||0))}function Ji(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Nf=e=>()=>e;function vx(e,t){return function(n){return e+n*t}}function bx(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Ax(e){return(e=+e)==1?Tf:function(t,n){return n-t?bx(t,n,e):Nf(isNaN(t)?n:t)}}function Tf(e,t){var n=t-e;return n?vx(e,n):Nf(isNaN(e)?t:e)}const eu=function e(t){var n=Ax(t);function r(o,s){var i=n((o=_a(o)).r,(s=_a(s)).r),a=n(o.g,s.g),l=n(o.b,s.b),c=Tf(o.opacity,s.opacity);return function(d){return o.r=i(d),o.g=a(d),o.b=l(d),o.opacity=c(d),o+""}}return r.gamma=e,r}(1);function ln(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var ka=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ea=new RegExp(ka.source,"g");function Ex(e){return function(){return e}}function Sx(e){return function(t){return e(t)+""}}function Mx(e,t){var n=ka.lastIndex=ea.lastIndex=0,r,o,s,i=-1,a=[],l=[];for(e=e+"",t=t+"";(r=ka.exec(e))&&(o=ea.exec(t));)(s=o.index)>n&&(s=t.slice(n,s),a[i]?a[i]+=s:a[++i]=s),(r=r[0])===(o=o[0])?a[i]?a[i]+=o:a[++i]=o:(a[++i]=null,l.push({i,x:ln(r,o)})),n=ea.lastIndex;return n<t.length&&(s=t.slice(n),a[i]?a[i]+=s:a[++i]=s),a.length<2?l[0]?Sx(l[0].x):Ex(t):(t=l.length,function(c){for(var d=0,f;d<t;++d)a[(f=l[d]).i]=f.x(c);return a.join("")})}var tu=180/Math.PI,Da={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function _f(e,t,n,r,o,s){var i,a,l;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,i=-i),{translateX:o,translateY:s,rotate:Math.atan2(t,e)*tu,skewX:Math.atan(l)*tu,scaleX:i,scaleY:a}}var ts;function Cx(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Da:_f(t.a,t.b,t.c,t.d,t.e,t.f)}function Rx(e){return e==null||(ts||(ts=document.createElementNS("http://www.w3.org/2000/svg","g")),ts.setAttribute("transform",e),!(e=ts.transform.baseVal.consolidate()))?Da:(e=e.matrix,_f(e.a,e.b,e.c,e.d,e.e,e.f))}function kf(e,t,n,r){function o(c){return c.length?c.pop()+" ":""}function s(c,d,f,u,h,p){if(c!==f||d!==u){var m=h.push("translate(",null,t,null,n);p.push({i:m-4,x:ln(c,f)},{i:m-2,x:ln(d,u)})}else(f||u)&&h.push("translate("+f+t+u+n)}function i(c,d,f,u){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),u.push({i:f.push(o(f)+"rotate(",null,r)-2,x:ln(c,d)})):d&&f.push(o(f)+"rotate("+d+r)}function a(c,d,f,u){c!==d?u.push({i:f.push(o(f)+"skewX(",null,r)-2,x:ln(c,d)}):d&&f.push(o(f)+"skewX("+d+r)}function l(c,d,f,u,h,p){if(c!==f||d!==u){var m=h.push(o(h)+"scale(",null,",",null,")");p.push({i:m-4,x:ln(c,f)},{i:m-2,x:ln(d,u)})}else(f!==1||u!==1)&&h.push(o(h)+"scale("+f+","+u+")")}return function(c,d){var f=[],u=[];return c=e(c),d=e(d),s(c.translateX,c.translateY,d.translateX,d.translateY,f,u),i(c.rotate,d.rotate,f,u),a(c.skewX,d.skewX,f,u),l(c.scaleX,c.scaleY,d.scaleX,d.scaleY,f,u),c=d=null,function(h){for(var p=-1,m=u.length,g;++p<m;)f[(g=u[p]).i]=g.x(h);return f.join("")}}}var Px=kf(Cx,"px, ","px)","deg)"),Ix=kf(Rx,", ",")",")"),Nx=1e-12;function nu(e){return((e=Math.exp(e))+1/e)/2}function Tx(e){return((e=Math.exp(e))-1/e)/2}function _x(e){return((e=Math.exp(2*e))-1)/(e+1)}const kx=function e(t,n,r){function o(s,i){var a=s[0],l=s[1],c=s[2],d=i[0],f=i[1],u=i[2],h=d-a,p=f-l,m=h*h+p*p,g,y;if(m<Nx)y=Math.log(u/c)/t,g=function(v){return[a+v*h,l+v*p,c*Math.exp(t*v*y)]};else{var b=Math.sqrt(m),w=(u*u-c*c+r*m)/(2*c*n*b),E=(u*u-c*c-r*m)/(2*u*n*b),P=Math.log(Math.sqrt(w*w+1)-w),A=Math.log(Math.sqrt(E*E+1)-E);y=(A-P)/t,g=function(v){var M=v*y,N=nu(P),_=c/(n*b)*(N*_x(t*M+P)-Tx(P));return[a+_*h,l+_*p,c*N/nu(t*M+P)]}}return g.duration=y*1e3*t/Math.SQRT2,g}return o.rho=function(s){var i=Math.max(.001,+s),a=i*i,l=a*a;return e(i,a,l)},o}(Math.SQRT2,2,4);var Mr=0,Yr=0,Vr=0,Df=1e3,Ds,Xr,Os=0,zn=0,fi=0,wo=typeof performance=="object"&&performance.now?performance:Date,Of=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Nl(){return zn||(Of(Dx),zn=wo.now()+fi)}function Dx(){zn=0}function Ls(){this._call=this._time=this._next=null}Ls.prototype=Lf.prototype={constructor:Ls,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Nl():+n)+(t==null?0:+t),!this._next&&Xr!==this&&(Xr?Xr._next=this:Ds=this,Xr=this),this._call=e,this._time=n,Oa()},stop:function(){this._call&&(this._call=null,this._time=1/0,Oa())}};function Lf(e,t,n){var r=new Ls;return r.restart(e,t,n),r}function Ox(){Nl(),++Mr;for(var e=Ds,t;e;)(t=zn-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Mr}function ru(){zn=(Os=wo.now())+fi,Mr=Yr=0;try{Ox()}finally{Mr=0,Bx(),zn=0}}function Lx(){var e=wo.now(),t=e-Os;t>Df&&(fi-=t,Os=e)}function Bx(){for(var e,t=Ds,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Ds=n);Xr=e,Oa(r)}function Oa(e){if(!Mr){Yr&&(Yr=clearTimeout(Yr));var t=e-zn;t>24?(e<1/0&&(Yr=setTimeout(ru,e-wo.now()-fi)),Vr&&(Vr=clearInterval(Vr))):(Vr||(Os=wo.now(),Vr=setInterval(Lx,Df)),Mr=1,Of(ru))}}function ou(e,t,n){var r=new Ls;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var Fx=ui("start","end","cancel","interrupt"),jx=[],Bf=0,su=1,La=2,ys=3,iu=4,Ba=5,ws=6;function hi(e,t,n,r,o,s){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;qx(e,n,{name:t,index:r,group:o,on:Fx,tween:jx,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Bf})}function Tl(e,t){var n=_t(e,t);if(n.state>Bf)throw new Error("too late; already scheduled");return n}function Ut(e,t){var n=_t(e,t);if(n.state>ys)throw new Error("too late; already running");return n}function _t(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function qx(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=Lf(s,0,n.time);function s(c){n.state=su,n.timer.restart(i,n.delay,n.time),n.delay<=c&&i(c-n.delay)}function i(c){var d,f,u,h;if(n.state!==su)return l();for(d in r)if(h=r[d],h.name===n.name){if(h.state===ys)return ou(i);h.state===iu?(h.state=ws,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[d]):+d<t&&(h.state=ws,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[d])}if(ou(function(){n.state===ys&&(n.state=iu,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=La,n.on.call("start",e,e.__data__,n.index,n.group),n.state===La){for(n.state=ys,o=new Array(u=n.tween.length),d=0,f=-1;d<u;++d)(h=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(o[++f]=h);o.length=f+1}}function a(c){for(var d=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=Ba,1),f=-1,u=o.length;++f<u;)o[f].call(e,d);n.state===Ba&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=ws,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function xs(e,t){var n=e.__transition,r,o,s=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){s=!1;continue}o=r.state>La&&r.state<Ba,r.state=ws,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}s&&delete e.__transition}}function zx(e){return this.each(function(){xs(this,e)})}function Hx(e,t){var n,r;return function(){var o=Ut(this,e),s=o.tween;if(s!==n){r=n=s;for(var i=0,a=r.length;i<a;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}o.tween=r}}function Vx(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var s=Ut(this,e),i=s.tween;if(i!==r){o=(r=i).slice();for(var a={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=a;break}l===c&&o.push(a)}s.tween=o}}function Ux(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=_t(this.node(),n).tween,o=0,s=r.length,i;o<s;++o)if((i=r[o]).name===e)return i.value;return null}return this.each((t==null?Hx:Vx)(n,e,t))}function _l(e,t,n){var r=e._id;return e.each(function(){var o=Ut(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return _t(o,r).value[t]}}function Ff(e,t){var n;return(typeof t=="number"?ln:t instanceof yo?eu:(n=yo(t))?(t=n,eu):Mx)(e,t)}function $x(e){return function(){this.removeAttribute(e)}}function Gx(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Kx(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttribute(e);return i===o?null:i===r?s:s=t(r=i,n)}}function Wx(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttributeNS(e.space,e.local);return i===o?null:i===r?s:s=t(r=i,n)}}function Yx(e,t,n){var r,o,s;return function(){var i,a=n(this),l;return a==null?void this.removeAttribute(e):(i=this.getAttribute(e),l=a+"",i===l?null:i===r&&l===o?s:(o=l,s=t(r=i,a)))}}function Xx(e,t,n){var r,o,s;return function(){var i,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),l=a+"",i===l?null:i===r&&l===o?s:(o=l,s=t(r=i,a)))}}function Qx(e,t){var n=di(e),r=n==="transform"?Ix:Ff;return this.attrTween(e,typeof t=="function"?(n.local?Xx:Yx)(n,r,_l(this,"attr."+e,t)):t==null?(n.local?Gx:$x)(n):(n.local?Wx:Kx)(n,r,t))}function Zx(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Jx(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function ev(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Jx(e,s)),n}return o._value=t,o}function tv(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Zx(e,s)),n}return o._value=t,o}function nv(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=di(e);return this.tween(n,(r.local?ev:tv)(r,t))}function rv(e,t){return function(){Tl(this,e).delay=+t.apply(this,arguments)}}function ov(e,t){return t=+t,function(){Tl(this,e).delay=t}}function sv(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?rv:ov)(t,e)):_t(this.node(),t).delay}function iv(e,t){return function(){Ut(this,e).duration=+t.apply(this,arguments)}}function av(e,t){return t=+t,function(){Ut(this,e).duration=t}}function lv(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?iv:av)(t,e)):_t(this.node(),t).duration}function cv(e,t){if(typeof t!="function")throw new Error;return function(){Ut(this,e).ease=t}}function uv(e){var t=this._id;return arguments.length?this.each(cv(t,e)):_t(this.node(),t).ease}function dv(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ut(this,e).ease=n}}function fv(e){if(typeof e!="function")throw new Error;return this.each(dv(this._id,e))}function hv(e){typeof e!="function"&&(e=gf(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],l,c=0;c<i;++c)(l=s[c])&&e.call(l,l.__data__,c,s)&&a.push(l);return new Zt(r,this._parents,this._name,this._id)}function pv(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,s=Math.min(r,o),i=new Array(r),a=0;a<s;++a)for(var l=t[a],c=n[a],d=l.length,f=i[a]=new Array(d),u,h=0;h<d;++h)(u=l[h]||c[h])&&(f[h]=u);for(;a<r;++a)i[a]=t[a];return new Zt(i,this._parents,this._name,this._id)}function gv(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function mv(e,t,n){var r,o,s=gv(t)?Tl:Ut;return function(){var i=s(this,e),a=i.on;a!==r&&(o=(r=a).copy()).on(t,n),i.on=o}}function yv(e,t){var n=this._id;return arguments.length<2?_t(this.node(),n).on.on(e):this.each(mv(n,e,t))}function wv(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function xv(){return this.on("end.remove",wv(this._id))}function vv(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Rl(e));for(var r=this._groups,o=r.length,s=new Array(o),i=0;i<o;++i)for(var a=r[i],l=a.length,c=s[i]=new Array(l),d,f,u=0;u<l;++u)(d=a[u])&&(f=e.call(d,d.__data__,u,a))&&("__data__"in d&&(f.__data__=d.__data__),c[u]=f,hi(c[u],t,n,u,c,_t(d,n)));return new Zt(s,this._parents,t,n)}function bv(e){var t=this._name,n=this._id;typeof e!="function"&&(e=pf(e));for(var r=this._groups,o=r.length,s=[],i=[],a=0;a<o;++a)for(var l=r[a],c=l.length,d,f=0;f<c;++f)if(d=l[f]){for(var u=e.call(d,d.__data__,f,l),h,p=_t(d,n),m=0,g=u.length;m<g;++m)(h=u[m])&&hi(h,t,n,m,u,p);s.push(u),i.push(d)}return new Zt(s,i,t,n)}var Av=Do.prototype.constructor;function Ev(){return new Av(this._groups,this._parents)}function Sv(e,t){var n,r,o;return function(){var s=Sr(this,e),i=(this.style.removeProperty(e),Sr(this,e));return s===i?null:s===n&&i===r?o:o=t(n=s,r=i)}}function jf(e){return function(){this.style.removeProperty(e)}}function Mv(e,t,n){var r,o=n+"",s;return function(){var i=Sr(this,e);return i===o?null:i===r?s:s=t(r=i,n)}}function Cv(e,t,n){var r,o,s;return function(){var i=Sr(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),Sr(this,e))),i===l?null:i===r&&l===o?s:(o=l,s=t(r=i,a))}}function Rv(e,t){var n,r,o,s="style."+t,i="end."+s,a;return function(){var l=Ut(this,e),c=l.on,d=l.value[s]==null?a||(a=jf(t)):void 0;(c!==n||o!==d)&&(r=(n=c).copy()).on(i,o=d),l.on=r}}function Pv(e,t,n){var r=(e+="")=="transform"?Px:Ff;return t==null?this.styleTween(e,Sv(e,r)).on("end.style."+e,jf(e)):typeof t=="function"?this.styleTween(e,Cv(e,r,_l(this,"style."+e,t))).each(Rv(this._id,e)):this.styleTween(e,Mv(e,r,t),n).on("end.style."+e,null)}function Iv(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Nv(e,t,n){var r,o;function s(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&Iv(e,i,n)),r}return s._value=t,s}function Tv(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Nv(e,t,n??""))}function _v(e){return function(){this.textContent=e}}function kv(e){return function(){var t=e(this);this.textContent=t??""}}function Dv(e){return this.tween("text",typeof e=="function"?kv(_l(this,"text",e)):_v(e==null?"":e+""))}function Ov(e){return function(t){this.textContent=e.call(this,t)}}function Lv(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&Ov(o)),t}return r._value=e,r}function Bv(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Lv(e))}function Fv(){for(var e=this._name,t=this._id,n=qf(),r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,l,c=0;c<a;++c)if(l=i[c]){var d=_t(l,t);hi(l,e,n,c,i,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Zt(r,this._parents,e,n)}function jv(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(s,i){var a={value:i},l={value:function(){--o===0&&s()}};n.each(function(){var c=Ut(this,r),d=c.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),c.on=t}),o===0&&s()})}var qv=0;function Zt(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function qf(){return++qv}var Gt=Do.prototype;Zt.prototype={constructor:Zt,select:vv,selectAll:bv,selectChild:Gt.selectChild,selectChildren:Gt.selectChildren,filter:hv,merge:pv,selection:Ev,transition:Fv,call:Gt.call,nodes:Gt.nodes,node:Gt.node,size:Gt.size,empty:Gt.empty,each:Gt.each,on:yv,attr:Qx,attrTween:nv,style:Pv,styleTween:Tv,text:Dv,textTween:Bv,remove:xv,tween:Ux,delay:sv,duration:lv,ease:uv,easeVarying:fv,end:jv,[Symbol.iterator]:Gt[Symbol.iterator]};function zv(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Hv={time:null,delay:0,duration:250,ease:zv};function Vv(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Uv(e){var t,n;e instanceof Zt?(t=e._id,e=e._name):(t=qf(),(n=Hv).time=Nl(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,l,c=0;c<a;++c)(l=i[c])&&hi(l,e,t,c,i,n||Vv(l,t));return new Zt(r,this._parents,e,t)}Do.prototype.interrupt=zx;Do.prototype.transition=Uv;const ns=e=>()=>e;function $v(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Yt(e,t,n){this.k=e,this.x=t,this.y=n}Yt.prototype={constructor:Yt,scale:function(e){return e===1?this:new Yt(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Yt(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var pi=new Yt(1,0,0);zf.prototype=Yt.prototype;function zf(e){for(;!e.__zoom;)if(!(e=e.parentNode))return pi;return e.__zoom}function ta(e){e.stopImmediatePropagation()}function Ur(e){e.preventDefault(),e.stopImmediatePropagation()}function Gv(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Kv(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function au(){return this.__zoom||pi}function Wv(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Yv(){return navigator.maxTouchPoints||"ontouchstart"in this}function Xv(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function Hf(){var e=Gv,t=Kv,n=Xv,r=Wv,o=Yv,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,l=kx,c=ui("start","zoom","end"),d,f,u,h=500,p=150,m=0,g=10;function y(R){R.property("__zoom",au).on("wheel.zoom",M,{passive:!1}).on("mousedown.zoom",N).on("dblclick.zoom",_).filter(o).on("touchstart.zoom",D).on("touchmove.zoom",B).on("touchend.zoom touchcancel.zoom",j).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(R,O,I,k){var F=R.selection?R.selection():R;F.property("__zoom",au),R!==F?P(R,O,I,k):F.interrupt().each(function(){A(this,arguments).event(k).start().zoom(null,typeof O=="function"?O.apply(this,arguments):O).end()})},y.scaleBy=function(R,O,I,k){y.scaleTo(R,function(){var F=this.__zoom.k,T=typeof O=="function"?O.apply(this,arguments):O;return F*T},I,k)},y.scaleTo=function(R,O,I,k){y.transform(R,function(){var F=t.apply(this,arguments),T=this.__zoom,z=I==null?E(F):typeof I=="function"?I.apply(this,arguments):I,V=T.invert(z),U=typeof O=="function"?O.apply(this,arguments):O;return n(w(b(T,U),z,V),F,i)},I,k)},y.translateBy=function(R,O,I,k){y.transform(R,function(){return n(this.__zoom.translate(typeof O=="function"?O.apply(this,arguments):O,typeof I=="function"?I.apply(this,arguments):I),t.apply(this,arguments),i)},null,k)},y.translateTo=function(R,O,I,k,F){y.transform(R,function(){var T=t.apply(this,arguments),z=this.__zoom,V=k==null?E(T):typeof k=="function"?k.apply(this,arguments):k;return n(pi.translate(V[0],V[1]).scale(z.k).translate(typeof O=="function"?-O.apply(this,arguments):-O,typeof I=="function"?-I.apply(this,arguments):-I),T,i)},k,F)};function b(R,O){return O=Math.max(s[0],Math.min(s[1],O)),O===R.k?R:new Yt(O,R.x,R.y)}function w(R,O,I){var k=O[0]-I[0]*R.k,F=O[1]-I[1]*R.k;return k===R.x&&F===R.y?R:new Yt(R.k,k,F)}function E(R){return[(+R[0][0]+ +R[1][0])/2,(+R[0][1]+ +R[1][1])/2]}function P(R,O,I,k){R.on("start.zoom",function(){A(this,arguments).event(k).start()}).on("interrupt.zoom end.zoom",function(){A(this,arguments).event(k).end()}).tween("zoom",function(){var F=this,T=arguments,z=A(F,T).event(k),V=t.apply(F,T),U=I==null?E(V):typeof I=="function"?I.apply(F,T):I,K=Math.max(V[1][0]-V[0][0],V[1][1]-V[0][1]),Y=F.__zoom,ee=typeof O=="function"?O.apply(F,T):O,Z=l(Y.invert(U).concat(K/Y.k),ee.invert(U).concat(K/ee.k));return function(q){if(q===1)q=ee;else{var W=Z(q),te=K/W[2];q=new Yt(te,U[0]-W[0]*te,U[1]-W[1]*te)}z.zoom(null,q)}})}function A(R,O,I){return!I&&R.__zooming||new v(R,O)}function v(R,O){this.that=R,this.args=O,this.active=0,this.sourceEvent=null,this.extent=t.apply(R,O),this.taps=0}v.prototype={event:function(R){return R&&(this.sourceEvent=R),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(R,O){return this.mouse&&R!=="mouse"&&(this.mouse[1]=O.invert(this.mouse[0])),this.touch0&&R!=="touch"&&(this.touch0[1]=O.invert(this.touch0[0])),this.touch1&&R!=="touch"&&(this.touch1[1]=O.invert(this.touch1[0])),this.that.__zoom=O,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(R){var O=et(this.that).datum();c.call(R,this.that,new $v(R,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:c}),O)}};function M(R,...O){if(!e.apply(this,arguments))return;var I=A(this,O).event(R),k=this.__zoom,F=Math.max(s[0],Math.min(s[1],k.k*Math.pow(2,r.apply(this,arguments)))),T=Mt(R);if(I.wheel)(I.mouse[0][0]!==T[0]||I.mouse[0][1]!==T[1])&&(I.mouse[1]=k.invert(I.mouse[0]=T)),clearTimeout(I.wheel);else{if(k.k===F)return;I.mouse=[T,k.invert(T)],xs(this),I.start()}Ur(R),I.wheel=setTimeout(z,p),I.zoom("mouse",n(w(b(k,F),I.mouse[0],I.mouse[1]),I.extent,i));function z(){I.wheel=null,I.end()}}function N(R,...O){if(u||!e.apply(this,arguments))return;var I=R.currentTarget,k=A(this,O,!0).event(R),F=et(R.view).on("mousemove.zoom",U,!0).on("mouseup.zoom",K,!0),T=Mt(R,I),z=R.clientX,V=R.clientY;Mf(R.view),ta(R),k.mouse=[T,this.__zoom.invert(T)],xs(this),k.start();function U(Y){if(Ur(Y),!k.moved){var ee=Y.clientX-z,Z=Y.clientY-V;k.moved=ee*ee+Z*Z>m}k.event(Y).zoom("mouse",n(w(k.that.__zoom,k.mouse[0]=Mt(Y,I),k.mouse[1]),k.extent,i))}function K(Y){F.on("mousemove.zoom mouseup.zoom",null),Cf(Y.view,k.moved),Ur(Y),k.event(Y).end()}}function _(R,...O){if(e.apply(this,arguments)){var I=this.__zoom,k=Mt(R.changedTouches?R.changedTouches[0]:R,this),F=I.invert(k),T=I.k*(R.shiftKey?.5:2),z=n(w(b(I,T),k,F),t.apply(this,O),i);Ur(R),a>0?et(this).transition().duration(a).call(P,z,k,R):et(this).call(y.transform,z,k,R)}}function D(R,...O){if(e.apply(this,arguments)){var I=R.touches,k=I.length,F=A(this,O,R.changedTouches.length===k).event(R),T,z,V,U;for(ta(R),z=0;z<k;++z)V=I[z],U=Mt(V,this),U=[U,this.__zoom.invert(U),V.identifier],F.touch0?!F.touch1&&F.touch0[2]!==U[2]&&(F.touch1=U,F.taps=0):(F.touch0=U,T=!0,F.taps=1+!!d);d&&(d=clearTimeout(d)),T&&(F.taps<2&&(f=U[0],d=setTimeout(function(){d=null},h)),xs(this),F.start())}}function B(R,...O){if(this.__zooming){var I=A(this,O).event(R),k=R.changedTouches,F=k.length,T,z,V,U;for(Ur(R),T=0;T<F;++T)z=k[T],V=Mt(z,this),I.touch0&&I.touch0[2]===z.identifier?I.touch0[0]=V:I.touch1&&I.touch1[2]===z.identifier&&(I.touch1[0]=V);if(z=I.that.__zoom,I.touch1){var K=I.touch0[0],Y=I.touch0[1],ee=I.touch1[0],Z=I.touch1[1],q=(q=ee[0]-K[0])*q+(q=ee[1]-K[1])*q,W=(W=Z[0]-Y[0])*W+(W=Z[1]-Y[1])*W;z=b(z,Math.sqrt(q/W)),V=[(K[0]+ee[0])/2,(K[1]+ee[1])/2],U=[(Y[0]+Z[0])/2,(Y[1]+Z[1])/2]}else if(I.touch0)V=I.touch0[0],U=I.touch0[1];else return;I.zoom("touch",n(w(z,V,U),I.extent,i))}}function j(R,...O){if(this.__zooming){var I=A(this,O).event(R),k=R.changedTouches,F=k.length,T,z;for(ta(R),u&&clearTimeout(u),u=setTimeout(function(){u=null},h),T=0;T<F;++T)z=k[T],I.touch0&&I.touch0[2]===z.identifier?delete I.touch0:I.touch1&&I.touch1[2]===z.identifier&&delete I.touch1;if(I.touch1&&!I.touch0&&(I.touch0=I.touch1,delete I.touch1),I.touch0)I.touch0[1]=this.__zoom.invert(I.touch0[0]);else if(I.end(),I.taps===2&&(z=Mt(z,this),Math.hypot(f[0]-z[0],f[1]-z[1])<g)){var V=et(this).on("dblclick.zoom");V&&V.apply(this,arguments)}}}return y.wheelDelta=function(R){return arguments.length?(r=typeof R=="function"?R:ns(+R),y):r},y.filter=function(R){return arguments.length?(e=typeof R=="function"?R:ns(!!R),y):e},y.touchable=function(R){return arguments.length?(o=typeof R=="function"?R:ns(!!R),y):o},y.extent=function(R){return arguments.length?(t=typeof R=="function"?R:ns([[+R[0][0],+R[0][1]],[+R[1][0],+R[1][1]]]),y):t},y.scaleExtent=function(R){return arguments.length?(s[0]=+R[0],s[1]=+R[1],y):[s[0],s[1]]},y.translateExtent=function(R){return arguments.length?(i[0][0]=+R[0][0],i[1][0]=+R[1][0],i[0][1]=+R[0][1],i[1][1]=+R[1][1],y):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},y.constrain=function(R){return arguments.length?(n=R,y):n},y.duration=function(R){return arguments.length?(a=+R,y):a},y.interpolate=function(R){return arguments.length?(l=R,y):l},y.on=function(){var R=c.on.apply(c,arguments);return R===c?y:R},y.clickDistance=function(R){return arguments.length?(m=(R=+R)*R,y):Math.sqrt(m)},y.tapDistance=function(R){return arguments.length?(g=+R,y):g},y}const It={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},xo=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Vf=["Enter"," ","Escape"];var Cr;(function(e){e.Strict="strict",e.Loose="loose"})(Cr||(Cr={}));var Ln;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ln||(Ln={}));var vo;(function(e){e.Partial="partial",e.Full="full"})(vo||(vo={}));const Uf={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var un;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(un||(un={}));var Bs;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Bs||(Bs={}));var ae;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ae||(ae={}));const lu={[ae.Left]:ae.Right,[ae.Right]:ae.Left,[ae.Top]:ae.Bottom,[ae.Bottom]:ae.Top};function Qv(e,t){if(!e&&!t)return!0;if(!e||!t||e.size!==t.size)return!1;if(!e.size&&!t.size)return!0;for(const n of e.keys())if(!t.has(n))return!1;return!0}function cu(e,t,n){if(!n)return;const r=[];e.forEach((o,s)=>{t!=null&&t.has(s)||r.push(o)}),r.length&&n(r)}function $f(e){return e===null?null:e?"valid":"invalid"}const Gf=e=>"id"in e&&"source"in e&&"target"in e,Zv=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),kl=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Lo=(e,t=[0,0])=>{const{width:n,height:r}=tn(e),o=e.origin??t,s=n*o[0],i=r*o[1];return{x:e.position.x-s,y:e.position.y-i}},Jv=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const s=typeof o=="string";let i=!t.nodeLookup&&!s?o:void 0;t.nodeLookup&&(i=s?t.nodeLookup.get(o):kl(o)?o:t.nodeLookup.get(o.id));const a=i?Fs(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return gi(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return mi(n)},Bo=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const o=Fs(r);n=gi(n,o)}}),mi(n)},Kf=(e,t,[n,r,o]=[0,0,1],s=!1,i=!1)=>{const a={...Fo(t,[n,r,o]),width:t.width/o,height:t.height/o},l=[];for(const c of e.values()){const{measured:d,selectable:f=!0,hidden:u=!1}=c;if(i&&!f||u)continue;const h=d.width??c.width??c.initialWidth??null,p=d.height??c.height??c.initialHeight??null,m=bo(a,Pr(c)),g=(h??0)*(p??0),y=s&&m>0;(!c.internals.handleBounds||y||m>=g||c.dragging)&&l.push(c)}return l},eb=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function tb(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(o=>o.id)):null;return e.forEach(o=>{o.measured.width&&o.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!o.hidden)&&(!r||r.has(o.id))&&n.set(o.id,o)}),n}async function nb({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:s},i){if(e.size===0)return Promise.resolve(!0);const a=tb(e,i),l=Bo(a),c=Dl(l,t,n,(i==null?void 0:i.minZoom)??o,(i==null?void 0:i.maxZoom)??s,(i==null?void 0:i.padding)??.1);return await r.setViewport(c,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function Wf({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:s}){const i=n.get(e),a=i.parentId?n.get(i.parentId):void 0,{x:l,y:c}=a?a.internals.positionAbsolute:{x:0,y:0},d=i.origin??r;let f=o;if(i.extent==="parent"&&!i.expandParent)if(!a)s==null||s("005",It.error005());else{const h=a.measured.width,p=a.measured.height;h&&p&&(f=[[l,c],[l+h,c+p]])}else a&&Ir(i.extent)&&(f=[[i.extent[0][0]+l,i.extent[0][1]+c],[i.extent[1][0]+l,i.extent[1][1]+c]]);const u=Ir(f)?Hn(t,f,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&(s==null||s("015",It.error015())),{position:{x:u.x-l+(i.measured.width??0)*d[0],y:u.y-c+(i.measured.height??0)*d[1]},positionAbsolute:u}}async function rb({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const s=new Set(e.map(u=>u.id)),i=[];for(const u of n){if(u.deletable===!1)continue;const h=s.has(u.id),p=!h&&u.parentId&&i.find(m=>m.id===u.parentId);(h||p)&&i.push(u)}const a=new Set(t.map(u=>u.id)),l=r.filter(u=>u.deletable!==!1),d=eb(i,l);for(const u of l)a.has(u.id)&&!d.find(p=>p.id===u.id)&&d.push(u);if(!o)return{edges:d,nodes:i};const f=await o({nodes:i,edges:d});return typeof f=="boolean"?f?{edges:d,nodes:i}:{edges:[],nodes:[]}:f}const Rr=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Hn=(e={x:0,y:0},t,n)=>({x:Rr(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:Rr(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function Yf(e,t,n){const{width:r,height:o}=tn(n),{x:s,y:i}=n.internals.positionAbsolute;return Hn(e,[[s,i],[s+r,i+o]],t)}const uu=(e,t,n)=>e<t?Rr(Math.abs(e-t),1,t)/t:e>n?-Rr(Math.abs(e-n),1,t)/t:0,Xf=(e,t,n=15,r=40)=>{const o=uu(e.x,r,t.width-r)*n,s=uu(e.y,r,t.height-r)*n;return[o,s]},gi=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Fa=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),mi=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Pr=(e,t=[0,0])=>{var o,s;const{x:n,y:r}=kl(e)?e.internals.positionAbsolute:Lo(e,t);return{x:n,y:r,width:((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0,height:((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0}},Fs=(e,t=[0,0])=>{var o,s;const{x:n,y:r}=kl(e)?e.internals.positionAbsolute:Lo(e,t);return{x:n,y:r,x2:n+(((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0),y2:r+(((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0)}},Qf=(e,t)=>mi(gi(Fa(e),Fa(t))),bo=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},du=e=>Rt(e.width)&&Rt(e.height)&&Rt(e.x)&&Rt(e.y),Rt=e=>!isNaN(e)&&isFinite(e),ob=(e,t)=>{},yi=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Fo=({x:e,y:t},[n,r,o],s=!1,i=[1,1])=>{const a={x:(e-n)/o,y:(t-r)/o};return s?yi(a,i):a},js=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r});function ir(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function sb(e,t,n){if(typeof e=="string"||typeof e=="number"){const r=ir(e,n),o=ir(e,t);return{top:r,right:o,bottom:r,left:o,x:o*2,y:r*2}}if(typeof e=="object"){const r=ir(e.top??e.y??0,n),o=ir(e.bottom??e.y??0,n),s=ir(e.left??e.x??0,t),i=ir(e.right??e.x??0,t);return{top:r,right:i,bottom:o,left:s,x:s+i,y:r+o}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function ib(e,t,n,r,o,s){const{x:i,y:a}=js(e,[t,n,r]),{x:l,y:c}=js({x:e.x+e.width,y:e.y+e.height},[t,n,r]),d=o-l,f=s-c;return{left:Math.floor(i),top:Math.floor(a),right:Math.floor(d),bottom:Math.floor(f)}}const Dl=(e,t,n,r,o,s)=>{const i=sb(s,t,n),a=(t-i.x)/e.width,l=(n-i.y)/e.height,c=Math.min(a,l),d=Rr(c,r,o),f=e.x+e.width/2,u=e.y+e.height/2,h=t/2-f*d,p=n/2-u*d,m=ib(e,h,p,d,t,n),g={left:Math.min(m.left-i.left,0),top:Math.min(m.top-i.top,0),right:Math.min(m.right-i.right,0),bottom:Math.min(m.bottom-i.bottom,0)};return{x:h-g.left+g.right,y:p-g.top+g.bottom,zoom:d}},qs=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Ir(e){return e!==void 0&&e!=="parent"}function tn(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function Zf(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function Jf(e,t={width:0,height:0},n,r,o){const s={...e},i=r.get(n);if(i){const a=i.origin||o;s.x+=i.internals.positionAbsolute.x-(t.width??0)*a[0],s.y+=i.internals.positionAbsolute.y-(t.height??0)*a[1]}return s}function fu(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function ab(){let e,t;return{promise:new Promise((r,o)=>{e=r,t=o}),resolve:e,reject:t}}function so(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){const{x:s,y:i}=Xt(e),a=Fo({x:s-((o==null?void 0:o.left)??0),y:i-((o==null?void 0:o.top)??0)},r),{x:l,y:c}=n?yi(a,t):a;return{xSnapped:l,ySnapped:c,...a}}const Ol=e=>({width:e.offsetWidth,height:e.offsetHeight}),eh=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},lb=["INPUT","SELECT","TEXTAREA"];function th(e){var r,o;const t=((o=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:o[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:lb.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const nh=e=>"clientX"in e,Xt=(e,t)=>{var s,i;const n=nh(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,o=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},hu=(e,t,n,r,o)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(i=>{const a=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:o,position:i.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...Ol(i)}})};function rh({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:s,targetControlX:i,targetControlY:a}){const l=e*.125+o*.375+i*.375+n*.125,c=t*.125+s*.375+a*.375+r*.125,d=Math.abs(l-e),f=Math.abs(c-t);return[l,c,d,f]}function rs(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function pu({pos:e,x1:t,y1:n,x2:r,y2:o,c:s}){switch(e){case ae.Left:return[t-rs(t-r,s),n];case ae.Right:return[t+rs(r-t,s),n];case ae.Top:return[t,n-rs(n-o,s)];case ae.Bottom:return[t,n+rs(o-n,s)]}}function oh({sourceX:e,sourceY:t,sourcePosition:n=ae.Bottom,targetX:r,targetY:o,targetPosition:s=ae.Top,curvature:i=.25}){const[a,l]=pu({pos:n,x1:e,y1:t,x2:r,y2:o,c:i}),[c,d]=pu({pos:s,x1:r,y1:o,x2:e,y2:t,c:i}),[f,u,h,p]=rh({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${a},${l} ${c},${d} ${r},${o}`,f,u,h,p]}function sh({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,s=n<e?n+o:n-o,i=Math.abs(r-t)/2,a=r<t?r+i:r-i;return[s,a,o,i]}function cb({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:o=!1}){if(!o)return r;const s=n||t.selected||e.selected,i=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(s?i:0)}function ub({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const s=gi(Fs(e),Fs(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return bo(i,mi(s))>0}const db=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,fb=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),ih=(e,t)=>{if(!e.source||!e.target)return t;let n;return Gf(e)?n={...e}:n={...e,id:db(e)},fb(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function ah({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,s,i,a]=sh({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,s,i,a]}const gu={[ae.Left]:{x:-1,y:0},[ae.Right]:{x:1,y:0},[ae.Top]:{x:0,y:-1},[ae.Bottom]:{x:0,y:1}},hb=({source:e,sourcePosition:t=ae.Bottom,target:n})=>t===ae.Left||t===ae.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},mu=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function pb({source:e,sourcePosition:t=ae.Bottom,target:n,targetPosition:r=ae.Top,center:o,offset:s}){const i=gu[t],a=gu[r],l={x:e.x+i.x*s,y:e.y+i.y*s},c={x:n.x+a.x*s,y:n.y+a.y*s},d=hb({source:l,sourcePosition:t,target:c}),f=d.x!==0?"x":"y",u=d[f];let h=[],p,m;const g={x:0,y:0},y={x:0,y:0},[b,w,E,P]=sh({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[f]*a[f]===-1){p=o.x??b,m=o.y??w;const v=[{x:p,y:l.y},{x:p,y:c.y}],M=[{x:l.x,y:m},{x:c.x,y:m}];i[f]===u?h=f==="x"?v:M:h=f==="x"?M:v}else{const v=[{x:l.x,y:c.y}],M=[{x:c.x,y:l.y}];if(f==="x"?h=i.x===u?M:v:h=i.y===u?v:M,t===r){const j=Math.abs(e[f]-n[f]);if(j<=s){const R=Math.min(s-1,s-j);i[f]===u?g[f]=(l[f]>e[f]?-1:1)*R:y[f]=(c[f]>n[f]?-1:1)*R}}if(t!==r){const j=f==="x"?"y":"x",R=i[f]===a[j],O=l[j]>c[j],I=l[j]<c[j];(i[f]===1&&(!R&&O||R&&I)||i[f]!==1&&(!R&&I||R&&O))&&(h=f==="x"?v:M)}const N={x:l.x+g.x,y:l.y+g.y},_={x:c.x+y.x,y:c.y+y.y},D=Math.max(Math.abs(N.x-h[0].x),Math.abs(_.x-h[0].x)),B=Math.max(Math.abs(N.y-h[0].y),Math.abs(_.y-h[0].y));D>=B?(p=(N.x+_.x)/2,m=h[0].y):(p=h[0].x,m=(N.y+_.y)/2)}return[[e,{x:l.x+g.x,y:l.y+g.y},...h,{x:c.x+y.x,y:c.y+y.y},n],p,m,E,P]}function gb(e,t,n,r){const o=Math.min(mu(e,t)/2,mu(t,n)/2,r),{x:s,y:i}=t;if(e.x===s&&s===n.x||e.y===i&&i===n.y)return`L${s} ${i}`;if(e.y===i){const c=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${s+o*c},${i}Q ${s},${i} ${s},${i+o*d}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${s},${i+o*l}Q ${s},${i} ${s+o*a},${i}`}function ja({sourceX:e,sourceY:t,sourcePosition:n=ae.Bottom,targetX:r,targetY:o,targetPosition:s=ae.Top,borderRadius:i=5,centerX:a,centerY:l,offset:c=20}){const[d,f,u,h,p]=pb({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:s,center:{x:a,y:l},offset:c});return[d.reduce((g,y,b)=>{let w="";return b>0&&b<d.length-1?w=gb(d[b-1],y,d[b+1],i):w=`${b===0?"M":"L"}${y.x} ${y.y}`,g+=w,g},""),f,u,h,p]}function yu(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function mb(e){var f;const{sourceNode:t,targetNode:n}=e;if(!yu(t)||!yu(n))return null;const r=t.internals.handleBounds||wu(t.handles),o=n.internals.handleBounds||wu(n.handles),s=xu((r==null?void 0:r.source)??[],e.sourceHandle),i=xu(e.connectionMode===Cr.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),e.targetHandle);if(!s||!i)return(f=e.onError)==null||f.call(e,"008",It.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(s==null?void 0:s.position)||ae.Bottom,l=(i==null?void 0:i.position)||ae.Top,c=Ao(t,s,a),d=Ao(n,i,l);return{sourceX:c.x,sourceY:c.y,targetX:d.x,targetY:d.y,sourcePosition:a,targetPosition:l}}function wu(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function Ao(e,t,n=ae.Left,r=!1){const o=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,s=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:a}=t??tn(e);if(r)return{x:o+i/2,y:s+a/2};switch((t==null?void 0:t.position)??n){case ae.Top:return{x:o+i/2,y:s};case ae.Right:return{x:o+i,y:s+a/2};case ae.Bottom:return{x:o+i/2,y:s+a};case ae.Left:return{x:o,y:s+a/2}}}function xu(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function qa(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function yb(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const s=new Set;return e.reduce((i,a)=>([a.markerStart||r,a.markerEnd||o].forEach(l=>{if(l&&typeof l=="object"){const c=qa(l,t);s.has(c)||(i.push({id:c,color:l.color||n,...l}),s.add(c))}}),i),[]).sort((i,a)=>i.id.localeCompare(a.id))}const Ll={nodeOrigin:[0,0],nodeExtent:xo,elevateNodesOnSelect:!0,defaults:{}},wb={...Ll,checkEquality:!0};function Bl(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function xb(e,t,n){const r=Bl(Ll,n);for(const o of e.values())if(o.parentId)Fl(o,e,t,r);else{const s=Lo(o,r.nodeOrigin),i=Ir(o.extent)?o.extent:r.nodeExtent,a=Hn(s,i,tn(o));o.internals.positionAbsolute=a}}function za(e,t,n,r){var l,c;const o=Bl(wb,r);let s=e.length>0;const i=new Map(t),a=o!=null&&o.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const d of e){let f=i.get(d.id);if(o.checkEquality&&d===(f==null?void 0:f.internals.userNode))t.set(d.id,f);else{const u=Lo(d,o.nodeOrigin),h=Ir(d.extent)?d.extent:o.nodeExtent,p=Hn(u,h,tn(d));f={...o.defaults,...d,measured:{width:(l=d.measured)==null?void 0:l.width,height:(c=d.measured)==null?void 0:c.height},internals:{positionAbsolute:p,handleBounds:d.measured?f==null?void 0:f.internals.handleBounds:void 0,z:lh(d,a),userNode:d}},t.set(d.id,f)}(f.measured===void 0||f.measured.width===void 0||f.measured.height===void 0)&&!f.hidden&&(s=!1),d.parentId&&Fl(f,t,n,r)}return s}function vb(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Fl(e,t,n,r){const{elevateNodesOnSelect:o,nodeOrigin:s,nodeExtent:i}=Bl(Ll,r),a=e.parentId,l=t.get(a);if(!l){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}vb(e,n);const c=o?1e3:0,{x:d,y:f,z:u}=bb(e,l,s,i,c),{positionAbsolute:h}=e.internals,p=d!==h.x||f!==h.y;(p||u!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:p?{x:d,y:f}:h,z:u}})}function lh(e,t){return(Rt(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function bb(e,t,n,r,o){const{x:s,y:i}=t.internals.positionAbsolute,a=tn(e),l=Lo(e,n),c=Ir(e.extent)?Hn(l,e.extent,a):l;let d=Hn({x:s+c.x,y:i+c.y},r,a);e.extent==="parent"&&(d=Yf(d,a,t));const f=lh(e,o),u=t.internals.z??0;return{x:d.x,y:d.y,z:u>f?u:f}}function jl(e,t,n,r=[0,0]){var i;const o=[],s=new Map;for(const a of e){const l=t.get(a.parentId);if(!l)continue;const c=((i=s.get(a.parentId))==null?void 0:i.expandedRect)??Pr(l),d=Qf(c,a.rect);s.set(a.parentId,{expandedRect:d,parent:l})}return s.size>0&&s.forEach(({expandedRect:a,parent:l},c)=>{var w;const d=l.internals.positionAbsolute,f=tn(l),u=l.origin??r,h=a.x<d.x?Math.round(Math.abs(d.x-a.x)):0,p=a.y<d.y?Math.round(Math.abs(d.y-a.y)):0,m=Math.max(f.width,Math.round(a.width)),g=Math.max(f.height,Math.round(a.height)),y=(m-f.width)*u[0],b=(g-f.height)*u[1];(h>0||p>0||y||b)&&(o.push({id:c,type:"position",position:{x:l.position.x-h+y,y:l.position.y-p+b}}),(w=n.get(c))==null||w.forEach(E=>{e.some(P=>P.id===E.id)||o.push({id:E.id,type:"position",position:{x:E.position.x+h,y:E.position.y+p}})})),(f.width<a.width||f.height<a.height||h||p)&&o.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:m+(h?u[0]*h-y:0),height:g+(p?u[1]*p-b:0)}})}),o}function Ab(e,t,n,r,o,s){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let a=!1;if(!i)return{changes:[],updatedInternals:a};const l=[],c=window.getComputedStyle(i),{m22:d}=new window.DOMMatrixReadOnly(c.transform),f=[];for(const u of e.values()){const h=t.get(u.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}const p=Ol(u.nodeElement),m=h.measured.width!==p.width||h.measured.height!==p.height;if(!!(p.width&&p.height&&(m||!h.internals.handleBounds||u.force))){const y=u.nodeElement.getBoundingClientRect(),b=Ir(h.extent)?h.extent:s;let{positionAbsolute:w}=h.internals;h.parentId&&h.extent==="parent"?w=Yf(w,p,t.get(h.parentId)):b&&(w=Hn(w,b,p));const E={...h,measured:p,internals:{...h.internals,positionAbsolute:w,handleBounds:{source:hu("source",u.nodeElement,y,d,h.id),target:hu("target",u.nodeElement,y,d,h.id)}}};t.set(h.id,E),h.parentId&&Fl(E,t,n,{nodeOrigin:o}),a=!0,m&&(l.push({id:h.id,type:"dimensions",dimensions:p}),h.expandParent&&h.parentId&&f.push({id:h.id,parentId:h.parentId,rect:Pr(E,o)}))}}if(f.length>0){const u=jl(f,t,n,o);l.push(...u)}return{changes:l,updatedInternals:a}}async function Eb({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,s]],r),a=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(a)}function vu(e,t,n,r,o,s){let i=o;const a=r.get(i)||new Map;r.set(i,a.set(n,t)),i=`${o}-${e}`;const l=r.get(i)||new Map;if(r.set(i,l.set(n,t)),s){i=`${o}-${e}-${s}`;const c=r.get(i)||new Map;r.set(i,c.set(n,t))}}function ch(e,t,n){e.clear(),t.clear();for(const r of n){const{source:o,target:s,sourceHandle:i=null,targetHandle:a=null}=r,l={edgeId:r.id,source:o,target:s,sourceHandle:i,targetHandle:a},c=`${o}-${i}--${s}-${a}`,d=`${s}-${a}--${o}-${i}`;vu("source",l,d,e,o,i),vu("target",l,c,e,s,a),t.set(r.id,r)}}function uh(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:uh(n,t):!1}function bu(e,t,n){var o;let r=e;do{if((o=r==null?void 0:r.matches)!=null&&o.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function Sb(e,t,n,r){const o=new Map;for(const[s,i]of e)if((i.selected||i.id===r)&&(!i.parentId||!uh(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const a=e.get(s);a&&o.set(s,{id:s,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return o}function na({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var i,a,l;const o=[];for(const[c,d]of t){const f=(i=n.get(c))==null?void 0:i.internals.userNode;f&&o.push({...f,position:d.position,dragging:r})}if(!e)return[o[0],o];const s=(a=n.get(e))==null?void 0:a.internals.userNode;return[s?{...s,position:((l=t.get(e))==null?void 0:l.position)||s.position,dragging:r}:o[0],o]}function Mb({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let s={x:null,y:null},i=0,a=new Map,l=!1,c={x:0,y:0},d=null,f=!1,u=null,h=!1;function p({noDragClassName:g,handleSelector:y,domNode:b,isSelectable:w,nodeId:E,nodeClickDistance:P=0}){u=et(b);function A({x:_,y:D},B){const{nodeLookup:j,nodeExtent:R,snapGrid:O,snapToGrid:I,nodeOrigin:k,onNodeDrag:F,onSelectionDrag:T,onError:z,updateNodePositions:V}=t();s={x:_,y:D};let U=!1,K={x:0,y:0,x2:0,y2:0};if(a.size>1&&R){const Y=Bo(a);K=Fa(Y)}for(const[Y,ee]of a){if(!j.has(Y))continue;let Z={x:_-ee.distance.x,y:D-ee.distance.y};I&&(Z=yi(Z,O));let q=[[R[0][0],R[0][1]],[R[1][0],R[1][1]]];if(a.size>1&&R&&!ee.extent){const{positionAbsolute:se}=ee.internals,oe=se.x-K.x+R[0][0],ne=se.x+ee.measured.width-K.x2+R[1][0],J=se.y-K.y+R[0][1],re=se.y+ee.measured.height-K.y2+R[1][1];q=[[oe,J],[ne,re]]}const{position:W,positionAbsolute:te}=Wf({nodeId:Y,nextPosition:Z,nodeLookup:j,nodeExtent:q,nodeOrigin:k,onError:z});U=U||ee.position.x!==W.x||ee.position.y!==W.y,ee.position=W,ee.internals.positionAbsolute=te}if(U&&(V(a,!0),B&&(r||F||!E&&T))){const[Y,ee]=na({nodeId:E,dragItems:a,nodeLookup:j});r==null||r(B,a,Y,ee),F==null||F(B,Y,ee),E||T==null||T(B,ee)}}async function v(){if(!d)return;const{transform:_,panBy:D,autoPanSpeed:B,autoPanOnNodeDrag:j}=t();if(!j){l=!1,cancelAnimationFrame(i);return}const[R,O]=Xf(c,d,B);(R!==0||O!==0)&&(s.x=(s.x??0)-R/_[2],s.y=(s.y??0)-O/_[2],await D({x:R,y:O})&&A(s,null)),i=requestAnimationFrame(v)}function M(_){var U;const{nodeLookup:D,multiSelectionActive:B,nodesDraggable:j,transform:R,snapGrid:O,snapToGrid:I,selectNodesOnDrag:k,onNodeDragStart:F,onSelectionDragStart:T,unselectNodesAndEdges:z}=t();f=!0,(!k||!w)&&!B&&E&&((U=D.get(E))!=null&&U.selected||z()),w&&k&&E&&(e==null||e(E));const V=so(_.sourceEvent,{transform:R,snapGrid:O,snapToGrid:I,containerBounds:d});if(s=V,a=Sb(D,j,V,E),a.size>0&&(n||F||!E&&T)){const[K,Y]=na({nodeId:E,dragItems:a,nodeLookup:D});n==null||n(_.sourceEvent,a,K,Y),F==null||F(_.sourceEvent,K,Y),E||T==null||T(_.sourceEvent,Y)}}const N=Rf().clickDistance(P).on("start",_=>{const{domNode:D,nodeDragThreshold:B,transform:j,snapGrid:R,snapToGrid:O}=t();d=(D==null?void 0:D.getBoundingClientRect())||null,h=!1,B===0&&M(_),s=so(_.sourceEvent,{transform:j,snapGrid:R,snapToGrid:O,containerBounds:d}),c=Xt(_.sourceEvent,d)}).on("drag",_=>{const{autoPanOnNodeDrag:D,transform:B,snapGrid:j,snapToGrid:R,nodeDragThreshold:O,nodeLookup:I}=t(),k=so(_.sourceEvent,{transform:B,snapGrid:j,snapToGrid:R,containerBounds:d});if((_.sourceEvent.type==="touchmove"&&_.sourceEvent.touches.length>1||E&&!I.has(E))&&(h=!0),!h){if(!l&&D&&f&&(l=!0,v()),!f){const F=k.xSnapped-(s.x??0),T=k.ySnapped-(s.y??0);Math.sqrt(F*F+T*T)>O&&M(_)}(s.x!==k.xSnapped||s.y!==k.ySnapped)&&a&&f&&(c=Xt(_.sourceEvent,d),A(k,_.sourceEvent))}}).on("end",_=>{if(!(!f||h)&&(l=!1,f=!1,cancelAnimationFrame(i),a.size>0)){const{nodeLookup:D,updateNodePositions:B,onNodeDragStop:j,onSelectionDragStop:R}=t();if(B(a,!1),o||j||!E&&R){const[O,I]=na({nodeId:E,dragItems:a,nodeLookup:D,dragging:!1});o==null||o(_.sourceEvent,a,O,I),j==null||j(_.sourceEvent,O,I),E||R==null||R(_.sourceEvent,I)}}}).filter(_=>{const D=_.target;return!_.button&&(!g||!bu(D,`.${g}`,b))&&(!y||bu(D,y,b))});u.call(N)}function m(){u==null||u.on(".drag",null)}return{update:p,destroy:m}}function Cb(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())bo(o,Pr(s))>0&&r.push(s);return r}const Rb=250;function Pb(e,t,n,r){var a,l;let o=[],s=1/0;const i=Cb(e,n,t+Rb);for(const c of i){const d=[...((a=c.internals.handleBounds)==null?void 0:a.source)??[],...((l=c.internals.handleBounds)==null?void 0:l.target)??[]];for(const f of d){if(r.nodeId===f.nodeId&&r.type===f.type&&r.id===f.id)continue;const{x:u,y:h}=Ao(c,f,f.position,!0),p=Math.sqrt(Math.pow(u-e.x,2)+Math.pow(h-e.y,2));p>t||(p<s?(o=[{...f,x:u,y:h}],s=p):p===s&&o.push({...f,x:u,y:h}))}}if(!o.length)return null;if(o.length>1){const c=r.type==="source"?"target":"source";return o.find(d=>d.type===c)??o[0]}return o[0]}function dh(e,t,n,r,o,s=!1){var c,d,f;const i=r.get(e);if(!i)return null;const a=o==="strict"?(c=i.internals.handleBounds)==null?void 0:c[t]:[...((d=i.internals.handleBounds)==null?void 0:d.source)??[],...((f=i.internals.handleBounds)==null?void 0:f.target)??[]],l=(n?a==null?void 0:a.find(u=>u.id===n):a==null?void 0:a[0])??null;return l&&s?{...l,...Ao(i,l,l.position,!0)}:l}function fh(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Ib(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const hh=()=>!0;function Nb(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:s,isTarget:i,domNode:a,nodeLookup:l,lib:c,autoPanOnConnect:d,flowId:f,panBy:u,cancelConnection:h,onConnectStart:p,onConnect:m,onConnectEnd:g,isValidConnection:y=hh,onReconnectEnd:b,updateConnection:w,getTransform:E,getFromHandle:P,autoPanSpeed:A}){const v=eh(e.target);let M=0,N;const{x:_,y:D}=Xt(e),B=v==null?void 0:v.elementFromPoint(_,D),j=fh(s,B),R=a==null?void 0:a.getBoundingClientRect();if(!R||!j)return;const O=dh(o,j,r,l,t);if(!O)return;let I=Xt(e,R),k=!1,F=null,T=!1,z=null;function V(){if(!d||!R)return;const[te,se]=Xf(I,R,A);u({x:te,y:se}),M=requestAnimationFrame(V)}const U={...O,nodeId:o,type:j,position:O.position},K=l.get(o),ee={inProgress:!0,isValid:null,from:Ao(K,U,ae.Left,!0),fromHandle:U,fromPosition:U.position,fromNode:K,to:I,toHandle:null,toPosition:lu[U.position],toNode:null};w(ee);let Z=ee;p==null||p(e,{nodeId:o,handleId:r,handleType:j});function q(te){if(!P()||!U){W(te);return}const se=E();I=Xt(te,R),N=Pb(Fo(I,se,!1,[1,1]),n,l,U),k||(V(),k=!0);const oe=ph(te,{handle:N,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:i?"target":"source",isValidConnection:y,doc:v,lib:c,flowId:f,nodeLookup:l});z=oe.handleDomNode,F=oe.connection,T=Ib(!!N,oe.isValid);const ne={...Z,isValid:T,to:N&&T?js({x:N.x,y:N.y},se):I,toHandle:oe.toHandle,toPosition:T&&oe.toHandle?oe.toHandle.position:lu[U.position],toNode:oe.toHandle?l.get(oe.toHandle.nodeId):null};T&&N&&Z.toHandle&&ne.toHandle&&Z.toHandle.type===ne.toHandle.type&&Z.toHandle.nodeId===ne.toHandle.nodeId&&Z.toHandle.id===ne.toHandle.id&&Z.to.x===ne.to.x&&Z.to.y===ne.to.y||(w(ne),Z=ne)}function W(te){(N||z)&&F&&T&&(m==null||m(F));const{inProgress:se,...oe}=Z,ne={...oe,toPosition:Z.toHandle?Z.toPosition:null};g==null||g(te,ne),s&&(b==null||b(te,ne)),h(),cancelAnimationFrame(M),k=!1,T=!1,F=null,z=null,v.removeEventListener("mousemove",q),v.removeEventListener("mouseup",W),v.removeEventListener("touchmove",q),v.removeEventListener("touchend",W)}v.addEventListener("mousemove",q),v.addEventListener("mouseup",W),v.addEventListener("touchmove",q),v.addEventListener("touchend",W)}function ph(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:s,doc:i,lib:a,flowId:l,isValidConnection:c=hh,nodeLookup:d}){const f=s==="target",u=t?i.querySelector(`.${a}-flow__handle[data-id="${l}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y:p}=Xt(e),m=i.elementFromPoint(h,p),g=m!=null&&m.classList.contains(`${a}-flow__handle`)?m:u,y={handleDomNode:g,isValid:!1,connection:null,toHandle:null};if(g){const b=fh(void 0,g),w=g.getAttribute("data-nodeid"),E=g.getAttribute("data-handleid"),P=g.classList.contains("connectable"),A=g.classList.contains("connectableend");if(!w||!b)return y;const v={source:f?w:r,sourceHandle:f?E:o,target:f?r:w,targetHandle:f?o:E};y.connection=v;const N=P&&A&&(n===Cr.Strict?f&&b==="source"||!f&&b==="target":w!==r||E!==o);y.isValid=N&&c(v),y.toHandle=dh(w,b,E,d,n,!1)}return y}const Ha={onPointerDown:Nb,isValid:ph};function Tb({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=et(e);function s({translateExtent:a,width:l,height:c,zoomStep:d=10,pannable:f=!0,zoomable:u=!0,inversePan:h=!1}){const p=w=>{const E=n();if(w.sourceEvent.type!=="wheel"||!t)return;const P=-w.sourceEvent.deltaY*(w.sourceEvent.deltaMode===1?.05:w.sourceEvent.deltaMode?1:.002)*d,A=E[2]*Math.pow(2,P);t.scaleTo(A)};let m=[0,0];const g=w=>{(w.sourceEvent.type==="mousedown"||w.sourceEvent.type==="touchstart")&&(m=[w.sourceEvent.clientX??w.sourceEvent.touches[0].clientX,w.sourceEvent.clientY??w.sourceEvent.touches[0].clientY])},y=w=>{const E=n();if(w.sourceEvent.type!=="mousemove"&&w.sourceEvent.type!=="touchmove"||!t)return;const P=[w.sourceEvent.clientX??w.sourceEvent.touches[0].clientX,w.sourceEvent.clientY??w.sourceEvent.touches[0].clientY],A=[P[0]-m[0],P[1]-m[1]];m=P;const v=r()*Math.max(E[2],Math.log(E[2]))*(h?-1:1),M={x:E[0]-A[0]*v,y:E[1]-A[1]*v},N=[[0,0],[l,c]];t.setViewportConstrained({x:M.x,y:M.y,zoom:E[2]},N,a)},b=Hf().on("start",g).on("zoom",f?y:null).on("zoom.wheel",u?p:null);o.call(b,{})}function i(){o.on("zoom",null)}return{update:s,destroy:i,pointer:Mt}}const _b=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,wi=e=>({x:e.x,y:e.y,zoom:e.k}),ra=({x:e,y:t,zoom:n})=>pi.translate(e,t).scale(n),mr=(e,t)=>e.target.closest(`.${t}`),gh=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),oa=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},mh=e=>{const t=e.ctrlKey&&qs()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function kb({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:c}){return d=>{if(mr(d,t))return!1;d.preventDefault(),d.stopImmediatePropagation();const f=n.property("__zoom").k||1;if(d.ctrlKey&&i){const g=Mt(d),y=mh(d),b=f*Math.pow(2,y);r.scaleTo(n,b,g,d);return}const u=d.deltaMode===1?20:1;let h=o===Ln.Vertical?0:d.deltaX*u,p=o===Ln.Horizontal?0:d.deltaY*u;!qs()&&d.shiftKey&&o!==Ln.Vertical&&(h=d.deltaY*u,p=0),r.translateBy(n,-(h/f)*s,-(p/f)*s,{internal:!0});const m=wi(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(d,m)),e.isPanScrolling&&(l==null||l(d,m),e.panScrollTimeout=setTimeout(()=>{c==null||c(d,m),e.isPanScrolling=!1},150))}}function Db({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){const s=r.type==="wheel",i=!t&&s&&!r.ctrlKey,a=mr(r,e);if(r.ctrlKey&&s&&a&&r.preventDefault(),i||a)return null;r.preventDefault(),n.call(this,r,o)}}function Ob({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var s,i,a;if((s=r.sourceEvent)!=null&&s.internal)return;const o=wi(r.transform);e.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=o,((a=r.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,o))}}function Lb({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return s=>{var i,a;e.usedRightMouseButton=!!(n&&gh(t,e.mouseButton??0)),(i=s.sourceEvent)!=null&&i.sync||r([s.transform.x,s.transform.y,s.transform.k]),o&&!((a=s.sourceEvent)!=null&&a.internal)&&(o==null||o(s.sourceEvent,wi(s.transform)))}}function Bb({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:s}){return i=>{var a;if(!((a=i.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,s&&gh(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),e.usedRightMouseButton=!1,r(!1),o&&_b(e.prevViewport,i.transform))){const l=wi(i.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o==null||o(i.sourceEvent,l)},n?150:0)}}}function Fb({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:a,noPanClassName:l,lib:c}){return d=>{var p;const f=e||t,u=n&&d.ctrlKey;if(d.button===1&&d.type==="mousedown"&&(mr(d,`${c}-flow__node`)||mr(d,`${c}-flow__edge`)))return!0;if(!r&&!f&&!o&&!s&&!n||i||mr(d,a)&&d.type==="wheel"||mr(d,l)&&(d.type!=="wheel"||o&&d.type==="wheel"&&!e)||!n&&d.ctrlKey&&d.type==="wheel")return!1;if(!n&&d.type==="touchstart"&&((p=d.touches)==null?void 0:p.length)>1)return d.preventDefault(),!1;if(!f&&!o&&!u&&d.type==="wheel"||!r&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(r)&&!r.includes(d.button)&&d.type==="mousedown")return!1;const h=Array.isArray(r)&&r.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||d.type==="wheel")&&h}}function jb({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:o,viewport:s,onPanZoom:i,onPanZoomStart:a,onPanZoomEnd:l,onDraggingChange:c}){const d={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},f=e.getBoundingClientRect(),u=Hf().clickDistance(!Rt(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(o),h=et(e).call(u);w({x:s.x,y:s.y,zoom:Rr(s.zoom,t,n)},[[0,0],[f.width,f.height]],o);const p=h.on("wheel.zoom"),m=h.on("dblclick.zoom");u.wheelDelta(mh);function g(B,j){return h?new Promise(R=>{u==null||u.transform(oa(h,j==null?void 0:j.duration,()=>R(!0)),B)}):Promise.resolve(!1)}function y({noWheelClassName:B,noPanClassName:j,onPaneContextMenu:R,userSelectionActive:O,panOnScroll:I,panOnDrag:k,panOnScrollMode:F,panOnScrollSpeed:T,preventScrolling:z,zoomOnPinch:V,zoomOnScroll:U,zoomOnDoubleClick:K,zoomActivationKeyPressed:Y,lib:ee,onTransformChange:Z}){O&&!d.isZoomingOrPanning&&b();const W=I&&!Y&&!O?kb({zoomPanValues:d,noWheelClassName:B,d3Selection:h,d3Zoom:u,panOnScrollMode:F,panOnScrollSpeed:T,zoomOnPinch:V,onPanZoomStart:a,onPanZoom:i,onPanZoomEnd:l}):Db({noWheelClassName:B,preventScrolling:z,d3ZoomHandler:p});if(h.on("wheel.zoom",W,{passive:!1}),!O){const se=Ob({zoomPanValues:d,onDraggingChange:c,onPanZoomStart:a});u.on("start",se);const oe=Lb({zoomPanValues:d,panOnDrag:k,onPaneContextMenu:!!R,onPanZoom:i,onTransformChange:Z});u.on("zoom",oe);const ne=Bb({zoomPanValues:d,panOnDrag:k,panOnScroll:I,onPaneContextMenu:R,onPanZoomEnd:l,onDraggingChange:c});u.on("end",ne)}const te=Fb({zoomActivationKeyPressed:Y,panOnDrag:k,zoomOnScroll:U,panOnScroll:I,zoomOnDoubleClick:K,zoomOnPinch:V,userSelectionActive:O,noPanClassName:j,noWheelClassName:B,lib:ee});u.filter(te),K?h.on("dblclick.zoom",m):h.on("dblclick.zoom",null)}function b(){u.on("zoom",null)}async function w(B,j,R){const O=ra(B),I=u==null?void 0:u.constrain()(O,j,R);return I&&await g(I),new Promise(k=>k(I))}async function E(B,j){const R=ra(B);return await g(R,j),new Promise(O=>O(R))}function P(B){if(h){const j=ra(B),R=h.property("__zoom");(R.k!==B.zoom||R.x!==B.x||R.y!==B.y)&&(u==null||u.transform(h,j,null,{sync:!0}))}}function A(){const B=h?zf(h.node()):{x:0,y:0,k:1};return{x:B.x,y:B.y,zoom:B.k}}function v(B,j){return h?new Promise(R=>{u==null||u.scaleTo(oa(h,j==null?void 0:j.duration,()=>R(!0)),B)}):Promise.resolve(!1)}function M(B,j){return h?new Promise(R=>{u==null||u.scaleBy(oa(h,j==null?void 0:j.duration,()=>R(!0)),B)}):Promise.resolve(!1)}function N(B){u==null||u.scaleExtent(B)}function _(B){u==null||u.translateExtent(B)}function D(B){const j=!Rt(B)||B<0?0:B;u==null||u.clickDistance(j)}return{update:y,destroy:b,setViewport:E,setViewportConstrained:w,getViewport:A,scaleTo:v,scaleBy:M,setScaleExtent:N,setTranslateExtent:_,syncViewport:P,setClickDistance:D}}var io;(function(e){e.Line="line",e.Handle="handle"})(io||(io={}));function qb({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:s}){const i=e-t,a=n-r,l=[i>0?1:i<0?-1:0,a>0?1:a<0?-1:0];return i&&o&&(l[0]=l[0]*-1),a&&s&&(l[1]=l[1]*-1),l}function zb(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:o}}function on(e,t){return Math.max(0,t-e)}function sn(e,t){return Math.max(0,e-t)}function os(e,t,n){return Math.max(0,t-e,e-n)}function Au(e,t){return e?!t:t}function Hb(e,t,n,r,o,s,i,a){let{affectsX:l,affectsY:c}=t;const{isHorizontal:d,isVertical:f}=t,u=d&&f,{xSnapped:h,ySnapped:p}=n,{minWidth:m,maxWidth:g,minHeight:y,maxHeight:b}=r,{x:w,y:E,width:P,height:A,aspectRatio:v}=e;let M=Math.floor(d?h-e.pointerX:0),N=Math.floor(f?p-e.pointerY:0);const _=P+(l?-M:M),D=A+(c?-N:N),B=-s[0]*P,j=-s[1]*A;let R=os(_,m,g),O=os(D,y,b);if(i){let F=0,T=0;l&&M<0?F=on(w+M+B,i[0][0]):!l&&M>0&&(F=sn(w+_+B,i[1][0])),c&&N<0?T=on(E+N+j,i[0][1]):!c&&N>0&&(T=sn(E+D+j,i[1][1])),R=Math.max(R,F),O=Math.max(O,T)}if(a){let F=0,T=0;l&&M>0?F=sn(w+M,a[0][0]):!l&&M<0&&(F=on(w+_,a[1][0])),c&&N>0?T=sn(E+N,a[0][1]):!c&&N<0&&(T=on(E+D,a[1][1])),R=Math.max(R,F),O=Math.max(O,T)}if(o){if(d){const F=os(_/v,y,b)*v;if(R=Math.max(R,F),i){let T=0;!l&&!c||l&&!c&&u?T=sn(E+j+_/v,i[1][1])*v:T=on(E+j+(l?M:-M)/v,i[0][1])*v,R=Math.max(R,T)}if(a){let T=0;!l&&!c||l&&!c&&u?T=on(E+_/v,a[1][1])*v:T=sn(E+(l?M:-M)/v,a[0][1])*v,R=Math.max(R,T)}}if(f){const F=os(D*v,m,g)/v;if(O=Math.max(O,F),i){let T=0;!l&&!c||c&&!l&&u?T=sn(w+D*v+B,i[1][0])/v:T=on(w+(c?N:-N)*v+B,i[0][0])/v,O=Math.max(O,T)}if(a){let T=0;!l&&!c||c&&!l&&u?T=on(w+D*v,a[1][0])/v:T=sn(w+(c?N:-N)*v,a[0][0])/v,O=Math.max(O,T)}}}N=N+(N<0?O:-O),M=M+(M<0?R:-R),o&&(u?_>D*v?N=(Au(l,c)?-M:M)/v:M=(Au(l,c)?-N:N)*v:d?(N=M/v,c=l):(M=N*v,l=c));const I=l?w+M:w,k=c?E+N:E;return{width:P+(l?-M:M),height:A+(c?-N:N),x:s[0]*M*(l?-1:1)+I,y:s[1]*N*(c?-1:1)+k}}const yh={width:0,height:0,x:0,y:0},Vb={...yh,pointerX:0,pointerY:0,aspectRatio:1};function Ub(e){return[[0,0],[e.measured.width,e.measured.height]]}function $b(e,t,n){const r=t.position.x+e.position.x,o=t.position.y+e.position.y,s=e.measured.width??0,i=e.measured.height??0,a=n[0]*s,l=n[1]*i;return[[r-a,o-l],[r+s-a,o+i-l]]}function Gb({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){const s=et(e);function i({controlPosition:l,boundaries:c,keepAspectRatio:d,resizeDirection:f,onResizeStart:u,onResize:h,onResizeEnd:p,shouldResize:m}){let g={...yh},y={...Vb};const b=zb(l);let w,E=null,P=[],A,v,M;const N=Rf().on("start",_=>{const{nodeLookup:D,transform:B,snapGrid:j,snapToGrid:R,nodeOrigin:O,paneDomNode:I}=n();if(w=D.get(t),!w)return;E=(I==null?void 0:I.getBoundingClientRect())??null;const{xSnapped:k,ySnapped:F}=so(_.sourceEvent,{transform:B,snapGrid:j,snapToGrid:R,containerBounds:E});g={width:w.measured.width??0,height:w.measured.height??0,x:w.position.x??0,y:w.position.y??0},y={...g,pointerX:k,pointerY:F,aspectRatio:g.width/g.height},A=void 0,w.parentId&&(w.extent==="parent"||w.expandParent)&&(A=D.get(w.parentId),v=A&&w.extent==="parent"?Ub(A):void 0),P=[],M=void 0;for(const[T,z]of D)if(z.parentId===t&&(P.push({id:T,position:{...z.position},extent:z.extent}),z.extent==="parent"||z.expandParent)){const V=$b(z,w,z.origin??O);M?M=[[Math.min(V[0][0],M[0][0]),Math.min(V[0][1],M[0][1])],[Math.max(V[1][0],M[1][0]),Math.max(V[1][1],M[1][1])]]:M=V}u==null||u(_,{...g})}).on("drag",_=>{const{transform:D,snapGrid:B,snapToGrid:j,nodeOrigin:R}=n(),O=so(_.sourceEvent,{transform:D,snapGrid:B,snapToGrid:j,containerBounds:E}),I=[];if(!w)return;const{x:k,y:F,width:T,height:z}=g,V={},U=w.origin??R,{width:K,height:Y,x:ee,y:Z}=Hb(y,b,O,c,d,U,v,M),q=K!==T,W=Y!==z,te=ee!==k&&q,se=Z!==F&&W;if(!te&&!se&&!q&&!W)return;if((te||se||U[0]===1||U[1]===1)&&(V.x=te?ee:g.x,V.y=se?Z:g.y,g.x=V.x,g.y=V.y,P.length>0)){const re=ee-k,le=Z-F;for(const ce of P)ce.position={x:ce.position.x-re+U[0]*(K-T),y:ce.position.y-le+U[1]*(Y-z)},I.push(ce)}if((q||W)&&(V.width=q&&(!f||f==="horizontal")?K:g.width,V.height=W&&(!f||f==="vertical")?Y:g.height,g.width=V.width,g.height=V.height),A&&w.expandParent){const re=U[0]*(V.width??0);V.x&&V.x<re&&(g.x=re,y.x=y.x-(V.x-re));const le=U[1]*(V.height??0);V.y&&V.y<le&&(g.y=le,y.y=y.y-(V.y-le))}const oe=qb({width:g.width,prevWidth:T,height:g.height,prevHeight:z,affectsX:b.affectsX,affectsY:b.affectsY}),ne={...g,direction:oe};(m==null?void 0:m(_,ne))!==!1&&(h==null||h(_,ne),r(V,I))}).on("end",_=>{p==null||p(_,{...g}),o==null||o({...g})});s.call(N)}function a(){s.on(".drag",null)}return{update:i,destroy:a}}var sa={exports:{}},ia={},aa={exports:{}},la={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eu;function Kb(){if(Eu)return la;Eu=1;var e=Hd();function t(f,u){return f===u&&(f!==0||1/f===1/u)||f!==f&&u!==u}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,o=e.useEffect,s=e.useLayoutEffect,i=e.useDebugValue;function a(f,u){var h=u(),p=r({inst:{value:h,getSnapshot:u}}),m=p[0].inst,g=p[1];return s(function(){m.value=h,m.getSnapshot=u,l(m)&&g({inst:m})},[f,h,u]),o(function(){return l(m)&&g({inst:m}),f(function(){l(m)&&g({inst:m})})},[f]),i(h),h}function l(f){var u=f.getSnapshot;f=f.value;try{var h=u();return!n(f,h)}catch{return!0}}function c(f,u){return u()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return la.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,la}var Su;function Wb(){return Su||(Su=1,aa.exports=Kb()),aa.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mu;function Yb(){if(Mu)return ia;Mu=1;var e=Hd(),t=Wb();function n(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var r=typeof Object.is=="function"?Object.is:n,o=t.useSyncExternalStore,s=e.useRef,i=e.useEffect,a=e.useMemo,l=e.useDebugValue;return ia.useSyncExternalStoreWithSelector=function(c,d,f,u,h){var p=s(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=a(function(){function y(A){if(!b){if(b=!0,w=A,A=u(A),h!==void 0&&m.hasValue){var v=m.value;if(h(v,A))return E=v}return E=A}if(v=E,r(w,A))return v;var M=u(A);return h!==void 0&&h(v,M)?(w=A,v):(w=A,E=M)}var b=!1,w,E,P=f===void 0?null:f;return[function(){return y(d())},P===null?void 0:function(){return y(P())}]},[d,f,u,h]);var g=o(c,p[0],p[1]);return i(function(){m.hasValue=!0,m.value=g},[g]),l(g),g},ia}var Cu;function Xb(){return Cu||(Cu=1,sa.exports=Yb()),sa.exports}var Qb=Xb();const Zb=q0(Qb),Jb={},Ru=e=>{let t;const n=new Set,r=(d,f)=>{const u=typeof d=="function"?d(t):d;if(!Object.is(u,t)){const h=t;t=f??(typeof u!="object"||u===null)?u:Object.assign({},t,u),n.forEach(p=>p(t,h))}},o=()=>t,l={setState:r,getState:o,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(Jb?"gh-pages":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(r,o,l);return l},e1=e=>e?Ru(e):Ru,{useDebugValue:t1}=St,{useSyncExternalStoreWithSelector:n1}=Zb,r1=e=>e;function wh(e,t=r1,n){const r=n1(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return t1(r),r}const Pu=(e,t)=>{const n=e1(e),r=(o,s=t)=>wh(n,o,s);return Object.assign(r,n),r},o1=(e,t)=>e?Pu(e,t):Pu;function Ne(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const xi=x.createContext(null),s1=xi.Provider,xh=It.error001();function ge(e,t){const n=x.useContext(xi);if(n===null)throw new Error(xh);return wh(n,e,t)}function Se(){const e=x.useContext(xi);if(e===null)throw new Error(xh);return x.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Iu={display:"none"},i1={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},vh="react-flow__node-desc",bh="react-flow__edge-desc",a1="react-flow__aria-live",l1=e=>e.ariaLiveMessage;function c1({rfId:e}){const t=ge(l1);return S.jsx("div",{id:`${a1}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:i1,children:t})}function u1({rfId:e,disableKeyboardA11y:t}){return S.jsxs(S.Fragment,{children:[S.jsxs("div",{id:`${vh}-${e}`,style:Iu,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),S.jsx("div",{id:`${bh}-${e}`,style:Iu,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&S.jsx(c1,{rfId:e})]})}const d1=e=>e.userSelectionActive?"none":"all",nn=x.forwardRef(({position:e="top-left",children:t,className:n,style:r,...o},s)=>{const i=ge(d1),a=`${e}`.split("-");return S.jsx("div",{className:_e(["react-flow__panel",n,...a]),style:{...r,pointerEvents:i},ref:s,...o,children:t})});nn.displayName="Panel";function f1({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:S.jsx(nn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:S.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const h1=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},ss=e=>e.id;function p1(e,t){return Ne(e.selectedNodes.map(ss),t.selectedNodes.map(ss))&&Ne(e.selectedEdges.map(ss),t.selectedEdges.map(ss))}function g1({onSelectionChange:e}){const t=Se(),{selectedNodes:n,selectedEdges:r}=ge(h1,p1);return x.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChangeHandlers.forEach(s=>s(o))},[n,r,e]),null}const m1=e=>!!e.onSelectionChangeHandlers;function y1({onSelectionChange:e}){const t=ge(m1);return e||t?S.jsx(g1,{onSelectionChange:e}):null}const Ah=[0,0],w1={x:0,y:0,zoom:1},x1=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],Nu=[...x1,"rfId"],v1=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Tu={translateExtent:xo,nodeOrigin:Ah,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function b1(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:o,setTranslateExtent:s,setNodeExtent:i,reset:a,setDefaultNodesAndEdges:l,setPaneClickDistance:c}=ge(v1,Ne),d=Se();x.useEffect(()=>(l(e.defaultNodes,e.defaultEdges),()=>{f.current=Tu,a()}),[]);const f=x.useRef(Tu);return x.useEffect(()=>{for(const u of Nu){const h=e[u],p=f.current[u];h!==p&&(typeof e[u]>"u"||(u==="nodes"?t(h):u==="edges"?n(h):u==="minZoom"?r(h):u==="maxZoom"?o(h):u==="translateExtent"?s(h):u==="nodeExtent"?i(h):u==="paneClickDistance"?c(h):u==="fitView"?d.setState({fitViewQueued:h}):u==="fitViewOptions"?d.setState({fitViewOptions:h}):d.setState({[u]:h})))}f.current=e},Nu.map(u=>e[u])),null}function _u(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function A1(e){var r;const[t,n]=x.useState(e==="system"?null:e);return x.useEffect(()=>{if(e!=="system"){n(e);return}const o=_u(),s=()=>n(o!=null&&o.matches?"dark":"light");return s(),o==null||o.addEventListener("change",s),()=>{o==null||o.removeEventListener("change",s)}},[e]),t!==null?t:(r=_u())!=null&&r.matches?"dark":"light"}const ku=typeof document<"u"?document:null;function Eo(e=null,t={target:ku,actInsideInputWithModifier:!0}){const[n,r]=x.useState(!1),o=x.useRef(!1),s=x.useRef(new Set([])),[i,a]=x.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=c.reduce((f,u)=>f.concat(...u),[]);return[c,d]}return[[],[]]},[e]);return x.useEffect(()=>{const l=(t==null?void 0:t.target)||ku;if(e!==null){const c=u=>{var m,g;if(o.current=u.ctrlKey||u.metaKey||u.shiftKey||u.altKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&th(u))return!1;const p=Ou(u.code,a);if(s.current.add(u[p]),Du(i,s.current,!1)){const y=((g=(m=u.composedPath)==null?void 0:m.call(u))==null?void 0:g[0])||u.target,b=(y==null?void 0:y.nodeName)==="BUTTON"||(y==null?void 0:y.nodeName)==="A";t.preventDefault!==!1&&(o.current||!b)&&u.preventDefault(),r(!0)}},d=u=>{const h=Ou(u.code,a);Du(i,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(u[h]),u.key==="Meta"&&s.current.clear(),o.current=!1},f=()=>{s.current.clear(),r(!1)};return l==null||l.addEventListener("keydown",c),l==null||l.addEventListener("keyup",d),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{l==null||l.removeEventListener("keydown",c),l==null||l.removeEventListener("keyup",d),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,r]),n}function Du(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function Ou(e,t){return t.includes(e)?"code":"key"}const E1=()=>{const e=Se();return x.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,o,s],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??r,y:t.y??o,zoom:t.zoom??s},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>{const{width:o,height:s,maxZoom:i,panZoom:a}=e.getState(),l=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:i,c=o/2-t*l,d=s/2-n*l;return a?(await a.setViewport({x:c,y:d,zoom:l},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:o,minZoom:s,maxZoom:i,panZoom:a}=e.getState(),l=Dl(t,r,o,s,i,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(l,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:o,snapToGrid:s,domNode:i}=e.getState();if(!i)return t;const{x:a,y:l}=i.getBoundingClientRect(),c={x:t.x-a,y:t.y-l},d=n.snapGrid??o,f=n.snapToGrid??s;return Fo(c,r,f,d)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:o,y:s}=r.getBoundingClientRect(),i=js(t,n);return{x:i.x+o,y:i.y+s}}}),[])};function Eh(e,t){const n=[],r=new Map,o=[];for(const s of e)if(s.type==="add"){o.push(s);continue}else if(s.type==="remove"||s.type==="replace")r.set(s.id,[s]);else{const i=r.get(s.id);i?i.push(s):r.set(s.id,[s])}for(const s of t){const i=r.get(s.id);if(!i){n.push(s);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const a={...s};for(const l of i)S1(l,a);n.push(a)}return o.length&&o.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function S1(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Sh(e,t){return Eh(e,t)}function Mh(e,t){return Eh(e,t)}function Nn(e,t){return{id:e,type:"select",selected:t}}function yr(e,t=new Set,n=!1){const r=[];for(const[o,s]of e){const i=t.has(o);!(s.selected===void 0&&!i)&&s.selected!==i&&(n&&(s.selected=i),r.push(Nn(s.id,i)))}return r}function Lu({items:e=[],lookup:t}){var o;const n=[],r=new Map(e.map(s=>[s.id,s]));for(const[s,i]of e.entries()){const a=t.get(i.id),l=((o=a==null?void 0:a.internals)==null?void 0:o.userNode)??a;l!==void 0&&l!==i&&n.push({id:i.id,item:i,type:"replace"}),l===void 0&&n.push({item:i,type:"add",index:s})}for(const[s]of t)r.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function Bu(e){return{id:e.id,type:"remove"}}const Fu=e=>Zv(e),M1=e=>Gf(e);function Ch(e){return x.forwardRef(e)}const C1=typeof window<"u"?x.useLayoutEffect:x.useEffect;function ju(e){const[t,n]=x.useState(BigInt(0)),[r]=x.useState(()=>R1(()=>n(o=>o+BigInt(1))));return C1(()=>{const o=r.get();o.length&&(e(o),r.reset())},[t]),r}function R1(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Rh=x.createContext(null);function P1({children:e}){const t=Se(),n=x.useCallback(a=>{const{nodes:l=[],setNodes:c,hasDefaultNodes:d,onNodesChange:f,nodeLookup:u,fitViewQueued:h}=t.getState();let p=l;for(const m of a)p=typeof m=="function"?m(p):m;if(d)c(p);else{const m=Lu({items:p,lookup:u});m.length>0?f==null||f(m):h&&window.requestAnimationFrame(()=>{const{fitViewQueued:g,nodes:y,setNodes:b}=t.getState();g&&b(y)})}},[]),r=ju(n),o=x.useCallback(a=>{const{edges:l=[],setEdges:c,hasDefaultEdges:d,onEdgesChange:f,edgeLookup:u}=t.getState();let h=l;for(const p of a)h=typeof p=="function"?p(h):p;d?c(h):f&&f(Lu({items:h,lookup:u}))},[]),s=ju(o),i=x.useMemo(()=>({nodeQueue:r,edgeQueue:s}),[]);return S.jsx(Rh.Provider,{value:i,children:e})}function I1(){const e=x.useContext(Rh);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const N1=e=>!!e.panZoom;function $e(){const e=E1(),t=Se(),n=I1(),r=ge(N1),o=x.useMemo(()=>{const s=f=>t.getState().nodeLookup.get(f),i=f=>{n.nodeQueue.push(f)},a=f=>{n.edgeQueue.push(f)},l=f=>{var y,b;const{nodeLookup:u,nodeOrigin:h}=t.getState(),p=Fu(f)?f:u.get(f.id),m=p.parentId?Jf(p.position,p.measured,p.parentId,u,h):p.position,g={...p,position:m,width:((y=p.measured)==null?void 0:y.width)??p.width,height:((b=p.measured)==null?void 0:b.height)??p.height};return Pr(g)},c=(f,u,h={replace:!1})=>{i(p=>p.map(m=>{if(m.id===f){const g=typeof u=="function"?u(m):u;return h.replace&&Fu(g)?g:{...m,...g}}return m}))},d=(f,u,h={replace:!1})=>{a(p=>p.map(m=>{if(m.id===f){const g=typeof u=="function"?u(m):u;return h.replace&&M1(g)?g:{...m,...g}}return m}))};return{getNodes:()=>t.getState().nodes.map(f=>({...f})),getNode:f=>{var u;return(u=s(f))==null?void 0:u.internals.userNode},getInternalNode:s,getEdges:()=>{const{edges:f=[]}=t.getState();return f.map(u=>({...u}))},getEdge:f=>t.getState().edgeLookup.get(f),setNodes:i,setEdges:a,addNodes:f=>{const u=Array.isArray(f)?f:[f];n.nodeQueue.push(h=>[...h,...u])},addEdges:f=>{const u=Array.isArray(f)?f:[f];n.edgeQueue.push(h=>[...h,...u])},toObject:()=>{const{nodes:f=[],edges:u=[],transform:h}=t.getState(),[p,m,g]=h;return{nodes:f.map(y=>({...y})),edges:u.map(y=>({...y})),viewport:{x:p,y:m,zoom:g}}},deleteElements:async({nodes:f=[],edges:u=[]})=>{const{nodes:h,edges:p,onNodesDelete:m,onEdgesDelete:g,triggerNodeChanges:y,triggerEdgeChanges:b,onDelete:w,onBeforeDelete:E}=t.getState(),{nodes:P,edges:A}=await rb({nodesToRemove:f,edgesToRemove:u,nodes:h,edges:p,onBeforeDelete:E}),v=A.length>0,M=P.length>0;if(v){const N=A.map(Bu);g==null||g(A),b(N)}if(M){const N=P.map(Bu);m==null||m(P),y(N)}return(M||v)&&(w==null||w({nodes:P,edges:A})),{deletedNodes:P,deletedEdges:A}},getIntersectingNodes:(f,u=!0,h)=>{const p=du(f),m=p?f:l(f),g=h!==void 0;return m?(h||t.getState().nodes).filter(y=>{const b=t.getState().nodeLookup.get(y.id);if(b&&!p&&(y.id===f.id||!b.internals.positionAbsolute))return!1;const w=Pr(g?y:b),E=bo(w,m);return u&&E>0||E>=m.width*m.height}):[]},isNodeIntersecting:(f,u,h=!0)=>{const m=du(f)?f:l(f);if(!m)return!1;const g=bo(m,u);return h&&g>0||g>=m.width*m.height},updateNode:c,updateNodeData:(f,u,h={replace:!1})=>{c(f,p=>{const m=typeof u=="function"?u(p):u;return h.replace?{...p,data:m}:{...p,data:{...p.data,...m}}},h)},updateEdge:d,updateEdgeData:(f,u,h={replace:!1})=>{d(f,p=>{const m=typeof u=="function"?u(p):u;return h.replace?{...p,data:m}:{...p,data:{...p.data,...m}}},h)},getNodesBounds:f=>{const{nodeLookup:u,nodeOrigin:h}=t.getState();return Jv(f,{nodeLookup:u,nodeOrigin:h})},getHandleConnections:({type:f,id:u,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}-${f}${u?`-${u}`:""}`))==null?void 0:p.values())??[])},getNodeConnections:({type:f,handleId:u,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}${f?u?`-${f}-${u}`:`-${f}`:""}`))==null?void 0:p.values())??[])},fitView:async f=>{const u=t.getState().fitViewResolver??ab();return t.setState({fitViewQueued:!0,fitViewOptions:f,fitViewResolver:u}),n.nodeQueue.push(h=>[...h]),u.promise}}},[]);return x.useMemo(()=>({...o,...e,viewportInitialized:r}),[r])}const qu=e=>e.selected,T1={actInsideInputWithModifier:!1},_1=typeof window<"u"?window:void 0;function k1({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=Se(),{deleteElements:r}=$e(),o=Eo(e,T1),s=Eo(t,{target:_1});x.useEffect(()=>{if(o){const{edges:i,nodes:a}=n.getState();r({nodes:a.filter(qu),edges:i.filter(qu)}),n.setState({nodesSelectionActive:!1})}},[o]),x.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function D1(e){const t=Se();x.useEffect(()=>{const n=()=>{var o,s;if(!e.current)return!1;const r=Ol(e.current);(r.height===0||r.width===0)&&((s=(o=t.getState()).onError)==null||s.call(o,"004",It.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const vi={position:"absolute",width:"100%",height:"100%",top:0,left:0},O1=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function L1({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:o=.5,panOnScrollMode:s=Ln.Free,zoomOnDoubleClick:i=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:c,minZoom:d,maxZoom:f,zoomActivationKeyCode:u,preventScrolling:h=!0,children:p,noWheelClassName:m,noPanClassName:g,onViewportChange:y,isControlledViewport:b,paneClickDistance:w}){const E=Se(),P=x.useRef(null),{userSelectionActive:A,lib:v}=ge(O1,Ne),M=Eo(u),N=x.useRef();D1(P);const _=x.useCallback(D=>{y==null||y({x:D[0],y:D[1],zoom:D[2]}),b||E.setState({transform:D})},[y,b]);return x.useEffect(()=>{if(P.current){N.current=jb({domNode:P.current,minZoom:d,maxZoom:f,translateExtent:c,viewport:l,paneClickDistance:w,onDraggingChange:R=>E.setState({paneDragging:R}),onPanZoomStart:(R,O)=>{const{onViewportChangeStart:I,onMoveStart:k}=E.getState();k==null||k(R,O),I==null||I(O)},onPanZoom:(R,O)=>{const{onViewportChange:I,onMove:k}=E.getState();k==null||k(R,O),I==null||I(O)},onPanZoomEnd:(R,O)=>{const{onViewportChangeEnd:I,onMoveEnd:k}=E.getState();k==null||k(R,O),I==null||I(O)}});const{x:D,y:B,zoom:j}=N.current.getViewport();return E.setState({panZoom:N.current,transform:[D,B,j],domNode:P.current.closest(".react-flow")}),()=>{var R;(R=N.current)==null||R.destroy()}}},[]),x.useEffect(()=>{var D;(D=N.current)==null||D.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:o,panOnScrollMode:s,zoomOnDoubleClick:i,panOnDrag:a,zoomActivationKeyPressed:M,preventScrolling:h,noPanClassName:g,userSelectionActive:A,noWheelClassName:m,lib:v,onTransformChange:_})},[e,t,n,r,o,s,i,a,M,h,g,A,m,v,_]),S.jsx("div",{className:"react-flow__renderer",ref:P,style:vi,children:p})}const B1=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function F1(){const{userSelectionActive:e,userSelectionRect:t}=ge(B1,Ne);return e&&t?S.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const ca=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},j1=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function q1({isSelecting:e,selectionKeyPressed:t,selectionMode:n=vo.Full,panOnDrag:r,selectionOnDrag:o,onSelectionStart:s,onSelectionEnd:i,onPaneClick:a,onPaneContextMenu:l,onPaneScroll:c,onPaneMouseEnter:d,onPaneMouseMove:f,onPaneMouseLeave:u,children:h}){const p=Se(),{userSelectionActive:m,elementsSelectable:g,dragging:y,connectionInProgress:b}=ge(j1,Ne),w=g&&(e||m),E=x.useRef(null),P=x.useRef(),A=x.useRef(new Set),v=x.useRef(new Set),M=x.useRef(!1),N=x.useRef(!1),_=k=>{if(M.current||b){M.current=!1;return}a==null||a(k),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},D=k=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){k.preventDefault();return}l==null||l(k)},B=c?k=>c(k):void 0,j=k=>{var U,K;const{resetSelectedElements:F,domNode:T}=p.getState();if(P.current=T==null?void 0:T.getBoundingClientRect(),!g||!e||k.button!==0||k.target!==E.current||!P.current)return;(K=(U=k.target)==null?void 0:U.setPointerCapture)==null||K.call(U,k.pointerId),N.current=!0,M.current=!1;const{x:z,y:V}=Xt(k.nativeEvent,P.current);F(),p.setState({userSelectionRect:{width:0,height:0,startX:z,startY:V,x:z,y:V}}),s==null||s(k)},R=k=>{const{userSelectionRect:F,transform:T,nodeLookup:z,edgeLookup:V,connectionLookup:U,triggerNodeChanges:K,triggerEdgeChanges:Y,defaultEdgeOptions:ee}=p.getState();if(!P.current||!F)return;M.current=!0;const{x:Z,y:q}=Xt(k.nativeEvent,P.current),{startX:W,startY:te}=F,se={startX:W,startY:te,x:Z<W?Z:W,y:q<te?q:te,width:Math.abs(Z-W),height:Math.abs(q-te)},oe=A.current,ne=v.current;A.current=new Set(Kf(z,se,T,n===vo.Partial,!0).map(re=>re.id)),v.current=new Set;const J=(ee==null?void 0:ee.selectable)??!0;for(const re of A.current){const le=U.get(re);if(le)for(const{edgeId:ce}of le.values()){const me=V.get(ce);me&&(me.selectable??J)&&v.current.add(ce)}}if(!fu(oe,A.current)){const re=yr(z,A.current,!0);K(re)}if(!fu(ne,v.current)){const re=yr(V,v.current);Y(re)}p.setState({userSelectionRect:se,userSelectionActive:!0,nodesSelectionActive:!1})},O=k=>{var T,z;if(k.button!==0||!N.current)return;(z=(T=k.target)==null?void 0:T.releasePointerCapture)==null||z.call(T,k.pointerId);const{userSelectionRect:F}=p.getState();!m&&F&&k.target===E.current&&(_==null||_(k)),p.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:A.current.size>0}),i==null||i(k),(t||o)&&(M.current=!1),N.current=!1},I=r===!0||Array.isArray(r)&&r.includes(0);return S.jsxs("div",{className:_e(["react-flow__pane",{draggable:I,dragging:y,selection:e}]),onClick:w?void 0:ca(_,E),onContextMenu:ca(D,E),onWheel:ca(B,E),onPointerEnter:w?void 0:d,onPointerDown:w?j:f,onPointerMove:w?R:f,onPointerUp:w?O:void 0,onPointerLeave:u,ref:E,style:vi,children:[h,S.jsx(F1,{})]})}function Va({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:s,multiSelectionActive:i,nodeLookup:a,onError:l}=t.getState(),c=a.get(e);if(!c){l==null||l("012",It.error012(e));return}t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&i)&&(s({nodes:[c],edges:[]}),requestAnimationFrame(()=>{var d;return(d=r==null?void 0:r.current)==null?void 0:d.blur()})):o([e])}function Ph({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:s,nodeClickDistance:i}){const a=Se(),[l,c]=x.useState(!1),d=x.useRef();return x.useEffect(()=>{d.current=Mb({getStoreItems:()=>a.getState(),onNodeMouseDown:f=>{Va({id:f,store:a,nodeRef:e})},onDragStart:()=>{c(!0)},onDragStop:()=>{c(!1)}})},[]),x.useEffect(()=>{var f,u;if(t)(f=d.current)==null||f.destroy();else if(e.current)return(u=d.current)==null||u.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:s,nodeId:o,nodeClickDistance:i}),()=>{var h;(h=d.current)==null||h.destroy()}},[n,r,t,s,e,o]),l}const z1=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Ih(){const e=Se();return x.useCallback(n=>{const{nodeExtent:r,snapToGrid:o,snapGrid:s,nodesDraggable:i,onError:a,updateNodePositions:l,nodeLookup:c,nodeOrigin:d}=e.getState(),f=new Map,u=z1(i),h=o?s[0]:5,p=o?s[1]:5,m=n.direction.x*h*n.factor,g=n.direction.y*p*n.factor;for(const[,y]of c){if(!u(y))continue;let b={x:y.internals.positionAbsolute.x+m,y:y.internals.positionAbsolute.y+g};o&&(b=yi(b,s));const{position:w,positionAbsolute:E}=Wf({nodeId:y.id,nextPosition:b,nodeLookup:c,nodeExtent:r,nodeOrigin:d,onError:a});y.position=w,y.internals.positionAbsolute=E,f.set(y.id,y)}l(f)},[])}const ql=x.createContext(null),H1=ql.Provider;ql.Consumer;const zl=()=>x.useContext(ql),V1=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),U1=(e,t,n)=>r=>{const{connectionClickStartHandle:o,connectionMode:s,connection:i}=r,{fromHandle:a,toHandle:l,isValid:c}=i,d=(l==null?void 0:l.nodeId)===e&&(l==null?void 0:l.id)===t&&(l==null?void 0:l.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:d,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.id)===t&&(o==null?void 0:o.type)===n,isPossibleEndHandle:s===Cr.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!o,valid:d&&c}};function $1({type:e="source",position:t=ae.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:s=!0,id:i,onConnect:a,children:l,className:c,onMouseDown:d,onTouchStart:f,...u},h){var O,I;const p=i||null,m=e==="target",g=Se(),y=zl(),{connectOnClick:b,noPanClassName:w,rfId:E}=ge(V1,Ne),{connectingFrom:P,connectingTo:A,clickConnecting:v,isPossibleEndHandle:M,connectionInProcess:N,clickConnectionInProcess:_,valid:D}=ge(U1(y,p,e),Ne);y||(I=(O=g.getState()).onError)==null||I.call(O,"010",It.error010());const B=k=>{const{defaultEdgeOptions:F,onConnect:T,hasDefaultEdges:z}=g.getState(),V={...F,...k};if(z){const{edges:U,setEdges:K}=g.getState();K(ih(V,U))}T==null||T(V),a==null||a(V)},j=k=>{if(!y)return;const F=nh(k.nativeEvent);if(o&&(F&&k.button===0||!F)){const T=g.getState();Ha.onPointerDown(k.nativeEvent,{autoPanOnConnect:T.autoPanOnConnect,connectionMode:T.connectionMode,connectionRadius:T.connectionRadius,domNode:T.domNode,nodeLookup:T.nodeLookup,lib:T.lib,isTarget:m,handleId:p,nodeId:y,flowId:T.rfId,panBy:T.panBy,cancelConnection:T.cancelConnection,onConnectStart:T.onConnectStart,onConnectEnd:T.onConnectEnd,updateConnection:T.updateConnection,onConnect:B,isValidConnection:n||T.isValidConnection,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle,autoPanSpeed:T.autoPanSpeed})}F?d==null||d(k):f==null||f(k)},R=k=>{const{onClickConnectStart:F,onClickConnectEnd:T,connectionClickStartHandle:z,connectionMode:V,isValidConnection:U,lib:K,rfId:Y,nodeLookup:ee,connection:Z}=g.getState();if(!y||!z&&!o)return;if(!z){F==null||F(k.nativeEvent,{nodeId:y,handleId:p,handleType:e}),g.setState({connectionClickStartHandle:{nodeId:y,type:e,id:p}});return}const q=eh(k.target),W=n||U,{connection:te,isValid:se}=Ha.isValid(k.nativeEvent,{handle:{nodeId:y,id:p,type:e},connectionMode:V,fromNodeId:z.nodeId,fromHandleId:z.id||null,fromType:z.type,isValidConnection:W,flowId:Y,doc:q,lib:K,nodeLookup:ee});se&&te&&B(te);const oe=structuredClone(Z);delete oe.inProgress,oe.toPosition=oe.toHandle?oe.toHandle.position:null,T==null||T(k,oe),g.setState({connectionClickStartHandle:null})};return S.jsx("div",{"data-handleid":p,"data-nodeid":y,"data-handlepos":t,"data-id":`${E}-${y}-${p}-${e}`,className:_e(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",w,c,{source:!m,target:m,connectable:r,connectablestart:o,connectableend:s,clickconnecting:v,connectingfrom:P,connectingto:A,valid:D,connectionindicator:r&&(!N||M)&&(N||_?s:o)}]),onMouseDown:j,onTouchStart:j,onClick:b?R:void 0,ref:h,...u,children:l})}const Nr=x.memo(Ch($1));function G1({data:e,isConnectable:t,sourcePosition:n=ae.Bottom}){return S.jsxs(S.Fragment,{children:[e==null?void 0:e.label,S.jsx(Nr,{type:"source",position:n,isConnectable:t})]})}function K1({data:e,isConnectable:t,targetPosition:n=ae.Top,sourcePosition:r=ae.Bottom}){return S.jsxs(S.Fragment,{children:[S.jsx(Nr,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,S.jsx(Nr,{type:"source",position:r,isConnectable:t})]})}function W1(){return null}function Y1({data:e,isConnectable:t,targetPosition:n=ae.Top}){return S.jsxs(S.Fragment,{children:[S.jsx(Nr,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const zs={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},zu={input:G1,default:K1,output:Y1,group:W1};function X1(e){var t,n,r,o;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((o=e.style)==null?void 0:o.height)}}const Q1=e=>{const{width:t,height:n,x:r,y:o}=Bo(e.nodeLookup,{filter:s=>!!s.selected});return{width:Rt(t)?t:null,height:Rt(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${o}px)`}};function Z1({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=Se(),{width:o,height:s,transformString:i,userSelectionActive:a}=ge(Q1,Ne),l=Ih(),c=x.useRef(null);if(x.useEffect(()=>{var u;n||(u=c.current)==null||u.focus({preventScroll:!0})},[n]),Ph({nodeRef:c}),a||!o||!s)return null;const d=e?u=>{const h=r.getState().nodes.filter(p=>p.selected);e(u,h)}:void 0,f=u=>{Object.prototype.hasOwnProperty.call(zs,u.key)&&(u.preventDefault(),l({direction:zs[u.key],factor:u.shiftKey?4:1}))};return S.jsx("div",{className:_e(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:S.jsx("div",{ref:c,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:o,height:s}})})}const Hu=typeof window<"u"?window:void 0,J1=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Nh({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:c,selectionOnDrag:d,selectionMode:f,onSelectionStart:u,onSelectionEnd:h,multiSelectionKeyCode:p,panActivationKeyCode:m,zoomActivationKeyCode:g,elementsSelectable:y,zoomOnScroll:b,zoomOnPinch:w,panOnScroll:E,panOnScrollSpeed:P,panOnScrollMode:A,zoomOnDoubleClick:v,panOnDrag:M,defaultViewport:N,translateExtent:_,minZoom:D,maxZoom:B,preventScrolling:j,onSelectionContextMenu:R,noWheelClassName:O,noPanClassName:I,disableKeyboardA11y:k,onViewportChange:F,isControlledViewport:T}){const{nodesSelectionActive:z,userSelectionActive:V}=ge(J1),U=Eo(c,{target:Hu}),K=Eo(m,{target:Hu}),Y=K||M,ee=K||E,Z=d&&Y!==!0,q=U||V||Z;return k1({deleteKeyCode:l,multiSelectionKeyCode:p}),S.jsx(L1,{onPaneContextMenu:s,elementsSelectable:y,zoomOnScroll:b,zoomOnPinch:w,panOnScroll:ee,panOnScrollSpeed:P,panOnScrollMode:A,zoomOnDoubleClick:v,panOnDrag:!U&&Y,defaultViewport:N,translateExtent:_,minZoom:D,maxZoom:B,zoomActivationKeyCode:g,preventScrolling:j,noWheelClassName:O,noPanClassName:I,onViewportChange:F,isControlledViewport:T,paneClickDistance:a,children:S.jsxs(q1,{onSelectionStart:u,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:Y,isSelecting:!!q,selectionMode:f,selectionKeyPressed:U,selectionOnDrag:Z,children:[e,z&&S.jsx(Z1,{onSelectionContextMenu:R,noPanClassName:I,disableKeyboardA11y:k})]})})}Nh.displayName="FlowRenderer";const eA=x.memo(Nh),tA=e=>t=>e?Kf(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function nA(e){return ge(x.useCallback(tA(e),[e]),Ne)}const rA=e=>e.updateNodeInternals;function oA(){const e=ge(rA),[t]=x.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(o=>{const s=o.target.getAttribute("data-id");r.set(s,{id:s,nodeElement:o.target,force:!0})}),e(r)}));return x.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function sA({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const o=Se(),s=x.useRef(null),i=x.useRef(null),a=x.useRef(e.sourcePosition),l=x.useRef(e.targetPosition),c=x.useRef(t),d=n&&!!e.internals.handleBounds;return x.useEffect(()=>{s.current&&!e.hidden&&(!d||i.current!==s.current)&&(i.current&&(r==null||r.unobserve(i.current)),r==null||r.observe(s.current),i.current=s.current)},[d,e.hidden]),x.useEffect(()=>()=>{i.current&&(r==null||r.unobserve(i.current),i.current=null)},[]),x.useEffect(()=>{if(s.current){const f=c.current!==t,u=a.current!==e.sourcePosition,h=l.current!==e.targetPosition;(f||u||h)&&(c.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function iA({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:s,onDoubleClick:i,nodesDraggable:a,elementsSelectable:l,nodesConnectable:c,nodesFocusable:d,resizeObserver:f,noDragClassName:u,noPanClassName:h,disableKeyboardA11y:p,rfId:m,nodeTypes:g,nodeClickDistance:y,onError:b}){const{node:w,internals:E,isParent:P}=ge(q=>{const W=q.nodeLookup.get(e),te=q.parentLookup.has(e);return{node:W,internals:W.internals,isParent:te}},Ne);let A=w.type||"default",v=(g==null?void 0:g[A])||zu[A];v===void 0&&(b==null||b("003",It.error003(A)),A="default",v=zu.default);const M=!!(w.draggable||a&&typeof w.draggable>"u"),N=!!(w.selectable||l&&typeof w.selectable>"u"),_=!!(w.connectable||c&&typeof w.connectable>"u"),D=!!(w.focusable||d&&typeof w.focusable>"u"),B=Se(),j=Zf(w),R=sA({node:w,nodeType:A,hasDimensions:j,resizeObserver:f}),O=Ph({nodeRef:R,disabled:w.hidden||!M,noDragClassName:u,handleSelector:w.dragHandle,nodeId:e,isSelectable:N,nodeClickDistance:y}),I=Ih();if(w.hidden)return null;const k=tn(w),F=X1(w),T=N||M||t||n||r||o,z=n?q=>n(q,{...E.userNode}):void 0,V=r?q=>r(q,{...E.userNode}):void 0,U=o?q=>o(q,{...E.userNode}):void 0,K=s?q=>s(q,{...E.userNode}):void 0,Y=i?q=>i(q,{...E.userNode}):void 0,ee=q=>{const{selectNodesOnDrag:W,nodeDragThreshold:te}=B.getState();N&&(!W||!M||te>0)&&Va({id:e,store:B,nodeRef:R}),t&&t(q,{...E.userNode})},Z=q=>{if(!(th(q.nativeEvent)||p))if(Vf.includes(q.key)&&N){const W=q.key==="Escape";Va({id:e,store:B,unselect:W,nodeRef:R})}else M&&w.selected&&Object.prototype.hasOwnProperty.call(zs,q.key)&&(q.preventDefault(),B.setState({ariaLiveMessage:`Moved selected node ${q.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~E.positionAbsolute.x}, y: ${~~E.positionAbsolute.y}`}),I({direction:zs[q.key],factor:q.shiftKey?4:1}))};return S.jsx("div",{className:_e(["react-flow__node",`react-flow__node-${A}`,{[h]:M},w.className,{selected:w.selected,selectable:N,parent:P,draggable:M,dragging:O}]),ref:R,style:{zIndex:E.z,transform:`translate(${E.positionAbsolute.x}px,${E.positionAbsolute.y}px)`,pointerEvents:T?"all":"none",visibility:j?"visible":"hidden",...w.style,...F},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:z,onMouseMove:V,onMouseLeave:U,onContextMenu:K,onClick:ee,onDoubleClick:Y,onKeyDown:D?Z:void 0,tabIndex:D?0:void 0,role:D?"button":void 0,"aria-describedby":p?void 0:`${vh}-${m}`,"aria-label":w.ariaLabel,children:S.jsx(H1,{value:e,children:S.jsx(v,{id:e,data:w.data,type:A,positionAbsoluteX:E.positionAbsolute.x,positionAbsoluteY:E.positionAbsolute.y,selected:w.selected??!1,selectable:N,draggable:M,deletable:w.deletable??!0,isConnectable:_,sourcePosition:w.sourcePosition,targetPosition:w.targetPosition,dragging:O,dragHandle:w.dragHandle,zIndex:E.z,parentId:w.parentId,...k})})})}const aA=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Th(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:s}=ge(aA,Ne),i=nA(e.onlyRenderVisibleElements),a=oA();return S.jsx("div",{className:"react-flow__nodes",style:vi,children:i.map(l=>S.jsx(iA,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,nodeClickDistance:e.nodeClickDistance,onError:s},l))})}Th.displayName="NodeRenderer";const lA=x.memo(Th);function cA(e){return ge(x.useCallback(n=>{if(!e)return n.edges.map(o=>o.id);const r=[];if(n.width&&n.height)for(const o of n.edges){const s=n.nodeLookup.get(o.source),i=n.nodeLookup.get(o.target);s&&i&&ub({sourceNode:s,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&r.push(o.id)}return r},[e]),Ne)}const uA=({color:e="none",strokeWidth:t=1})=>S.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),dA=({color:e="none",strokeWidth:t=1})=>S.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Vu={[Bs.Arrow]:uA,[Bs.ArrowClosed]:dA};function fA(e){const t=Se();return x.useMemo(()=>{var o,s;return Object.prototype.hasOwnProperty.call(Vu,e)?Vu[e]:((s=(o=t.getState()).onError)==null||s.call(o,"009",It.error009(e)),null)},[e])}const hA=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const l=fA(t);return l?S.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:S.jsx(l,{color:n,strokeWidth:i})}):null},_h=({defaultColor:e,rfId:t})=>{const n=ge(s=>s.edges),r=ge(s=>s.defaultEdgeOptions),o=x.useMemo(()=>yb(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return o.length?S.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:S.jsx("defs",{children:o.map(s=>S.jsx(hA,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};_h.displayName="MarkerDefinitions";var pA=x.memo(_h);function kh({x:e,y:t,label:n,labelStyle:r,labelShowBg:o=!0,labelBgStyle:s,labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...d}){const[f,u]=x.useState({x:1,y:0,width:0,height:0}),h=_e(["react-flow__edge-textwrapper",c]),p=x.useRef(null);return x.useEffect(()=>{if(p.current){const m=p.current.getBBox();u({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),n?S.jsxs("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:h,visibility:f.width?"visible":"hidden",...d,children:[o&&S.jsx("rect",{width:f.width+2*i[0],x:-i[0],y:-i[1],height:f.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),S.jsx("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:p,style:r,children:n}),l]}):null}kh.displayName="EdgeText";const gA=x.memo(kh);function bi({path:e,labelX:t,labelY:n,label:r,labelStyle:o,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:c=20,...d}){return S.jsxs(S.Fragment,{children:[S.jsx("path",{...d,d:e,fill:"none",className:_e(["react-flow__edge-path",d.className])}),c&&S.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:c,className:"react-flow__edge-interaction"}),r&&Rt(t)&&Rt(n)?S.jsx(gA,{x:t,y:n,label:r,labelStyle:o,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function Uu({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===ae.Left||e===ae.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Dh({sourceX:e,sourceY:t,sourcePosition:n=ae.Bottom,targetX:r,targetY:o,targetPosition:s=ae.Top}){const[i,a]=Uu({pos:n,x1:e,y1:t,x2:r,y2:o}),[l,c]=Uu({pos:s,x1:r,y1:o,x2:e,y2:t}),[d,f,u,h]=rh({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:i,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${e},${t} C${i},${a} ${l},${c} ${r},${o}`,d,f,u,h]}function Oh(e){return x.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,sourcePosition:i,targetPosition:a,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:g,interactionWidth:y})=>{const[b,w,E]=Dh({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:s,targetPosition:a}),P=e.isInternal?void 0:t;return S.jsx(bi,{id:P,path:b,labelX:w,labelY:E,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:g,interactionWidth:y})})}const mA=Oh({isInternal:!1}),Lh=Oh({isInternal:!0});mA.displayName="SimpleBezierEdge";Lh.displayName="SimpleBezierEdgeInternal";function Bh(e){return x.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,style:u,sourcePosition:h=ae.Bottom,targetPosition:p=ae.Top,markerEnd:m,markerStart:g,pathOptions:y,interactionWidth:b})=>{const[w,E,P]=ja({sourceX:n,sourceY:r,sourcePosition:h,targetX:o,targetY:s,targetPosition:p,borderRadius:y==null?void 0:y.borderRadius,offset:y==null?void 0:y.offset}),A=e.isInternal?void 0:t;return S.jsx(bi,{id:A,path:w,labelX:E,labelY:P,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,style:u,markerEnd:m,markerStart:g,interactionWidth:b})})}const Fh=Bh({isInternal:!1}),jh=Bh({isInternal:!0});Fh.displayName="SmoothStepEdge";jh.displayName="SmoothStepEdgeInternal";function qh(e){return x.memo(({id:t,...n})=>{var o;const r=e.isInternal?void 0:t;return S.jsx(Fh,{...n,id:r,pathOptions:x.useMemo(()=>{var s;return{borderRadius:0,offset:(s=n.pathOptions)==null?void 0:s.offset}},[(o=n.pathOptions)==null?void 0:o.offset])})})}const yA=qh({isInternal:!1}),zh=qh({isInternal:!0});yA.displayName="StepEdge";zh.displayName="StepEdgeInternal";function Hh(e){return x.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,style:u,markerEnd:h,markerStart:p,interactionWidth:m})=>{const[g,y,b]=ah({sourceX:n,sourceY:r,targetX:o,targetY:s}),w=e.isInternal?void 0:t;return S.jsx(bi,{id:w,path:g,labelX:y,labelY:b,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:f,style:u,markerEnd:h,markerStart:p,interactionWidth:m})})}const wA=Hh({isInternal:!1}),Vh=Hh({isInternal:!0});wA.displayName="StraightEdge";Vh.displayName="StraightEdgeInternal";function Uh(e){return x.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:s,sourcePosition:i=ae.Bottom,targetPosition:a=ae.Top,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:g,pathOptions:y,interactionWidth:b})=>{const[w,E,P]=oh({sourceX:n,sourceY:r,sourcePosition:i,targetX:o,targetY:s,targetPosition:a,curvature:y==null?void 0:y.curvature}),A=e.isInternal?void 0:t;return S.jsx(bi,{id:A,path:w,labelX:E,labelY:P,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:f,labelBgPadding:u,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:g,interactionWidth:b})})}const xA=Uh({isInternal:!1}),$h=Uh({isInternal:!0});xA.displayName="BezierEdge";$h.displayName="BezierEdgeInternal";const $u={default:$h,straight:Vh,step:zh,smoothstep:jh,simplebezier:Lh},Gu={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},vA=(e,t,n)=>n===ae.Left?e-t:n===ae.Right?e+t:e,bA=(e,t,n)=>n===ae.Top?e-t:n===ae.Bottom?e+t:e,Ku="react-flow__edgeupdater";function Wu({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:s,onMouseOut:i,type:a}){return S.jsx("circle",{onMouseDown:o,onMouseEnter:s,onMouseOut:i,className:_e([Ku,`${Ku}-${a}`]),cx:vA(t,r,e),cy:bA(n,r,e),r,stroke:"transparent",fill:"transparent"})}function AA({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:o,targetX:s,targetY:i,sourcePosition:a,targetPosition:l,onReconnect:c,onReconnectStart:d,onReconnectEnd:f,setReconnecting:u,setUpdateHover:h}){const p=Se(),m=(E,P)=>{if(E.button!==0)return;const{autoPanOnConnect:A,domNode:v,isValidConnection:M,connectionMode:N,connectionRadius:_,lib:D,onConnectStart:B,onConnectEnd:j,cancelConnection:R,nodeLookup:O,rfId:I,panBy:k,updateConnection:F}=p.getState(),T=P.type==="target";u(!0),d==null||d(E,n,P.type);const z=(U,K)=>{u(!1),f==null||f(U,n,P.type,K)},V=U=>c==null?void 0:c(n,U);Ha.onPointerDown(E.nativeEvent,{autoPanOnConnect:A,connectionMode:N,connectionRadius:_,domNode:v,handleId:P.id,nodeId:P.nodeId,nodeLookup:O,isTarget:T,edgeUpdaterType:P.type,lib:D,flowId:I,cancelConnection:R,panBy:k,isValidConnection:M,onConnect:V,onConnectStart:B,onConnectEnd:j,onReconnectEnd:z,updateConnection:F,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle})},g=E=>m(E,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),y=E=>m(E,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),b=()=>h(!0),w=()=>h(!1);return S.jsxs(S.Fragment,{children:[(e===!0||e==="source")&&S.jsx(Wu,{position:a,centerX:r,centerY:o,radius:t,onMouseDown:g,onMouseEnter:b,onMouseOut:w,type:"source"}),(e===!0||e==="target")&&S.jsx(Wu,{position:l,centerX:s,centerY:i,radius:t,onMouseDown:y,onMouseEnter:b,onMouseOut:w,type:"target"})]})}function EA({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:o,onDoubleClick:s,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,reconnectRadius:d,onReconnect:f,onReconnectStart:u,onReconnectEnd:h,rfId:p,edgeTypes:m,noPanClassName:g,onError:y,disableKeyboardA11y:b}){let w=ge(ne=>ne.edgeLookup.get(e));const E=ge(ne=>ne.defaultEdgeOptions);w=E?{...E,...w}:w;let P=w.type||"default",A=(m==null?void 0:m[P])||$u[P];A===void 0&&(y==null||y("011",It.error011(P)),P="default",A=$u.default);const v=!!(w.focusable||t&&typeof w.focusable>"u"),M=typeof f<"u"&&(w.reconnectable||n&&typeof w.reconnectable>"u"),N=!!(w.selectable||r&&typeof w.selectable>"u"),_=x.useRef(null),[D,B]=x.useState(!1),[j,R]=x.useState(!1),O=Se(),{zIndex:I,sourceX:k,sourceY:F,targetX:T,targetY:z,sourcePosition:V,targetPosition:U}=ge(x.useCallback(ne=>{const J=ne.nodeLookup.get(w.source),re=ne.nodeLookup.get(w.target);if(!J||!re)return{zIndex:w.zIndex,...Gu};const le=mb({id:e,sourceNode:J,targetNode:re,sourceHandle:w.sourceHandle||null,targetHandle:w.targetHandle||null,connectionMode:ne.connectionMode,onError:y});return{zIndex:cb({selected:w.selected,zIndex:w.zIndex,sourceNode:J,targetNode:re,elevateOnSelect:ne.elevateEdgesOnSelect}),...le||Gu}},[w.source,w.target,w.sourceHandle,w.targetHandle,w.selected,w.zIndex]),Ne),K=x.useMemo(()=>w.markerStart?`url('#${qa(w.markerStart,p)}')`:void 0,[w.markerStart,p]),Y=x.useMemo(()=>w.markerEnd?`url('#${qa(w.markerEnd,p)}')`:void 0,[w.markerEnd,p]);if(w.hidden||k===null||F===null||T===null||z===null)return null;const ee=ne=>{var ce;const{addSelectedEdges:J,unselectNodesAndEdges:re,multiSelectionActive:le}=O.getState();N&&(O.setState({nodesSelectionActive:!1}),w.selected&&le?(re({nodes:[],edges:[w]}),(ce=_.current)==null||ce.blur()):J([e])),o&&o(ne,w)},Z=s?ne=>{s(ne,{...w})}:void 0,q=i?ne=>{i(ne,{...w})}:void 0,W=a?ne=>{a(ne,{...w})}:void 0,te=l?ne=>{l(ne,{...w})}:void 0,se=c?ne=>{c(ne,{...w})}:void 0,oe=ne=>{var J;if(!b&&Vf.includes(ne.key)&&N){const{unselectNodesAndEdges:re,addSelectedEdges:le}=O.getState();ne.key==="Escape"?((J=_.current)==null||J.blur(),re({edges:[w]})):le([e])}};return S.jsx("svg",{style:{zIndex:I},children:S.jsxs("g",{className:_e(["react-flow__edge",`react-flow__edge-${P}`,w.className,g,{selected:w.selected,animated:w.animated,inactive:!N&&!o,updating:D,selectable:N}]),onClick:ee,onDoubleClick:Z,onContextMenu:q,onMouseEnter:W,onMouseMove:te,onMouseLeave:se,onKeyDown:v?oe:void 0,tabIndex:v?0:void 0,role:v?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":w.ariaLabel===null?void 0:w.ariaLabel||`Edge from ${w.source} to ${w.target}`,"aria-describedby":v?`${bh}-${p}`:void 0,ref:_,children:[!j&&S.jsx(A,{id:e,source:w.source,target:w.target,type:w.type,selected:w.selected,animated:w.animated,selectable:N,deletable:w.deletable??!0,label:w.label,labelStyle:w.labelStyle,labelShowBg:w.labelShowBg,labelBgStyle:w.labelBgStyle,labelBgPadding:w.labelBgPadding,labelBgBorderRadius:w.labelBgBorderRadius,sourceX:k,sourceY:F,targetX:T,targetY:z,sourcePosition:V,targetPosition:U,data:w.data,style:w.style,sourceHandleId:w.sourceHandle,targetHandleId:w.targetHandle,markerStart:K,markerEnd:Y,pathOptions:"pathOptions"in w?w.pathOptions:void 0,interactionWidth:w.interactionWidth}),M&&S.jsx(AA,{edge:w,isReconnectable:M,reconnectRadius:d,onReconnect:f,onReconnectStart:u,onReconnectEnd:h,sourceX:k,sourceY:F,targetX:T,targetY:z,sourcePosition:V,targetPosition:U,setUpdateHover:B,setReconnecting:R})]})})}const SA=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Gh({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:o,onReconnect:s,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:d,reconnectRadius:f,onEdgeDoubleClick:u,onReconnectStart:h,onReconnectEnd:p,disableKeyboardA11y:m}){const{edgesFocusable:g,edgesReconnectable:y,elementsSelectable:b,onError:w}=ge(SA,Ne),E=cA(t);return S.jsxs("div",{className:"react-flow__edges",children:[S.jsx(pA,{defaultColor:e,rfId:n}),E.map(P=>S.jsx(EA,{id:P,edgesFocusable:g,edgesReconnectable:y,elementsSelectable:b,noPanClassName:o,onReconnect:s,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:d,reconnectRadius:f,onDoubleClick:u,onReconnectStart:h,onReconnectEnd:p,rfId:n,onError:w,edgeTypes:r,disableKeyboardA11y:m},P))]})}Gh.displayName="EdgeRenderer";const MA=x.memo(Gh),CA=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function RA({children:e}){const t=ge(CA);return S.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function PA(e){const t=$e(),n=x.useRef(!1);x.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const IA=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function NA(e){const t=ge(IA),n=Se();return x.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function TA(e){return e.connection.inProgress?{...e.connection,to:Fo(e.connection.to,e.transform)}:{...e.connection}}function _A(e){return TA}function kA(e){const t=_A();return ge(t,Ne)}const DA=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function OA({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:o,width:s,height:i,isValid:a,inProgress:l}=ge(DA,Ne);return!(s&&o&&l)?null:S.jsx("svg",{style:e,width:s,height:i,className:"react-flow__connectionline react-flow__container",children:S.jsx("g",{className:_e(["react-flow__connection",$f(a)]),children:S.jsx(Kh,{style:t,type:n,CustomComponent:r,isValid:a})})})}const Kh=({style:e,type:t=un.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:o,from:s,fromNode:i,fromHandle:a,fromPosition:l,to:c,toNode:d,toHandle:f,toPosition:u}=kA();if(!o)return;if(n)return S.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:a,fromX:s.x,fromY:s.y,toX:c.x,toY:c.y,fromPosition:l,toPosition:u,connectionStatus:$f(r),toNode:d,toHandle:f});let h="";const p={sourceX:s.x,sourceY:s.y,sourcePosition:l,targetX:c.x,targetY:c.y,targetPosition:u};switch(t){case un.Bezier:[h]=oh(p);break;case un.SimpleBezier:[h]=Dh(p);break;case un.Step:[h]=ja({...p,borderRadius:0});break;case un.SmoothStep:[h]=ja(p);break;default:[h]=ah(p)}return S.jsx("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};Kh.displayName="ConnectionLine";const LA={};function Yu(e=LA){x.useRef(e),Se(),x.useEffect(()=>{},[e])}function BA(){Se(),x.useRef(!1),x.useEffect(()=>{},[])}function Wh({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:o,onNodeDoubleClick:s,onEdgeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:d,onSelectionContextMenu:f,onSelectionStart:u,onSelectionEnd:h,connectionLineType:p,connectionLineStyle:m,connectionLineComponent:g,connectionLineContainerStyle:y,selectionKeyCode:b,selectionOnDrag:w,selectionMode:E,multiSelectionKeyCode:P,panActivationKeyCode:A,zoomActivationKeyCode:v,deleteKeyCode:M,onlyRenderVisibleElements:N,elementsSelectable:_,defaultViewport:D,translateExtent:B,minZoom:j,maxZoom:R,preventScrolling:O,defaultMarkerColor:I,zoomOnScroll:k,zoomOnPinch:F,panOnScroll:T,panOnScrollSpeed:z,panOnScrollMode:V,zoomOnDoubleClick:U,panOnDrag:K,onPaneClick:Y,onPaneMouseEnter:ee,onPaneMouseMove:Z,onPaneMouseLeave:q,onPaneScroll:W,onPaneContextMenu:te,paneClickDistance:se,nodeClickDistance:oe,onEdgeContextMenu:ne,onEdgeMouseEnter:J,onEdgeMouseMove:re,onEdgeMouseLeave:le,reconnectRadius:ce,onReconnect:me,onReconnectStart:de,onReconnectEnd:be,noDragClassName:ze,noWheelClassName:Xe,noPanClassName:lt,disableKeyboardA11y:wt,nodeExtent:Cn,rfId:xt,viewport:Le,onViewportChange:Qe}){return Yu(e),Yu(t),BA(),PA(n),NA(Le),S.jsx(eA,{onPaneClick:Y,onPaneMouseEnter:ee,onPaneMouseMove:Z,onPaneMouseLeave:q,onPaneContextMenu:te,onPaneScroll:W,paneClickDistance:se,deleteKeyCode:M,selectionKeyCode:b,selectionOnDrag:w,selectionMode:E,onSelectionStart:u,onSelectionEnd:h,multiSelectionKeyCode:P,panActivationKeyCode:A,zoomActivationKeyCode:v,elementsSelectable:_,zoomOnScroll:k,zoomOnPinch:F,zoomOnDoubleClick:U,panOnScroll:T,panOnScrollSpeed:z,panOnScrollMode:V,panOnDrag:K,defaultViewport:D,translateExtent:B,minZoom:j,maxZoom:R,onSelectionContextMenu:f,preventScrolling:O,noDragClassName:ze,noWheelClassName:Xe,noPanClassName:lt,disableKeyboardA11y:wt,onViewportChange:Qe,isControlledViewport:!!Le,children:S.jsxs(RA,{children:[S.jsx(MA,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:i,onReconnect:me,onReconnectStart:de,onReconnectEnd:be,onlyRenderVisibleElements:N,onEdgeContextMenu:ne,onEdgeMouseEnter:J,onEdgeMouseMove:re,onEdgeMouseLeave:le,reconnectRadius:ce,defaultMarkerColor:I,noPanClassName:lt,disableKeyboardA11y:wt,rfId:xt}),S.jsx(OA,{style:m,type:p,component:g,containerStyle:y}),S.jsx("div",{className:"react-flow__edgelabel-renderer"}),S.jsx(lA,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:d,nodeClickDistance:oe,onlyRenderVisibleElements:N,noPanClassName:lt,noDragClassName:ze,disableKeyboardA11y:wt,nodeExtent:Cn,rfId:xt}),S.jsx("div",{className:"react-flow__viewport-portal"})]})})}Wh.displayName="GraphView";const FA=x.memo(Wh),Xu=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:l=.5,maxZoom:c=2,nodeOrigin:d,nodeExtent:f}={})=>{const u=new Map,h=new Map,p=new Map,m=new Map,g=r??t??[],y=n??e??[],b=d??[0,0],w=f??xo;ch(p,m,g);const E=za(y,u,h,{nodeOrigin:b,nodeExtent:w,elevateNodesOnSelect:!1});let P=[0,0,1];if(i&&o&&s){const A=Bo(u,{filter:_=>!!((_.width||_.initialWidth)&&(_.height||_.initialHeight))}),{x:v,y:M,zoom:N}=Dl(A,o,s,l,c,(a==null?void 0:a.padding)??.1);P=[v,M,N]}return{rfId:"1",width:0,height:0,transform:P,nodes:y,nodesInitialized:E,nodeLookup:u,parentLookup:h,edges:g,edgeLookup:m,connectionLookup:p,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:l,maxZoom:c,translateExtent:xo,nodeExtent:w,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Cr.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:b,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Uf},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:ob,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},jA=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:l,maxZoom:c,nodeOrigin:d,nodeExtent:f})=>o1((u,h)=>{async function p(){const{nodeLookup:m,panZoom:g,fitViewOptions:y,fitViewResolver:b,width:w,height:E,minZoom:P,maxZoom:A}=h();g&&(await nb({nodes:m,width:w,height:E,panZoom:g,minZoom:P,maxZoom:A},y),b==null||b.resolve(!0),u({fitViewResolver:null}))}return{...Xu({nodes:e,edges:t,width:o,height:s,fitView:i,fitViewOptions:a,minZoom:l,maxZoom:c,nodeOrigin:d,nodeExtent:f,defaultNodes:n,defaultEdges:r}),setNodes:m=>{const{nodeLookup:g,parentLookup:y,nodeOrigin:b,elevateNodesOnSelect:w,fitViewQueued:E}=h(),P=za(m,g,y,{nodeOrigin:b,nodeExtent:f,elevateNodesOnSelect:w,checkEquality:!0});E&&P?(p(),u({nodes:m,nodesInitialized:P,fitViewQueued:!1,fitViewOptions:void 0})):u({nodes:m,nodesInitialized:P})},setEdges:m=>{const{connectionLookup:g,edgeLookup:y}=h();ch(g,y,m),u({edges:m})},setDefaultNodesAndEdges:(m,g)=>{if(m){const{setNodes:y}=h();y(m),u({hasDefaultNodes:!0})}if(g){const{setEdges:y}=h();y(g),u({hasDefaultEdges:!0})}},updateNodeInternals:m=>{const{triggerNodeChanges:g,nodeLookup:y,parentLookup:b,domNode:w,nodeOrigin:E,nodeExtent:P,debug:A,fitViewQueued:v}=h(),{changes:M,updatedInternals:N}=Ab(m,y,b,w,E,P);N&&(xb(y,b,{nodeOrigin:E,nodeExtent:P}),v?(p(),u({fitViewQueued:!1,fitViewOptions:void 0})):u({}),(M==null?void 0:M.length)>0&&(A&&console.log("React Flow: trigger node changes",M),g==null||g(M)))},updateNodePositions:(m,g=!1)=>{const y=[],b=[],{nodeLookup:w,triggerNodeChanges:E}=h();for(const[P,A]of m){const v=w.get(P),M=!!(v!=null&&v.expandParent&&(v!=null&&v.parentId)&&(A!=null&&A.position)),N={id:P,type:"position",position:M?{x:Math.max(0,A.position.x),y:Math.max(0,A.position.y)}:A.position,dragging:g};M&&v.parentId&&y.push({id:P,parentId:v.parentId,rect:{...A.internals.positionAbsolute,width:A.measured.width??0,height:A.measured.height??0}}),b.push(N)}if(y.length>0){const{parentLookup:P,nodeOrigin:A}=h(),v=jl(y,w,P,A);b.push(...v)}E(b)},triggerNodeChanges:m=>{const{onNodesChange:g,setNodes:y,nodes:b,hasDefaultNodes:w,debug:E}=h();if(m!=null&&m.length){if(w){const P=Sh(m,b);y(P)}E&&console.log("React Flow: trigger node changes",m),g==null||g(m)}},triggerEdgeChanges:m=>{const{onEdgesChange:g,setEdges:y,edges:b,hasDefaultEdges:w,debug:E}=h();if(m!=null&&m.length){if(w){const P=Mh(m,b);y(P)}E&&console.log("React Flow: trigger edge changes",m),g==null||g(m)}},addSelectedNodes:m=>{const{multiSelectionActive:g,edgeLookup:y,nodeLookup:b,triggerNodeChanges:w,triggerEdgeChanges:E}=h();if(g){const P=m.map(A=>Nn(A,!0));w(P);return}w(yr(b,new Set([...m]),!0)),E(yr(y))},addSelectedEdges:m=>{const{multiSelectionActive:g,edgeLookup:y,nodeLookup:b,triggerNodeChanges:w,triggerEdgeChanges:E}=h();if(g){const P=m.map(A=>Nn(A,!0));E(P);return}E(yr(y,new Set([...m]))),w(yr(b,new Set,!0))},unselectNodesAndEdges:({nodes:m,edges:g}={})=>{const{edges:y,nodes:b,nodeLookup:w,triggerNodeChanges:E,triggerEdgeChanges:P}=h(),A=m||b,v=g||y,M=A.map(_=>{const D=w.get(_.id);return D&&(D.selected=!1),Nn(_.id,!1)}),N=v.map(_=>Nn(_.id,!1));E(M),P(N)},setMinZoom:m=>{const{panZoom:g,maxZoom:y}=h();g==null||g.setScaleExtent([m,y]),u({minZoom:m})},setMaxZoom:m=>{const{panZoom:g,minZoom:y}=h();g==null||g.setScaleExtent([y,m]),u({maxZoom:m})},setTranslateExtent:m=>{var g;(g=h().panZoom)==null||g.setTranslateExtent(m),u({translateExtent:m})},setPaneClickDistance:m=>{var g;(g=h().panZoom)==null||g.setClickDistance(m)},resetSelectedElements:()=>{const{edges:m,nodes:g,triggerNodeChanges:y,triggerEdgeChanges:b,elementsSelectable:w}=h();if(!w)return;const E=g.reduce((A,v)=>v.selected?[...A,Nn(v.id,!1)]:A,[]),P=m.reduce((A,v)=>v.selected?[...A,Nn(v.id,!1)]:A,[]);y(E),b(P)},setNodeExtent:m=>{const{nodes:g,nodeLookup:y,parentLookup:b,nodeOrigin:w,elevateNodesOnSelect:E,nodeExtent:P}=h();m[0][0]===P[0][0]&&m[0][1]===P[0][1]&&m[1][0]===P[1][0]&&m[1][1]===P[1][1]||(za(g,y,b,{nodeOrigin:w,nodeExtent:m,elevateNodesOnSelect:E,checkEquality:!1}),u({nodeExtent:m}))},panBy:m=>{const{transform:g,width:y,height:b,panZoom:w,translateExtent:E}=h();return Eb({delta:m,panZoom:w,transform:g,translateExtent:E,width:y,height:b})},cancelConnection:()=>{u({connection:{...Uf}})},updateConnection:m=>{u({connection:m})},reset:()=>u({...Xu()})}},Object.is);function Yh({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:o,initialHeight:s,initialMinZoom:i,initialMaxZoom:a,initialFitViewOptions:l,fitView:c,nodeOrigin:d,nodeExtent:f,children:u}){const[h]=x.useState(()=>jA({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:s,fitView:c,minZoom:i,maxZoom:a,fitViewOptions:l,nodeOrigin:d,nodeExtent:f}));return S.jsx(s1,{value:h,children:S.jsx(P1,{children:u})})}function qA({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:s,height:i,fitView:a,fitViewOptions:l,minZoom:c,maxZoom:d,nodeOrigin:f,nodeExtent:u}){return x.useContext(xi)?S.jsx(S.Fragment,{children:e}):S.jsx(Yh,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:o,initialWidth:s,initialHeight:i,fitView:a,initialFitViewOptions:l,initialMinZoom:c,initialMaxZoom:d,nodeOrigin:f,nodeExtent:u,children:e})}const zA={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function HA({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:s,edgeTypes:i,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:d,onMoveStart:f,onMoveEnd:u,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:g,onClickConnectEnd:y,onNodeMouseEnter:b,onNodeMouseMove:w,onNodeMouseLeave:E,onNodeContextMenu:P,onNodeDoubleClick:A,onNodeDragStart:v,onNodeDrag:M,onNodeDragStop:N,onNodesDelete:_,onEdgesDelete:D,onDelete:B,onSelectionChange:j,onSelectionDragStart:R,onSelectionDrag:O,onSelectionDragStop:I,onSelectionContextMenu:k,onSelectionStart:F,onSelectionEnd:T,onBeforeDelete:z,connectionMode:V,connectionLineType:U=un.Bezier,connectionLineStyle:K,connectionLineComponent:Y,connectionLineContainerStyle:ee,deleteKeyCode:Z="Backspace",selectionKeyCode:q="Shift",selectionOnDrag:W=!1,selectionMode:te=vo.Full,panActivationKeyCode:se="Space",multiSelectionKeyCode:oe=qs()?"Meta":"Control",zoomActivationKeyCode:ne=qs()?"Meta":"Control",snapToGrid:J,snapGrid:re,onlyRenderVisibleElements:le=!1,selectNodesOnDrag:ce,nodesDraggable:me,nodesConnectable:de,nodesFocusable:be,nodeOrigin:ze=Ah,edgesFocusable:Xe,edgesReconnectable:lt,elementsSelectable:wt=!0,defaultViewport:Cn=w1,minZoom:xt=.5,maxZoom:Le=2,translateExtent:Qe=xo,preventScrolling:nr=!0,nodeExtent:Be,defaultMarkerColor:Rn="#b1b1b7",zoomOnScroll:vt=!0,zoomOnPinch:rr=!0,panOnScroll:zi=!1,panOnScrollSpeed:Hi=.5,panOnScrollMode:Go=Ln.Free,zoomOnDoubleClick:Vi=!0,panOnDrag:Ui=!0,onPaneClick:Ve,onPaneMouseEnter:zr,onPaneMouseMove:or,onPaneMouseLeave:Ko,onPaneScroll:Wo,onPaneContextMenu:$i,paneClickDistance:Hr=0,nodeClickDistance:Yo=0,children:L,onReconnect:G,onReconnectStart:Q,onReconnectEnd:ie,onEdgeContextMenu:fe,onEdgeDoubleClick:Ae,onEdgeMouseEnter:Oe,onEdgeMouseMove:Re,onEdgeMouseLeave:bt,reconnectRadius:ct=10,onNodesChange:At,onEdgesChange:c0,noDragClassName:u0="nodrag",noWheelClassName:d0="nowheel",noPanClassName:Nc="nopan",fitView:Tc,fitViewOptions:_c,connectOnClick:f0,attributionPosition:h0,proOptions:p0,defaultEdgeOptions:g0,elevateNodesOnSelect:m0,elevateEdgesOnSelect:y0,disableKeyboardA11y:kc=!1,autoPanOnConnect:w0,autoPanOnNodeDrag:x0,autoPanSpeed:v0,connectionRadius:b0,isValidConnection:A0,onError:E0,style:S0,id:Dc,nodeDragThreshold:M0,viewport:C0,onViewportChange:R0,width:P0,height:I0,colorMode:N0="light",debug:T0,onScroll:Xo,..._0},k0){const Gi=Dc||"1",D0=A1(N0),O0=x.useCallback(Oc=>{Oc.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Xo==null||Xo(Oc)},[Xo]);return S.jsx("div",{"data-testid":"rf__wrapper",..._0,onScroll:O0,style:{...S0,...zA},ref:k0,className:_e(["react-flow",o,D0]),id:Dc,children:S.jsxs(qA,{nodes:e,edges:t,width:P0,height:I0,fitView:Tc,fitViewOptions:_c,minZoom:xt,maxZoom:Le,nodeOrigin:ze,nodeExtent:Be,children:[S.jsx(FA,{onInit:c,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:b,onNodeMouseMove:w,onNodeMouseLeave:E,onNodeContextMenu:P,onNodeDoubleClick:A,nodeTypes:s,edgeTypes:i,connectionLineType:U,connectionLineStyle:K,connectionLineComponent:Y,connectionLineContainerStyle:ee,selectionKeyCode:q,selectionOnDrag:W,selectionMode:te,deleteKeyCode:Z,multiSelectionKeyCode:oe,panActivationKeyCode:se,zoomActivationKeyCode:ne,onlyRenderVisibleElements:le,defaultViewport:Cn,translateExtent:Qe,minZoom:xt,maxZoom:Le,preventScrolling:nr,zoomOnScroll:vt,zoomOnPinch:rr,zoomOnDoubleClick:Vi,panOnScroll:zi,panOnScrollSpeed:Hi,panOnScrollMode:Go,panOnDrag:Ui,onPaneClick:Ve,onPaneMouseEnter:zr,onPaneMouseMove:or,onPaneMouseLeave:Ko,onPaneScroll:Wo,onPaneContextMenu:$i,paneClickDistance:Hr,nodeClickDistance:Yo,onSelectionContextMenu:k,onSelectionStart:F,onSelectionEnd:T,onReconnect:G,onReconnectStart:Q,onReconnectEnd:ie,onEdgeContextMenu:fe,onEdgeDoubleClick:Ae,onEdgeMouseEnter:Oe,onEdgeMouseMove:Re,onEdgeMouseLeave:bt,reconnectRadius:ct,defaultMarkerColor:Rn,noDragClassName:u0,noWheelClassName:d0,noPanClassName:Nc,rfId:Gi,disableKeyboardA11y:kc,nodeExtent:Be,viewport:C0,onViewportChange:R0}),S.jsx(b1,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:g,onClickConnectEnd:y,nodesDraggable:me,nodesConnectable:de,nodesFocusable:be,edgesFocusable:Xe,edgesReconnectable:lt,elementsSelectable:wt,elevateNodesOnSelect:m0,elevateEdgesOnSelect:y0,minZoom:xt,maxZoom:Le,nodeExtent:Be,onNodesChange:At,onEdgesChange:c0,snapToGrid:J,snapGrid:re,connectionMode:V,translateExtent:Qe,connectOnClick:f0,defaultEdgeOptions:g0,fitView:Tc,fitViewOptions:_c,onNodesDelete:_,onEdgesDelete:D,onDelete:B,onNodeDragStart:v,onNodeDrag:M,onNodeDragStop:N,onSelectionDrag:O,onSelectionDragStart:R,onSelectionDragStop:I,onMove:d,onMoveStart:f,onMoveEnd:u,noPanClassName:Nc,nodeOrigin:ze,rfId:Gi,autoPanOnConnect:w0,autoPanOnNodeDrag:x0,autoPanSpeed:v0,onError:E0,connectionRadius:b0,isValidConnection:A0,selectNodesOnDrag:ce,nodeDragThreshold:M0,onBeforeDelete:z,paneClickDistance:Hr,debug:T0}),S.jsx(y1,{onSelectionChange:j}),L,S.jsx(f1,{proOptions:p0,position:h0}),S.jsx(u1,{rfId:Gi,disableKeyboardA11y:kc})]})})}var VA=Ch(HA);const UA=It.error014();function So({id:e,handleType:t,handleId:n,onConnect:r,onDisconnect:o}={}){const s=zl(),i=e??s;if(!i)throw new Error(UA);const a=x.useRef(null),l=ge(c=>c.connectionLookup.get(`${i}${t?n?`-${t}-${n}`:`-${t}`:""}`),Qv);return x.useEffect(()=>{if(a.current&&a.current!==l){const c=l??new Map;cu(a.current,c,o),cu(c,a.current,r)}a.current=l??new Map},[l,r,o]),x.useMemo(()=>Array.from((l==null?void 0:l.values())??[]),[l])}function $A({dimensions:e,lineWidth:t,variant:n,className:r}){return S.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:_e(["react-flow__background-pattern",n,r])})}function GA({radius:e,className:t}){return S.jsx("circle",{cx:e,cy:e,r:e,className:_e(["react-flow__background-pattern","dots",t])})}var fn;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(fn||(fn={}));const KA={[fn.Dots]:1,[fn.Lines]:1,[fn.Cross]:6},WA=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Xh({id:e,variant:t=fn.Dots,gap:n=20,size:r,lineWidth:o=1,offset:s=0,color:i,bgColor:a,style:l,className:c,patternClassName:d}){const f=x.useRef(null),{transform:u,patternId:h}=ge(WA,Ne),p=r||KA[t],m=t===fn.Dots,g=t===fn.Cross,y=Array.isArray(n)?n:[n,n],b=[y[0]*u[2]||1,y[1]*u[2]||1],w=p*u[2],E=Array.isArray(s)?s:[s,s],P=g?[w,w]:b,A=[E[0]*u[2]||1+P[0]/2,E[1]*u[2]||1+P[1]/2],v=`${h}${e||""}`;return S.jsxs("svg",{className:_e(["react-flow__background",c]),style:{...l,...vi,"--xy-background-color-props":a,"--xy-background-pattern-color-props":i},ref:f,"data-testid":"rf__background",children:[S.jsx("pattern",{id:v,x:u[0]%b[0],y:u[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${A[0]},-${A[1]})`,children:m?S.jsx(GA,{radius:w/2,className:d}):S.jsx($A,{dimensions:P,lineWidth:o,variant:t,className:d})}),S.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${v})`})]})}Xh.displayName="Background";const YA=x.memo(Xh);function XA(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:S.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function QA(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:S.jsx("path",{d:"M0 0h32v4.2H0z"})})}function ZA(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:S.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function JA(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:S.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function eE(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:S.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function is({children:e,className:t,...n}){return S.jsx("button",{type:"button",className:_e(["react-flow__controls-button",t]),...n,children:e})}const tE=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function Qh({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:s,onZoomOut:i,onFitView:a,onInteractiveChange:l,className:c,children:d,position:f="bottom-left",orientation:u="vertical","aria-label":h="React Flow controls"}){const p=Se(),{isInteractive:m,minZoomReached:g,maxZoomReached:y}=ge(tE,Ne),{zoomIn:b,zoomOut:w,fitView:E}=$e(),P=()=>{b(),s==null||s()},A=()=>{w(),i==null||i()},v=()=>{E(o),a==null||a()},M=()=>{p.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),l==null||l(!m)},N=u==="horizontal"?"horizontal":"vertical";return S.jsxs(nn,{className:_e(["react-flow__controls",N,c]),position:f,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&S.jsxs(S.Fragment,{children:[S.jsx(is,{onClick:P,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:y,children:S.jsx(XA,{})}),S.jsx(is,{onClick:A,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:g,children:S.jsx(QA,{})})]}),n&&S.jsx(is,{className:"react-flow__controls-fitview",onClick:v,title:"fit view","aria-label":"fit view",children:S.jsx(ZA,{})}),r&&S.jsx(is,{className:"react-flow__controls-interactive",onClick:M,title:"toggle interactivity","aria-label":"toggle interactivity",children:m?S.jsx(eE,{}):S.jsx(JA,{})}),d]})}Qh.displayName="Controls";x.memo(Qh);function nE({id:e,x:t,y:n,width:r,height:o,style:s,color:i,strokeColor:a,strokeWidth:l,className:c,borderRadius:d,shapeRendering:f,selected:u,onClick:h}){const{background:p,backgroundColor:m}=s||{},g=i||p||m;return S.jsx("rect",{className:_e(["react-flow__minimap-node",{selected:u},c]),x:t,y:n,rx:d,ry:d,width:r,height:o,style:{fill:g,stroke:a,strokeWidth:l},shapeRendering:f,onClick:h?y=>h(y,e):void 0})}const rE=x.memo(nE),oE=e=>e.nodes.map(t=>t.id),ua=e=>e instanceof Function?e:()=>e;function sE({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o,nodeComponent:s=rE,onClick:i}){const a=ge(oE,Ne),l=ua(t),c=ua(e),d=ua(n),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return S.jsx(S.Fragment,{children:a.map(u=>S.jsx(aE,{id:u,nodeColorFunc:l,nodeStrokeColorFunc:c,nodeClassNameFunc:d,nodeBorderRadius:r,nodeStrokeWidth:o,NodeComponent:s,onClick:i,shapeRendering:f},u))})}function iE({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:o,nodeStrokeWidth:s,shapeRendering:i,NodeComponent:a,onClick:l}){const{node:c,x:d,y:f,width:u,height:h}=ge(p=>{const{internals:m}=p.nodeLookup.get(e),g=m.userNode,{x:y,y:b}=m.positionAbsolute,{width:w,height:E}=tn(g);return{node:g,x:y,y:b,width:w,height:E}},Ne);return!c||c.hidden||!Zf(c)?null:S.jsx(a,{x:d,y:f,width:u,height:h,style:c.style,selected:!!c.selected,className:r(c),color:t(c),borderRadius:o,strokeColor:n(c),strokeWidth:s,shapeRendering:i,onClick:l,id:c.id})}const aE=x.memo(iE);var lE=x.memo(sE);const cE=200,uE=150,dE=e=>!e.hidden,fE=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Qf(Bo(e.nodeLookup,{filter:dE}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},hE="react-flow__minimap-desc";function Zh({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:o="",nodeBorderRadius:s=5,nodeStrokeWidth:i,nodeComponent:a,bgColor:l,maskColor:c,maskStrokeColor:d,maskStrokeWidth:f,position:u="bottom-right",onClick:h,onNodeClick:p,pannable:m=!1,zoomable:g=!1,ariaLabel:y="React Flow mini map",inversePan:b,zoomStep:w=10,offsetScale:E=5}){const P=Se(),A=x.useRef(null),{boundingRect:v,viewBB:M,rfId:N,panZoom:_,translateExtent:D,flowWidth:B,flowHeight:j}=ge(fE,Ne),R=(e==null?void 0:e.width)??cE,O=(e==null?void 0:e.height)??uE,I=v.width/R,k=v.height/O,F=Math.max(I,k),T=F*R,z=F*O,V=E*F,U=v.x-(T-v.width)/2-V,K=v.y-(z-v.height)/2-V,Y=T+V*2,ee=z+V*2,Z=`${hE}-${N}`,q=x.useRef(0),W=x.useRef();q.current=F,x.useEffect(()=>{if(A.current&&_)return W.current=Tb({domNode:A.current,panZoom:_,getTransform:()=>P.getState().transform,getViewScale:()=>q.current}),()=>{var oe;(oe=W.current)==null||oe.destroy()}},[_]),x.useEffect(()=>{var oe;(oe=W.current)==null||oe.update({translateExtent:D,width:B,height:j,inversePan:b,pannable:m,zoomStep:w,zoomable:g})},[m,g,b,w,D,B,j]);const te=h?oe=>{var re;const[ne,J]=((re=W.current)==null?void 0:re.pointer(oe))||[0,0];h(oe,{x:ne,y:J})}:void 0,se=p?x.useCallback((oe,ne)=>{const J=P.getState().nodeLookup.get(ne).internals.userNode;p(oe,J)},[]):void 0;return S.jsx(nn,{position:u,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof f=="number"?f*F:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:_e(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:S.jsxs("svg",{width:R,height:O,viewBox:`${U} ${K} ${Y} ${ee}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Z,ref:A,onClick:te,children:[y&&S.jsx("title",{id:Z,children:y}),S.jsx(lE,{onClick:se,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:o,nodeStrokeWidth:i,nodeComponent:a}),S.jsx("path",{className:"react-flow__minimap-mask",d:`M${U-V},${K-V}h${Y+V*2}v${ee+V*2}h${-Y-V*2}z
        M${M.x},${M.y}h${M.width}v${M.height}h${-M.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Zh.displayName="MiniMap";x.memo(Zh);function pE({nodeId:e,position:t,variant:n=io.Handle,className:r,style:o={},children:s,color:i,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:f=!1,resizeDirection:u,shouldResize:h,onResizeStart:p,onResize:m,onResizeEnd:g}){const y=zl(),b=typeof e=="string"?e:y,w=Se(),E=x.useRef(null),P=n===io.Line?"right":"bottom-right",A=t??P,v=x.useRef(null);x.useEffect(()=>{if(!(!E.current||!b))return v.current||(v.current=Gb({domNode:E.current,nodeId:b,getStoreItems:()=>{const{nodeLookup:D,transform:B,snapGrid:j,snapToGrid:R,nodeOrigin:O,domNode:I}=w.getState();return{nodeLookup:D,transform:B,snapGrid:j,snapToGrid:R,nodeOrigin:O,paneDomNode:I}},onChange:(D,B)=>{const{triggerNodeChanges:j,nodeLookup:R,parentLookup:O,nodeOrigin:I}=w.getState(),k=[],F={x:D.x,y:D.y},T=R.get(b);if(T&&T.expandParent&&T.parentId){const z=T.origin??I,V=D.width??T.measured.width??0,U=D.height??T.measured.height??0,K={id:T.id,parentId:T.parentId,rect:{width:V,height:U,...Jf({x:D.x??T.position.x,y:D.y??T.position.y},{width:V,height:U},T.parentId,R,z)}},Y=jl([K],R,O,I);k.push(...Y),F.x=D.x?Math.max(z[0]*V,D.x):void 0,F.y=D.y?Math.max(z[1]*U,D.y):void 0}if(F.x!==void 0&&F.y!==void 0){const z={id:b,type:"position",position:{...F}};k.push(z)}if(D.width!==void 0&&D.height!==void 0){const V={id:b,type:"dimensions",resizing:!0,setAttributes:u?u==="horizontal"?"width":"height":!0,dimensions:{width:D.width,height:D.height}};k.push(V)}for(const z of B){const V={...z,type:"position"};k.push(V)}j(k)},onEnd:({width:D,height:B})=>{const j={id:b,type:"dimensions",resizing:!1,dimensions:{width:D,height:B}};w.getState().triggerNodeChanges([j])}})),v.current.update({controlPosition:A,boundaries:{minWidth:a,minHeight:l,maxWidth:c,maxHeight:d},keepAspectRatio:f,resizeDirection:u,onResizeStart:p,onResize:m,onResizeEnd:g,shouldResize:h}),()=>{var D;(D=v.current)==null||D.destroy()}},[A,a,l,c,d,f,p,m,g,h]);const M=A.split("-"),N=n===io.Line?"borderColor":"backgroundColor",_=i?{...o,[N]:i}:o;return S.jsx("div",{className:_e(["react-flow__resize-control","nodrag",...M,n,r]),ref:E,style:_,children:s})}x.memo(pE);const Qu=e=>{let t;const n=new Set,r=(c,d)=>{const f=typeof c=="function"?c(t):c;if(!Object.is(f,t)){const u=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(h=>h(t,u))}},o=()=>t,a={setState:r,getState:o,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=t=e(r,o,a);return a},gE=e=>e?Qu(e):Qu,mE=e=>e;function yE(e,t=mE){const n=St.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return St.useDebugValue(n),n}const Zu=e=>{const t=gE(e),n=r=>yE(t,r);return Object.assign(n,t),n},Ai=e=>e?Zu(e):Zu;class wE{constructor(t,n){H(this,"inputs",new Map);H(this,"outputs",new Map);H(this,"results",new Map);H(this,"mark",null);H(this,"nodeId");H(this,"compute");this.nodeId=t,this.updateData(n)}updateData(t){Object.entries(t).forEach(([n,r])=>{n==="compute"&&(this.compute=r)})}getResult(t){return this.results.get(t)}}const fr=Ai(e=>({nodeMap:new Map,sortedNodes:[],mapErrors:{cycle:!1},replaceNode:t=>{e(n=>{var r;return n.nodeMap.has(t.id)?(r=n.nodeMap.get(t.id))==null||r.updateData(t.data):n.nodeMap.set(t.id,new wE(t.id,t.data)),n})},removeNode:t=>{e(n=>(n.nodeMap.delete(t),n))},addEdge:t=>{e(n=>{const r=n.nodeMap.get(t.source),o=n.nodeMap.get(t.target);if(r&&o&&t.targetHandle&&t.sourceHandle){let s=null;"id"in t?s=t.id:s=vE(t),r.outputs.set(s,{targetNode:o,targetHandleId:t.targetHandle,sourceHandleId:t.sourceHandle}),o.inputs.set(t.targetHandle,{sourceNode:r,sourceHandleId:t.sourceHandle,edgeId:s})}return{...n,sortedNodes:Ju(n.mapErrors,n.nodeMap)}})},removeEdge:t=>{e(n=>{const{edgeSource:r,edgeTarget:o}=xE(t),s=n.nodeMap.get(r),i=n.nodeMap.get(o);return s==null||s.outputs.delete(t),i&&Array.from(i.inputs).some(([a,l])=>l.edgeId===t&&i.inputs.delete(a)),{...n,sortedNodes:Ju(n.mapErrors,n.nodeMap)}})},compute:()=>{e(t=>(bE(t.mapErrors,t.sortedNodes),t))},debugPrint:()=>{e(t=>(console.log(t.mapErrors.cycle),t.nodeMap.forEach(n=>{console.log(n)}),t))}}));function xE(e){const t=/^xy-edge__([0-9a-fA-F-]{36})(.*?)-([0-9a-fA-F-]{36})(.*)$/,n=e.match(t);if(!n)throw new Error("String does not match expected format");return{edgeSource:n[1],edgeSourceHandle:n[2],edgeTarget:n[3],edgeTargetHandle:n[4]}}function vE(e){return"xy-edge__"+e.source+e.sourceHandle+"-"+e.target+e.targetHandle}function bE(e,t){if(e.cycle){console.log("Cannot compute because of cycle");return}t.forEach(([n,r])=>{if(!r.compute)throw new Error("Compute is not defined");r.compute(r.inputs,r.results)})}function Ju(e,t){e.cycle=!1,t.forEach(r=>{r.mark=null});let n=new Map;return t.forEach(r=>{r.mark||Jh(r,n,e)}),e.cycle?[]:Array.from(n).reverse()}function Jh(e,t,n){if(e.mark!=1){if(e.mark==0){console.log("Found cycle"),n.cycle=!0;return}e.mark=0,e.outputs.forEach(({targetNode:r})=>{Jh(r,t,n)}),e.mark=1,t.set(e.nodeId,e)}}const ep=Ai(e=>({keysPressed:{},setKeyPressed:(t,n)=>e(r=>({keysPressed:{...r.keysPressed,[t]:n}}))})),Hs=Ai(e=>({time:0,deltaTime:0,setTime:t=>(t=Math.round(t*1e3)/1e3,e({time:t})),setDeltaTime:t=>e({deltaTime:t})}));var AE=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:t*4-205]=t;return n=>{for(var r=n.length,o=new Uint8Array((r-(n[r-1]=="=")-(n[r-2]=="="))*3/4|0),s=0,i=0;s<r;){var a=e[n.charCodeAt(s++)],l=e[n.charCodeAt(s++)],c=e[n.charCodeAt(s++)],d=e[n.charCodeAt(s++)];o[i++]=a<<2|l>>4,o[i++]=l<<4|c>>2,o[i++]=c<<6|d}return o}})(),EE={version:"3001.0.16"};function Bt(e,t,n){return t>n?Bt(e,n,t):Math.min(Math.max(e,t),n)}var ye,pe=(ye=class{constructor(t,n,r){H(this,"r",255);H(this,"g",255);H(this,"b",255);this.r=Bt(t,0,255),this.g=Bt(n,0,255),this.b=Bt(r,0,255)}static fromArray(t){return new ye(t[0],t[1],t[2])}static fromHex(t){if(typeof t=="number")return new ye(t>>16&255,t>>8&255,t>>0&255);if(typeof t=="string"){let n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(!n)throw new Error("Invalid hex color format");return new ye(parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16))}else throw new Error("Invalid hex color format")}static fromHSL(t,n,r){if(n==0)return new ye(255*r,255*r,255*r);let o=(d,f,u)=>(u<0&&(u+=1),u>1&&(u-=1),u<1/6?d+(f-d)*6*u:u<1/2?f:u<2/3?d+(f-d)*(2/3-u)*6:d),s=r<.5?r*(1+n):r+n-r*n,i=2*r-s,a=o(i,s,t+1/3),l=o(i,s,t),c=o(i,s,t-1/3);return new ye(Math.round(a*255),Math.round(l*255),Math.round(c*255))}clone(){return new ye(this.r,this.g,this.b)}lighten(t){return new ye(this.r+t,this.g+t,this.b+t)}darken(t){return this.lighten(-t)}invert(){return new ye(255-this.r,255-this.g,255-this.b)}mult(t){return new ye(this.r*t.r/255,this.g*t.g/255,this.b*t.b/255)}lerp(t,n){return new ye(nt(this.r,t.r,n),nt(this.g,t.g,n),nt(this.b,t.b,n))}toHSL(){let t=this.r/255,n=this.g/255,r=this.b/255,o=Math.max(t,n,r),s=Math.min(t,n,r),i=(o+s)/2,a=i,l=i;if(o==s)i=a=0;else{let c=o-s;switch(a=l>.5?c/(2-o-s):c/(o+s),o){case t:i=(n-r)/c+(n<r?6:0);break;case n:i=(r-t)/c+2;break;case r:i=(t-n)/c+4;break}i/=6}return[i,a,l]}eq(t){return this.r===t.r&&this.g===t.g&&this.b===t.b}toString(){return`rgb(${this.r}, ${this.g}, ${this.b})`}toHex(){return"#"+((1<<24)+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1)}toArray(){return[this.r,this.g,this.b]}},H(ye,"RED",new ye(255,0,0)),H(ye,"GREEN",new ye(0,255,0)),H(ye,"BLUE",new ye(0,0,255)),H(ye,"YELLOW",new ye(255,255,0)),H(ye,"MAGENTA",new ye(255,0,255)),H(ye,"CYAN",new ye(0,255,255)),H(ye,"WHITE",new ye(255,255,255)),H(ye,"BLACK",new ye(0,0,0)),ye);function we(...e){if(e.length===0)return new pe(255,255,255);if(e.length===1){if(e[0]instanceof pe)return e[0].clone();if(typeof e[0]=="string")return pe.fromHex(e[0]);if(Array.isArray(e[0])&&e[0].length===3)return pe.fromArray(e[0])}else if(e.length===2){if(e[0]instanceof pe)return e[0].clone()}else if(e.length===3||e.length===4)return new pe(e[0],e[1],e[2]);throw new Error("Invalid color arguments")}var SE=(e,t,n)=>pe.fromHSL(e,t,n);function De(e){return e*Math.PI/180}function Vn(e){return e*180/Math.PI}function nt(e,t,n){if(typeof e=="number"&&typeof t=="number")return e+(t-e)*n;if(e instanceof X&&t instanceof X||e instanceof pe&&t instanceof pe)return e.lerp(t,n);throw new Error(`Bad value for lerp(): ${e}, ${t}. Only number, Vec2 and Color is supported.`)}function Ot(e,t,n,r,o){return r+(e-t)/(n-t)*(o-r)}function ME(e,t,n,r,o){return Bt(Ot(e,t,n,r,o),r,o)}var ve,X=(ve=class{constructor(t=0,n=t){H(this,"x",0);H(this,"y",0);this.x=t,this.y=n}static fromAngle(t){let n=De(t);return new ve(Math.cos(n),Math.sin(n))}static fromArray(t){return new ve(t[0],t[1])}clone(){return new ve(this.x,this.y)}add(...t){let n=$(...t);return new ve(this.x+n.x,this.y+n.y)}sub(...t){let n=$(...t);return new ve(this.x-n.x,this.y-n.y)}scale(...t){let n=$(...t);return new ve(this.x*n.x,this.y*n.y)}dist(...t){let n=$(...t);return this.sub(n).len()}sdist(...t){let n=$(...t);return this.sub(n).slen()}static sdist(t,n){let r=t.x-n.x,o=t.y-n.y;return r*r+o*o}len(){return Math.sqrt(this.dot(this))}slen(){return this.dot(this)}unit(){let t=this.len();return t===0?new ve(0):this.scale(1/t)}normal(){return new ve(this.y,-this.x)}reflect(t){return this.sub(t.scale(2*this.dot(t)))}project(t){return t.scale(t.dot(this)/t.len())}reject(t){return this.sub(this.project(t))}dot(t){return this.x*t.x+this.y*t.y}static dot(t,n){return t.x*n.x+t.y*n.y}cross(t){return this.x*t.y-this.y*t.x}static cross(t,n){return t.x*n.y-t.y*n.x}angle(...t){let n=$(...t);return Vn(Math.atan2(this.y-n.y,this.x-n.x))}angleBetween(...t){let n=$(...t);return Vn(Math.atan2(this.cross(n),this.dot(n)))}lerp(t,n){return new ve(nt(this.x,t.x,n),nt(this.y,t.y,n))}slerp(t,n){let r=this.dot(t),o=this.cross(t),s=Math.atan2(o,r);return this.scale(Math.sin((1-n)*s)).add(t.scale(Math.sin(n*s))).scale(1/o)}isZero(){return this.x===0&&this.y===0}toFixed(t){return new ve(Number(this.x.toFixed(t)),Number(this.y.toFixed(t)))}transform(t){return t.multVec2(this)}eq(t){return this.x===t.x&&this.y===t.y}bbox(){return new Ee(this,0,0)}toString(){return`vec2(${this.x.toFixed(2)}, ${this.y.toFixed(2)})`}toArray(){return[this.x,this.y]}},H(ve,"ZERO",new ve(0,0)),H(ve,"ONE",new ve(1,1)),H(ve,"LEFT",new ve(-1,0)),H(ve,"RIGHT",new ve(1,0)),H(ve,"UP",new ve(0,-1)),H(ve,"DOWN",new ve(0,1)),ve);function $(...e){if(e.length===1){if(e[0]instanceof X)return new X(e[0].x,e[0].y);if(Array.isArray(e[0])&&e[0].length===2)return new X(...e[0])}return new X(...e)}var Ie=class Ua{constructor(t,n,r,o){H(this,"x",0);H(this,"y",0);H(this,"w",1);H(this,"h",1);this.x=t,this.y=n,this.w=r,this.h=o}scale(t){return new Ua(this.x+this.w*t.x,this.y+this.h*t.y,this.w*t.w,this.h*t.h)}pos(){return new X(this.x,this.y)}clone(){return new Ua(this.x,this.y,this.w,this.h)}eq(t){return this.x===t.x&&this.y===t.y&&this.w===t.w&&this.h===t.h}toString(){return`quad(${this.x}, ${this.y}, ${this.w}, ${this.h})`}};function ke(e,t,n,r){return new Ie(e,t,n,r)}var Vs=class hr{constructor(t,n,r,o){H(this,"a");H(this,"b");H(this,"c");H(this,"d");this.a=t,this.b=n,this.c=r,this.d=o}mul(t){return new hr(this.a*t.a+this.b*t.c,this.a*t.b+this.b*t.d,this.c*t.a+this.d*t.c,this.c*t.b+this.d*t.d)}transform(t){return $(this.a*t.x+this.b*t.y,this.c*t.x+this.d*t.y)}get inverse(){let t=this.det;return new hr(this.d/t,-this.b/t,-this.c/t,this.a/t)}get transpose(){return new hr(this.a,this.c,this.b,this.d)}get eigenvalues(){let t=this.trace/2,n=this.det,r=t+Math.sqrt(t*t-n),o=t-Math.sqrt(t*t-n);return[r,o]}eigenvectors(t,n){return this.c!=0?[[t-this.d,this.c],[n-this.d,this.c]]:this.b!=0?[[this.b,t-this.a],[this.b,n-this.a]]:Math.abs(this.transform($(1,0)).x-t)<Number.EPSILON?[[1,0],[0,1]]:[[0,1],[1,0]]}get det(){return this.a*this.d-this.b*this.c}get trace(){return this.a+this.d}static rotation(t){let n=Math.cos(t),r=Math.sin(t);return new hr(n,r,-r,n)}static scale(t,n){return new hr(t,0,0,n)}},Qr=class Zr{constructor(t,n,r,o,s,i,a,l,c){H(this,"m11");H(this,"m12");H(this,"m13");H(this,"m21");H(this,"m22");H(this,"m23");H(this,"m31");H(this,"m32");H(this,"m33");this.m11=t,this.m12=n,this.m13=r,this.m21=o,this.m22=s,this.m23=i,this.m31=a,this.m32=l,this.m33=c}static fromMat2(t){return new Zr(t.a,t.b,0,t.c,t.d,0,0,0,1)}toMat2(){return new Vs(this.m11,this.m12,this.m21,this.m22)}mul(t){return new Zr(this.m11*t.m11+this.m12*t.m21+this.m13*t.m31,this.m11*t.m12+this.m12*t.m22+this.m13*t.m32,this.m11*t.m13+this.m12*t.m23+this.m13*t.m33,this.m21*t.m11+this.m22*t.m21+this.m23*t.m31,this.m21*t.m12+this.m22*t.m22+this.m23*t.m32,this.m21*t.m13+this.m22*t.m23+this.m23*t.m33,this.m31*t.m11+this.m32*t.m21+this.m33*t.m31,this.m31*t.m12+this.m32*t.m22+this.m33*t.m32,this.m31*t.m13+this.m32*t.m23+this.m33*t.m33)}get det(){return this.m11*this.m22*this.m33+this.m12*this.m23*this.m31+this.m13*this.m21*this.m32-this.m13*this.m22*this.m31-this.m12*this.m21*this.m33-this.m11*this.m23*this.m32}rotate(t){let n=Math.cos(t),r=Math.sin(t),o=this.m11,s=this.m12;return this.m11=n*this.m11+r*this.m21,this.m12=n*this.m12+r*this.m22,this.m21=n*this.m21-r*o,this.m22=n*this.m22-r*s,this}scale(t,n){return this.m11*=t,this.m12*=t,this.m21*=n,this.m22*=n,this}get inverse(){let t=this.det;return new Zr((this.m22*this.m33-this.m23*this.m32)/t,(this.m13*this.m32-this.m12*this.m33)/t,(this.m12*this.m23-this.m13*this.m22)/t,(this.m23*this.m31-this.m21*this.m33)/t,(this.m11*this.m33-this.m13*this.m31)/t,(this.m13*this.m21-this.m11*this.m23)/t,(this.m21*this.m32-this.m22*this.m31)/t,(this.m12*this.m31-this.m11*this.m32)/t,(this.m11*this.m22-this.m12*this.m21)/t)}get transpose(){return new Zr(this.m11,this.m21,this.m31,this.m12,this.m22,this.m32,this.m13,this.m23,this.m33)}},Ft=class Kt{constructor(t){H(this,"m",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);t&&(this.m=t)}static translate(t){return new Kt([1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,0,1])}static scale(t){return new Kt([t.x,0,0,0,0,t.y,0,0,0,0,1,0,0,0,0,1])}static rotateX(t){t=De(-t);let n=Math.cos(t),r=Math.sin(t);return new Kt([1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1])}static rotateY(t){t=De(-t);let n=Math.cos(t),r=Math.sin(t);return new Kt([n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1])}static rotateZ(t){t=De(-t);let n=Math.cos(t),r=Math.sin(t);return new Kt([n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1])}translate(t){return this.m[12]+=this.m[0]*t.x+this.m[4]*t.y,this.m[13]+=this.m[1]*t.x+this.m[5]*t.y,this.m[14]+=this.m[2]*t.x+this.m[6]*t.y,this.m[15]+=this.m[3]*t.x+this.m[7]*t.y,this}scale(t){return this.m[0]*=t.x,this.m[4]*=t.y,this.m[1]*=t.x,this.m[5]*=t.y,this.m[2]*=t.x,this.m[6]*=t.y,this.m[3]*=t.x,this.m[7]*=t.y,this}rotate(t){t=De(-t);let n=Math.cos(t),r=Math.sin(t),o=this.m[0],s=this.m[1],i=this.m[4],a=this.m[5];return this.m[0]=o*n+s*r,this.m[1]=-o*r+s*n,this.m[4]=i*n+a*r,this.m[5]=-i*r+a*n,this}mult(t){let n=[];for(let r=0;r<4;r++)for(let o=0;o<4;o++)n[r*4+o]=this.m[0*4+o]*t.m[r*4+0]+this.m[1*4+o]*t.m[r*4+1]+this.m[2*4+o]*t.m[r*4+2]+this.m[3*4+o]*t.m[r*4+3];return new Kt(n)}multVec2(t){return new X(t.x*this.m[0]+t.y*this.m[4]+this.m[12],t.x*this.m[1]+t.y*this.m[5]+this.m[13])}getTranslation(){return new X(this.m[12],this.m[13])}getScale(){if(this.m[0]!=0||this.m[1]!=0){let t=this.m[0]*this.m[5]-this.m[1]*this.m[4],n=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return new X(n,t/n)}else if(this.m[4]!=0||this.m[5]!=0){let t=this.m[0]*this.m[5]-this.m[1]*this.m[4],n=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]);return new X(t/n,n)}else return new X(0,0)}getRotation(){if(this.m[0]!=0||this.m[1]!=0){let t=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return Vn(this.m[1]>0?Math.acos(this.m[0]/t):-Math.acos(this.m[0]/t))}else if(this.m[4]!=0||this.m[5]!=0){let t=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]);return Vn(Math.PI/2-(this.m[5]>0?Math.acos(-this.m[4]/t):-Math.acos(this.m[4]/t)))}else return 0}getSkew(){if(this.m[0]!=0||this.m[1]!=0){let t=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return new X(Math.atan(this.m[0]*this.m[4]+this.m[1]*this.m[5])/(t*t),0)}else if(this.m[4]!=0||this.m[5]!=0){let t=Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]);return new X(0,Math.atan(this.m[0]*this.m[4]+this.m[1]*this.m[5])/(t*t))}else return new X(0,0)}invert(){let t=[],n=this.m[10]*this.m[15]-this.m[14]*this.m[11],r=this.m[9]*this.m[15]-this.m[13]*this.m[11],o=this.m[9]*this.m[14]-this.m[13]*this.m[10],s=this.m[8]*this.m[15]-this.m[12]*this.m[11],i=this.m[8]*this.m[14]-this.m[12]*this.m[10],a=this.m[8]*this.m[13]-this.m[12]*this.m[9],l=this.m[6]*this.m[15]-this.m[14]*this.m[7],c=this.m[5]*this.m[15]-this.m[13]*this.m[7],d=this.m[5]*this.m[14]-this.m[13]*this.m[6],f=this.m[4]*this.m[15]-this.m[12]*this.m[7],u=this.m[4]*this.m[14]-this.m[12]*this.m[6],h=this.m[5]*this.m[15]-this.m[13]*this.m[7],p=this.m[4]*this.m[13]-this.m[12]*this.m[5],m=this.m[6]*this.m[11]-this.m[10]*this.m[7],g=this.m[5]*this.m[11]-this.m[9]*this.m[7],y=this.m[5]*this.m[10]-this.m[9]*this.m[6],b=this.m[4]*this.m[11]-this.m[8]*this.m[7],w=this.m[4]*this.m[10]-this.m[8]*this.m[6],E=this.m[4]*this.m[9]-this.m[8]*this.m[5];t[0]=this.m[5]*n-this.m[6]*r+this.m[7]*o,t[4]=-(this.m[4]*n-this.m[6]*s+this.m[7]*i),t[8]=this.m[4]*r-this.m[5]*s+this.m[7]*a,t[12]=-(this.m[4]*o-this.m[5]*i+this.m[6]*a),t[1]=-(this.m[1]*n-this.m[2]*r+this.m[3]*o),t[5]=this.m[0]*n-this.m[2]*s+this.m[3]*i,t[9]=-(this.m[0]*r-this.m[1]*s+this.m[3]*a),t[13]=this.m[0]*o-this.m[1]*i+this.m[2]*a,t[2]=this.m[1]*l-this.m[2]*c+this.m[3]*d,t[6]=-(this.m[0]*l-this.m[2]*f+this.m[3]*u),t[10]=this.m[0]*h-this.m[1]*f+this.m[3]*p,t[14]=-(this.m[0]*d-this.m[1]*u+this.m[2]*p),t[3]=-(this.m[1]*m-this.m[2]*g+this.m[3]*y),t[7]=this.m[0]*m-this.m[2]*b+this.m[3]*w,t[11]=-(this.m[0]*g-this.m[1]*b+this.m[3]*E),t[15]=this.m[0]*y-this.m[1]*w+this.m[2]*E;let P=this.m[0]*t[0]+this.m[1]*t[4]+this.m[2]*t[8]+this.m[3]*t[12];for(let A=0;A<4;A++)for(let v=0;v<4;v++)t[A*4+v]*=1/P;return new Kt(t)}clone(){return new Kt([...this.m])}toString(){return this.m.toString()}};function tp(e,t,n,r=o=>-Math.cos(o)){return e+(r(n)+1)/2*(t-e)}var CE=1103515245,RE=12345,ed=2147483648,np=class{constructor(e){H(this,"seed");this.seed=e}gen(){return this.seed=(CE*this.seed+RE)%ed,this.seed/ed}genNumber(e,t){return e+this.gen()*(t-e)}genVec2(e,t){return new X(this.genNumber(e.x,t.x),this.genNumber(e.y,t.y))}genColor(e,t){return new pe(this.genNumber(e.r,t.r),this.genNumber(e.g,t.g),this.genNumber(e.b,t.b))}genAny(...e){if(e.length===0)return this.gen();if(e.length===1){if(typeof e[0]=="number")return this.genNumber(0,e[0]);if(e[0]instanceof X)return this.genVec2($(0,0),e[0]);if(e[0]instanceof pe)return this.genColor(we(0,0,0),e[0])}else if(e.length===2){if(typeof e[0]=="number"&&typeof e[1]=="number")return this.genNumber(e[0],e[1]);if(e[0]instanceof X&&e[1]instanceof X)return this.genVec2(e[0],e[1]);if(e[0]instanceof pe&&e[1]instanceof pe)return this.genColor(e[0],e[1])}throw new Error("More than 2 arguments not supported")}},$a=new np(Date.now());function PE(e){return e!=null&&($a.seed=e),$a.seed}function je(...e){return $a.genAny(...e)}function rp(...e){return Math.floor(je(...e.length>0?e:[2]))}function IE(e){return je()<=e}function op(e){for(let t=e.length-1;t>0;t--){let n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function NE(e,t){return e.length<=t?e.slice():op(e.slice()).slice(0,t)}function TE(e){return e[rp(e.length)]}function sp(e,t){return e.pos.x+e.width>t.pos.x&&e.pos.x<t.pos.x+t.width&&e.pos.y+e.height>t.pos.y&&e.pos.y<t.pos.y+t.height}function _E(e,t){if(e.p1.x===e.p2.x&&e.p1.y===e.p2.y||t.p1.x===t.p2.x&&t.p1.y===t.p2.y)return null;let n=(t.p2.y-t.p1.y)*(e.p2.x-e.p1.x)-(t.p2.x-t.p1.x)*(e.p2.y-e.p1.y);if(n===0)return null;let r=((t.p2.x-t.p1.x)*(e.p1.y-t.p1.y)-(t.p2.y-t.p1.y)*(e.p1.x-t.p1.x))/n,o=((e.p2.x-e.p1.x)*(e.p1.y-t.p1.y)-(e.p2.y-e.p1.y)*(e.p1.x-t.p1.x))/n;return r<0||r>1||o<0||o>1?null:r}function Hl(e,t){let n=_E(e,t);return n?$(e.p1.x+n*(e.p2.x-e.p1.x),e.p1.y+n*(e.p2.y-e.p1.y)):null}function Vl(e,t){let n=t.p2.sub(t.p1),r=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;if(n.x!=0){let s=(e.pos.x-t.p1.x)/n.x,i=(e.pos.x+e.width-t.p1.x)/n.x;r=Math.max(r,Math.min(s,i)),o=Math.min(o,Math.max(s,i))}if(n.y!=0){let s=(e.pos.y-t.p1.y)/n.y,i=(e.pos.y+e.height-t.p1.y)/n.y;r=Math.max(r,Math.min(s,i)),o=Math.min(o,Math.max(s,i))}return o>=r&&o>=0&&r<=1}function Ei(e,t){return t.x>e.pos.x&&t.x<e.pos.x+e.width&&t.y>e.pos.y&&t.y<e.pos.y+e.height}function ip(e,t){let n=Math.max(e.pos.x,Math.min(t.center.x,e.pos.x+e.width)),r=Math.max(e.pos.y,Math.min(t.center.y,e.pos.y+e.height));return $(n,r).sdist(t.center)<=t.radius*t.radius}function ap(e,t){return lp(t,new Ye(e.points()))}function Ul(e,t){let n=t.sub(e.p1),r=e.p2.sub(e.p1);if(Math.abs(n.cross(r))>Number.EPSILON)return!1;let o=n.dot(r)/r.dot(r);return o>=0&&o<=1}function jo(e,t){let n=e.p2.sub(e.p1),r=n.dot(n),o=e.p1.sub(t.center),s=2*n.dot(o),i=o.dot(o)-t.radius*t.radius,a=s*s-4*r*i;if(r<=Number.EPSILON||a<0)return!1;if(a==0){let l=-s/(2*r);if(l>=0&&l<=1)return!0}else{let l=(-s+Math.sqrt(a))/(2*r),c=(-s-Math.sqrt(a))/(2*r);if(l>=0&&l<=1||c>=0&&c<=1)return!0}return Si(t,e.p1)}function $l(e,t){if(yn(t,e.p1)||yn(t,e.p2))return!0;for(let n=0;n<t.pts.length;n++){let r=t.pts[n],o=t.pts[(n+1)%t.pts.length];if(Hl(e,new it(r,o)))return!0}return!1}function Si(e,t){return e.center.sdist(t)<e.radius*e.radius}function kE(e,t){return e.center.sdist(t.center)<(e.radius+t.radius)*(e.radius+t.radius)}function Mi(e,t){let n=t.pts[t.pts.length-1];for(let r of t.pts){if(jo(new it(n,r),e))return!0;n=r}return Si(e,t.pts[0])?!0:yn(t,e.center)}function lp(e,t){for(let n=0;n<e.pts.length;n++)if($l(new it(e.pts[n],e.pts[(n+1)%e.pts.length]),t))return!0;return!!(e.pts.some(n=>yn(t,n))||t.pts.some(n=>yn(e,n)))}function yn(e,t){let n=!1,r=e.pts;for(let o=0,s=r.length-1;o<r.length;s=o++)r[o].y>t.y!=r[s].y>t.y&&t.x<(r[s].x-r[o].x)*(t.y-r[o].y)/(r[s].y-r[o].y)+r[o].x&&(n=!n);return n}function Gl(e,t){t=t.sub(e.center);let n=De(e.angle),r=Math.cos(n),o=Math.sin(n),s=t.x*r+t.y*o,i=-t.x*o+t.y*r;return s*s/(e.radiusX*e.radiusX)+i*i/(e.radiusY*e.radiusY)<1}function Us(e,t){let n=t.center.sub(e.center),r=De(e.angle),o=Math.cos(r),s=Math.sin(r),i=n.x*o+n.y*s,a=-n.x*s+n.y*o;return Gl(new rn($(),e.radiusX+t.radius,e.radiusY+t.radius,0),$(i,a))}function cp(e,t){let n=e.toMat2().inverse;return t=new it(n.transform(t.p1.sub(e.center)),n.transform(t.p2.sub(e.center))),jo(t,new st($(),1))}function DE(e,t){if(e.radiusX===e.radiusY)return Us(t,new st(e.center,e.radiusX));if(t.radiusX===t.radiusY)return Us(e,new st(t.center,t.radiusX));let n=new Qr(1/e.radiusX**2,0,0,0,1/e.radiusY**2,0,0,0,-1),r=new Qr(1/t.radiusX**2,0,0,0,1/t.radiusY**2,0,0,0,-1),o=e.center.x,s=e.center.y,i=t.center.x,a=t.center.y,l=De(e.angle),c=De(t.angle),d=new Qr(Math.cos(l),-Math.sin(l),o,Math.sin(l),Math.cos(l),s,0,0,1),f=new Qr(Math.cos(c),-Math.sin(c),i,Math.sin(c),Math.cos(c),a,0,0,1),u=d.inverse,h=f.inverse,p=u.transpose.mul(n).mul(u),m=h.transpose.mul(r).mul(h),g=p.m11,y=p.m12,b=p.m13,w=p.m21,E=p.m22,P=p.m23,A=p.m31,v=p.m32,M=p.m33,N=m.m11,_=m.m12,D=m.m13,B=m.m21,j=m.m22,R=m.m23,O=m.m31,I=m.m32,k=m.m33,F=g*E*M-g*P*v-y*w*M+y*P*A+b*w*v-b*E*A,T=(g*E*k-g*P*I-g*v*R+g*M*j-y*w*k+y*P*O+y*A*R-y*M*B+b*w*I-b*E*O-b*A*j+b*v*B+w*v*D-w*M*_-E*A*D+E*M*N+P*A*_-P*v*N)/F,z=(g*j*k-g*R*I-y*B*k+y*R*O+b*B*I-b*j*O-w*_*k+w*D*I+E*N*k-E*D*O-P*N*I+P*_*O+A*_*R-A*D*j-v*N*R+v*D*B+M*N*j-M*_*B)/F,V=(N*j*k-N*R*I-_*B*k+_*R*O+D*B*I-D*j*O)/F;if(T>=0){let U=-3*z+T**2,K=3*T*V+z*T**2-4*z**2,Y=-27*V**2+18*V*T*z+T**2*z**2-4*T**3*V-4*z**3;return!(U>0&&K<0&&Y>0)}else{let U=-3*z+T**2,K=-27*V**2+18*V*T*z+T**2*z**2-4*T**3*V-4*z**3;return!(U>0&&K>0)}}function up(e,t){return Kl(e,new Ye(t.points()))}function Kl(e,t){let n=e.toMat2().inverse;return t=new Ye(t.pts.map(r=>n.transform(r.sub(e.center)))),Mi(new st($(),1),t)}function OE(e,t){return e.x===t.x&&e.y===t.y}function LE(e,t){return t instanceof X?OE(t,e.pt):t instanceof st?Si(t,e.pt):t instanceof it?Ul(t,e.pt):t instanceof Ee?Ei(t,e.pt):t instanceof Ye?yn(t,e.pt):t instanceof rn?Gl(t,e.pt):!1}function BE(e,t){return t instanceof X?Ul(e,t):t instanceof st?jo(e,t):t instanceof it?Hl(e,t)!=null:t instanceof Ee?Vl(t,e):t instanceof Ye?$l(e,t):t instanceof rn?cp(t,e):!1}function FE(e,t){return t instanceof X?Si(e,t):t instanceof st?kE(e,t):t instanceof it?jo(t,e):t instanceof Ee?ip(t,e):t instanceof Ye?Mi(e,t):t instanceof rn?Us(t,e):!1}function jE(e,t){return t instanceof X?Ei(e,t):t instanceof st?ip(e,t):t instanceof it?Vl(e,t):t instanceof Ee?sp(e,t):t instanceof Ye?ap(e,t):t instanceof rn?up(t,e):!1}function qE(e,t){return t instanceof X?yn(e,t):t instanceof st?Mi(t,e):t instanceof it?$l(t,e):t instanceof Ee?ap(t,e):t instanceof Ye?lp(t,e):t instanceof rn?Kl(t,e):!1}function zE(e,t){return t instanceof X?Gl(e,t):t instanceof st?Us(e,t):t instanceof it?cp(e,t):t instanceof Ee?up(e,t):t instanceof Ye?Kl(e,t):t instanceof rn?DE(t,e):!1}function dp(e,t,n){let r=e,o=n.p1,s=n.p2,i=t,a=s.sub(o),l=i.cross(a);if(Math.abs(l)<Number.EPSILON)return null;let c=o.sub(r),d=c.cross(a)/l;if(d<=0||d>=1)return null;let f=c.cross(i)/l;if(f<=0||f>=1)return null;let u=a.normal().unit();return t.dot(u)>0&&(u.x*=-1,u.y*=-1),{point:r.add(i.scale(d)),normal:u,fraction:d}}function HE(e,t,n){let r=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY,s;if(e.x!=0){let i=(n.pos.x-e.x)/t.x,a=(n.pos.x+n.width-e.x)/t.x;s=$(-Math.sign(t.x),0),r=Math.max(r,Math.min(i,a)),o=Math.min(o,Math.max(i,a))}if(e.y!=0){let i=(n.pos.y-e.y)/t.y,a=(n.pos.y+n.height-e.y)/t.y;Math.min(i,a)>r&&(s=$(0,-Math.sign(t.y))),r=Math.max(r,Math.min(i,a)),o=Math.min(o,Math.max(i,a))}return o>=r&&r>=0&&r<=1?{point:e.add(t.scale(r)),normal:s,fraction:r}:null}function fp(e,t,n){let r=e,o=n.center,s=t,i=s.dot(s),a=r.sub(o),l=2*s.dot(a),c=a.dot(a)-n.radius*n.radius,d=l*l-4*i*c;if(i<=Number.EPSILON||d<0)return null;if(d==0){let f=-l/(2*i);if(f>=0&&f<=1){let u=r.add(s.scale(f));return{point:u,normal:u.sub(o),fraction:f}}}else{let f=(-l+Math.sqrt(d))/(2*i),u=(-l-Math.sqrt(d))/(2*i),h=null;if(f>=0&&f<=1&&(h=f),u>=0&&u<=1&&(h=Math.min(u,h??u)),h!=null){let p=r.add(s.scale(h));return{point:p,normal:p.sub(o).unit(),fraction:h}}}return null}function VE(e,t,n){let r=n.pts,o=null,s=r[r.length-1];for(let i=0;i<r.length;i++){let a=r[i],l=dp(e,t,new it(s,a));l&&(!o||o.fraction>l.fraction)&&(o=l),s=a}return o}function UE(e,t,n){let r=n.toMat2(),o=r.inverse,s=o.transform(e.sub(n.center)),i=o.transform(t),a=fp(s,i,new st($(),1));if(a){let l=Vs.rotation(De(-n.angle)),c=Vs.scale(n.radiusX,n.radiusY).transform(a.point),d=r.transform(a.point).add(n.center),f=d.dist(e)/t.len();return{point:d,normal:l.transform($(n.radiusY**2*c.x,n.radiusX**2*c.y)).unit(),fraction:f}}return a}function $E(e,t,n,r=64){let o=e,s=t.len(),i=t.scale(1/s),a=0,l=$(Math.floor(e.x),Math.floor(e.y)),c=$(i.x>0?1:-1,i.y>0?1:-1),d=$(Math.abs(1/i.x),Math.abs(1/i.y)),f=$(c.x>0?l.x+1-e.x:e.x-l.x,c.y>0?l.y+1-e.y:e.y-l.y),u=$(d.x<1/0?d.x*f.x:1/0,d.y<1/0?d.y*f.y:1/0),h=-1;for(;a<=r;){let p=n(l);if(p===!0)return{point:o.add(i.scale(a)),normal:$(h===0?-c.x:0,h===1?-c.y:0),fraction:a/s,gridPos:l};if(p)return p;u.x<u.y?(l.x+=c.x,a=u.x,u.x+=d.x,h=0):(l.y+=c.y,a=u.y,u.y+=d.y,h=1)}return null}var GE=class Ga{constructor(t){H(this,"pt");this.pt=t.clone()}transform(t){return new Ga(t.multVec2(this.pt))}bbox(){return new Ee(this.pt,0,0)}area(){return 0}clone(){return new Ga(this.pt)}collides(t){return LE(this,t)}contains(t){return this.pt.eq(t)}raycast(t,n){return null}random(){return this.pt.clone()}},it=class Ka{constructor(t,n){H(this,"p1");H(this,"p2");this.p1=t.clone(),this.p2=n.clone()}transform(t){return new Ka(t.multVec2(this.p1),t.multVec2(this.p2))}bbox(){return Ee.fromPoints(this.p1,this.p2)}area(){return this.p1.dist(this.p2)}clone(){return new Ka(this.p1,this.p2)}collides(t){return BE(this,t)}contains(t){return this.collides(t)}raycast(t,n){return dp(t,n,this)}random(){return this.p1.add(this.p2.sub(this.p1).scale(je(1)))}},Ee=class Wa{constructor(t,n,r){H(this,"pos");H(this,"width");H(this,"height");this.pos=t.clone(),this.width=n,this.height=r}static fromPoints(t,n){return new Wa(t.clone(),n.x-t.x,n.y-t.y)}center(){return new X(this.pos.x+this.width/2,this.pos.y+this.height/2)}points(){return[this.pos,this.pos.add(this.width,0),this.pos.add(this.width,this.height),this.pos.add(0,this.height)]}transform(t){return new Ye(this.points().map(n=>t.multVec2(n)))}bbox(){return this.clone()}area(){return this.width*this.height}clone(){return new Wa(this.pos.clone(),this.width,this.height)}distToPoint(t){return Math.sqrt(this.sdistToPoint(t))}sdistToPoint(t){let n=this.pos,r=this.pos.add(this.width,this.height),o=Math.max(n.x-t.x,0,t.x-r.x),s=Math.max(n.y-t.y,0,t.y-r.y);return o*o+s*s}collides(t){return jE(this,t)}contains(t){return this.collides(t)}raycast(t,n){return HE(t,n,this)}random(){return this.pos.add(je(this.width),je(this.height))}},st=class hp{constructor(t,n){H(this,"center");H(this,"radius");this.center=t.clone(),this.radius=n}transform(t){return new rn(this.center,this.radius,this.radius).transform(t)}bbox(){return Ee.fromPoints(this.center.sub($(this.radius)),this.center.add($(this.radius)))}area(){return this.radius*this.radius*Math.PI}clone(){return new hp(this.center,this.radius)}collides(t){return FE(this,t)}contains(t){return this.collides(t)}raycast(t,n){return fp(t,n,this)}random(){return this.center.add(X.fromAngle(je(360)).scale(je(this.radius)))}},rn=class pr{constructor(t,n,r,o=0){H(this,"center");H(this,"radiusX");H(this,"radiusY");H(this,"angle");this.center=t.clone(),this.radiusX=n,this.radiusY=r,this.angle=o}static fromMat2(t){let n=t.inverse,r=n.transpose.mul(n),[o,s]=r.eigenvalues,[i,a]=r.eigenvectors(o,s),[l,c]=[1/Math.sqrt(o),1/Math.sqrt(s)];return l>c?new pr($(),l,c,Vn(Math.atan2(-i[1],i[0]))):new pr($(),c,l,Vn(Math.atan2(-a[1],a[0])))}toMat2(){let t=De(this.angle),n=Math.cos(t),r=Math.sin(t);return new Vs(n*this.radiusX,-r*this.radiusY,r*this.radiusX,n*this.radiusY)}transform(t){if(this.angle==0&&t.getRotation()==0)return new pr(t.multVec2(this.center),t.m[0]*this.radiusX,t.m[5]*this.radiusY);{let n=this.toMat2(),r=t.getRotation(),o=t.getScale();n=Qr.fromMat2(n).scale(o.x,o.y).rotate(r).toMat2();let s=pr.fromMat2(n);return s.center=t.multVec2(this.center),s}}bbox(){if(this.angle==0)return Ee.fromPoints(this.center.sub($(this.radiusX,this.radiusY)),this.center.add($(this.radiusX,this.radiusY)));{let t=De(this.angle),n=Math.cos(t),r=Math.sin(t),o=this.radiusX*n,s=this.radiusX*r,i=this.radiusY*r,a=this.radiusY*n,l=Math.sqrt(o*o+i*i),c=Math.sqrt(s*s+a*a);return Ee.fromPoints(this.center.sub($(l,c)),this.center.add($(l,c)))}}area(){return this.radiusX*this.radiusY*Math.PI}clone(){return new pr(this.center,this.radiusX,this.radiusY,this.angle)}collides(t){return zE(this,t)}contains(t){t=t.sub(this.center);let n=De(this.angle),r=Math.cos(n),o=Math.sin(n),s=t.x*r+t.y*o,i=-t.x*o+t.y*r;return s*s/(this.radiusX*this.radiusX)+i*i/(this.radiusY*this.radiusY)<1}raycast(t,n){return UE(t,n,this)}random(){return this.center}};function KE(e,t,n,r){let o=t.sub(e),s=r.sub(n),i=o.cross(s);return i<1e-5&&i>-1e-5||(i=n.sub(e).cross(s)/i,i<0||i>1)?null:e.add(o.scale(i))}var Ye=class Jr{constructor(t){H(this,"pts");if(t.length<3)throw new Error("Polygons should have at least 3 vertices");this.pts=t}transform(t){return new Jr(this.pts.map(n=>t.multVec2(n)))}bbox(){let t=$(Number.MAX_VALUE),n=$(-Number.MAX_VALUE);for(let r of this.pts)t.x=Math.min(t.x,r.x),n.x=Math.max(n.x,r.x),t.y=Math.min(t.y,r.y),n.y=Math.max(n.y,r.y);return Ee.fromPoints(t,n)}area(){let t=0,n=this.pts.length;for(let r=0;r<n;r++){let o=this.pts[r],s=this.pts[(r+1)%n];t+=o.x*s.y*.5,t-=s.x*o.y*.5}return Math.abs(t)}clone(){return new Jr(this.pts.map(t=>t.clone()))}collides(t){return qE(this,t)}contains(t){return this.collides(t)}raycast(t,n){return VE(t,n,this)}random(){return $()}cut(t,n){new it(t,n);let r=[],o=[],s=n.sub(t),i=this.pts[this.pts.length-1],a=i.sub(t),l=s.cross(a)>0;return this.pts.forEach(c=>{a=c.sub(t);let d=s.cross(a)>0;if(l!=d){let f=KE(i,c,t,n);r.push(f),o.push(f),l=d}(d?r:o).push(c),i=c}),[r.length?new Jr(r):null,o.length?new Jr(o):null]}};function WE(e,t,n,r){let o=r*r,s=1-r,i=s*s;return e.scale(i).add(t.scale(2*s*r)).add(n.scale(o))}function YE(e,t,n,r){let o=1-r;return t.sub(e).scale(2*o).add(n.sub(t).scale(2*r))}function XE(e,t,n,r){return n.sub(t.scale(2)).add(e).scale(2)}function Wl(e,t,n,r,o){let s=o*o,i=s*o,a=1-o,l=a*a,c=l*a;return e.scale(c).add(t.scale(3*l*o)).add(n.scale(3*a*s)).add(r.scale(i))}function QE(e,t,n,r,o){let s=o*o,i=1-o,a=i*i;return t.sub(e).scale(3*a).add(n.sub(t).scale(6*i*o)).add(r.sub(n).scale(3*s))}function ZE(e,t,n,r,o){let s=1-o;return n.sub(t.scale(2)).add(e).scale(6*s).add(r.sub(n.scale(2)).add(t).scale(6*o))}function JE(e,t,n,r,o){let s=.5*(((-o+2)*o-1)*o),i=.5*((3*o-5)*o*o+2),a=.5*(((-3*o+4)*o+1)*o),l=.5*((o-1)*o*o);return e.scale(s).add(t.scale(i)).add(n.scale(a)).add(r.scale(l))}function eS(e,t,n,r,o){let s=.5*((-3*o+4)*o-1),i=.5*((9*o-10)*o),a=.5*((-9*o+8)*o+1),l=.5*((3*o-2)*o);return e.scale(s).add(t.scale(i)).add(n.scale(a)).add(r.scale(l))}function tS(e){let t=pp(e),n=t(1);return r=>{let o=r*n,s=t(o,!0);return e(s)}}function pp(e,t=10,n=10){let r=[0],o=[0],s=1/(t-1)/n,i=0,a=e(0),l=0;for(let c=1;c<t;c++){for(let d=0;d<n;d++){l+=s;let f=e(l),u=f.dist(a);i+=u,a=f}r[c]=i,o[c]=l}return o[t-1]=1,(c,d=!1)=>{if(d){let f=c;if(f<=0)return 0;if(f>=i)return 1;let u=0;for(;r[u+1]<f;)u++;let h=o[u],p=o[u+1],m=r[u],g=r[u+1],y=(f-m)/(g-m);return h+(p-h)*y}else{if(c<=0)return 0;if(c>=1)return r[t-1];let f=0;for(;o[f+1]<c;)f++;let u=o[f],h=o[f+1],p=r[f],m=r[f+1],g=(c-u)/(h-u);return p+(m-p)*g}}}function qo(e,t,n,r){let o=2*e+t-2*r+n,s=-3*e+3*r-2*t-n,i=t,a=e;return l=>{let c=l*l,d=c*l;return o*d+s*c+i*l+a}}function gp(e,t,n,r,o,s=qo){let i=s(t.x,(1-o)*(n.x-e.x),(1-o)*(r.x-t.x),n.x),a=s(t.y,(1-o)*(n.y-e.y),(1-o)*(r.y-t.y),n.y);return l=>new X(i(l),a(l))}function $s(e,t,n,r,o=qo){return gp(e,t,n,r,.5,o)}function nS(e,t,n,r,o=qo){return $s(r.add(e.sub(t).scale(6)),e,r,e.add(r.sub(n).scale(6)),o)}function rS(e,t,n,r,o,s,i,a=qo){let l=a(t.x,.5*(1-o)*(1+i)*(1+s)*(t.x-e.x)+.5*(1-o)*(1-i)*(1-s)*(n.x-t.x),.5*(1-o)*(1+i)*(1-s)*(n.x-t.x)+.5*(1-o)*(1-i)*(1+s)*(r.x-n.x),n.x),c=a(t.y,.5*(1-o)*(1+i)*(1+s)*(t.y-e.y)+.5*(1-o)*(1-i)*(1-s)*(n.y-t.y),.5*(1-o)*(1+i)*(1-s)*(n.y-t.y)+.5*(1-o)*(1-i)*(1+s)*(r.y-n.y),n.y);return d=>new X(l(d),c(d))}function oS(e,t,n,r){let o=2*e+t-2*r+n,s=-3*e+3*r-2*t+n,i=t;return a=>{let l=a*a;return 3*o*l+2*s*a+i}}function $r(e){return 0<=e&&e<=1}function da(e,t){return Math.abs(e-t)<=Number.EPSILON}function Gr(e){return e<0?-Math.pow(-e,1/3):Math.pow(e,1/3)}function sS(e,t,n,r){let o=3*e-6*t+3*n,s=-3*e+3*t,i=e,a=-e+3*t-3*n+r;if(da(a,0)){if(da(o,0))return da(s,0)?[]:[-i/s].filter($r);let g=Math.sqrt(s*s-4*o*i),y=2*o;return[(g-s)/y,(-s-g)/y].filter($r)}o/=a,s/=a,i/=a;let l=(3*s-o*o)/3,c=l/3,d=(2*o*o*o-9*o*s+27*i)/27,f=d/2,u=f*f+c*c*c;if(u<0){let g=-l/3,y=g*g*g,b=Math.sqrt(y),w=-d/(2*b),E=w<-1?-1:w>1?1:w,P=Math.acos(E),A=2*Gr(b),v=A*Math.cos(P/3)-o/3,M=A*Math.cos((P+2*Math.PI)/3)-o/3,N=A*Math.cos((P+4*Math.PI)/3)-o/3;return[v,M,N].filter($r)}if(u===0){let g=f<0?Gr(-f):-Gr(f),y=2*g-o/3,b=-g-o/3;return[y,b].filter($r)}let h=Math.sqrt(u),p=Gr(h-f),m=Gr(h+f);return[p-m-o/3].filter($r)}function iS(e,t,n,r,o){let s=sS(e.x-o,t.x-o,n.x-o,r.x-o);return s.length>0?Wl(e,t,n,r,s[0]).y:NaN}function aS(e){if(!e||e.length==0)throw new Error("Need at least one point for easingLinear.");let t=e.length;return n=>{if(n<=0||e.length==1||n<=e[0].x)return e[0].y;for(let r=0;r<t;r++)if(e[r].x>=n)return Ot(n,e[r-1].x,e[r].x,e[r-1].y,e[r].y);return e[e.length-1].y}}function lS(e,t){return n=>iS($(0,0),e,t,$(1,1),n)}function cS(e,t="jump-end"){let n=1/e,r=t=="jump-start"||t=="jump-both",o=t=="jump-end"||t=="jump-both",s=1/(e+(o?1:0)),i=r?s:0;return a=>{let l=Math.floor(a/n);return i+l*s}}function uS(e,t){let n=Number.MAX_VALUE,r={normal:$(0),distance:0};for(let o of[e,t])for(let s=0;s<o.pts.length;s++){let i=o.pts[s],a=o.pts[(s+1)%o.pts.length].sub(i).normal().unit(),l=Number.MAX_VALUE,c=-Number.MAX_VALUE;for(let h=0;h<e.pts.length;h++){let p=e.pts[h].dot(a);l=Math.min(l,p),c=Math.max(c,p)}let d=Number.MAX_VALUE,f=-Number.MAX_VALUE;for(let h=0;h<t.pts.length;h++){let p=t.pts[h].dot(a);d=Math.min(d,p),f=Math.max(f,p)}let u=Math.min(c,f)-Math.max(l,d);if(u<0)return null;if(u<Math.abs(n)){let h=f-l,p=d-c;n=Math.abs(h)<Math.abs(p)?h:p,r.normal=a,r.distance=n}}return r}function mp(e,t,n){return(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)>=0}function dS(e){let t=0,n=e[e.length-1];for(let r=0;r<e.length;r++)t+=(e[r].x-n.x)*(e[r].y+n.y),n=e[r];return t<0}function fa(e,t,n,r){let o=r.x-n.x,s=r.y-n.y,i=o*(e.y-n.y)-s*(e.x-n.x),a=o*(t.y-n.y)-s*(t.x-n.x);return i*a>=0}function fS(e,t,n,r){return fa(e,t,n,r)&&fa(e,n,t,r)&&fa(e,r,t,n)}function hS(e,t,n,r){for(let o of e)if(o!==t&&o!==n&&o!==r&&fS(o,t,n,r))return!0;return!1}function pS(e,t,n,r){return mp(e,t,n)&&!hS(r,e,t,n)}function yp(e){if(e.length<3)return[];if(e.length==3)return[e];let t=[],n=[],r=0;for(let f=0;f<e.length;f++){let u=e[r],h=e[f];(h.x<u.x||h.x==u.x&&h.y<u.y)&&(r=r),t[f]=f+1,n[f]=f-1}t[t.length-1]=0,n[0]=n.length-1,dS(e)||([t,n]=[n,t]);let o=[];for(let f=0;f<e.length;++f)mp(e[n[f]],e[f],e[t[f]])||o.push(e[f]);let s=[],i=e.length,a=1,l=0,c,d;for(;i>3;){c=t[a],d=n[a];let f=e[d],u=e[a],h=e[c];if(pS(f,u,h,o))s.push([f,u,h]),t[d]=c,n[c]=d,o.splice(o.indexOf(u),1),--i,l=0;else if(++l>i)return[];a=c}return c=t[a],d=n[a],s.push([e[d],e[a],e[c]]),s}function gS(e){if(e.length<3)return!1;let t=e.length-2,n=e.length-1,r=0,o=e[n].sub(e[t]),s=e[r].sub(e[n]),i=o.cross(s);for(;r+1<e.length;)if(t=n,n=r,r++,o=e[n].sub(e[t]),s=e[r].sub(e[n]),o.cross(s)*i<0)return!1;return!0}var wp=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",Ci="topleft",mS="monospace",Gs="monospace",Ya="linear",Yl=[{name:"a_pos",size:2},{name:"a_uv",size:2},{name:"a_color",size:4}],yS=Yl.reduce((e,t)=>e+t.size,0),xp=2048,wS=xp*4*yS,xS=xp*6,vS=`
attribute vec2 a_pos;
attribute vec2 a_uv;
attribute vec4 a_color;

varying vec2 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

vec4 def_vert() {
	return vec4(a_pos, 0.0, 1.0);
}

{{user}}

void main() {
	vec4 pos = vert(a_pos, a_uv, a_color);
	v_pos = a_pos;
	v_uv = a_uv;
	v_color = a_color;
	gl_Position = pos;
}
`,bS=`
precision mediump float;

varying vec2 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

uniform sampler2D u_tex;

vec4 def_frag() {
	vec4 texColor = texture2D(u_tex, v_uv);
	return vec4((v_color.rgb * texColor.rgb), texColor.a) * v_color.a;
}

{{user}}

void main() {
	gl_FragColor = frag(v_pos, v_uv, v_color, u_tex);
	if (gl_FragColor.a == 0.0) {
		discard;
	}
}
`,Xa=`
vec4 vert(vec2 pos, vec2 uv, vec4 color) {
	return def_vert();
}
`,Qa=`
vec4 frag(vec2 pos, vec2 uv, vec4 color, sampler2D tex) {
	return def_frag();
}
`,AS=new Set(["id","require"]),ES=new Set(["add","fixedUpdate","update","draw","destroy","inspect","drawInspect"]),td=200,SS=640,MS=65536,vp=Symbol.for("kaplay.cancel"),bp=class extends Map{constructor(){super(...arguments);H(this,"lastID",0)}push(t){let n=this.lastID;return this.set(n,t),this.lastID++,n}pushd(t){let n=this.push(t);return()=>this.delete(n)}},Zn=class Ap{constructor(t){H(this,"paused",!1);H(this,"cancel");this.cancel=t}static join(t){let n=new Ap(()=>t.forEach(r=>r.cancel()));return Object.defineProperty(n,"paused",{get:()=>t[0].paused,set:r=>t.forEach(o=>o.paused=r)}),n.paused=!1,n}static replace(t,n){return t.cancel=()=>n.cancel(),n.paused=t.paused,Object.defineProperty(t,"paused",{get:()=>n.paused,set:r=>n.paused=r}),t}},We=class{constructor(){H(this,"cancellers",new WeakMap);H(this,"handlers",new bp)}add(e){function t(...o){if(!r.paused)return e(...o)}let n=this.handlers.pushd(t),r=new Zn(n);return this.cancellers.set(t,n),r}addOnce(e){let t=this.add((...n)=>{t.cancel(),e(...n)});return t}next(){return new Promise(e=>this.addOnce(e))}trigger(...e){this.handlers.forEach(t=>{let n=t(...e),r;n===vp&&(r=this.cancellers.get(t))&&r()})}numListeners(){return this.handlers.size}clear(){this.handlers.clear()}},Mo=class{constructor(){H(this,"handlers",{});H(this,"registers",{})}on(e,t){return this.handlers[e]||(this.handlers[e]=new We),this.handlers[e].add(t)}onOnce(e,t){let n=this.on(e,(...r)=>{n.cancel(),t(...r)});return n}next(e){return new Promise(t=>{this.onOnce(e,(...n)=>t(n[0]))})}trigger(e,...t){this.handlers[e]&&this.handlers[e].trigger(...t)}remove(e){delete this.handlers[e]}clear(){this.handlers={}}numListeners(e){var t;return((t=this.handlers[e])==null?void 0:t.numListeners())??0}},CS=e=>e[0]instanceof pe,RS=e=>e[0]instanceof X,PS=e=>typeof e[0]=="number",Ep=class{constructor(e=(t,n)=>t<n){H(this,"_items");H(this,"_compareFn");this._compareFn=e,this._items=[]}insert(e){this._items.push(e),this.moveUp(this._items.length-1)}remove(){if(this._items.length===0)return null;let e=this._items[0],t=this._items.pop();return this._items.length!==0&&(this._items[0]=t,this.moveDown(0)),e}clear(){this._items.splice(0,this._items.length)}moveUp(e){for(;e>0;){let t=Math.floor((e-1)/2);if(!this._compareFn(this._items[e],this._items[t])&&this._items[e]>=this._items[t])break;this.swap(e,t),e=t}}moveDown(e){for(;e<Math.floor(this._items.length/2);){let t=2*e+1;if(t<this._items.length-1&&!this._compareFn(this._items[t],this._items[t+1])&&++t,this._compareFn(this._items[e],this._items[t]))break;this.swap(e,t),e=t}}swap(e,t){[this._items[e],this._items[t]]=[this._items[t],this._items[e]]}get length(){return this._items.length}};function IS(e){let t=window.atob(e),n=t.length,r=new Uint8Array(n);for(let o=0;o<n;o++)r[o]=t.charCodeAt(o);return r.buffer}function NS(e){return IS(e.split(",")[1])}function Xl(e,t){let n=document.createElement("a");n.href=t,n.download=e,n.click()}function Sp(e,t){Xl(e,"data:text/plain;charset=utf-8,"+t)}function TS(e,t){Sp(e,JSON.stringify(t))}function nd(e,t){let n=URL.createObjectURL(t);Xl(e,n),URL.revokeObjectURL(n)}var Mp=e=>e.match(/^data:\w+\/\w+;base64,.+/),_S=e=>e.split(".").slice(0,-1).join(".");function Ql(e,t){if(e===t)return!0;let n=typeof e,r=typeof t;if(n!==r)return!1;if(n==="object"&&r==="object"&&e!==null&&t!==null){if(Array.isArray(e)!==Array.isArray(t))return!1;let o=Object.keys(e),s=Object.keys(t);if(o.length!==s.length)return!1;for(let i of o){let a=e[i],l=t[i];if(!Ql(a,l))return!1}return!0}return!1}var rd=new Set,kS=e=>e instanceof Error?e.message:String(e);function DS(e){rd.has(e)||(rd.add(e),console.warn(e))}function Or(e,t){DS(`${e} is deprecated. Use ${t} instead.`)}function Za(e,t){return Number(e.toFixed(t))}function Me(e,t){return(...n)=>{let r=n.length;if(r===e.length)return e(...n);if(r===t.length)return t(...n)}}var OS=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);function LS(e){if(typeof e!="string")throw new TypeError("string cannot be undefined or null");let t=[],n=0,r=0;for(;n<e.length;){if(r+=BS(n+r,e),US(e[n+r])&&r++,zS(e[n+r])&&r++,HS(e[n+r])&&r++,$S(e[n+r])){r++;continue}t.push(e.substring(n,n+r)),n+=r,r=0}return t}function BS(e,t){let n=t[e];if(!FS(n)||e===t.length-1)return 1;let r=n+t[e+1],o=t.substring(e+2,e+5);return od(r)&&od(o)?4:jS(r)&&VS(o)?t.slice(e).indexOf(String.fromCodePoint(917631))+2:qS(o)?4:2}function FS(e){return e&&Jn(e[0].charCodeAt(0),55296,56319)}function od(e){return Jn(Zl(e),127462,127487)}function jS(e){return Jn(Zl(e),127988,127988)}function qS(e){return Jn(Zl(e),127995,127999)}function zS(e){return typeof e=="string"&&Jn(e.charCodeAt(0),65024,65039)}function HS(e){return typeof e=="string"&&Jn(e.charCodeAt(0),8400,8447)}function VS(e){let t=e.codePointAt(0);return typeof e=="string"&&typeof t=="number"&&Jn(t,917504,917631)}function US(e){return typeof e=="string"&&OS.includes(e.charCodeAt(0))}function $S(e){return typeof e=="string"&&e.charCodeAt(0)===8205}function Zl(e){let t=e.charCodeAt(0)-55296,n=e.charCodeAt(1)-56320;return(t<<10)+n+65536}function Jn(e,t,n){return e>=t&&e<=n}var ut=(e,t)=>Array.isArray(e)?e==null?void 0:e.includes(t):e===t,kt=(e,t)=>Array.isArray(t)?t.some(n=>e.has(n)):e.has(t),as=(e,t,n)=>{var r;e.has(t)?(r=e.get(t))==null||r.push(n):e.set(t,[n])},GS=(()=>{let e=0;return()=>e++})(),KS={"Joy-Con L+R (STANDARD GAMEPAD Vendor: 057e Product: 200e)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",6:"ltrigger",7:"rtrigger",8:"select",9:"start",10:"lstick",11:"rstick",12:"dpad-up",13:"dpad-down",14:"dpad-left",15:"dpad-right",16:"home",17:"capture"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}},"Joy-Con (L) (STANDARD GAMEPAD Vendor: 057e Product: 2006)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",9:"select",10:"lstick",16:"start"},sticks:{left:{x:0,y:1}}},"Joy-Con (R) (STANDARD GAMEPAD Vendor: 057e Product: 2007)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",9:"start",10:"lstick",16:"select"},sticks:{left:{x:0,y:1}}},"Pro Controller (STANDARD GAMEPAD Vendor: 057e Product: 2009)":{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",6:"ltrigger",7:"rtrigger",8:"select",9:"start",10:"lstick",11:"rstick",12:"dpad-up",13:"dpad-down",14:"dpad-left",15:"dpad-right",16:"home",17:"capture"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}},default:{buttons:{0:"south",1:"east",2:"west",3:"north",4:"lshoulder",5:"rshoulder",6:"ltrigger",7:"rtrigger",8:"select",9:"start",10:"lstick",11:"rstick",12:"dpad-up",13:"dpad-down",14:"dpad-left",15:"dpad-right",16:"home"},sticks:{left:{x:0,y:1},right:{x:2,y:3}}}};function Cp(){let e=C.globalOpt.pixelDensity??1,t=C.globalOpt.width,n=C.globalOpt.height,r=C.gfx.ggl.gl.drawingBufferWidth,o=C.gfx.ggl.gl.drawingBufferHeight,s=r/e,i=o/e,a=0,l=0,c=s,d=i;if(C.globalOpt.letterbox){if(!t||!n)throw new Error("Letterboxing requires width and height defined.");let f=s/i,u=t/n;if(f>u){let h=i*u;a=(s-h)/2,c=h}else{let h=s/u;d=h,l=(i-h)/2}}if(C.globalOpt.stretch&&(!C.globalOpt.width||!C.globalOpt.height))throw new Error("Stretching requires width and height defined.");C.gfx.viewport={x:a,y:l,width:c,height:d,scale:(C.gfx.viewport.width+C.gfx.viewport.height)/(C.gfx.width+C.gfx.height)}}function WS(e){return new X(e.x*C.gfx.viewport.width/C.gfx.width,e.y*C.gfx.viewport.height/C.gfx.height)}function YS(e){return new X((e.x-C.gfx.viewport.x)*C.gfx.width/C.gfx.viewport.width,(e.y-C.gfx.viewport.y)*C.gfx.height/C.gfx.viewport.height)}var XS=()=>_n.lastInputDevice,QS=()=>{let e=_n.buttons;for(let t in e){let n=e[t].keyboard&&[e[t].keyboard].flat(),r=e[t].keyboardCode&&[e[t].keyboardCode].flat(),o=e[t].gamepad&&[e[t].gamepad].flat(),s=e[t].mouse&&[e[t].mouse].flat();n&&n.forEach(i=>{as(_n.buttonsByKey,i,t)}),r&&r.forEach(i=>{as(_n.buttonsByKeyCode,i,t)}),o&&o.forEach(i=>{as(_n.buttonsByGamepad,i,t)}),s&&s.forEach(i=>{as(_n.buttonsByMouse,i,t)})}},ao=class{constructor(){H(this,"pressed",new Set([]));H(this,"pressedRepeat",new Set([]));H(this,"released",new Set([]));H(this,"down",new Set([]))}update(){this.pressed.clear(),this.released.clear(),this.pressedRepeat.clear()}press(e){this.pressed.add(e),this.pressedRepeat.add(e),this.down.add(e)}pressRepeat(e){this.pressedRepeat.add(e)}release(e){this.down.delete(e),this.pressed.delete(e),this.released.add(e)}},ZS=class{constructor(){H(this,"buttonState",new ao);H(this,"stickState",new Map)}},JS=class{constructor(){H(this,"dts",[]);H(this,"timer",0);H(this,"fps",0)}tick(e){this.dts.push(e),this.timer+=e,this.timer>=1&&(this.timer=0,this.fps=Math.round(1/(this.dts.reduce((t,n)=>t+n)/this.dts.length)),this.dts=[])}},_n,sd=KS,eM=e=>{let t=e.buttons??{};return{canvas:e.canvas,buttons:t,buttonsByKey:new Map,buttonsByMouse:new Map,buttonsByGamepad:new Map,buttonsByKeyCode:new Map,loopID:null,stopped:!1,dt:0,fixedDt:1/50,restDt:0,time:0,realTime:0,fpsCounter:new JS,timeScale:1,skipTime:!1,isHidden:!1,numFrames:0,mousePos:new X(0),mouseDeltaPos:new X(0),keyState:new ao,mouseState:new ao,mergedGamepadState:new ZS,gamepadStates:new Map,lastInputDevice:null,buttonState:new ao,gamepads:[],charInputted:[],isMouseMoved:!1,lastWidth:e.canvas.offsetWidth,lastHeight:e.canvas.offsetHeight,events:new Mo}},tM=e=>{if(!e.canvas)throw new Error("Please provide a canvas");let t=eM(e);_n=t,QS();function n(){return t.dt*t.timeScale}function r(){return t.fixedDt*t.timeScale}function o(){return t.restDt*t.timeScale}function s(){return t.isHidden}function i(){return t.time}function a(){return t.fpsCounter.fps}function l(){return t.numFrames}function c(){return t.canvas.toDataURL()}function d(L){t.canvas.style.cursor=L}function f(){return t.canvas.style.cursor}function u(L){if(L)try{let G=t.canvas.requestPointerLock();G!=null&&G.catch&&G.catch(Q=>console.error(Q))}catch(G){console.error(G)}else document.exitPointerLock()}function h(){return!!document.pointerLockElement}function p(L){L.requestFullscreen?L.requestFullscreen():L.webkitRequestFullscreen&&L.webkitRequestFullscreen()}function m(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullScreen&&document.webkitExitFullScreen()}function g(L=!0){L?p(t.canvas):m()}function y(){return document.fullscreenElement===t.canvas||document.webkitFullscreenElement===t.canvas}function b(){t.stopped=!0;let L=Object.entries(Ve),G=Object.entries(zr),Q=Object.entries(or);for(let[ie,fe]of L)t.canvas.removeEventListener(ie,fe);for(let[ie,fe]of G)document.removeEventListener(ie,fe);for(let[ie,fe]of Q)window.removeEventListener(ie,fe);Yo.disconnect()}function w(L,G){t.loopID!==null&&cancelAnimationFrame(t.loopID);let Q=0,ie=0,fe=Ae=>{if(t.stopped)return;if(document.visibilityState!=="visible"){t.loopID=requestAnimationFrame(fe);return}let Oe=Ae/1e3,Re=Math.min(Oe-t.realTime,.25),bt=e.maxFPS?1/e.maxFPS:0;if(t.realTime=Oe,ie+=Re,ie>bt){if(!t.skipTime){for(Q+=ie,t.dt=t.fixedDt,t.restDt=0;Q>t.fixedDt;)Q-=t.fixedDt,Q<t.fixedDt&&(t.restDt=Q),L();t.restDt=Q,t.dt=ie,t.time+=n(),t.fpsCounter.tick(t.dt)}ie=0,t.skipTime=!1,t.numFrames++,G(zi,Hi)}t.loopID=requestAnimationFrame(fe)};fe(0)}function E(){return"ontouchstart"in window||navigator.maxTouchPoints>0}function P(){return t.mousePos.clone()}function A(){return t.mouseDeltaPos.clone()}function v(L="left"){return t.mouseState.pressed.has(L)}function M(L="left"){return t.mouseState.down.has(L)}function N(L="left"){return t.mouseState.released.has(L)}function _(){return t.isMouseMoved}function D(L){return L===void 0?t.keyState.pressed.size>0:kt(t.keyState.pressed,L)}function B(L){return L===void 0?t.keyState.pressedRepeat.size>0:kt(t.keyState.pressedRepeat,L)}function j(L){return L===void 0?t.keyState.down.size>0:kt(t.keyState.down,L)}function R(L){return L===void 0?t.keyState.released.size>0:kt(t.keyState.released,L)}function O(L){return L===void 0?t.mergedGamepadState.buttonState.pressed.size>0:kt(t.mergedGamepadState.buttonState.pressed,L)}function I(L){return L===void 0?t.mergedGamepadState.buttonState.down.size>0:kt(t.mergedGamepadState.buttonState.down,L)}function k(L){return L===void 0?t.mergedGamepadState.buttonState.released.size>0:kt(t.mergedGamepadState.buttonState.released,L)}function F(L){return L===void 0?t.buttonState.pressed.size>0:kt(t.buttonState.pressed,L)}function T(L){return L===void 0?t.buttonState.down.size>0:kt(t.buttonState.down,L)}function z(L){return L===void 0?t.buttonState.released.size>0:kt(t.buttonState.released,L)}function V(L){var G;return(G=t.buttons)==null?void 0:G[L]}function U(L,G){t.buttons[L]={...t.buttons[L],...G}}function K(L){t.buttonState.press(L),t.events.trigger("buttonPress",L)}function Y(L){t.buttonState.release(L),t.events.trigger("buttonRelease",L)}function ee(L){return t.events.on("resize",L)}let Z=Me(L=>t.events.on("keyDown",L),(L,G)=>t.events.on("keyDown",Q=>ut(L,Q)&&G(Q))),q=Me(L=>t.events.on("keyPress",G=>L(G)),(L,G)=>t.events.on("keyPress",Q=>ut(L,Q)&&G(Q))),W=Me(L=>t.events.on("keyPressRepeat",L),(L,G)=>t.events.on("keyPressRepeat",Q=>ut(L,Q)&&G(Q))),te=Me(L=>t.events.on("keyRelease",L),(L,G)=>t.events.on("keyRelease",Q=>ut(L,Q)&&G(Q))),se=Me(L=>t.events.on("mouseDown",G=>L(G)),(L,G)=>t.events.on("mouseDown",Q=>ut(L,Q)&&G(Q))),oe=Me(L=>t.events.on("mousePress",G=>L(G)),(L,G)=>t.events.on("mousePress",Q=>ut(L,Q)&&G(Q))),ne=Me(L=>t.events.on("mouseRelease",G=>L(G)),(L,G)=>t.events.on("mouseRelease",Q=>Q===L&&G(Q)));function J(L){return t.events.on("mouseMove",()=>L(P(),A()))}function re(L){return t.events.on("charInput",L)}function le(L){return t.events.on("touchStart",L)}function ce(L){return t.events.on("touchMove",L)}function me(L){return t.events.on("touchEnd",L)}function de(L){return t.events.on("scroll",L)}function be(L){return t.events.on("hide",L)}function ze(L){return t.events.on("show",L)}let Xe=Me(L=>t.events.on("gamepadButtonPress",(G,Q)=>L(G,Q)),(L,G)=>t.events.on("gamepadButtonPress",(Q,ie)=>ut(L,Q)&&G(Q,ie))),lt=Me(L=>t.events.on("gamepadButtonDown",(G,Q)=>L(G,Q)),(L,G)=>t.events.on("gamepadButtonDown",(Q,ie)=>ut(L,Q)&&G(Q,ie))),wt=Me(L=>t.events.on("gamepadButtonRelease",(G,Q)=>L(G,Q)),(L,G)=>t.events.on("gamepadButtonRelease",(Q,ie)=>ut(L,Q)&&G(Q,ie)));function Cn(L,G){return t.events.on("gamepadStick",(Q,ie,fe)=>Q===L&&G(ie,fe))}function xt(L){t.events.on("gamepadConnect",L)}function Le(L){t.events.on("gamepadDisconnect",L)}function Qe(L){return t.mergedGamepadState.stickState.get(L)||new X(0)}function nr(){return[...t.charInputted]}function Be(){return[...t.gamepads]}let Rn=Me(L=>t.events.on("buttonPress",G=>L(G)),(L,G)=>t.events.on("buttonPress",Q=>ut(L,Q)&&G(Q))),vt=Me(L=>t.events.on("buttonDown",G=>L(G)),(L,G)=>t.events.on("buttonDown",Q=>ut(L,Q)&&G(Q))),rr=Me(L=>t.events.on("buttonRelease",G=>L(G)),(L,G)=>t.events.on("buttonRelease",Q=>ut(L,Q)&&G(Q)));function zi(){t.events.trigger("input"),t.keyState.down.forEach(L=>t.events.trigger("keyDown",L)),t.mouseState.down.forEach(L=>t.events.trigger("mouseDown",L)),t.buttonState.down.forEach(L=>{t.events.trigger("buttonDown",L)}),Ui()}function Hi(){t.keyState.update(),t.mouseState.update(),t.buttonState.update(),t.mergedGamepadState.buttonState.update(),t.mergedGamepadState.stickState.forEach((L,G)=>{t.mergedGamepadState.stickState.set(G,new X(0))}),t.charInputted=[],t.isMouseMoved=!1,t.mouseDeltaPos=new X(0),t.gamepadStates.forEach(L=>{L.buttonState.update(),L.stickState.forEach((G,Q)=>{L.stickState.set(Q,new X(0))})})}function Go(L){let G={index:L.index,isPressed:Q=>{var ie;return((ie=t.gamepadStates.get(L.index))==null?void 0:ie.buttonState.pressed.has(Q))||!1},isDown:Q=>{var ie;return((ie=t.gamepadStates.get(L.index))==null?void 0:ie.buttonState.down.has(Q))||!1},isReleased:Q=>{var ie;return((ie=t.gamepadStates.get(L.index))==null?void 0:ie.buttonState.released.has(Q))||!1},getStick:Q=>{var ie;return((ie=t.gamepadStates.get(L.index))==null?void 0:ie.stickState.get(Q))||$()}};return t.gamepads.push(G),t.gamepadStates.set(L.index,{buttonState:new ao,stickState:new Map([["left",new X(0)],["right",new X(0)]])}),G}function Vi(L){t.gamepads=t.gamepads.filter(G=>G.index!==L.index),t.gamepadStates.delete(L.index)}function Ui(){var L,G;for(let Q of navigator.getGamepads())Q&&!t.gamepadStates.has(Q.index)&&Go(Q);for(let Q of t.gamepads){let ie=navigator.getGamepads()[Q.index];if(!ie)continue;let fe=(e.gamepads??{})[ie.id]||sd[ie.id]||sd.default,Ae=t.gamepadStates.get(Q.index);if(Ae){for(let Oe=0;Oe<ie.buttons.length;Oe++){let Re=fe.buttons[Oe],bt=ie.buttons[Oe],ct=t.buttonsByGamepad.has(Re);if(bt.pressed){if(Ae.buttonState.down.has(Re)){t.events.trigger("gamepadButtonDown",Re,Q);continue}t.lastInputDevice="gamepad",ct&&((L=t.buttonsByGamepad.get(Re))==null||L.forEach(At=>{t.buttonState.press(At),t.events.trigger("buttonPress",At)})),t.mergedGamepadState.buttonState.press(Re),Ae.buttonState.press(Re),t.events.trigger("gamepadButtonPress",Re,Q)}else Ae.buttonState.down.has(Re)&&(ct&&((G=t.buttonsByGamepad.get(Re))==null||G.forEach(At=>{t.buttonState.release(At),t.events.trigger("buttonRelease",At)})),t.mergedGamepadState.buttonState.release(Re),Ae.buttonState.release(Re),t.events.trigger("gamepadButtonRelease",Re,Q))}for(let Oe in fe.sticks){let Re=fe.sticks[Oe];if(!Re)continue;let bt=new X(ie.axes[Re.x],ie.axes[Re.y]);Ae.stickState.set(Oe,bt),t.mergedGamepadState.stickState.set(Oe,bt),t.events.trigger("gamepadStick",Oe,bt,Q)}}}}let Ve={},zr={},or={},Ko=e.pixelDensity||1;Ve.mousemove=L=>{let G=YS(new X(L.offsetX,L.offsetY)),Q=new X(L.movementX,L.movementY);if(y()){let ie=t.canvas.width/Ko,fe=t.canvas.height/Ko,Ae=window.innerWidth,Oe=window.innerHeight,Re=Ae/Oe,bt=ie/fe;if(Re>bt){let ct=Oe/fe,At=(Ae-ie*ct)/2;G.x=Ot(L.offsetX-At,0,ie*ct,0,ie),G.y=Ot(L.offsetY,0,fe*ct,0,fe)}else{let ct=Ae/ie,At=(Oe-fe*ct)/2;G.x=Ot(L.offsetX,0,ie*ct,0,ie),G.y=Ot(L.offsetY-At,0,fe*ct,0,fe)}}t.events.onOnce("input",()=>{t.isMouseMoved=!0,t.mousePos=G,t.mouseDeltaPos=Q,t.events.trigger("mouseMove")})};let Wo=["left","middle","right","back","forward"];Ve.mousedown=L=>{t.events.onOnce("input",()=>{var Q;let G=Wo[L.button];G&&(t.lastInputDevice="mouse",t.buttonsByMouse.has(G)&&((Q=t.buttonsByMouse.get(G))==null||Q.forEach(ie=>{t.buttonState.press(ie),t.events.trigger("buttonPress",ie)})),t.mouseState.press(G),t.events.trigger("mousePress",G))})},Ve.mouseup=L=>{t.events.onOnce("input",()=>{var Q;let G=Wo[L.button];G&&(t.buttonsByMouse.has(G)&&((Q=t.buttonsByMouse.get(G))==null||Q.forEach(ie=>{t.buttonState.release(ie),t.events.trigger("buttonRelease",ie)})),t.mouseState.release(G),t.events.trigger("mouseRelease",G))})};let $i=new Set([" ","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Tab"]),Hr={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"};Ve.keydown=L=>{$i.has(L.key)&&L.preventDefault(),t.events.onOnce("input",()=>{var ie,fe;let G=Hr[L.key]||L.key.toLowerCase(),Q=L.code;if(G===void 0)throw new Error(`Unknown key: ${L.key}`);G.length===1?(t.events.trigger("charInput",G),t.charInputted.push(G)):G==="space"&&(t.events.trigger("charInput"," "),t.charInputted.push(" ")),L.repeat?(t.keyState.pressRepeat(G),t.events.trigger("keyPressRepeat",G)):(t.lastInputDevice="keyboard",t.buttonsByKey.has(G)&&((ie=t.buttonsByKey.get(G))==null||ie.forEach(Ae=>{t.buttonState.press(Ae),t.events.trigger("buttonPress",Ae)})),t.buttonsByKeyCode.has(Q)&&((fe=t.buttonsByKeyCode.get(Q))==null||fe.forEach(Ae=>{t.buttonState.press(Ae),t.events.trigger("buttonPress",Ae)})),t.keyState.press(G),t.events.trigger("keyPressRepeat",G),t.events.trigger("keyPress",G))})},Ve.keyup=L=>{t.events.onOnce("input",()=>{var ie,fe;let G=Hr[L.key]||L.key.toLowerCase(),Q=L.code;t.buttonsByKey.has(G)&&((ie=t.buttonsByKey.get(G))==null||ie.forEach(Ae=>{t.buttonState.release(Ae),t.events.trigger("buttonRelease",Ae)})),t.buttonsByKeyCode.has(Q)&&((fe=t.buttonsByKeyCode.get(Q))==null||fe.forEach(Ae=>{t.buttonState.release(Ae),t.events.trigger("buttonRelease",Ae)})),t.keyState.release(G),t.events.trigger("keyRelease",G)})},Ve.touchstart=L=>{L.preventDefault(),t.events.onOnce("input",()=>{var ie;let G=[...L.changedTouches],Q=t.canvas.getBoundingClientRect();e.touchToMouse!==!1&&(t.mousePos=new X(G[0].clientX-Q.x,G[0].clientY-Q.y),t.lastInputDevice="mouse",t.buttonsByMouse.has("left")&&((ie=t.buttonsByMouse.get("left"))==null||ie.forEach(fe=>{t.buttonState.press(fe),t.events.trigger("buttonPress",fe)})),t.mouseState.press("left"),t.events.trigger("mousePress","left")),G.forEach(fe=>{t.events.trigger("touchStart",new X(fe.clientX-Q.x,fe.clientY-Q.y),fe)})})},Ve.touchmove=L=>{L.preventDefault(),t.events.onOnce("input",()=>{let G=[...L.changedTouches],Q=t.canvas.getBoundingClientRect();if(e.touchToMouse!==!1){let ie=t.mousePos;t.mousePos=new X(G[0].clientX-Q.x,G[0].clientY-Q.y),t.mouseDeltaPos=t.mousePos.sub(ie),t.events.trigger("mouseMove")}G.forEach(ie=>{t.events.trigger("touchMove",new X(ie.clientX-Q.x,ie.clientY-Q.y),ie)})})},Ve.touchend=L=>{t.events.onOnce("input",()=>{var ie;let G=[...L.changedTouches],Q=t.canvas.getBoundingClientRect();e.touchToMouse!==!1&&(t.mousePos=new X(G[0].clientX-Q.x,G[0].clientY-Q.y),t.mouseDeltaPos=new X(0,0),t.buttonsByMouse.has("left")&&((ie=t.buttonsByMouse.get("left"))==null||ie.forEach(fe=>{t.buttonState.release(fe),t.events.trigger("buttonRelease",fe)})),t.mouseState.release("left"),t.events.trigger("mouseRelease","left")),G.forEach(fe=>{t.events.trigger("touchEnd",new X(fe.clientX-Q.x,fe.clientY-Q.y),fe)})})},Ve.touchcancel=L=>{t.events.onOnce("input",()=>{let G=[...L.changedTouches],Q=t.canvas.getBoundingClientRect();e.touchToMouse!==!1&&(t.mousePos=new X(G[0].clientX-Q.x,G[0].clientY-Q.y),t.mouseState.release("left"),t.events.trigger("mouseRelease","left")),G.forEach(ie=>{t.events.trigger("touchEnd",new X(ie.clientX-Q.x,ie.clientY-Q.y),ie)})})},Ve.wheel=L=>{L.preventDefault(),t.events.onOnce("input",()=>{t.events.trigger("scroll",new X(L.deltaX,L.deltaY))})},Ve.contextmenu=L=>L.preventDefault(),zr.visibilitychange=()=>{document.visibilityState==="visible"?(t.skipTime=!0,t.isHidden=!1,t.events.trigger("show")):(t.isHidden=!0,t.events.trigger("hide"))},or.gamepadconnected=L=>{let G=Go(L.gamepad);t.events.onOnce("input",()=>{t.events.trigger("gamepadConnect",G)})},or.gamepaddisconnected=L=>{let G=Be().filter(Q=>Q.index===L.gamepad.index)[0];Vi(L.gamepad),t.events.onOnce("input",()=>{t.events.trigger("gamepadDisconnect",G)})};for(let[L,G]of Object.entries(Ve))t.canvas.addEventListener(L,G);for(let[L,G]of Object.entries(zr))document.addEventListener(L,G);for(let[L,G]of Object.entries(or))window.addEventListener(L,G);let Yo=new ResizeObserver(L=>{for(let G of L)if(G.target===t.canvas){if(t.lastWidth===t.canvas.offsetWidth&&t.lastHeight===t.canvas.offsetHeight)return;t.lastWidth=t.canvas.offsetWidth,t.lastHeight=t.canvas.offsetHeight,t.events.onOnce("input",()=>{t.events.trigger("resize")})}});return Yo.observe(t.canvas),{state:t,dt:n,fixedDt:r,restDt:o,time:i,run:w,canvas:t.canvas,fps:a,numFrames:l,quit:b,isHidden:s,setFullscreen:g,isFullscreen:y,setCursor:d,screenshot:c,getGamepads:Be,getCursor:f,setCursorLocked:u,isCursorLocked:h,isTouchscreen:E,mousePos:P,mouseDeltaPos:A,isKeyDown:j,isKeyPressed:D,isKeyPressedRepeat:B,isKeyReleased:R,isMouseDown:M,isMousePressed:v,isMouseReleased:N,isMouseMoved:_,isGamepadButtonPressed:O,isGamepadButtonDown:I,isGamepadButtonReleased:k,getGamepadStick:Qe,isButtonPressed:F,isButtonDown:T,isButtonReleased:z,setButton:U,getButton:V,pressButton:K,releaseButton:Y,charInputted:nr,onResize:ee,onKeyDown:Z,onKeyPress:q,onKeyPressRepeat:W,onKeyRelease:te,onMouseDown:se,onMousePress:oe,onMouseRelease:ne,onMouseMove:J,onCharInput:re,onTouchStart:le,onTouchMove:ce,onTouchEnd:me,onScroll:de,onHide:be,onShow:ze,onGamepadButtonDown:lt,onGamepadButtonPress:Xe,onGamepadButtonRelease:wt,onGamepadStick:Cn,onGamepadConnect:xt,onGamepadDisconnect:Le,onButtonPress:Rn,onButtonDown:vt,onButtonRelease:rr,getLastInputDeviceType:XS,events:t.events}};function qe(){return C.app.dt()}function Ja(){return C.app.fixedDt()}function el(){return C.app.restDt()}var nM=new X(-1,-1),rM=new X(0,-1),oM=new X(1,-1),sM=new X(-1,0),iM=new X(0,0),aM=new X(1,0),lM=new X(-1,1),cM=new X(0,1),uM=new X(1,1);function Lr(e){switch(e){case"topleft":return nM;case"top":return rM;case"topright":return oM;case"left":return sM;case"center":return iM;case"right":return aM;case"botleft":return lM;case"bot":return cM;case"botright":return uM;default:return e}}function dM(e){switch(e){case"left":return 0;case"center":return .5;case"right":return 1;default:return 0}}function fM(e){return e.createBuffer(1,1,44100)}var ls=2.5949095,id=1.70158+1,ad=2*Math.PI/3,ld=2*Math.PI/4.5,vs={linear:e=>e,easeInSine:e=>1-Math.cos(e*Math.PI/2),easeOutSine:e=>Math.sin(e*Math.PI/2),easeInOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,easeInQuad:e=>e*e,easeOutQuad:e=>1-(1-e)*(1-e),easeInOutQuad:e=>e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2,easeInCubic:e=>e*e*e,easeOutCubic:e=>1-Math.pow(1-e,3),easeInOutCubic:e=>e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1-Math.pow(1-e,4),easeInOutQuart:e=>e<.5?8*e*e*e*e:1-Math.pow(-2*e+2,4)/2,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1-Math.pow(1-e,5),easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2,easeInExpo:e=>e===0?0:Math.pow(2,10*e-10),easeOutExpo:e=>e===1?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>e===0?0:e===1?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2,easeInCirc:e=>1-Math.sqrt(1-Math.pow(e,2)),easeOutCirc:e=>Math.sqrt(1-Math.pow(e-1,2)),easeInOutCirc:e=>e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2,easeInBack:e=>id*e*e*e-1.70158*e*e,easeOutBack:e=>1+id*Math.pow(e-1,3)+1.70158*Math.pow(e-1,2),easeInOutBack:e=>e<.5?Math.pow(2*e,2)*((ls+1)*2*e-ls)/2:(Math.pow(2*e-2,2)*((ls+1)*(e*2-2)+ls)+2)/2,easeInElastic:e=>e===0?0:e===1?1:-Math.pow(2,10*e-10)*Math.sin((e*10-10.75)*ad),easeOutElastic:e=>e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e*10-.75)*ad)+1,easeInOutElastic:e=>e===0?0:e===1?1:e<.5?-(Math.pow(2,20*e-10)*Math.sin((20*e-11.125)*ld))/2:Math.pow(2,-20*e+10)*Math.sin((20*e-11.125)*ld)/2+1,easeInBounce:e=>1-vs.easeOutBounce(1-e),easeOutBounce:e=>e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,easeInOutBounce:e=>e<.5?(1-vs.easeOutBounce(1-2*e))/2:(1+vs.easeOutBounce(2*e-1))/2},Co=vs;function hM(e,t,n){let r=[],o=t;for(r.push(o);o!==e;){if(o=n.get(o),o==null)return null;r.push(o)}return r.reverse()}function pM(e,t,n){var i;let r=new Ep((a,l)=>a.cost<l.cost);r.insert({cost:0,node:t});let o=new Map;o.set(t,t);let s=new Map;for(s.set(t,0);r.length!==0;){let a=(i=r.remove())==null?void 0:i.node;if(a===n)break;let l=e.getNeighbours(a);for(let c of l){let d=(s.get(a)||0)+e.getCost(a,c)+e.getHeuristic(c,n);(!s.has(c)||d<s.get(c))&&(s.set(c,d),r.insert({cost:d,node:c}),o.set(c,a))}}return hM(t,n,o)}var gM=class{constructor(e,t,n){H(this,"a");H(this,"b");H(this,"polygon");this.a=e,this.b=t,this.polygon=new WeakRef(n)}isLeft(e,t){return(this.b.x-this.a.x)*(t-this.a.y)-(e-this.a.x)*(this.b.y-this.a.y)}get middle(){return this.a.add(this.b).scale(.5)}},mM=class{constructor(e){H(this,"_edges");H(this,"_centroid");H(this,"_id");this._id=e}get id(){return this._id}set edges(e){this._edges=e;let t=0,n=0,r=0;for(let o of this._edges){o.polygon=new WeakRef(this);let s=o.a.x*o.b.y-o.a.y*o.b.x;t+=(o.a.x+o.b.x)*s,n+=(o.a.y+o.b.y)*s,r+=s}r/=2,this._centroid=$(t/(6*r),n/(6*r))}get edges(){return this._edges}get centroid(){return this._centroid}contains(e){let t=!1;for(let n of this.edges)n.b.y>e.y!=n.a.y>e.y&&e.x<(n.a.x-n.b.x)*(e.y-n.b.y)/(n.a.y-n.b.y)+n.b.x&&(t=!t);return t}},yM=class{constructor(){H(this,"_polygons");H(this,"_pointCache");H(this,"_edgeCache");this._polygons=[],this._pointCache={},this._edgeCache={}}_addPoint(e){let t=this._pointCache[`${e.x}_${e.y}`];return t||(t=e.clone(),this._pointCache[`${e.x}_${e.y}`]=t,t)}_addEdge(e){let t=`${e.a.x}_${e.a.y}-${e.b.x}_${e.b.y}`;return this._edgeCache[t]=e,e}_findEdge(e,t){let n=`${e.x}_${e.y}-${t.x}_${t.y}`;return this._edgeCache[n]}_findCommonEdge(e,t){for(let n of e.edges){let r=this._findEdge(n.b,n.a);if(r&&r.polygon.deref().id===t.id)return r}return null}addPolygon(e){let t=new mM(this._polygons.length),n=e.map((r,o)=>new gM(r,e[(o+1)%e.length],t));t.edges=n,this._polygons.push(t);for(let r of t.edges)this._addEdge(r);return t}addRect(e,t){let n=this._addPoint(e),r=this._addPoint(e.add(t.x,0)),o=this._addPoint(e.add(t)),s=this._addPoint(e.add(0,t.y));return this.addPolygon([n,r,o,s])}_getLocation(e){for(let t of this._polygons)if(t.contains(e))return t;return null}getNeighbours(e){let t=[];for(let n of this._polygons[e].edges){let r=this._findEdge(n.b,n.a);if(r){let o=r.polygon.deref();o&&t.push(o.id)}}return t}getCost(e,t){return 1}getHeuristic(e,t){let n=this._polygons[e],r=this._polygons[t],o=n.centroid.x-r.centroid.x,s=n.centroid.y-r.centroid.y;return Math.sqrt(o*o+s*s)}getPath(e,t){return e===void 0||t===void 0?[]:e===t?[e,t]:pM(this,e,t)}getWaypointPath(e,t,n){let r=(n==null?void 0:n.type)||"centroids",o=this._getLocation(e),s=this._getLocation(t);if(o===void 0||s===void 0)return[];let i=this.getPath(o.id,s.id);if(!i)return[];if(r==="edges"){let a=[];for(let l=1;l<i.length;l++){let c=this._polygons[i[l-1]],d=this._polygons[i[l]],f=this._findCommonEdge(c,d);a.push(f.middle.add(d.centroid.sub(f.middle).unit().scale(4)))}return[e,...a,t]}else return[e,...i.slice(1,-1).map(a=>this._polygons[a].centroid),t]}};function lo(e){let t=new Ft;return e.pos&&t.translate(e.pos),e.scale&&t.scale(e.scale),e.angle&&t.rotate(e.angle),e.parent?t.mult(e.parent.transform):t}function wM(e){return new X(e.x/He()*2-1,-e.y/Ue()*2+1)}function eo(e,t,n,r,o,s=1){r=De(r%360),o=De(o%360),o<=r&&(o+=Math.PI*2);let i=[],a=Math.ceil((o-r)/De(8)*s),l=(o-r)/a,c=$(Math.cos(r),Math.sin(r)),d=$(Math.cos(l),Math.sin(l));for(let f=0;f<=a;f++)i.push(e.add(t*c.x,n*c.y)),c=$(c.x*d.x-c.y*d.y,c.x*d.y+c.y*d.x);return i}function xM(...e){let t=we(...e),n=e[3]??1;C.gfx.bgColor=t,C.gfx.bgAlpha=n,C.gfx.ggl.gl.clearColor(t.r/255,t.g/255,t.b/255,n)}function vM(){var e,t;return((t=(e=C.gfx.bgColor)==null?void 0:e.clone)==null?void 0:t.call(e))??null}function Te(...e){if(e[0]===void 0)return;let t=$(...e);t.x===0&&t.y===0||C.gfx.transform.translate(t)}function dt(){C.gfx.transformStack.push(C.gfx.transform.clone())}function bM(e){C.gfx.transform=e.clone()}function Ro(...e){if(e[0]===void 0)return;let t=$(...e);t.x===1&&t.y===1||C.gfx.transform.scale(t)}function Tr(e){e&&C.gfx.transform.rotate(e)}function tt(){C.gfx.transformStack.length>0&&(C.gfx.transform=C.gfx.transformStack.pop())}function ft(){C.gfx.renderer.flush()}function He(){return C.gfx.width}function Ue(){return C.gfx.height}function Rp(){return(C.gfx.viewport.width+C.gfx.viewport.height)/(C.gfx.width+C.gfx.height)}function Ks(){return $(He()/2,Ue()/2)}var AM=class{constructor(e,t,n,r){H(this,"lastTextureId",0);H(this,"textures",[]);H(this,"bigTextures",[]);H(this,"texturesPosition",new Map);H(this,"canvas");H(this,"c2d");H(this,"x",0);H(this,"y",0);H(this,"curHeight",0);H(this,"gfx");H(this,"padding");this.gfx=e,this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=n,this.textures=[pn.fromImage(e,this.canvas)],this.bigTextures=[],this.padding=r;let o=this.canvas.getContext("2d");if(!o)throw new Error("Failed to get 2d context");this.c2d=o}add_single(e){let t=pn.fromImage(this.gfx,e);return this.bigTextures.push(t),[t,new Ie(0,0,1,1),0]}add(e){let t=e.width+this.padding*2,n=e.height+this.padding*2;(t>this.canvas.width||n>this.canvas.height)&&this.add_single(e),this.x+t>this.canvas.width&&(this.x=0,this.y+=this.curHeight,this.curHeight=0),this.y+n>this.canvas.height&&(this.c2d.clearRect(0,0,this.canvas.width,this.canvas.height),this.textures.push(pn.fromImage(this.gfx,this.canvas)),this.x=0,this.y=0,this.curHeight=0);let r=this.textures[this.textures.length-1],o=new X(this.x+this.padding,this.y+this.padding);return this.x+=t,n>this.curHeight&&(this.curHeight=n),e instanceof ImageData?this.c2d.putImageData(e,o.x,o.y):this.c2d.drawImage(e,o.x,o.y),r.update(this.canvas),this.texturesPosition.set(this.lastTextureId,{position:o,size:new X(e.width,e.height),texture:r}),this.lastTextureId++,[r,new Ie(o.x/this.canvas.width,o.y/this.canvas.height,e.width/this.canvas.width,e.height/this.canvas.height),this.lastTextureId-1]}free(){for(let e of this.textures)e.free();for(let e of this.bigTextures)e.free()}};function mt(e){return typeof e!="string"||Mp(e)?e:C.assets.urlPrefix+e}var yt=class Pp{constructor(t){H(this,"loaded",!1);H(this,"data",null);H(this,"error",null);H(this,"onLoadEvents",new We);H(this,"onErrorEvents",new We);H(this,"onFinishEvents",new We);t.then(n=>{this.loaded=!0,this.data=n,this.onLoadEvents.trigger(n)}).catch(n=>{if(this.error=n,this.onErrorEvents.numListeners()>0)this.onErrorEvents.trigger(n);else throw n}).finally(()=>{this.onFinishEvents.trigger(),this.loaded=!0})}static loaded(t){let n=new Pp(Promise.resolve(t));return n.data=t,n.loaded=!0,n}onLoad(t){return this.loaded&&this.data?t(this.data):this.onLoadEvents.add(t),this}onError(t){return this.loaded&&this.error?t(this.error):this.onErrorEvents.add(t),this}onFinish(t){return this.loaded?t():this.onFinishEvents.add(t),this}then(t){return this.onLoad(t)}catch(t){return this.onError(t)}finally(t){return this.onFinish(t)}},ar=class{constructor(){H(this,"assets",new Map);H(this,"lastUID",0)}add(e,t){let n=e??this.lastUID+++"",r=new yt(t);return this.assets.set(n,r),r}addLoaded(e,t){let n=e??this.lastUID+++"",r=yt.loaded(t);return this.assets.set(n,r),r}get(e){return this.assets.get(e)}progress(){if(this.assets.size===0)return 1;let e=0;return this.assets.forEach(t=>{t.loaded&&e++}),e/this.assets.size}getFailedAssets(){return Array.from(this.assets.keys()).filter(e=>this.assets.get(e).error!==null).map(e=>[e,this.assets.get(e)])}};function Jl(e){return fetch(e).then(t=>{if(!t.ok)throw new Error(`Failed to fetch "${e}"`);return t})}function Ri(e){return Jl(e).then(t=>t.json())}function EM(e){return Jl(e).then(t=>t.text())}function SM(e){return Jl(e).then(t=>t.arrayBuffer())}function MM(e){return e!==void 0&&(C.assets.urlPrefix=e),C.assets.urlPrefix}function CM(e,t){return C.assets.custom.add(e,Ri(mt(t)))}function Pi(e){let t=new Image;return t.crossOrigin="anonymous",t.src=e,new Promise((n,r)=>{t.onload=()=>n(t),t.onerror=()=>r(new Error(`Failed to load image from "${e}"`))})}function Un(){let e=[C.assets.sprites,C.assets.sounds,C.assets.shaders,C.assets.fonts,C.assets.bitmapFonts,C.assets.custom];return e.reduce((t,n)=>t+n.progress(),0)/e.length}function Ip(){return[C.assets.sprites,C.assets.sounds,C.assets.shaders,C.assets.fonts,C.assets.bitmapFonts,C.assets.custom].reduce((e,t)=>e.concat(t.getFailedAssets()),[])}function RM(e){return C.assets.custom.get(e)??null}function tl(e){return C.assets.custom.add(null,e)}var PM=(e,t)=>({urlPrefix:"",sprites:new ar,fonts:new ar,bitmapFonts:new ar,sounds:new ar,shaders:new ar,custom:new ar,music:{},packer:new AM(e,2048,2048,t),loaded:!1}),IM="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA1CAYAAADyMeOEAAAAAXNSR0IArs4c6QAAAoVJREFUaIHdm7txwkAQhheGAqACiCHzOKQDQrqgILpwSAeEDBnEUAF0gCMxZ7G72qce/mec2Lpf9+3unaS78wgSNZ8uX5729+d1FNWXUuGmXlBOUUEIMckEpeQJgBu6C+BSFngztBR2vd+ovY+7g+p6LbgaWgJrAeUkDYIUXgXdBBwNi6kpABJwMTQH3AZsXRR8GHTfgEth8E3gjdAUcNewpbTgY85sCMCUuOokozE0YM0YRzM9NGAAXd8+omAF5h4lnmBRvpSnZHyLoLEbaN+aKB9KWv/KWw0tAbbANnlG+UvB2dm77NxxdwgBpjrF/d7rW9cbmpvio2A5z8iAYpVU8pGZlo6/2+MSco2lHfd3rv9jAP038e1xef9o2mjvYb2OqpqKE81028/jeietlSEVO5FRWsxWsJit1G3aFpW8iWe5RwpiCZAk25QvV6nz6fIlynRGuTd5WqpJ4guAlDfVKBK87hXljflgv1ON6fV+4+5gVlA17SfeG0heKqQd4l4jI/wrmaA9N9R4ar+wpHJDZyrrfcH0nB66PqAzPi76pn+faSyJk/vzOorYhGurQrzj/P68jtBMawHaHBIR9xoD5O34dy0qQOSYHvqExq2TpT2nf76+w7y251OYF0CRaU+J920TwLUa6inx6OxE6g80lu2ux7Y2eJLF/rCXE6zEPdnenk9o+4ih9AEdnW2q81HXl5LuU6OTl2fXUhqganbXAGq3g6jJOWV/OnoesO6YqqEB/GdNsjf7uHtwj2DzmRNpp7iOZfm6D9oAxB6Yi1gC4oIYeo4MIPdopEQRB+cAko5J1tW386HpB2Kz1eop4Epdwls/kgZ1sh8gZsEjdcWkr//D8Qu3Z3l5Nl1NtAAAAABJRU5ErkJggg==",wn=class to{constructor(t,n,r={},o=null){H(this,"tex");H(this,"frames",[new Ie(0,0,1,1)]);H(this,"anims",{});H(this,"slice9",null);this.tex=t,n&&(this.frames=n),this.anims=r,this.slice9=o}get width(){return this.tex.width*this.frames[0].w}get height(){return this.tex.height*this.frames[0].h}static from(t,n={}){return typeof t=="string"?to.fromURL(t,n):Promise.resolve(to.fromImage(t,n))}static fromImage(t,n={}){let[r,o]=n.singular?C.assets.packer.add_single(t):C.assets.packer.add(t),s=n.frames?n.frames.map(i=>new Ie(o.x+i.x*o.w,o.y+i.y*o.h,i.w*o.w,i.h*o.h)):Tp(n.sliceX||1,n.sliceY||1,o.x,o.y,o.w,o.h);return new to(r,s,n.anims,n.slice9)}static fromURL(t,n={}){return Pi(t).then(r=>to.fromImage(r,n))}};function bs(e){if(typeof e=="string"){let t=Np(e);if(t)return t;if(Un()<1)return null;throw new Error(`Sprite not found: ${e}`)}else{if(e instanceof wn)return yt.loaded(e);if(e instanceof yt)return e;throw new Error(`Invalid sprite: ${e}`)}}function Np(e){return C.assets.sprites.get(e)??null}function co(e,t,n={sliceX:1,sliceY:1,anims:{}}){return t=mt(t),Array.isArray(t)?t.some(r=>typeof r=="string")?C.assets.sprites.add(e,Promise.all(t.map(r=>typeof r=="string"?Pi(r):Promise.resolve(r))).then(r=>cd(r,n))):C.assets.sprites.addLoaded(e,cd(t,n)):typeof t=="string"?C.assets.sprites.add(e,wn.from(t,n)):C.assets.sprites.addLoaded(e,wn.fromImage(t,n))}function Tp(e=1,t=1,n=0,r=0,o=1,s=1){let i=[],a=o/e,l=s/t;for(let c=0;c<t;c++)for(let d=0;d<e;d++)i.push(new Ie(n+d*a,r+c*l,a,l));return i}function cd(e,t={}){let n=document.createElement("canvas"),r=e[0].width,o=e[0].height;n.width=r*e.length,n.height=o;let s=n.getContext("2d");if(!s)throw new Error("Failed to create canvas context");e.forEach((a,l)=>{a instanceof ImageData?s.putImageData(a,l*r,0):s.drawImage(a,l*r,0)});let i=s.getImageData(0,0,e.length*r,o);return wn.fromImage(i,{...t,sliceX:e.length,sliceY:1})}function NM(e="bean"){return co(e,IM)}function TM(e,t,n){t=mt(t),n=mt(n),typeof t=="string"&&!n&&(n=_S(t)+".json");let r=typeof n=="string"?Ri(n):Promise.resolve(n);return C.assets.sprites.add(e,r.then(o=>{let s=o.meta.size,i=o.frames.map(l=>new Ie(l.frame.x/s.w,l.frame.y/s.h,l.frame.w/s.w,l.frame.h/s.h)),a={};for(let l of o.meta.frameTags)l.from===l.to?a[l.name]=l.from:a[l.name]={from:l.from,to:l.to,speed:10,loop:!0,pingpong:l.direction==="pingpong"};return wn.from(t,{frames:i,anims:a})}))}var As=class{constructor(e,t={}){H(this,"fontface");H(this,"filter",Ya);H(this,"outline",null);H(this,"size",64);if(this.fontface=e,this.filter=t.filter??Ya,this.size=t.size??64,this.size>256)throw new Error("Max font size: 256");t.outline&&(this.outline={width:1,color:we(0,0,0)},typeof t.outline=="number"?this.outline.width=t.outline:typeof t.outline=="object"&&(t.outline.width&&(this.outline.width=t.outline.width),t.outline.color&&(this.outline.color=t.outline.color)))}};function _p(e){if(!e)return _p(C.globalOpt.font??mS);if(typeof e=="string"){let t=Dp(e),n=kp(e);if(t)return t.data??t;if(n)return n.data??n;if(document.fonts.check(`64px ${e}`))return e;if(Un()<1)return null;throw new Error(`Font not found: ${e}`)}else if(e instanceof yt)return e.data?e.data:e;return e}function kp(e){return C.assets.fonts.get(e)??null}function _M(e,t,n={}){let r=mt(t),o=new FontFace(e,typeof t=="string"?`url(${r})`:r);return document.fonts.add(o),C.assets.fonts.add(e,o.load().catch(s=>{throw new Error(`Failed to load font from "${r}": ${s}`)}).then(s=>new As(s,n)))}function kM(e,t,n,r){let o=e.width/t,s={},i=r.split("").entries();for(let[a,l]of i)s[l]=new Ie(a%o*t,Math.floor(a/o)*n,t,n);return{tex:e,map:s,size:n}}function Dp(e){return C.assets.bitmapFonts.get(e)??null}function DM(e,t,n,r,o={}){let s=mt(t);return C.assets.bitmapFonts.add(e,Pi(s).then(i=>kM(pn.fromImage(C.gfx.ggl,i,o),n,r,o.chars??wp)))}function OM(e,t){return t=mt(t),C.assets.sprites.add(e,new Promise(async n=>{let r=typeof t=="string"?await Ri(t):t,o=await Promise.all(r.frames.map(Pi)),s=document.createElement("canvas");s.width=r.width,s.height=r.height*r.frames.length;let i=s.getContext("2d");if(!i)throw new Error("Failed to create canvas context");o.forEach((l,c)=>{i.drawImage(l,0,c*r.height)});let a=await co(null,s,{sliceY:r.frames.length,anims:r.anims});n(a)}))}var LM=class{constructor(e,t,n,r){H(this,"ctx");H(this,"glProgram");this.ctx=e,e.onDestroy(()=>this.free());let o=e.gl,s=o.createShader(o.VERTEX_SHADER),i=o.createShader(o.FRAGMENT_SHADER);if(!s||!i)throw new Error("Failed to create shader");o.shaderSource(s,t),o.shaderSource(i,n),o.compileShader(s),o.compileShader(i);let a=o.createProgram();if(this.glProgram=a,o.attachShader(a,s),o.attachShader(a,i),r.forEach((l,c)=>o.bindAttribLocation(a,c,l)),o.linkProgram(a),!o.getProgramParameter(a,o.LINK_STATUS)){let l=o.getShaderInfoLog(s);if(l)throw new Error("VERTEX SHADER "+l);let c=o.getShaderInfoLog(i);if(c)throw new Error("FRAGMENT SHADER "+c)}o.deleteShader(s),o.deleteShader(i)}bind(){this.ctx.pushProgram(this.glProgram)}unbind(){this.ctx.popProgram()}send(e){let t=this.ctx.gl;for(let n in e){let r=e[n],o=t.getUniformLocation(this.glProgram,n);if(typeof r=="number")t.uniform1f(o,r);else if(r instanceof Ft)t.uniformMatrix4fv(o,!1,new Float32Array(r.m));else if(r instanceof pe)t.uniform3f(o,r.r,r.g,r.b);else if(r instanceof X)t.uniform2f(o,r.x,r.y);else if(Array.isArray(r))r[0],PS(r)?t.uniform1fv(o,r):RS(r)?t.uniform2fv(o,r.map(s=>[s.x,s.y]).flat()):CS(r)&&t.uniform3fv(o,r.map(s=>[s.r,s.g,s.b]).flat());else throw new Error("Unsupported uniform data type")}}free(){this.ctx.gl.deleteProgram(this.glProgram)}};function ec(e,t=Xa,n=Qa){let r=vS.replace("{{user}}",t??Xa),o=bS.replace("{{user}}",n??Qa);try{return new LM(e,r,o,Yl.map(s=>s.name))}catch(s){let i=/(?<type>^\w+) SHADER ERROR: 0:(?<line>\d+): (?<msg>.+)/,a=kS(s).match(i);if(!(a!=null&&a.groups))throw s;let l=Number(a.groups.line)-14,c=a.groups.msg.trim(),d=a.groups.type.toLowerCase();throw new Error(`${d} shader line ${l}: ${c}`)}}function BM(e){if(!e)return C.gfx.defShader;if(typeof e=="string"){let t=Op(e);if(t)return t.data??t;if(Un()<1)return null;throw new Error(`Shader not found: ${e}`)}else if(e instanceof yt)return e.data?e.data:e;return e}function Op(e){return C.assets.shaders.get(e)??null}function FM(e,t,n){return C.assets.shaders.addLoaded(e,ec(C.gfx.ggl,t,n))}function jM(e,t,n){t=mt(t),n=mt(n);let r=s=>s?EM(s):Promise.resolve(null),o=Promise.all([r(t),r(n)]).then(([s,i])=>ec(C.gfx.ggl,s,i));return C.assets.shaders.add(e,o)}var Po=class Es{constructor(t){H(this,"buf");this.buf=t}static fromArrayBuffer(t){return new Promise((n,r)=>C.audio.ctx.decodeAudioData(t,n,r)).then(n=>new Es(n))}static fromURL(t){return Mp(t)?Es.fromArrayBuffer(NS(t)):SM(t).then(n=>Es.fromArrayBuffer(n))}};function qM(e){if(typeof e=="string"){let t=Lp(e);if(t)return t;if(Un()<1)return null;throw new Error(`Sound not found: ${e}`)}else{if(e instanceof Po)return yt.loaded(e);if(e instanceof yt)return e;throw new Error(`Invalid sound: ${e}`)}}function Lp(e){return C.assets.sounds.get(e)??null}function zM(e,t){return t=mt(t),C.assets.sounds.add(e,typeof t=="string"?Po.fromURL(t):Po.fromArrayBuffer(t))}function HM(e,t){let n=mt(t),r=new Audio(n);return r.preload="auto",C.assets.music[e]=n}function Bp(e,t){return e=mt(e),tl(typeof t=="string"?new Promise((n,r)=>{Ri(t).then(o=>{Bp(e,o).then(n).catch(r)})}):wn.from(e).then(n=>{let r={};for(let o in t){let s=t[o],i=n.frames[0],a=2048*i.w,l=2048*i.h,c=s.frames?s.frames.map(f=>new Ie(i.x+(s.x+f.x)/a*i.w,i.y+(s.y+f.y)/l*i.h,f.w/a*i.w,f.h/l*i.h)):Tp(s.sliceX||1,s.sliceY||1,i.x+s.x/a*i.w,i.y+s.y/l*i.h,s.width/a*i.w,s.height/l*i.h),d=new wn(n.tex,c,s.anims);C.assets.sprites.addLoaded(o,d),r[o]=d}return r}))}function An(e,t,n=!1,r,o,s={}){let i=r??C.gfx.defTex,a=o??C.gfx.defShader,l=BM(a);if(!l||l instanceof yt)return;let c=C.gfx.fixed||n?C.gfx.transform:C.game.cam.transform.mult(C.gfx.transform),d=[];for(let f of e){let u=wM(c.multVec2(f.pos));d.push(u.x,u.y,f.uv.x,f.uv.y,f.color.r/255,f.color.g/255,f.color.b/255,f.opacity)}C.gfx.renderer.push(C.gfx.ggl.gl.TRIANGLES,d,t,l,i,s)}function hn(e){if(!e.pts)throw new Error('drawPolygon() requires property "pts".');let t=e.pts.length;if(!(t<3)){if(dt(),Te(e.pos),Ro(e.scale),Tr(e.angle),Te(e.offset),e.fill!==!1){let n=e.color??pe.WHITE,r=e.pts.map((s,i)=>({pos:new X(s.x,s.y),uv:e.uv?e.uv[i]:new X(0,0),color:e.colors&&e.colors[i]?e.colors[i].mult(n):n,opacity:e.opacity??1})),o;e.triangulate?o=yp(e.pts).map(s=>s.map(i=>e.pts.indexOf(i))).flat():o=[...Array(t-2).keys()].map(s=>[0,s+1,s+2]).flat(),An(r,e.indices??o,e.fixed,e.uv?e.tex:C.gfx.defTex,e.shader,e.uniform??void 0)}e.outline&&tc({pts:[...e.pts,e.pts[0]],radius:e.radius,width:e.outline.width,color:e.outline.color,join:e.outline.join,uniform:e.uniform,fixed:e.fixed,opacity:e.opacity??e.outline.opacity}),tt()}}function Fp(e){if(e.radiusX===void 0||e.radiusY===void 0)throw new Error('drawEllipse() requires properties "radiusX" and "radiusY".');if(e.radiusX===0||e.radiusY===0)return;let t=e.start??0,n=e.end??360,r=Lr(e.anchor??"center").scale(new X(-e.radiusX,-e.radiusY)),o=eo(r,e.radiusX,e.radiusY,t,n,e.resolution);o.unshift(r);let s=Object.assign({},e,{pts:o,radius:0,...e.gradient?{colors:[e.gradient[0],...Array(o.length-1).fill(e.gradient[1])]}:{}});if(n-t>=360&&e.outline){e.fill!==!1&&hn(Object.assign({},s,{outline:null})),hn(Object.assign({},s,{pts:o.slice(1),fill:!1}));return}hn(s)}function Br(e){if(typeof e.radius!="number")throw new Error('drawCircle() requires property "radius".');e.radius!==0&&Fp(Object.assign({},e,{radiusX:e.radius,radiusY:e.radius,angle:0}))}function no(e){let{p1:t,p2:n}=e;if(!t||!n)throw new Error('drawLine() requires properties "p1" and "p2".');let r=e.width||1,o=n.sub(t).unit().normal().scale(r*.5),s=[t.sub(o),t.add(o),n.add(o),n.sub(o)].map(i=>({pos:new X(i.x,i.y),uv:new X(0),color:e.color??pe.WHITE,opacity:e.opacity??1}));An(s,[0,1,3,1,2,3],e.fixed,C.gfx.defTex,e.shader,e.uniform??void 0)}function VM(e){let t=e.pts,n=[],r=(e.width||1)*.5,o=t[0]===t[t.length-1]||t[0].eq(t[t.length-1]),s=e.pos||$(0,0),i;o?i=t[0].sub(t[t.length-2]):i=t[1].sub(t[0]);let a=i.len(),l=i.normal().scale(-r/a),c,d=t[0];if(!o)switch(e.cap){case"square":{let p=i.scale(-r/a);n.push(d.add(p).add(l)),n.push(d.add(p).sub(l));break}case"round":{let p=Math.max(r,10),m=Math.PI/p,g=l.scale(-1),y=Math.cos(m),b=Math.sin(m);for(let w=0;w<p;w++)n.push(d),n.push(d.sub(g)),g=$(g.x*y-g.y*b,g.x*b+g.y*y)}}for(let p=1;p<t.length;p++){if(d===t[p]||d.eq(t[p]))continue;c=d,d=t[p];let m=d.sub(c),g=m.len(),y=m.normal().scale(-r/g),b=i.cross(m);if(Math.abs(b)/(a*g)<.05){n.push(c.add(l)),n.push(c.sub(l)),i.dot(m)<0&&(n.push(c.sub(l)),n.push(c.add(l))),i=m,a=g,l=y;continue}let w=y.sub(l).cross(m)/b,E=l.add(i.scale(w));b>0?(n.push(c.add(E)),n.push(c.sub(l)),n.push(c.add(E)),n.push(c.sub(y))):(n.push(c.add(l)),n.push(c.sub(E)),n.push(c.add(y)),n.push(c.sub(E))),i=m,a=g,l=y}if(!o)switch(n.push(d.add(l)),n.push(d.sub(l)),e.cap){case"square":{let p=i.scale(r/a);n.push(d.add(p).add(l)),n.push(d.add(p).sub(l));break}case"round":{let p=Math.max(r,10),m=Math.PI/p,g=l.scale(1),y=Math.cos(m),b=Math.sin(m);for(let w=0;w<p;w++)g=$(g.x*y-g.y*b,g.x*b+g.y*y),n.push(d),n.push(d.sub(g))}}if(n.length<4)return;let f=n.map(p=>({pos:s.add(p),uv:$(),color:e.color||pe.WHITE,opacity:e.opacity??1})),u=[],h=0;for(let p=0;p<n.length-2;p+=2)u[h++]=p+1,u[h++]=p,u[h++]=p+2,u[h++]=p+2,u[h++]=p+3,u[h++]=p+1;o&&(u[h++]=n.length-1,u[h++]=n.length-2,u[h++]=0,u[h++]=0,u[h++]=1,u[h++]=n.length-1),An(f,u,e.fixed,C.gfx.defTex,e.shader,e.uniform??void 0)}function UM(e){let t=e.pts,n=[],r=(e.width||1)*.5,o=t[0]===t[t.length-1]||t[0].eq(t[t.length-1]),s=e.pos||$(0,0),i;o?i=t[0].sub(t[t.length-2]):i=t[1].sub(t[0]);let a=i.len(),l=i.normal().scale(-r/a),c,d=t[0];if(!o)switch(e.cap){case"square":{let p=i.scale(-r/a);n.push(d.add(p).add(l)),n.push(d.add(p).sub(l));break}case"round":{let p=Math.max(r,10),m=Math.PI/p,g=l.scale(-1),y=Math.cos(m),b=Math.sin(m);for(let w=0;w<p;w++)n.push(d),n.push(d.sub(g)),g=$(g.x*y-g.y*b,g.x*b+g.y*y)}}for(let p=1;p<t.length;p++){if(d===t[p]||d.eq(t[p]))continue;c=d,d=t[p];let m=d.sub(c),g=m.len(),y=m.normal().scale(-r/g),b=i.cross(m);if(Math.abs(b)/(a*g)<.05){n.push(c.add(l)),n.push(c.sub(l)),i.dot(m)<0&&(n.push(c.sub(l)),n.push(c.add(l))),i=m,a=g,l=y;continue}let w=y.sub(l).cross(m)/b,E=l.add(i.scale(w));if(b>0){let P=c.add(E),A=Math.max(r,10),v=De(l.angleBetween(y)/A),M=l,N=Math.cos(v),_=Math.sin(v);for(let D=0;D<A;D++)n.push(P),n.push(c.sub(M)),M=$(M.x*N-M.y*_,M.x*_+M.y*N)}else{let P=c.sub(E),A=Math.max(r,10),v=De(l.angleBetween(y)/A),M=l,N=Math.cos(v),_=Math.sin(v);for(let D=0;D<A;D++)n.push(c.add(M)),n.push(P),M=$(M.x*N-M.y*_,M.x*_+M.y*N)}i=m,a=g,l=y}if(!o)switch(n.push(d.add(l)),n.push(d.sub(l)),e.cap){case"square":{let p=i.scale(r/a);n.push(d.add(p).add(l)),n.push(d.add(p).sub(l));break}case"round":{let p=Math.max(r,10),m=Math.PI/p,g=l.scale(1),y=Math.cos(m),b=Math.sin(m);for(let w=0;w<p;w++)g=$(g.x*y-g.y*b,g.x*b+g.y*y),n.push(d),n.push(d.sub(g))}}if(n.length<4)return;let f=n.map(p=>({pos:s.add(p),uv:$(),color:e.color||pe.WHITE,opacity:e.opacity??1})),u=[],h=0;for(let p=0;p<n.length-2;p+=2)u[h++]=p+1,u[h++]=p,u[h++]=p+2,u[h++]=p+2,u[h++]=p+3,u[h++]=p+1;o&&(u[h++]=n.length-1,u[h++]=n.length-2,u[h++]=0,u[h++]=0,u[h++]=1,u[h++]=n.length-1),An(f,u,e.fixed,C.gfx.defTex,e.shader,e.uniform??void 0)}function $M(e){let t=e.pts,n=[],r=(e.width||1)*.5,o=t[0]===t[t.length-1]||t[0].eq(t[t.length-1]),s=e.pos||$(0,0),i;o?i=t[0].sub(t[t.length-2]):i=t[1].sub(t[0]);let a=i.len(),l=i.normal().scale(-r/a),c,d=t[0];if(!o)switch(e.cap){case"square":{let p=i.scale(-r/a);n.push(d.add(p).add(l)),n.push(d.add(p).sub(l));break}case"round":{let p=Math.max(r,10),m=Math.PI/p,g=l.scale(-1),y=Math.cos(m),b=Math.sin(m);for(let w=0;w<p;w++)n.push(d),n.push(d.sub(g)),g=$(g.x*y-g.y*b,g.x*b+g.y*y)}}for(let p=1;p<t.length;p++){if(d===t[p]||d.eq(t[p]))continue;c=d,d=t[p];let m=d.sub(c),g=m.len(),y=m.normal().scale(-r/g),b=i.cross(m);if(Math.abs(b)/(a*g)<.05){n.push(c.add(l)),n.push(c.sub(l)),i.dot(m)<0&&(n.push(c.sub(l)),n.push(c.add(l))),i=m,a=g,l=y;continue}let w=y.sub(l).cross(m)/b,E=l.add(i.scale(w));n.push(c.add(E)),n.push(c.sub(E)),i=m,a=g,l=y}if(!o)switch(n.push(d.add(l)),n.push(d.sub(l)),e.cap){case"square":{let p=i.scale(r/a);n.push(d.add(p).add(l)),n.push(d.add(p).sub(l));break}case"round":{let p=Math.max(r,10),m=Math.PI/p,g=l.scale(1),y=Math.cos(m),b=Math.sin(m);for(let w=0;w<p;w++)g=$(g.x*y-g.y*b,g.x*b+g.y*y),n.push(d),n.push(d.sub(g))}}if(n.length<4)return;let f=n.map(p=>({pos:s.add(p),uv:$(),color:e.color||pe.WHITE,opacity:e.opacity??1})),u=[],h=0;for(let p=0;p<n.length-2;p+=2)u[h++]=p+1,u[h++]=p,u[h++]=p+2,u[h++]=p+2,u[h++]=p+3,u[h++]=p+1;o&&(u[h++]=n.length-1,u[h++]=n.length-2,u[h++]=0,u[h++]=0,u[h++]=1,u[h++]=n.length-1),An(f,u,e.fixed,C.gfx.defTex,e.shader,e.uniform??void 0)}function tc(e){let t=e.pts,n=e.width??1;if(!t)throw new Error('drawLines() requires property "pts".');if(!(t.length<2)){if(t.length>2)switch(e.join){case"bevel":return VM(e);case"round":return UM(e);case"miter":return $M(e)}if(e.radius&&t.length>=3){no(Object.assign({},e,{p1:t[0],p2:t[1]}));for(let r=1;r<t.length-2;r++){let o=t[r],s=t[r+1];no(Object.assign({},e,{p1:o,p2:s}))}no(Object.assign({},e,{p1:t[t.length-2],p2:t[t.length-1]}))}else for(let r=0;r<t.length-1;r++)no(Object.assign({},e,{p1:t[r],p2:t[r+1]})),e.join!=="none"&&Br(Object.assign({},e,{pos:t[r],radius:n/2}))}}function jp(e,t){let n=t.segments??16,r=[];for(let o=0;o<=n;o++)r.push(e(o/n));tc({pts:r,width:t.width||1,pos:t.pos,color:t.color,opacity:t.opacity})}function GM(e){jp(t=>Wl(e.pt1,e.pt2,e.pt3,e.pt4,t),e)}var pn=class qp{constructor(t,n,r,o={}){H(this,"ctx");H(this,"src",null);H(this,"glTex");H(this,"width");H(this,"height");this.ctx=t;let s=t.gl,i=t.gl.createTexture();if(!i)throw new Error("Failed to create texture");this.glTex=i,t.onDestroy(()=>this.free()),this.width=n,this.height=r;let a={linear:s.LINEAR,nearest:s.NEAREST}[o.filter??t.opts.texFilter??"nearest"],l={repeat:s.REPEAT,clampToEdge:s.CLAMP_TO_EDGE}[o.wrap??"clampToEdge"];this.bind(),n&&r&&s.texImage2D(s.TEXTURE_2D,0,s.RGBA,n,r,0,s.RGBA,s.UNSIGNED_BYTE,null),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,l),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,l),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this.unbind()}static fromImage(t,n,r={}){let o=new qp(t,n.width,n.height,r);return o.update(n),o.src=n,o}update(t,n=0,r=0){let o=this.ctx.gl;this.bind(),o.texSubImage2D(o.TEXTURE_2D,0,n,r,o.RGBA,o.UNSIGNED_BYTE,t),this.unbind()}bind(){this.ctx.pushTexture2D(this.glTex)}unbind(){this.ctx.popTexture2D()}free(){this.ctx.gl.deleteTexture(this.glTex)}},Ws=class{constructor(e,t,n,r={}){H(this,"ctx");H(this,"tex");H(this,"glFramebuffer");H(this,"glRenderbuffer");this.ctx=e;let o=e.gl;e.onDestroy(()=>this.free()),this.tex=new pn(e,t,n,r);let s=o.createFramebuffer(),i=o.createRenderbuffer();if(!s||!i)throw new Error("Failed to create framebuffer");this.glFramebuffer=s,this.glRenderbuffer=i,this.bind(),o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,t,n),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,this.tex.glTex,0),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,this.glRenderbuffer),this.unbind()}get width(){return this.tex.width}get height(){return this.tex.height}toImageData(){let e=this.ctx.gl,t=new Uint8ClampedArray(this.width*this.height*4);this.bind(),e.readPixels(0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,t),this.unbind();let n=this.width*4,r=new Uint8Array(n);for(let o=0;o<(this.height/2|0);o++){let s=o*n,i=(this.height-o-1)*n;r.set(t.subarray(s,s+n)),t.copyWithin(s,i,i+n),t.set(r,i)}return new ImageData(t,this.width,this.height)}toDataURL(){let e=document.createElement("canvas"),t=e.getContext("2d");if(e.width=this.width,e.height=this.height,!t)throw new Error("Failed to get 2d context");return t.putImageData(this.toImageData(),0,0),e.toDataURL()}clear(){let e=this.ctx.gl;e.clear(e.COLOR_BUFFER_BIT)}draw(e){this.bind(),e(),this.unbind()}bind(){this.ctx.pushFramebuffer(this.glFramebuffer),this.ctx.pushRenderbuffer(this.glRenderbuffer),this.ctx.pushViewport({x:0,y:0,w:this.width,h:this.height})}unbind(){this.ctx.popFramebuffer(),this.ctx.popRenderbuffer(),this.ctx.popViewport()}free(){let e=this.ctx.gl;e.deleteFramebuffer(this.glFramebuffer),e.deleteRenderbuffer(this.glRenderbuffer),this.tex.free()}},KM=class{constructor(e,t,n,r){H(this,"ctx");H(this,"glVBuf");H(this,"glIBuf");H(this,"vqueue",[]);H(this,"iqueue",[]);H(this,"stride");H(this,"maxVertices");H(this,"maxIndices");H(this,"vertexFormat");H(this,"numDraws",0);H(this,"curPrimitive",null);H(this,"curTex",null);H(this,"curShader",null);H(this,"curUniform",{});let o=e.gl;this.vertexFormat=t,this.ctx=e,this.stride=t.reduce((i,a)=>i+a.size,0),this.maxVertices=n,this.maxIndices=r;let s=o.createBuffer();if(!s)throw new Error("Failed to create vertex buffer");this.glVBuf=s,e.pushArrayBuffer(this.glVBuf),o.bufferData(o.ARRAY_BUFFER,n*4,o.DYNAMIC_DRAW),e.popArrayBuffer(),this.glIBuf=o.createBuffer(),e.pushElementArrayBuffer(this.glIBuf),o.bufferData(o.ELEMENT_ARRAY_BUFFER,r*4,o.DYNAMIC_DRAW),e.popElementArrayBuffer()}push(e,t,n,r,o=null,s={}){(e!==this.curPrimitive||o!==this.curTex||r!==this.curShader||!Ql(this.curUniform,s)||this.vqueue.length+t.length*this.stride>this.maxVertices||this.iqueue.length+n.length>this.maxIndices)&&this.flush();let i=this.vqueue.length/this.stride;for(let a of t)this.vqueue.push(a);for(let a of n)this.iqueue.push(a+i);this.curPrimitive=e,this.curShader=r,this.curTex=o,this.curUniform=s}flush(){var t,n;if(!this.curPrimitive||!this.curShader||this.vqueue.length===0||this.iqueue.length===0)return;let e=this.ctx.gl;this.ctx.pushArrayBuffer(this.glVBuf),e.bufferSubData(e.ARRAY_BUFFER,0,new Float32Array(this.vqueue)),this.ctx.pushElementArrayBuffer(this.glIBuf),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(this.iqueue)),this.ctx.setVertexFormat(this.vertexFormat),this.curShader.bind(),this.curShader.send(this.curUniform),(t=this.curTex)==null||t.bind(),e.drawElements(this.curPrimitive,this.iqueue.length,e.UNSIGNED_SHORT,0),(n=this.curTex)==null||n.unbind(),this.curShader.unbind(),this.ctx.popArrayBuffer(),this.ctx.popElementArrayBuffer(),this.vqueue=[],this.iqueue=[],this.numDraws++}free(){let e=this.ctx.gl;e.deleteBuffer(this.glVBuf),e.deleteBuffer(this.glIBuf)}};function In(e){let t=[],n=s=>{t.push(s),e(s)},r=()=>{t.pop(),e(o()??null)},o=()=>t[t.length-1];return[n,r,o]}function WM(e,t={}){let n=[];function r(P){n.push(P)}function o(){n.forEach(A=>A());let P=e.getExtension("WEBGL_lose_context");P&&P.loseContext()}let s=null;function i(P){if(Ql(P,s))return;s=P;let A=P.reduce((v,M)=>v+M.size,0);P.reduce((v,M,N)=>(e.vertexAttribPointer(N,M.size,e.FLOAT,!1,A*4,v),e.enableVertexAttribArray(N),v+M.size*4),0)}let[a,l]=In(P=>e.bindTexture(e.TEXTURE_2D,P)),[c,d]=In(P=>e.bindBuffer(e.ARRAY_BUFFER,P)),[f,u]=In(P=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,P)),[h,p]=In(P=>e.bindFramebuffer(e.FRAMEBUFFER,P)),[m,g]=In(P=>e.bindRenderbuffer(e.RENDERBUFFER,P)),[y,b]=In(P=>{if(!P)return;let{x:A,y:v,w:M,h:N}=P;e.viewport(A,v,M,N)}),[w,E]=In(P=>e.useProgram(P));return y({x:0,y:0,w:e.drawingBufferWidth,h:e.drawingBufferHeight}),{gl:e,opts:t,onDestroy:r,destroy:o,pushTexture2D:a,popTexture2D:l,pushArrayBuffer:c,popArrayBuffer:d,pushElementArrayBuffer:f,popElementArrayBuffer:u,pushFramebuffer:h,popFramebuffer:p,pushRenderbuffer:m,popRenderbuffer:g,pushViewport:y,popViewport:b,pushProgram:w,popProgram:E,setVertexFormat:i}}var ha={};function ud(e,t){if(t.override){Object.assign(e,t);return}t.pos&&(e.pos=e.pos.add(t.pos)),t.scale&&(e.scale=e.scale.scale($(t.scale))),t.angle&&(e.angle+=t.angle),t.color&&e.ch.length===1&&(e.color=e.color.mult(t.color)),t.opacity!=null&&(e.opacity*=t.opacity)}function nl(e){let t={},n="",r=[],o=String(e),s=i=>{r.length>0&&(t[n.length]=r.slice()),n+=i};for(;o!=="";){if(o[0]==="\\"){if(o.length===1)throw new Error("Styled text error: \\ at end of string");s(o[1]),o=o.slice(2);continue}if(o[0]==="["){let i=/^\[(\/)?(\w+?)\]/.exec(o);if(!i){s(o[0]),o=o.slice(1);continue}let[a,l,c]=i;if(l!==void 0){let d=r.pop();if(d!==c)throw d!==void 0?new Error(`Styled text error: mismatched tags. Expected [/${d}], got [/${c}]`):new Error(`Styled text error: stray end tag [/${c}]`)}else r.push(c);o=o.slice(a.length);continue}s(o[0]),o=o.slice(1)}if(r.length>0)throw new Error(`Styled text error: unclosed tags ${r}`);return{charStyleMap:t,text:n}}function $n(e){var w,E,P;if(e.text===void 0)throw new Error('formatText() requires property "text".');let t=_p(e.font);if(!e.text||e.text===""||t instanceof yt||!t)return{width:0,height:0,chars:[],opt:e,renderedText:""};let{charStyleMap:n,text:r}=nl(e.text+""),o=LS(r);if(t instanceof As||typeof t=="string"){let A=t instanceof As?t.fontface.family:t,v=t instanceof As?{outline:t.outline,filter:t.filter}:{outline:null,filter:Ya},M=ha[A]??{font:{tex:new pn(C.gfx.ggl,2048,2048,{filter:v.filter}),map:{},size:64},cursor:new X(0),maxHeight:0,outline:v.outline};ha[A]||(ha[A]=M),t=M.font;for(let N of o)if(!M.font.map[N]){let _=C.fontCacheC2d;if(!_)throw new Error("fontCacheC2d is not defined.");if(!C.fontCacheCanvas)throw new Error("fontCacheCanvas is not defined.");_.clearRect(0,0,C.fontCacheCanvas.width,C.fontCacheCanvas.height),_.font=`${t.size}px ${A}`,_.textBaseline="top",_.textAlign="left",_.fillStyle="#ffffff";let D=_.measureText(N),B=Math.ceil(D.width);if(!B)continue;let j=Math.ceil(Math.abs(D.actualBoundingBoxAscent))+Math.ceil(Math.abs(D.actualBoundingBoxDescent));M.outline&&M.outline.width&&M.outline.color&&(_.lineJoin="round",_.lineWidth=M.outline.width*2,_.strokeStyle=M.outline.color.toHex(),_.strokeText(N,M.outline.width,M.outline.width),B+=M.outline.width*2,j+=M.outline.width*3),_.fillText(N,((w=M.outline)==null?void 0:w.width)??0,((E=M.outline)==null?void 0:E.width)??0);let R=_.getImageData(0,0,B,j);if(M.cursor.x+B>2048&&(M.cursor.x=0,M.cursor.y+=M.maxHeight,M.maxHeight=0,M.cursor.y>2048))throw new Error("Font atlas exceeds character limit");t.tex.update(R,M.cursor.x,M.cursor.y),t.map[N]=new Ie(M.cursor.x,M.cursor.y,B,j),M.cursor.x+=B+1,M.maxHeight=Math.max(M.maxHeight,j)}}let s=e.size||t.size,i=$(e.scale??1).scale(s/t.size),a=e.lineSpacing??0,l=e.letterSpacing??0,c=0,d=0,f=0,u=[],h=[],p=0,m=null,g=0,y;for(;p<o.length;){let A=o[p];if(A===`
`)f+=s+a,u.push({width:c-l,chars:h}),m=null,g=0,c=0,h=[],y=void 0;else{let v=t.map[A];if(v){let M=v.w*i.x;e.width&&c+M>e.width&&(f+=s+a,m!=null&&(p-=h.length-m,A=o[p],v=t.map[A],M=v.w*i.x,h=h.slice(0,m-1),c=g),m=null,g=0,u.push({width:c-l,chars:h}),c=y??0,h=[]),h.push({tex:t.tex,width:v.w,height:v.h,quad:new Ie(v.x/t.tex.width,v.y/t.tex.height,v.w/t.tex.width,v.h/t.tex.height),ch:A,pos:new X(c,f),opacity:e.opacity??1,color:e.color??pe.WHITE,scale:$(i),angle:0}),A===" "&&(m=h.length,g=c),e.indentAll&&y===void 0&&/\S/.test(A)&&(y=c),c+=M,d=Math.max(d,c),c+=l}}p++}u.push({width:c-l,chars:h}),f+=s,e.width&&(d=e.width);let b=[];for(let A=0;A<u.length;A++){let v=(d-u[A].width)*dM(e.align??"left");for(let M of u[A].chars){let N=t.map[M.ch],_=b.length+A;if(M.pos=M.pos.add(v,0).add(N.w*i.x*.5,N.h*i.y*.5),e.transform){let D=typeof e.transform=="function"?e.transform(_,M.ch):e.transform;D&&ud(M,D)}if(n[_]){let D=n[_];for(let B of D){let j=(P=e.styles)==null?void 0:P[B],R=typeof j=="function"?j(_,M.ch):j;R&&ud(M,R)}}b.push(M)}}return{width:d,height:f,chars:b,opt:e,renderedText:r}}function Io(e){if(e.width===void 0||e.height===void 0)throw new Error('drawUVQuad() requires property "width" and "height".');if(e.width<=0||e.height<=0)return;let t=e.width,n=e.height,r=Lr(e.anchor||Ci).scale(new X(t,n).scale(-.5)),o=e.quad||new Ie(0,0,1,1),s=e.color||we(255,255,255),i=e.opacity??1,a=e.tex?.1/e.tex.width:0,l=e.tex?.1/e.tex.height:0,c=o.x+a,d=o.y+l,f=o.w-a*2,u=o.h-l*2;dt(),Te(e.pos),Tr(e.angle),Ro(e.scale),Te(r),An([{pos:new X(-t/2,n/2),uv:new X(e.flipX?c+f:c,e.flipY?d:d+u),color:s,opacity:i},{pos:new X(-t/2,-n/2),uv:new X(e.flipX?c+f:c,e.flipY?d+u:d),color:s,opacity:i},{pos:new X(t/2,-n/2),uv:new X(e.flipX?c:c+f,e.flipY?d+u:d),color:s,opacity:i},{pos:new X(t/2,n/2),uv:new X(e.flipX?c:c+f,e.flipY?d:d+u),color:s,opacity:i}],[0,1,3,1,2,3],e.fixed,e.tex,e.shader,e.uniform??void 0),tt()}function Gn(e){dt(),Te(e.opt.pos),Tr(e.opt.angle),Te(Lr(e.opt.anchor??"topleft").add(1,1).scale(e.width,e.height).scale(-.5)),e.chars.forEach(t=>{Io({tex:t.tex,width:t.width,height:t.height,pos:t.pos,scale:t.scale,angle:t.angle,color:t.color,opacity:t.opacity,quad:t.quad,anchor:"center",uniform:e.opt.uniform,shader:e.opt.shader,fixed:e.opt.fixed})}),tt()}function ht(e){if(e.width===void 0||e.height===void 0)throw new Error('drawRect() requires property "width" and "height".');if(e.width<=0||e.height<=0)return;let t=e.width,n=e.height,r=Lr(e.anchor||Ci).add(1,1).scale(new X(t,n).scale(-.5)),o=[new X(0,0),new X(t,0),new X(t,n),new X(0,n)];if(e.radius){let s=Math.min(t,n)/2,i=Array.isArray(e.radius)?e.radius.map(a=>Math.min(s,a)):new Array(4).fill(Math.min(s,e.radius));o=[new X(i[0],0),...i[1]?eo(new X(t-i[1],i[1]),i[1],i[1],270,360):[$(t,0)],...i[2]?eo(new X(t-i[2],n-i[2]),i[2],i[2],0,90):[$(t,n)],...i[3]?eo(new X(i[3],n-i[3]),i[3],i[3],90,180):[$(0,n)],...i[0]?eo(new X(i[0],i[0]),i[0],i[0],180,270):[]]}hn(Object.assign({},e,{offset:r,pts:o,...e.gradient?{colors:e.horizontal?[e.gradient[0],e.gradient[1],e.gradient[1],e.gradient[0]]:[e.gradient[0],e.gradient[0],e.gradient[1],e.gradient[1]]}:{}}))}function dn(e){ft();let t=C.gfx.width,n=C.gfx.height;C.gfx.width=C.gfx.viewport.width,C.gfx.height=C.gfx.viewport.height,e(),ft(),C.gfx.width=t,C.gfx.height=n}function dd(e,t){dn(()=>{let n=$(8);dt(),Te(e);let r=$n({text:t,font:Gs,size:16,pos:n,color:we(255,255,255),fixed:!0}),o=r.width+n.x*2,s=r.height+n.x*2;e.x+o>=He()&&Te($(-o,0)),e.y+s>=Ue()&&Te($(0,-s)),ht({width:o,height:s,color:we(0,0,0),radius:4,opacity:.8,fixed:!0}),Gn(r),tt()})}function zp(e){if(!e.p1||!e.p2||!e.p3)throw new Error('drawTriangle() requires properties "p1", "p2" and "p3".');return hn(Object.assign({},e,{pts:[e.p1,e.p2,e.p3]}))}function YM(){if(C.debug.inspect){let e=null;for(let t of C.game.root.get("*",{recursive:!0}))if(t.has("area")&&t.isHovering()){e=t;break}if(C.game.root.drawInspect(),e){let t=[],n=e.inspect();for(let r in n)n[r]?t.push(`${n[r]}`):t.push(`${r}`);dd(WS(C.k.mousePos()),t.join(`
`))}dd($(8),`FPS: ${C.debug.fps()}`)}C.debug.paused&&dn(()=>{dt(),Te(He(),0),Te(-8,8);let e=32;ht({width:e,height:e,anchor:"topright",color:we(0,0,0),opacity:.8,radius:4,fixed:!0});for(let t=1;t<=2;t++)ht({width:4,height:e*.6,anchor:"center",pos:$(-32/3*t,e*.5),color:we(255,255,255),radius:2,fixed:!0});tt()}),C.debug.timeScale!==1&&dn(()=>{dt(),Te(He(),Ue()),Te(-8,-8);let e=8,t=$n({text:C.debug.timeScale.toFixed(1),font:Gs,size:16,color:we(255,255,255),pos:$(-8),anchor:"botright",fixed:!0});ht({width:t.width+e*2+e*4,height:t.height+e*2,anchor:"botright",color:we(0,0,0),opacity:.8,radius:4,fixed:!0});for(let n=0;n<2;n++){let r=C.debug.timeScale<1;zp({p1:$(-t.width-e*(r?2:3.5),-8),p2:$(-t.width-e*(r?2:3.5),-8-t.height),p3:$(-t.width-e*(r?3.5:2),-8-t.height/2),pos:$(-n*e*1+(r?-8*.5:0),0),color:we(255,255,255),fixed:!0})}Gn(t),tt()}),C.debug.curRecording&&dn(()=>{dt(),Te(0,Ue()),Te(24,-24),Br({radius:12,color:we(255,0,0),opacity:tp(0,1,C.app.time()*4),fixed:!0}),tt()}),C.debug.showLog&&C.game.logs.length>0&&dn(()=>{dt(),Te(0,Ue()),Te(8,-8);let e=8,t=[];for(let r of C.game.logs){let o="",s=r.msg instanceof Error?"error":"info";o+=`[time]${r.time.toFixed(2)}[/time]`,o+=" ",o+=`[${s}]${rl(r.msg)}[/${s}]`,t.push(o)}C.game.logs=C.game.logs.filter(r=>C.app.time()-r.time<(C.globalOpt.logTime||4));let n=$n({text:t.join(`
`),font:Gs,pos:$(e,-8),anchor:"botleft",size:16,width:He()*.6,lineSpacing:e/2,fixed:!0,styles:{time:{color:we(127,127,127)},info:{color:we(255,255,255)},error:{color:we(255,0,127)}}});ht({width:n.width+e*2,height:n.height+e*2,anchor:"botleft",color:we(0,0,0),radius:4,opacity:.8,fixed:!0}),Gn(n),tt()})}function rl(e,t=!1,n=new Set){if(n.has(e))return"<recursive>";var r="",o;return t&&typeof e=="string"&&(e=JSON.stringify(e)),Array.isArray(e)&&(r=["[",e.map(s=>rl(s,!0,n.union(new Set([e])))).join(", "),"]"].join(""),e=r),e===null?"null":(typeof e=="object"&&e.toString===Object.prototype.toString&&(e.constructor!==Object&&(r+=e.constructor.name+" "),r+=["{",(o=Object.getOwnPropertyNames(e).map(s=>`${/^\w+$/.test(s)?s:JSON.stringify(s)}: ${rl(e[s],!0,n.union(new Set([e])))}`).join(", "))?` ${o} `:"","}"].join(""),e=r),String(e).replaceAll(new RegExp("(?<!\\\\)\\[","g"),"\\["))}function XM(){let e=C.game.cam,t=X.fromAngle(je(0,360)).scale(e.shake);e.shake=nt(e.shake,0,5*qe()),e.transform=new Ft().translate(Ks()).scale(e.scale).rotate(e.angle).translate((e.pos??Ks()).scale(-1).add(t)),C.game.root.draw(),ft()}function QM(){let e=Un();C.game.events.numListeners("loading")>0?C.game.events.trigger("loading",e):dn(()=>{let t=He()/2,n=24,r=$(He()/2,Ue()/2).sub($(t/2,n/2));ht({pos:$(0),width:He(),height:Ue(),color:we(0,0,0)}),ht({pos:r,width:t,height:n,fill:!1,outline:{width:4}}),ht({pos:r,width:t*e,height:n})})}function Hp(e,t,n){let r=C.gfx.ggl.gl;ft(),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST),r.stencilFunc(r.NEVER,1,255),r.stencilOp(r.REPLACE,r.REPLACE,r.REPLACE),t(),ft(),r.stencilFunc(n,1,255),r.stencilOp(r.KEEP,r.KEEP,r.KEEP),e(),ft(),r.disable(r.STENCIL_TEST)}function ZM(e,t){let n=C.gfx.ggl.gl;Hp(e,t,n.EQUAL)}function Ys(e){var s,i;if(!e.tex)throw new Error('drawTexture() requires property "tex".');let t=e.quad??new Ie(0,0,1,1),n=e.tex.width*t.w,r=e.tex.height*t.h,o=new X(1);if(e.tiled){let a=Lr(e.anchor||Ci);(((s=e.pos)==null?void 0:s.x)||0)-(a.x+1)*.5*(e.width||n),(((i=e.pos)==null?void 0:i.y)||0)-(a.y+1)*.5*(e.height||r);let l=(e.width||n)/n,c=(e.height||r)/r,d=Math.floor(l),f=Math.floor(c),u=l-d,h=c-f,p=(d+u?1:0)*(f+h?1:0),m=new Array(p*6),g=new Array(p*4),y=0,b=(w,E,P,A,v)=>{m[y*6+0]=y*4+0,m[y*6+1]=y*4+1,m[y*6+2]=y*4+3,m[y*6+3]=y*4+1,m[y*6+4]=y*4+2,m[y*6+5]=y*4+3,g[y*4+0]={pos:new X(w-a.x,E-a.y),uv:new X(v.x,v.y),color:e.color||pe.WHITE,opacity:e.opacity||1},g[y*4+1]={pos:new X(w+P-a.x,E-a.y),uv:new X(v.x+v.w,v.y),color:e.color||pe.WHITE,opacity:e.opacity||1},g[y*4+2]={pos:new X(w+P-a.x,E+A-a.y),uv:new X(v.x+v.w,v.y+v.h),color:e.color||pe.WHITE,opacity:e.opacity||1},g[y*4+3]={pos:new X(w-a.x,E+A-a.y),uv:new X(v.x,v.y+v.h),color:e.color||pe.WHITE,opacity:e.opacity||1},y++};for(let w=0;w<f;w++){for(let E=0;E<d;E++)b(E*n,w*r,n,r,t);u&&b(d*n,w*r,n*u,r,new Ie(t.x,t.y,t.w*u,t.h))}if(h){for(let w=0;w<d;w++)b(w*n,f*r,n,r*h,new Ie(t.x,t.y,t.w,t.h*h));u&&b(d*n,f*r,n*u,r*h,new Ie(t.x,t.y,t.w*u,t.h*h))}An(g,m,e.fixed,e.tex,e.shader,e.uniform??void 0)}else e.width&&e.height?(o.x=e.width/n,o.y=e.height/r):e.width?(o.x=e.width/n,o.y=o.x):e.height&&(o.y=e.height/r,o.x=o.y),Io(Object.assign({},e,{scale:o.scale(e.scale||new X(1)),tex:e.tex,quad:t,width:n,height:r}))}function JM(e){if(!e.sprite)throw new Error('drawSprite() requires property "sprite"');let t=bs(e.sprite);if(!t||!t.data)return;let n=t.data.frames[e.frame??0];if(!n)throw new Error(`Frame not found: ${e.frame??0}`);Ys(Object.assign({},e,{tex:t.data.tex,quad:n.scale(e.quad??new Ie(0,0,1,1))}))}function eC(e,t){let n=C.gfx.ggl.gl;Hp(e,t,n.NOTEQUAL)}function fd(e){Gn($n(e))}var tC=(e,t)=>{let n=ec(t,Xa,Qa),r=e.pixelDensity??1,o=e.scale??1,{gl:s}=t,i=pn.fromImage(t,new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1)),a=e.width&&e.height?new Ws(t,e.width*r*o,e.height*r*o):new Ws(t,s.drawingBufferWidth,s.drawingBufferHeight),l=null,c=1;e.background&&(typeof e.background=="string"?l=we(e.background):(l=we(...e.background),c=e.background[3]??1),s.clearColor(l.r/255,l.g/255,l.b/255,c??1)),s.enable(s.BLEND),s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);let d=new KM(t,Yl,wS,xS),f=pn.fromImage(t,new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,190,190,255,128,128,128,255]),2,2),{wrap:"repeat",filter:"nearest"});return{lastDrawCalls:0,ggl:t,defShader:n,defTex:i,frameBuffer:a,postShader:null,postShaderUniform:null,renderer:d,transform:new Ft,transformStack:[],bgTex:f,bgColor:l,bgAlpha:c,width:e.width??s.drawingBufferWidth/r/o,height:e.height??s.drawingBufferHeight/r/o,viewport:{x:0,y:0,width:s.drawingBufferWidth,height:s.drawingBufferHeight,scale:1},fixed:!1}};function Bn(e){return e.fixed?!0:e.parent?Bn(e.parent):!1}function Kn(e){return{color:e.color,opacity:e.opacity,anchor:e.anchor,outline:e.outline,shader:e.shader,uniform:e.uniform}}function nC(e,t={}){return{id:"circle",radius:e,draw(){Br(Object.assign(Kn(this),{radius:this.radius,fill:t.fill}))},renderArea(){return new Ee(new X(this.anchor?0:-this.radius),this.radius*2,this.radius*2)},inspect(){return`radius: ${Math.ceil(this.radius)}`}}}function Vp(...e){return{id:"color",color:we(...e),inspect(){return`color: ${this.color.toString()}`}}}function rC(e){return{add(){this.canvas=e}}}function oC(e=1){let t,n=0,r=!1;return{require:["opacity"],add(){t=this.opacity,this.opacity=0},update(){r||(n+=qe(),this.opacity=Ot(n,0,e,0,t),n>=e&&(this.opacity=t,r=!0))}}}function sC(e="intersect"){return{id:"mask",mask:e}}function Up(e){return{id:"opacity",opacity:e??1,fadeIn(t=1,n=C.k.easings.linear){return C.game.root.tween(0,this.opacity,t,r=>this.opacity=r,n)},fadeOut(t=1,n=C.k.easings.linear){return C.game.root.tween(this.opacity,0,t,r=>this.opacity=r,n)},inspect(){return`opacity: ${Za(this.opacity,1)}`}}}function iC(e=1,t=we(0,0,0),n=1,r="miter",o=10,s="butt"){return{id:"outline",outline:{width:e,color:t,opacity:n,join:r,miterLimit:o,cap:s},inspect(){return`outline: ${this.outline.width}px, ${this.outline.color}`}}}var aC=class{constructor(){H(this,"pos",$(0));H(this,"vel",$(0));H(this,"acc",$(0));H(this,"angle",0);H(this,"angularVelocity",0);H(this,"damping",0);H(this,"t");H(this,"lt",null);H(this,"gc");this.t=0,this.gc=!0}get progress(){return this.lt?this.t/this.lt:this.t}};function lC(e,t){let n=t.lifetime,r=[],o=e.colors||[pe.WHITE],s=e.opacities||[1],i=e.quads||[new Ie(0,0,1,1)],a=e.scales||[1],l=e.lifeTime,c=t.direction,d=t.spread,f=e.speed||[0,0],u=e.angle||[0,0],h=e.angularVelocity||[0,0],p=e.acceleration||[$(0),$(0)],m=e.damping||[0,0],g=[],y=new Array(e.max),b=0,w=0;for(let A=0;A<e.max;A++){g[A*6+0]=A*4+0,g[A*6+1]=A*4+1,g[A*6+2]=A*4+3,g[A*6+3]=A*4+1,g[A*6+4]=A*4+2,g[A*6+5]=A*4+3;for(let v=0;v<4;v++)y[A*4+v]={pos:new X(0,0),uv:new X(0,0),color:we(255,255,255),opacity:1};r[A]=new aC}let E=new We;function P(A=0){for(;A<e.max;){if(r[A].gc)return A;A++}return null}return{id:"particles",emit(A){let v=0;for(let M=0;M<A;M++){if(v=P(v),v==null)return;let N=je(c-d,c+d),_=X.fromAngle(N).scale(je(f[0],f[1])),D=je(u[0],u[1]),B=je(h[0],h[1]),j=$(je(p[0].x,p[1].x),je(p[0].y,p[1].y)),R=je(m[0],m[1]),O=l?je(l[0],l[1]):null,I=t.shape?t.shape.random():$(),k=r[v];k.lt=O,k.pos=I,k.vel=_,k.acc=j,k.angle=D,k.angularVelocity=B,k.damping=R,k.angularVelocity=B,k.gc=!1}b+=A},update(){if(n!==void 0&&n<=0)return;let A=qe();for(let v of r)if(!v.gc){if(v.t+=A,v.lt&&v.t>=v.lt){v.gc=!0,b--;continue}v.vel=v.vel.add(v.acc.scale(A)).scale(1-v.damping*A),v.pos=v.pos.add(v.vel.scale(A)),v.angle+=v.angularVelocity*A}for(n!==void 0&&(n-=A,n<=0&&E.trigger()),w+=A;b<e.max&&t.rate&&w>t.rate;)this.emit(1),b++,w-=t.rate},draw(){if(!(n!==void 0&&n<=0)){for(let A=0;A<r.length;A++){let v=r[A];if(v.gc)continue;let M=v.progress,N=Math.floor(v.progress*o.length),_=N<o.length-1?nt(o[N],o[N+1],Ot(M,N/o.length,(N+1)/o.length,0,1)):o[N],D=Math.floor(v.progress*s.length),B=D<s.length-1?nt(s[D],s[D+1],Ot(M,D/s.length,(D+1)/s.length,0,1)):s[D],j=Math.floor(v.progress*i.length),R=i[j],O=Math.floor(v.progress*a.length),I=a[O],k=Math.cos(v.angle*Math.PI/180),F=Math.sin(v.angle*Math.PI/180),T=(e.texture?e.texture.width:10)*R.w/2,z=(e.texture?e.texture.height:10)*R.h/2,V=A*4,U=y[V];U.pos.x=v.pos.x+-T*I*k- -z*I*F,U.pos.y=v.pos.y+-T*I*F+-z*I*k,U.uv.x=R.x,U.uv.y=R.y,U.color.r=_.r,U.color.g=_.g,U.color.b=_.b,U.opacity=B,U=y[V+1],U.pos.x=v.pos.x+T*I*k- -z*I*F,U.pos.y=v.pos.y+T*I*F+-z*I*k,U.uv.x=R.x+R.w,U.uv.y=R.y,U.color.r=_.r,U.color.g=_.g,U.color.b=_.b,U.opacity=B,U=y[V+2],U.pos.x=v.pos.x+T*I*k-z*I*F,U.pos.y=v.pos.y+T*I*F+z*I*k,U.uv.x=R.x+R.w,U.uv.y=R.y+R.h,U.color.r=_.r,U.color.g=_.g,U.color.b=_.b,U.opacity=B,U=y[V+3],U.pos.x=v.pos.x+-T*I*k-z*I*F,U.pos.y=v.pos.y+-T*I*F+z*I*k,U.uv.x=R.x,U.uv.y=R.y+R.h,U.color.r=_.r,U.color.g=_.g,U.color.b=_.b,U.opacity=B}An(y,g,this.fixed,e.texture,this.shader,this.uniform)}},onEnd(A){return E.add(A)},inspect(){return`count: ${b}/${e.max}`}}}function cC(e,t={}){if(e.length<3)throw new Error(`Polygon's need more than two points, ${e.length} points provided`);return{id:"polygon",pts:e,colors:t.colors,uv:t.uv,tex:t.tex,radius:t.radius,draw(){hn(Object.assign(Kn(this),{pts:this.pts,colors:this.colors,uv:this.uv,tex:this.tex,radius:this.radius,fill:t.fill,triangulate:t.triangulate}))},renderArea(){return new Ye(this.pts)},inspect(){return`polygon: ${this.pts.map(n=>`[${n.x},${n.y}]`).join(",")}`}}}function $p(e,t,n){let r;return C.game.root.get("area").forEach(o=>{if(n&&n.some(i=>o.is(i)))return;let s=o.worldArea().raycast(e,t);s&&(r?s.fraction<r.fraction&&(r=s,r.object=o):(r=s,r.object=o))}),r}function Gp(e,t,n={}){return{id:"rect",width:e,height:t,radius:n.radius||0,draw(){ht(Object.assign(Kn(this),{width:this.width,height:this.height,radius:this.radius,fill:n.fill}))},renderArea(){return new Ee($(0),this.width,this.height)},inspect(){return`rect: (${Math.ceil(this.width)}w, ${Math.ceil(this.height)}h)`}}}function uC(e,t){return{id:"shader",shader:e,...typeof t=="function"?{uniform:t(),update(){this.uniform=t()}}:{uniform:t},inspect(){return`shader: ${e}`}}}function dC(e,t){if(!t.tileWidth||!t.tileHeight)throw new Error("Must provide tileWidth and tileHeight.");let n=C.game.root.add([Xs(t.pos??$(0))]),r=e.length,o=0,s=null,i=null,a=null,l=null,c=A=>A.x+A.y*o,d=A=>$(Math.floor(A%o),Math.floor(A/o)),f=()=>{s=[];for(let A of n.children)u(A)},u=A=>{let v=c(A.tilePos);s[v]?s[v].push(A):s[v]=[A]},h=A=>{let v=c(A.tilePos);if(s[v]){let M=s[v].indexOf(A);M>=0&&s[v].splice(M,1)}},p=()=>{let A=!1;for(let v of n.children){let M=n.pos2Tile(v.pos);(v.tilePos.x!=M.x||v.tilePos.y!=M.y)&&(A=!0,h(v),v.tilePos.x=M.x,v.tilePos.y=M.y,u(v))}A&&n.trigger("spatialMapChanged")},m=()=>{let A=n.getSpatialMap(),v=n.numRows()*n.numColumns();i?i.length=v:i=new Array(v),i.fill(1,0,v);for(let M=0;M<A.length;M++){let N=A[M];if(N){let _=0;for(let D of N)if(D.isObstacle){_=1/0;break}else _+=D.cost;i[M]=_||1}}},g=()=>{let A=n.getSpatialMap(),v=n.numRows()*n.numColumns();a?a.length=v:a=new Array(v),a.fill(15,0,v);for(let M=0;M<A.length;M++){let N=A[M];if(N){let _=N.length,D=15;for(let B=0;B<_;B++)D|=N[B].edgeMask;a[M]=D}}},y=()=>{let A=n.numRows()*n.numColumns(),v=(N,_)=>{let D=[];for(D.push(N);D.length>0;){let B=D.pop();E(B).forEach(j=>{l[j]<0&&(l[j]=_,D.push(j))})}};l?l.length=A:l=new Array(A),l.fill(-1,0,A);let M=0;for(let N=0;N<i.length;N++){if(l[N]>=0){M++;continue}v(N,M),M++}},b=(A,v)=>i[v],w=(A,v)=>{let M=d(A),N=d(v);return M.dist(N)},E=(A,v)=>{let M=[],N=Math.floor(A%o),_=N>0&&a[A]&1&&i[A-1]!==1/0,D=A>=o&&a[A]&2&&i[A-o]!==1/0,B=N<o-1&&a[A]&4&&i[A+1]!==1/0,j=A<o*r-o-1&&a[A]&8&&i[A+o]!==1/0;return v?(_&&(D&&M.push(A-o-1),M.push(A-1),j&&M.push(A+o-1)),D&&M.push(A-o),B&&(D&&M.push(A-o+1),M.push(A+1),j&&M.push(A+o+1)),j&&M.push(A+o)):(_&&M.push(A-1),D&&M.push(A-o),B&&M.push(A+1),j&&M.push(A+o)),M},P={id:"level",tileWidth(){return t.tileWidth},tileHeight(){return t.tileHeight},spawn(A,...v){let M=$(...v),N=(()=>{if(typeof A=="string"){if(t.tiles[A]){if(typeof t.tiles[A]!="function")throw new Error("Level symbol def must be a function returning a component list");return t.tiles[A](M)}else if(t.wildcardTile)return t.wildcardTile(A,M)}else{if(Array.isArray(A))return A;throw new Error("Expected a symbol or a component list")}})();if(!N)return null;let _=!1,D=!1;for(let j of N)j.id==="tile"&&(D=!0),j.id==="pos"&&(_=!0);_||N.push(Xs(this.tile2Pos(M))),D||N.push(ug());let B=n.add(N);return _&&(B.tilePosOffset=B.pos.clone()),B.tilePos=M,B.transform=lo(B),s&&(u(B),this.trigger("spatialMapChanged"),this.trigger("navigationMapInvalid")),B},numColumns(){return o},numRows(){return r},levelWidth(){return o*this.tileWidth()},levelHeight(){return r*this.tileHeight()},tile2Pos(...A){return $(...A).scale(this.tileWidth(),this.tileHeight())},pos2Tile(...A){let v=$(...A);return $(Math.floor(v.x/this.tileWidth()),Math.floor(v.y/this.tileHeight()))},getSpatialMap(){return s||f(),s},removeFromSpatialMap:h,insertIntoSpatialMap:u,onSpatialMapChanged(A){return this.on("spatialMapChanged",A)},onNavigationMapInvalid(A){return this.on("navigationMapInvalid",A)},getAt(A){s||f();let v=c(A);return s[v]||[]},raycast(A,v){let M=this.toWorld(A),N=this.toWorld(A.add(v)).sub(M),_=1/this.tileWidth(),D=A.scale(_),B=$E(D,v,j=>{let R=this.getAt(j);if(R.some(I=>I.isObstacle))return!0;let O=null;for(let I of R)if(I.has("area")){let k=I.worldArea().raycast(M,N);k&&(O?k.fraction<O.fraction&&(O=k,O.object=I):(O=k,O.object=I))}return O&&(O.point=this.fromWorld(O.point).scale(_)),O||!1},64);return B&&(B.point=B.point.scale(this.tileWidth())),B},update(){s&&p()},invalidateNavigationMap(){i=null,a=null,l=null},onNavigationMapChanged(A){return this.on("navigationMapChanged",A)},getTilePath(A,v,M={}){var k;if(i||m(),a||g(),l||y(),A.x<0||A.x>=o||A.y<0||A.y>=r||v.x<0||v.x>=o||v.y<0||v.y>=r)return null;let N=c(A),_=c(v);if(i[_]===1/0)return null;if(N===_)return[];if(l[N]!=-1&&l[N]!==l[_])return null;let D=new Ep((F,T)=>F.cost<T.cost);D.insert({cost:0,node:N});let B=new Map;B.set(N,N);let j=new Map;for(j.set(N,0);D.length!==0;){let F=(k=D.remove())==null?void 0:k.node;if(F===_)break;let T=E(F,M.allowDiagonals);for(let z of T){let V=(j.get(F)||0)+b(F,z)+w(z,_);(!j.has(z)||V<j.get(z))&&(j.set(z,V),D.insert({cost:V,node:z}),B.set(z,F))}}let R=[],O=_,I=d(O);for(R.push(I);O!==N;){let F=B.get(O);if(F===void 0)throw new Error("Bug in pathfinding algorithm");O=F;let T=d(O);R.push(T)}return R.reverse()},getPath(A,v,M={}){let N=this.tileWidth(),_=this.tileHeight(),D=this.getTilePath(this.pos2Tile(A),this.pos2Tile(v),M);return D?[A,...D.slice(1,-1).map(B=>B.scale(N,_).add(N/2,_/2)),v]:null}};return n.use(P),n.onNavigationMapInvalid(()=>{n.invalidateNavigationMap(),n.trigger("navigationMapChanged")}),e.forEach((A,v)=>{let M=A.split("");o=Math.max(M.length,o),M.forEach((N,_)=>{n.spawn(N,$(_,v))})}),n}function at(e,t,n){return C.game.objEvents.registers[e]||(C.game.objEvents.registers[e]=new bp),C.game.objEvents.on(e,(r,...o)=>{r.is(t)&&n(r,...o)})}var fC=(e,t,...n)=>{for(let r of C.game.root.children)r.is(t)&&r.trigger(e,n)},hC=Me(e=>{let t=C.game.root.add([{fixedUpdate:e}]);return{get paused(){return t.paused},set paused(n){t.paused=n},cancel:()=>t.destroy()}},(e,t)=>at("fixedUpdate",e,t)),Kp=Me(e=>{let t=C.game.root.add([{update:e}]);return{get paused(){return t.paused},set paused(n){t.paused=n},cancel:()=>t.destroy()}},(e,t)=>at("update",e,t)),pC=Me(e=>{let t=C.game.root.add([{draw:e}]);return{get paused(){return t.hidden},set paused(n){t.hidden=n},cancel:()=>t.destroy()}},(e,t)=>at("draw",e,t)),Wp=Me(e=>C.game.events.on("add",e),(e,t)=>at("add",e,t)),gC=Me(e=>C.game.events.on("destroy",e),(e,t)=>at("destroy",e,t)),mC=Me(e=>C.game.events.on("use",e),(e,t)=>at("use",e,t)),yC=Me(e=>C.game.events.on("unuse",e),(e,t)=>at("unuse",e,t)),Yp=Me(e=>C.game.events.on("tag",e),(e,t)=>at("tag",e,t)),wC=Me(e=>C.game.events.on("untag",e),(e,t)=>at("untag",e,t));function xC(e,t,n){return at("collide",e,(r,o,s)=>o.is(t)&&n(r,o,s))}function vC(e,t,n){return at("collideUpdate",e,(r,o,s)=>o.is(t)&&n(r,o,s))}function bC(e,t,n){return at("collideEnd",e,(r,o,s)=>o.is(t)&&n(r,o,s))}function Ii(e,t){C.game.root.get(e,{recursive:!0}).forEach(t),Wp(e,t),Yp((n,r)=>{r===e&&t(n)})}var AC=Me(e=>C.app.onMousePress(e),(e,t)=>{let n=[];return Ii(e,r=>{if(!r.area)throw new Error("onClick() requires the object to have area() component");n.push(r.onClick(()=>t(r)))}),Zn.join(n)});function EC(e,t){let n=[];return Ii(e,r=>{if(!r.area)throw new Error("onHover() requires the object to have area() component");n.push(r.onHover(()=>t(r)))}),Zn.join(n)}function SC(e,t){let n=[];return Ii(e,r=>{if(!r.area)throw new Error("onHoverUpdate() requires the object to have area() component");n.push(r.onHoverUpdate(()=>t(r)))}),Zn.join(n)}function MC(e,t){let n=[];return Ii(e,r=>{if(!r.area)throw new Error("onHoverEnd() requires the object to have area() component");n.push(r.onHoverEnd(()=>t(r)))}),Zn.join(n)}function CC(e){C.game.events.on("loading",e)}function RC(e){C.app.onResize(e)}function PC(e){C.game.events.on("error",e)}function nc(e){C.assets.loaded?e():C.game.events.on("load",e)}function IC(e){if(C.assets.loaded)Ip().forEach(t=>e(...t));else return C.game.events.on("loadError",e)}function Xp(...e){C.game.cam.pos=$(...e)}function Qp(){return C.game.cam.pos?C.game.cam.pos.clone():Ks()}function Zp(...e){C.game.cam.scale=$(...e)}function Jp(){return C.game.cam.scale.clone()}function eg(e){C.game.cam.angle=e}function tg(){return C.game.cam.angle}function NC(){return C.game.cam.transform.clone()}function ng(e=we(255,255,255),t=1){let n=C.game.root.add([Gp(He(),Ue()),Vp(e),Up(1),hg()]),r=n.fadeOut(t);return r.onEnd(()=>cg(n)),r}function TC(){return C.game.cam.transform.clone()}function _C(e=12){C.game.cam.shake+=e}function ol(e){return C.game.cam.transform.multVec2(e)}function rg(e){return C.game.cam.transform.invert().multVec2(e)}function kC(...e){return Or("camPos","setCamPos / getCamPos"),e.length>0&&Xp(...e),Qp()}function DC(...e){return Or("camScale","setCamScale / getCamScale"),e.length>0&&Zp(...e),Jp()}function OC(e){return Or("camRot","setCamRot / getCamRot"),e!==void 0&&eg(e),tg()}function LC(e=we(255,255,255),t=1){return Or("camFlash","flash"),ng(e,t)}function rc(e=[]){let t=new Map,n=[],r={},o=new Mo,s=[],i=new Set("*"),a=C.globalOpt.tagsAsComponents,l=null,c=!1,d={id:GS(),hidden:!1,transform:new Ft,children:[],parent:null,set paused(u){if(u!==c){c=u;for(let h of s)h.paused=u}},get paused(){return c},get tags(){return Array.from(i)},add(u){let h=Array.isArray(u)?rc(u):u;if(h.parent)throw new Error("Cannot add a game obj that already has a parent.");return h.parent=this,h.transform=lo(h),this.children.push(h),h.trigger("add",h),C.game.events.trigger("add",h),h},readd(u){let h=this.children.indexOf(u);return h!==-1&&(this.children.splice(h,1),this.children.push(u)),u},remove(u){let h=this.children.indexOf(u);if(h!==-1){u.parent=null,this.children.splice(h,1);let p=m=>{m.trigger("destroy"),C.game.events.trigger("destroy",m),m.children.forEach(g=>p(g))};p(u)}},removeAll(u){if(u)this.get(u).forEach(h=>this.remove(h));else for(let h of[...this.children])this.remove(h)},fixedUpdate(){this.paused||(this.children.forEach(u=>u.fixedUpdate()),this.trigger("fixedUpdate"))},update(){this.paused||(this.children.forEach(u=>u.update()),this.trigger("update"))},draw(){if(this.hidden)return;this.canvas&&(ft(),this.canvas.bind());let u=C.gfx.fixed;this.fixed&&(C.gfx.fixed=!0),dt(),Te(this.pos),Ro(this.scale),Tr(this.angle);let h=this.children.sort((p,m)=>{let g=p.layerIndex??C.game.defaultLayerIndex,y=m.layerIndex??C.game.defaultLayerIndex;return g-y||(p.z??0)-(m.z??0)});if(this.mask){let p={intersect:C.k.drawMasked,subtract:C.k.drawSubtracted}[this.mask];if(!p)throw new Error(`Invalid mask func: "${this.mask}"`);p(()=>{h.forEach(m=>m.draw())},()=>{this.trigger("draw")})}else this.trigger("draw"),h.forEach(p=>p.draw());tt(),C.gfx.fixed=u,this.canvas&&(ft(),this.canvas.unbind())},drawInspect(){this.hidden||(dt(),Te(this.pos),Ro(this.scale),Tr(this.angle),this.children.forEach(u=>u.drawInspect()),this.trigger("drawInspect"),tt())},use(u){var m;if(typeof u=="string")return i.add(u);if(!u||typeof u!="object")throw new Error(`You can only pass a component or a string to .use(), you passed a "${typeof u}"`);let h=[];u.id?(this.unuse(u.id),r[u.id]=[],h=r[u.id],t.set(u.id,u),a&&i.add(u.id)):n.push(u);for(let g in u){if(AS.has(g))continue;let y=Object.getOwnPropertyDescriptor(u,g);if(y)if(typeof y.value=="function"&&(u[g]=u[g].bind(this)),y.set&&Object.defineProperty(u,g,{set:y.set.bind(this)}),y.get&&Object.defineProperty(u,g,{get:y.get.bind(this)}),ES.has(g)){let b=g==="add"?()=>{var w;l=E=>h.push(E),(w=u[g])==null||w.call(u),l=null}:u[g];h.push(this.on(g,b).cancel)}else if(this[g]===void 0)Object.defineProperty(this,g,{get:()=>u[g],set:b=>u[g]=b,configurable:!0,enumerable:!0}),h.push(()=>delete this[g]);else{let b=(m=t.values().find(w=>w[g]!==void 0))==null?void 0:m.id;throw new Error(`Duplicate component property: "${g}" while adding component "${u.id}"`+(b?` (originally added by "${b}")`:""))}}let p=()=>{if(u.require){for(let g of u.require)if(!this.c(g))throw new Error(`Component "${u.id}" requires component "${g}"`)}};u.destroy&&h.push(u.destroy.bind(this)),this.exists()?(p(),u.add&&(l=g=>h.push(g),u.add.call(this),l=null),u.id&&(this.trigger("use",u.id),C.game.events.trigger("use",this,u.id))):u.require&&h.push(this.on("add",p).cancel)},unuse(u){if(t.has(u)){for(let h of t.values())if(h.require&&h.require.includes(u))throw new Error(`Can't unuse. Component "${h.id}" requires component "${u}"`);t.delete(u),this.trigger("unuse",u),C.game.events.trigger("unuse",this,u)}else a&&i.has(u)&&i.delete(u);r[u]&&(r[u].forEach(h=>h()),delete r[u])},c(u){return t.get(u)??null},get(u,h={}){let p=(g,y)=>h.only==="comps"?g.has(y):h.only==="tags"?g.is(y):g.is(y)||g.has(y),m=h.recursive?this.children.flatMap(function g(y){return[y,...y.children.flatMap(g)]}):this.children;if(m=m.filter(g=>u?p(g,u):!0),h.liveUpdate){let g=b=>h.recursive?this.isAncestorOf(b):b.parent===this,y=[];y.push(C.k.onAdd(b=>{g(b)&&p(b,u)&&m.push(b)})),y.push(C.k.onDestroy(b=>{if(g(b)&&p(b,u)){let w=m.findIndex(E=>E.id===b.id);w!==-1&&m.splice(w,1)}})),this.onDestroy(()=>{for(let b of y)b.cancel()})}return m},query(u){let h=u.hierarchy||"children",p=u.include,m=u.exclude,g=[];switch(h){case"children":g=this.children;break;case"siblings":g=this.parent?this.parent.children.filter(b=>b!==this):[];break;case"ancestors":let y=this.parent;for(;y;)g.push(y),y=y.parent;break;case"descendants":g=this.children.flatMap(function b(w){return[w,...w.children.flatMap(b)]});break}if(p&&((u.includeOp||"and")==="and"||!Array.isArray(u.include)?g=g.filter(y=>y.is(p)):g=g.filter(y=>u.include.some(b=>y.is(b)))),m&&((u.includeOp||"and")==="and"||!Array.isArray(u.include)?g=g.filter(y=>!y.is(m)):g=g.filter(y=>!u.exclude.some(b=>y.is(b)))),u.visible===!0&&(g=g.filter(y=>y.visible)),u.distance){if(!this.pos)throw Error("Can't do a distance query from an object without pos");let y=u.distanceOp||"near",b=u.distance*u.distance;y==="near"?g=g.filter(w=>w.pos&&this.pos.sdist(w.pos)<=b):g=g.filter(w=>w.pos&&this.pos.sdist(w.pos)>b)}return u.name&&(g=g.filter(y=>y.name===u.name)),g},isAncestorOf(u){return u.parent?u.parent===this||this.isAncestorOf(u.parent):!1},exists(){return C.game.root.isAncestorOf(this)},is(u,h="and"){return Array.isArray(u)?h==="and"?u.every(p=>i.has(p)):u.some(p=>i.has(p)):i.has(u)},tag(u){if(Array.isArray(u))for(let h of u)i.add(h),this.trigger("tag",h),C.game.events.trigger("tag",this,h);else i.add(u),this.trigger("tag",u),C.game.events.trigger("tag",this,u)},untag(u){if(Array.isArray(u))for(let h of u)i.delete(h),this.trigger("untag",h),C.game.events.trigger("untag",this,h);else i.delete(u),this.trigger("untag",u),C.game.events.trigger("untag",this,u)},has(u,h="and"){return Array.isArray(u)?h==="and"?u.every(p=>t.has(p)):u.some(p=>t.has(p)):t.has(u)},on(u,h){let p=o.on(u,h.bind(this));return l&&l(()=>p.cancel()),p},trigger(u,...h){o.trigger(u,...h),C.game.objEvents.trigger(u,this,...h)},destroy(){this.parent&&this.parent.remove(this)},inspect(){var h;let u={};for(let[p,m]of t)u[p]=((h=m.inspect)==null?void 0:h.call(m))??null;for(let[p,m]of n.entries()){if(m.inspect){u[p]=m.inspect();continue}for(let[g,y]of Object.entries(m))typeof y!="function"&&(u[g]=`${g}: ${y}`)}return u},onAdd(u){return this.on("add",u)},onFixedUpdate(u){return this.on("fixedUpdate",u)},onUpdate(u){return this.on("update",u)},onDraw(u){return this.on("draw",u)},onDestroy(u){return this.on("destroy",u)},onUse(u){return this.on("use",u)},onUnuse(u){return this.on("unuse",u)},clearEvents(){o.clear()}},f=["onKeyPress","onKeyPressRepeat","onKeyDown","onKeyRelease","onMousePress","onMouseDown","onMouseRelease","onMouseMove","onCharInput","onMouseMove","onTouchStart","onTouchMove","onTouchEnd","onScroll","onGamepadButtonPress","onGamepadButtonDown","onGamepadButtonRelease","onGamepadStick","onButtonPress","onButtonDown","onButtonRelease"];for(let u of f)d[u]=(...h)=>{var m,g;let p=(g=(m=C.app)[u])==null?void 0:g.call(m,...h);return s.push(p),d.onDestroy(()=>p.cancel()),d.on("sceneEnter",()=>{var b,w;s.splice(s.indexOf(p),1);let y=(w=(b=C.app)[u])==null?void 0:w.call(b,...h);Zn.replace(p,y),s.push(p)}),p};for(let u of e)d.use(u);return d}var BC=()=>({events:new Mo,objEvents:new Mo,root:rc([]),gravity:null,scenes:{},currentScene:null,layers:null,defaultLayerIndex:0,logs:[],cam:{pos:null,scale:new X(1),angle:0,shake:0,transform:new Ft}});function FC(e){C.game.gravity=e?(C.game.gravity||$(0,1)).unit().scale(e):null}function jC(){return C.game.gravity?C.game.gravity.len():0}function qC(e){C.game.gravity=e.unit().scale(C.game.gravity?C.game.gravity.len():1)}function uo(){return C.game.gravity?C.game.gravity.unit():$(0,1)}var zC=AE("//uUBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAATAAAeAAANDQ0NDRoaGhoaKCgoKCg1NTU1NTVDQ0NDQ1BQUFBQXl5eXl5ra2tra2t5eXl5eYaGhoaGlJSUlJShoaGhoaGvr6+vr7y8vLy8ysrKysrX19fX19fl5eXl5fLy8vLy//////8AAAA5TEFNRTMuMTAwAaoAAAAAAAAAABSAJAOPhgAAgAAAHgBaqIlmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uUBAAP8h1kPIABR4BEDGeQAEbkSb2RAACBFMEyMiAAASJw4xjgwAGyRvfIoZT2QKGV5YNw/tKID9+X93qXtBQUFBQ/e+EFKTQUT/dy3f5dK/3d04rkXHpufCClDAaH7jDMgFAQEGfPt+jI352U9vU4GLRpzkUDeeeTQggQe2ggF3d7/3j697DnhCH5iGf38//iNj9oy2Jk71oj+CBAABGNB4RJNMwgCABCB//8//l////1z6XEGd73az07sOkwZD9VYgjzjmQ6j4EMfZM86OJ7GUWwvFw3ZPcdVEtczf9RNf6xMyxLjZZgjMQ7KDkLSU8g2E12UDUWrf//////9LdtFdeeqKwSitW9SJL59VM5pyUGiBNiK0jIGO0j7p3pUpWpaeqi1nTvqP3b43mGmM6HeXFjIlRwiFiIDQRRAGgkDQhxMMv//+f1//6XM/PfMvysJa3993MjDjhaRkrV3cRPXjGptDDGTHtFKUeMHU0K5STvVfMtVX/UXHctt1Z1//uUBB0AgnZkQAAgRTBMzIgAACiqCdB9E1QRgAFuIuGmhjABPZRJRCHi4etY2gcEYRwFw5KFBMMRV/////z6kX2ppnJszEzKbkZKEumm+pBRUDBg9IsgXGXrazn1QhmGjBrLVjT5Xvir0HT7d//HSZh18IZdji2N5JZgbA3DwQAahogSDqUhQuNtpJmBTwAGMY2QP3c/dy4EKsAABoXEJEFmlf/c4TgYtwcAbwfD4gOOoS1QIH7jDnNzYVe1x4mNFyD2jMVaaykjV29ePMARwXcUOgAFr+UjhVz4jhwMDFxPKgYs3cDFpohVgAAYAIO7u8eAAjRNA7hBFAwN3ACDvu7nETkLMrnyIj8v/9fNwhF9vKRfm82P5zPPmLV/WKs9G3d16n/v3rubEN0zgs7RdWrHne9brdv5bI4EwEAM6lj7aVdTKtXQHgLdzCKQ2kcihe4FyMcD1r3nR4TWxuax5EOZJEs3DEQnjyqyB8cSfrI6GEcoJxiHBDEfrTOFYrO1//uUBCgAA406ym5hgAB1R1ktzDwACxDBZzj0gAFhGrA3HoACypAXH9HY4umZan4ZlZKldajczMzMzOTnzMvnb77f/1IuSzHIbnJLJdapWmwUAQBXqWPtqV1OyqVqXhB9abR90OyKEsM51pIJK/nXplbDPtKz2dH+oVWeZSm8z7nvAZ19bneqhk3qeBhrhZiLbCc8sRnXb520RnPFd61/AgSR4f8CVlfWpD/////+N6/jv8v4f/6Ln///06c8YYcQIaGmAJ9VhMHEZYc9Kn0TOOYKv2cibDoZieAaGy4Cd6AfGkxQQr+agomAw+dC7AkjOxklIZEpUgmHxXP7/znl/4qT9Z/8+T2a0WF9/lvpv39if/KZnV6Gp1vQRmN1rYDAADfLGQxVR2d49LQLXdImm5n40smwjQ4aIYKMeKCOEw0OBV5cHA8cFV8mB5LyIIeksHspy79/iTv9SH+v66f2Wn/i+Lt//x9y//5MohgAAXiTCVBil4RUZ7XUvPRCD9Uc//uUBAoAAro3Wzc9AABXRutm56AACrUhc6eYT0FWpC508wnoO35hs9j6x7PQOB0PF0JWIkYwigNPoXUBA0cKA6JwDB7lRKDm/93r/mb6iEqL5lv3Vq//6YgYd1AgECi4xACCYbHyukYAAF4kwlQYpeEVGe11Lz0Qg/VHDt+YbPY+sez0DgdDxdCViJGMIoDT6F1AQNHCgOicAwe5USg5v/d6/5m+ohKi+Zb91av/+mIGHdQIBAouMQAgmGx8rptmoLKSACTuBBUPFsH6RlCz+UhoKeVfJy/eqOspBG4PScFOnOxYJJcf/nVzmyfR42Zwxy//hfSUrPq1SzFnO7q/SzNUzst+GQpnZ/kLwzVZ9xJ2lVa02zUFlJABJ3AgqHi2D9IyhZ/KQ0FPKvk5fvVHWUgjcHpOCnTnYsEkuP/zq5zZPo8bM4Y5f/wvpKVn1apZiznd1fpZmqZ2W/DIUzs/yF4Zqs+4k7SqtaYkWgEGMgppYQlMVdKcos2bWFZbFIJp//uUBAsAAr0wWe1hAABXpgs9rCAACwS5azj0gAFgly1nHpAAVgWmZa3LaUWCcGh5HgOEYkViyQUjrX+G5FUr5Dla1ZhtXDf7ckpazXwzeusqq+zXwUePSw8NYzlZKWfbyzod4dCRItAIMZBTSwhKYq6U5RZs2sKy2KQTSrAtMy1uW0osE4NDyPAcIxIrFkgpHWv8NyKpXyHK1qzDauG/25JS1mvhm9dZVV9mvgo8elh4axnKyUs+3lnQ7w6EkIEIIZFKlBSAGwRMrEIEuM658s5gvyVtFDrQtgTY2YSPlAJcgwlXLmokM8sUQJYJOm3eaW04jWVsoghX+ZBt3SHFZOypVez//VONpL+du6U+4WLXBC79cuhAhBDIpUoKQA2CJlYhAlxnXPlnMF+StoodaFsCbGzCR8oBLkGEq5c1EhnliiBLBJ027zS2nEaytlEEK/zINu6Q4rJ2VKr2f/6pxtJfzt3Sn3Cxa4IXfrl6IGEh4icUSUDRZk/k88VFEmCy//uUBAkAAociWgZh4ABQ5EtAzDwAC6zBXBmXgAF1mCuDMvAART7WmhWQ9QwYJexoKJ+z1bcQqfEFmtDtXH8lUg2omFi2b/4+UhW/j+bHgwAM8SqMAQFxYj9wqAwhlftf//sSQMJDxE4okoGizJ/J54qKJMFkin2tNCsh6hgwS9jQUT9nq24hU+ILNaHauP5KpBtRMLFs3/x8pCt/H82PBgAZ4lUYAgLixH7hUBhDK/a///YmHznKbibgJd0lEi0TfuHXCfhZ0faHA6GL3GuUpLTgTwnd/upcFAbo+BGMfzKxWE9PNg+sbrEwwRLn6uFElWTc/zN8Yvf5V3xV29///8OO/f7j3cT0mgMTPP9uPEwIQ+c5TcTcBLukokWib9w64T8LOj7Q4HQxe41ylJacCeE7v91LgoDdHwIxj+ZWKwnp5sH1jdYmGCJc/Vwokqybn+ZvjF7/Ku+Ku3v///hx37/ce7iek0BiZ5/tx4mBCmI5QXQAgigG+j0P8fdg2Xjs//uUBAiAAqwlWwY94ABVhKtgx7wACoilZ7z0AAFUlOz3noAAii2PkO1AMBYBIssJqQ5PtEdSQ2WE3xIF22b19axY89F5QQmWCwxJrf51h5mt74jRvBahCxQkS0MgJxY15ITjX3sb+vlGI5QXQAgigG+j0P8fdg2Xjsii2PkO1AMBYBIssJqQ5PtEdSQ2WE3xIF22b19axY89F5QQmWCwxJrf51h5mt74jRvBahCxQkS0MgJxY15ITjX3sb+vlEBsAgCSkHfwmFY/MMKQyg4tjhHeuR2mpSZWstSwEQAw00wZaogwgZL3PPVWw9vuB51zUXf3Df/ytV917DjxQEGA+0mbu4YYg4TnkRcMGQsxH/Ioc1AbAIAkpB38JhWPzDCkMoOLY4R3rkdpqUmVrLUsBEAMNNMGWqIMIGS9zz1VsPb7gedc1F39w3/8rVfdew48UQIFwus29HKDIAW8tcsSGAOKXK/jHmF1AkIAAC8ZUaEFwTHUylbannoarv7HwxH8//uUBAwEAtAx18sMQuBVJisaYSJeCmhnX6eZLQFZJy208wmidE7zXIRk0ZLYCqc1eg1sKc3HZuweFNeSCHHGg+JyhTcd8RE3/+rJXIdH6UpI2qUdVtHGRCOewEOXGUfKG2/v+RIoA0MAAAByh2gABL0EpLTwNTz0qzjM2ER8SF2lsSRLESGiqG5JXMCauo+aTB1GQKTyJd6SDnG6Iv8rkaoYeRihQbVGzJSSQ4sOghQh7vhkf+T0agMeCYAcAABBO40gsg/gOpfIiHoQgldEIGLVK9EaTFmFH9jkkvLA41VT/4q0XDJLUopJkJmWHAqZyRAPJOvBUS+NYSLC4FFjoJkUfGP/La3XNJCMJPep5CkIaRQCSTuM4ikUepPHAnZLEErtHuqs1EWDizBAvsdVeWBxqqn9aiS9FK24Z0KUhvVkY7ZbylKV/SrKiK0yrKqFkPe3/sZ//8xt6t2dajIDpFMRf6tSU9FIlJJKChTJIgq2hhZlrTlNcpaB/Xv5rDOU//uUBA2AAoQl1lVgwARQxLrKrBgAjCyVTrmngAGFkqnXNPAAg4ANdH9PKxIijn/xmvyjW2ZISnLe5yUtyv2ufSTfVJUGyoFiU6s6Crgyd2PEyn5Ul/85kUElPRSJSSSgoUySIKtoYWZa05TXKWgf17+awzlIOADXR/TxLEiKOf/GZ/KNbZkhKct7nJS3K/a59JN9UlQbKgWJTqzoKuDJ3Y8TKflSX/zmRQSCs10kCQCFAcBJCZCbl2c0bF5RBELfoQBmp3G2m3m3lgZoN0/BmhutukeGPbe/GtGj9jtiXNZdfDjIwYiYvnePS27ebO75y/Edksl4SONB/PlBrg6dNh8h+pW2//lktFhYcFZrpIEgEKA4CSEyE3Ls5o2LyiCIW/QgDNTuNtNvNvLAzQbp+DNDdbdI8Me29+NaNH7HbEuay6+HGRgxExfO8elt282d3zl+I7JZLwkcaD+fKDXB06bD5D9Stt//LJaLCw4AhAEAACKEywIJz0PRwTBn6tS2//uUBAmAAmUjVNdhAABMpGqa7CAACWiNUay8pYEtEao1l5SwsvqET9LUv/TIpAROYdsSHIoHxzccjRUPRZmVQnHLH7FYdB9rF8Q11yOCAKeHZHyIhMO///lWz0JPcAQgCAABFCZYEE56Ho4Jgz9WpbWX1CJ+lqX/pkUgInMO2JDkUD45uORoqHoszKoTjlj9isOg+1i+Ia65HBAFPDsj5EQmHf//yrZ6EnuACgcjEAKT2Dfl0wUuCCDwOHgDLjMYs6OLViO840e/fHfBZmadNu+NYYNVT84fPkYRCJ/K5V3vsq0Gh0H0YgBP+moubbodw+IHr/kgAoHIxACk9g35dMFLggg8Dh4Ay4zGLOji1YjvONHv3x3wWZmnTbvjWGDVU/OHz5GEQifyuVd77KtBodB9GIAT/pqLm26HcPiB6/5KAE6OeESRRgDMViF4jCI2bT5fbThs6iKGQfPTVaYtXdjMROEbiIqKlZk1KJAzpcWEnNs6FapfKXq1jerLEhaS//uUBB+BAmUqVWsMKrhMpUqtYYVXCTSlTzWSgAE0lKp2sFAAqcgRPyRHxKsBPAQVtIgCdHPCJIowBmKxC8RhEbNp8vtpw2dRFDIPnpqtMWruxmInCNxEVFSsyalEgZ0uLCTm2dCtUvlL1axvVliQtJVOQIn5Ij4lWAngIK2kQCHQhVnhkMD1BlLGveBt13z8bjbsI+MtfqdjdaAQiJFeBGV0AQFB2Qr8QDBc8iiATM25R8+fqp/Izn9CHGC7CEg5BTqd6jM4IBoADCiIYSTWAeAwKIoGBRr+EfZ3bjcbhhdDLX6nY3WgEIiRXgRloICoOyFfiA4+RRAJmbco+fP1U/kZz+hDjBdhCQcgp1O9QZnAQAbiCQAm485bonLdZ5NLqAAAEaPfiGAJsDpfUrAhC8wIZFkkEsiX6UBGvscp3FQfN5VNjWCnQ6AGqvk/UqZBbG3rpCt0gR7qtiNBxOfSeTupa6fMjXaMuYTclIn9ZIVayP2pYMiVUajtVYufukCu//uUBDWABAw9Uu5p4AKDx9qdzLwAiiyjShmngAFFlGlDNPAAm9bW7Vct6q61jNa/e6f/0cL33T31CoACacjUkabckdbjkoAAQ2Pe5fJoCshU+EXmCMRGkCbpN6UCNfKFHfcVB8kSOgSgDsuTAAtXyfqVMgtjb10hW6QI91XCQyZP85jl1K90+ZGuz5Ewl0gGT+skKsGAr0weA/JVRqO1Vi5+6QK6b1tbtFct6q61jNa+26fG/RwvfdPeIpm6BswQctcoCeIAYEYf1mWXRGbxQSwlUiCoY91ytUSo4mqDAgHrhQ3Y/4l2ptfeDG/xHfQXlda18S59aW+rZz8/Gtf7vXU0aFeJUKxkREA+tA5tnJGCDlrlATxADAjD+syy6IzeKCWEqkQVDHuuVqiVHE1QYEA9cKG7H/Eu1Nr7wY3+I76C8rrWviXPrS31bOfn41r/d66mjQrxKhWMiIgH1oHNs5Iw4nNwugqcGVUIoOnFryq5YBVMFyLPEAM4rxNXgSVW//uUBA+AAtkszwZtgABapZngzbAACxyZTzmkgAljkynnNJABzA8PYTFvx2VIR78NqPytscLolrRXGbLUv3rfHNp37BGU77n4xv9NNmu7larWfrk294JgJMNJQ9k6Z//3mHE5uF0FTgyqhFB04teVXLAKpguRZ4gBnFeJq8CSq2YHh7CYt+OypCPfhtR+VtjhdEtaK4zZal+9b45tO/YIynfc/GN/pps13crVaz9cm3vBMBJhpKLJ0z//vAA/m9Y8//8wALImAAl3wUQQSnfKuPXkDS5Ql5I8JfOufQG0twDlAxToCFKYarEoVqWFNJ6nNVd9fnX5/O72D/GEfeJf1TBIwjlyh7XHDg+dW/e///9oGG0YAH83rHn//mABZEwAEu+CiCCU75Vx68gaXKEvJHhL51z6A2luAcoGKdAQpTDVYlCtSwppPU5qrvr86/P53ewf4wj7xL+qYJGEcuUPa44cHzq373///tAw2joy5iMKijE5A82dFg4+liKoGBQF//uUBAmAAqobToZt4ABVI2nQzbwAClBrX7j0gBFKDWv3HpACuAcKpXhYKYZtV8OtethxIYxrF3onBiRVg0Z5VNJHjodV8sWdI031RiPzue4vQ9IA5zgUawg6s0J1ixM4H0rkVfR6DLmIwqKMTkDzZ0WDj6WIqgYFAW4BwqleFgphm1Xw6162HEhjGsXeicGJFWDRnlU2I8dDqvlizpGm+qMR+dz3F6HpAHOcCjWEHVmhOsWJnA+lcir6PQCI3I43G43HIxGIwIABFJObxBmwXEYYlhzHKcYl4ccyEKlyI6ONNnSpVx1pORjqKXEvGgpRqN/VI1tIQnEAogesbyZtJhhEj7rQutav+WB4ClRCCI3I43G43HIxGIwIABFJObxBmwXEYYlhzHKcYl4ccyEKlyI6ONNnSpVx1pORjqKXEvGgpRqN/VI1tIQnEAogesbyZtJhhEj7rQutav+WB4ClRDWAElxIBP/fgA5BRsQaBJEcORBgUrqXzDOmyQ7B8Js0//uUBA+AAnIbz+9swABNA3nq7ZgACYxbKSxpgQEzi6UljTAh0ph0igLRRPKosl/+21oMFkUfTMlPbu5vLWMhsIpBoJlEBWacSYwqxs0adkSycpqwAugFfb4AMMU0BUCAJUc6VBAkwaXzDlPhDsnkNmmlMVAKAOiieBJHkv/22tBkzUfXZJ+37zy1jILgmkGjpRAVmnCVjCrGzRozkSydWoAAhAKsACEHAmDZAyOJvjXlQsCbLAhfALBGnDuUyMsKxSWoyN41Ma1yzl81ldaycS4FmOc/HeG0F0EouNMvOJY8wRknQ2MHFgo50O9wABCAVYAEIOBMGyBkcTfGvKhYE2WBC+AWCNOHcpkZYViktRkbxqY1rlnL5rK61k4lwLMc5+Od4vceyz2aZfD2t6Yf1T8VpbBUmvyf/6WSCIaFJmBQHBBPnChjBCJpALOEZzWEOoXAjEVcJwU6QNMnCQemw5lYr1wP4Yrd7Kh813KsJITdZtDZdO/Nb/EeIEOq6mn9//uUBCMMglwayou4eTBKg1lRdw8mCRxbKCzswxEuGGWdow2oj0ziXaKZIIhoUmYFAcEE+cKGMEImkAs4RnNYQ6hcCMRVwnBTpA0ycJB6bDmVivXA/hit3sqHzXcqwkhN1m0Nl0781v8R4gQ3qup/2PTcl2geDKLS0Dlz62OeezARhAXGxQHQWEYYrFAT3TZw4FCwS4JDTF8AkaliQVaJoBk2ZlkiTQ2GgZmiQ1TzBSo+AA7JnYoKkVD1ZLuX4AtuEAwAFeAsHNMiPlXBIxSunQZU2GQTJoCe6bOHAoWCXBIaYvkUWljkvhpGS5mWFUrqaky+ZUivDyLT+PkTH9Nf5Jc8MPCT5LS5agFKBGvwAEGuOYUBgViPhKwULrvceUN2EYE5cfjEPVa76oYHc8iajBh079LyeBx+8xsatjP5+f/v9moz085O0y92c1/TLeIQBc5iarAMAtQBhIDsHMLAswKiDlZBMLgFd7jyhuwXBjO4/GIeq131ERQsohipJqEF//uUBDuAAl4rSc1swABNpWkWriAAT6S1N7msABH4Fqa3NYACK3Y2lxKnyqWlj4I9evjntWStpWltoH3a1c9wPfBQe51tv4QIRW5JWpHY2wmAQCAA3Ez8JQ0wQP/M2RNaIDhCYutAAONBBkAlvb4j4+qi40CU4Bh3bhxXygTVd/7vSq0iY6iSWWXrsXQ29eVJCqUsoXWy7X/vdWvP1JZg/tBEovFId////7rne699onXkM9DUl/+GAZBQDf8JEQCKo//+ogQCRyuRRuRthMAgEABkJp6CMpiBP+aMybcYnwznWkEqoAuaC5GfvF8HZFWg/FXSa8blglIwmKgd/7XpVaYZFGTZZe5DuQPushJSpXIpuwbX/vdWvL6kswcmPQFF4Ef3////LXO917pQHTyGedqP//DAMgoD3/CREAiqP/2eqv////////3dk90KlpVV3eUWVjHLZSMUp5hxnpOcO1WpXVXu4ijKYTSd3IJ7Kzt6Wp7FWiGQUEGFRgdCgpRM//uUBB8P8lRjwIcAoABJLFgQ4BQASJmNAgAFHEkIsiAAAaegRMowxhYVZBMOCoAh7/////////79CTkvIITTqZkZjVGEMPHvEBE7IZXMpGVFYqsKyOYw5jjmOZkFDdkZLkW+9NjEIZxbiYixXO5QkcoRVQoYBgYPlK+XmRGbwXaEFZGvWIpZLWEizxltQ9uELQV7E73d3HESrONG7w3dTdpF6Skf/zNT3I6rIKxJy1oKCtGGjj5FDxcKB+HpYd/3//i3rZFOT0N05+QpgWZYZ3pi5biJNCj4fRQQwYK8p48BQUTWPDTbNjkPn8+1VXKvJ7dJ5Gb2mESWLjnHOYNH07r6//////////icK81KXqTXuvQEteLGdY0DKwrjQVTIMKbgE0b41Egi1KxtuNwUpf9X+bNqTUlXbDClWgIlS4wMVc1F0QZc3/N/yto/7eUShjGUstRgIUZXKUrFYwU5SgKOxgYE+krfVkf6St/VpnMaYwpwoCjoZwoCZwqFC4LH//uUBD+P4jNjPwAjN8I7THfwAEnqR8mAugCAcQkHsheEERr40LUwj//hIzL//9k/9rJZ9lks+yyVDL/////81YHZUMj//yZZLHIy7/5qwMHHIyZZL/sslQyNWt/I1DBQYRxPYaxS/////5kn///6on0VEVP/6on/7OVFVO5QwUGEOzyhgaoqKhQwMGCUjt////8qaLdr/qTiyzLxaJxpRTt6RBhIhDZMQU1FMy4xMDCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"),HC=()=>(()=>{let e=new(window.AudioContext||window.webkitAudioContext),t=e.createGain();t.connect(e.destination);let n=new Po(fM(e));return e.decodeAudioData(zC.buffer.slice(0)).then(r=>{n.buf=r}).catch(r=>{console.error("Failed to load burp: ",r)}),{ctx:e,masterNode:t,burpSnd:n}})();function VC(e,t={}){let n=new We,r=new Audio(e);r.crossOrigin="anonymous",r.loop=!!t.loop,C.audio.ctx.createMediaElementSource(r).connect(C.audio.masterNode);function o(){C.debug.paused||C.app.isHidden()&&!C.globalOpt.backgroundAudio||C.audio.ctx.resume()}function s(){o(),r.play()}return t.paused||s(),r.onended=()=>n.trigger(),{play(){s()},seek(i){r.currentTime=i},stop(){r.pause(),this.seek(0)},set loop(i){r.loop=i},get loop(){return r.loop},set paused(i){i?r.pause():s()},get paused(){return r.paused},time(){return r.currentTime},duration(){return r.duration},set volume(i){r.volume=Bt(i,0,1)},get volume(){return r.volume},set speed(i){r.playbackRate=Math.max(i,0)},get speed(){return r.playbackRate},set detune(i){},get detune(){return 0},onEnd(i){return n.add(i)},then(i){return this.onEnd(i)}}}function UC(e,t={}){if(typeof e=="string"&&C.assets.music[e])return VC(C.assets.music[e],t);let n=C.audio.ctx,r=t.paused??!1,o=n.createBufferSource(),s=new We,i=n.createGain(),a=n.createStereoPanner(),l=t.seek??0,c=0,d=0,f=!1;o.loop=!!t.loop,o.detune.value=t.detune??0,o.playbackRate.value=t.speed??1,o.connect(a),o.onended=()=>{var g;p()>=(((g=o.buffer)==null?void 0:g.duration)??Number.POSITIVE_INFINITY)&&s.trigger()},a.pan.value=t.pan??0,a.connect(i),i.connect(C.audio.masterNode),i.gain.value=t.volume??1;let u=g=>{o.buffer=g.buf,r||(c=n.currentTime,o.start(0,l),f=!0)},h=qM(e);h instanceof yt&&h.onLoad(u);let p=()=>{if(!o.buffer)return 0;let g=r?d-c:n.currentTime-c,y=o.buffer.duration;return o.loop?g%y:Math.min(g,y)},m=g=>{let y=n.createBufferSource();return y.buffer=g.buffer,y.loop=g.loop,y.playbackRate.value=g.playbackRate.value,y.detune.value=g.detune.value,y.onended=g.onended,y.connect(a),y};return{stop(){this.paused=!0,this.seek(0)},set paused(g){if(r!==g)if(r=g,g)f&&(o.stop(),f=!1),d=n.currentTime;else{o=m(o);let y=d-c;o.start(0,y),f=!0,c=n.currentTime-y,d=0}},get paused(){return r},play(g=0){this.seek(g),this.paused=!1},seek(g){var y;(y=o.buffer)!=null&&y.duration&&(g>o.buffer.duration||(r?(o=m(o),c=d-g):(o.stop(),o=m(o),c=n.currentTime-g,o.start(0,g),f=!0,d=0)))},set speed(g){o.playbackRate.value=g},get speed(){return o.playbackRate.value},set detune(g){o.detune.value=g},get detune(){return o.detune.value},set volume(g){i.gain.value=Math.max(g,0)},get volume(){return i.gain.value},set pan(g){a.pan.value=g},get pan(){return a.pan.value},set loop(g){o.loop=g},get loop(){return o.loop},duration(){var g;return((g=o.buffer)==null?void 0:g.duration)??0},time(){return p()%this.duration()},onEnd(g){return s.add(g)},then(g){return this.onEnd(g)}}}function og(e){return C.k.play(C.audio.burpSnd,e)}function sg(e){C.audio.masterNode.gain.value=e}function ig(){return C.audio.masterNode.gain.value}function $C(e){return Or("volume","setVolume / getVolume"),e!==void 0&&sg(e),ig()}function ag(){C.app.onHide(()=>{C.globalOpt.backgroundAudio||C.audio.ctx.suspend()}),C.app.onShow(()=>{!C.globalOpt.backgroundAudio&&!C.debug.paused&&C.audio.ctx.resume()}),C.app.onResize(()=>{if(C.app.isFullscreen())return;let e=C.globalOpt.width&&C.globalOpt.height;e&&!C.globalOpt.stretch&&!C.globalOpt.letterbox||(C.canvas.width=C.canvas.offsetWidth*C.pixelDensity,C.canvas.height=C.canvas.offsetHeight*C.pixelDensity,Cp(),e||(C.gfx.frameBuffer.free(),C.gfx.frameBuffer=new Ws(C.gfx.ggl,C.gfx.ggl.gl.drawingBufferWidth,C.gfx.ggl.gl.drawingBufferHeight),C.gfx.width=C.gfx.ggl.gl.drawingBufferWidth/C.pixelDensity/C.gscale,C.gfx.height=C.gfx.ggl.gl.drawingBufferHeight/C.pixelDensity/C.gscale))}),C.globalOpt.debug!==!1&&(C.app.onKeyPress(C.globalOpt.debugKey??"f1",()=>C.debug.inspect=!C.debug.inspect),C.app.onKeyPress("f2",()=>C.debug.clearLog()),C.app.onKeyPress("f8",()=>C.debug.paused=!C.debug.paused),C.app.onKeyPress("f7",()=>{C.debug.timeScale=Za(Bt(C.debug.timeScale-.2,0,2),1)}),C.app.onKeyPress("f9",()=>{C.debug.timeScale=Za(Bt(C.debug.timeScale+.2,0,2),1)}),C.app.onKeyPress("f10",()=>C.debug.stepFrame())),C.globalOpt.burp&&C.app.onKeyPress("b",()=>og())}function GC(e,t={}){let n=C.game.root.add([Xs(e),fg()]),r=(t.speed||1)*5,o=t.scale||1;n.add([sl(C.boomSprite),Qs(0),ll("center"),pd(r,o),...t.comps??[]]);let s=n.add([sl(C.kaSprite),Qs(0),ll("center"),il(),...t.comps??[]]);return s.wait(.4/r,()=>s.use(pd(r,o))),s.onDestroy(()=>n.destroy()),n}function lg(e,t){if(C.game.layers)throw Error("Layers can only be assigned once.");let n=e.indexOf(t);if(n==-1)throw Error("The default layer name should be present in the layers list.");C.game.layers=e,C.game.defaultLayerIndex=n}function KC(){return C.game.layers}function WC(){var e;return((e=C.game.layers)==null?void 0:e[C.game.defaultLayerIndex])??null}function YC(e,t){Or("layers","setLayers"),lg(e,t)}function cg(e){e.destroy()}function XC(){return C.game.root}function QC(e,t){C.game.scenes[e]=t}function ZC(e,...t){if(!C.game.scenes[e])throw new Error(`Scene not found: ${e}`);C.game.events.onOnce("frameEnd",()=>{C.game.events.trigger("sceneLeave",e),C.app.events.clear(),C.game.events.clear(),C.game.objEvents.clear(),[...C.game.root.children].forEach(n=>{!n.stay||n.scenesToStay&&!n.scenesToStay.includes(e)?C.game.root.remove(n):n.trigger("sceneEnter",e)}),C.game.root.clearEvents(),ag(),C.game.cam={pos:null,scale:$(1),angle:0,shake:0,transform:new Ft},C.game.scenes[e](...t)}),C.game.currentScene=e}function JC(e){return C.game.events.on("sceneLeave",e)}function e2(){return C.game.currentScene}function sl(e,t={}){let n=null,r=null,o=null,s=new We;if(!e)throw new Error("Please pass the resource name or data to sprite()");let i=(c,d,f,u)=>{let h=$(1,1);return f&&u?(h.x=f/(c.width*d.w),h.y=u/(c.height*d.h)):f?(h.x=f/(c.width*d.w),h.y=h.x):u&&(h.y=u/(c.height*d.h),h.x=h.y),h},a=(c,d)=>{if(!d)return;let f=d.frames[0].clone();t.quad&&(f=f.scale(t.quad));let u=i(d.tex,f,t.width,t.height);if(c.width=d.tex.width*f.w*u.x,c.height=d.tex.height*f.h*u.y,d.anims)for(let h in d.anims){let p=d.anims[h];typeof p!="number"&&(p.frames=l(p))}n=d,s.trigger(n),t.anim&&c.play(t.anim)},l=c=>{if(c.frames)return c.frames;let d=[];if(c.from===void 0||c.to===void 0)throw new Error("Sprite anim 'from' and 'to' must be defined if 'frames' is not defined");let f=Math.abs(c.to-c.from)+1;for(let u=0;u<f;u++)d.push(c.from+u*Math.sign(c.to-c.from));if(c.pingpong)for(let u=f-2;u>0;u--)d.push(d[u]);return d};return{id:"sprite",width:0,height:0,frame:t.frame||0,quad:t.quad||new Ie(0,0,1,1),animSpeed:t.animSpeed??1,flipX:t.flipX??!1,flipY:t.flipY??!1,get sprite(){return e.toString()},set sprite(c){let d=bs(c);d&&d.onLoad(f=>a(this,f))},get animFrame(){if(!n||!r||o===null)return this.frame;let c=n.anims[r.name];return typeof c=="number"?c:c.from===void 0||c.to===void 0?r.frameIndex:this.frame-Math.min(c.from,c.to)},draw(){if(!n)return;let c=n.frames[this.frame??0];if(!c)throw new Error(`Frame not found: ${this.frame??0}`);if(n.slice9){let{left:d,right:f,top:u,bottom:h}=n.slice9,p=n.tex.width*c.w,m=n.tex.height*c.h,g=this.width-d-f,y=this.height-u-h,b=d/p,w=f/p,E=1-b-w,P=u/m,A=h/m,v=1-P-A,M=[ke(0,0,b,P),ke(b,0,E,P),ke(b+E,0,w,P),ke(0,P,b,v),ke(b,P,E,v),ke(b+E,P,w,v),ke(0,P+v,b,A),ke(b,P+v,E,A),ke(b+E,P+v,w,A),ke(0,0,d,u),ke(d,0,g,u),ke(d+g,0,f,u),ke(0,u,d,y),ke(d,u,g,y),ke(d+g,u,f,y),ke(0,u+y,d,h),ke(d,u+y,g,h),ke(d+g,u+y,f,h)];for(let N=0;N<9;N++){let _=M[N],D=M[N+9];Ys(Object.assign(Kn(this),{pos:D.pos(),tex:n.tex,quad:c.scale(_),flipX:this.flipX,flipY:this.flipY,tiled:t.tiled,width:D.w,height:D.h}))}}else Ys(Object.assign(Kn(this),{tex:n.tex,quad:c.scale(this.quad??new Ie(0,0,1,1)),flipX:this.flipX,flipY:this.flipY,tiled:t.tiled,width:this.width,height:this.height}))},add(){let c=bs(e);c?c.onLoad(d=>a(this,d)):nc(()=>a(this,bs(e).data))},update(){if(!n||!r||o===null)return;let c=n.anims[r.name];if(typeof c=="number"){this.frame=c;return}if(c.speed===0)throw new Error("Sprite anim speed cannot be 0");if(r.timer+=qe()*this.animSpeed,r.timer>=1/r.speed){r.timer=0,r.frameIndex+=o;let d=c.frames;if(r.frameIndex>=d.length)if(r.pingpong&&!c.pingpong)o=-1,r.frameIndex=d.length-2;else if(r.loop)r.frameIndex=0;else{this.frame=d.at(-1),r.onEnd(),this.stop();return}else if(r.frameIndex<0)if(r.pingpong&&r.loop)o=1,r.frameIndex=1;else if(r.loop)r.frameIndex=d.length-1;else{this.frame=d[0],r.onEnd(),this.stop();return}this.frame=d[r.frameIndex]}},play(c,d={}){if(!n){s.add(()=>this.play(c,d));return}let f=n.anims[c];if(f===void 0)throw new Error(`Anim not found: ${c}`);r&&this.stop(),r=typeof f=="number"?{name:c,timer:0,loop:!1,pingpong:!1,speed:0,frameIndex:0,onEnd:()=>{}}:{name:c,timer:0,loop:d.loop??f.loop??!1,pingpong:d.pingpong??f.pingpong??!1,speed:d.speed??f.speed??10,frameIndex:0,onEnd:d.onEnd??(()=>{})},o=typeof f=="number"?null:1,this.frame=typeof f=="number"?f:f.frames[0],this.trigger("animStart",c)},stop(){if(!r)return;let c=r.name;r=null,this.trigger("animEnd",c)},numFrames(){return(n==null?void 0:n.frames.length)??0},getCurAnim(){return r},curAnim(){return r==null?void 0:r.name},getAnim(c){return(n==null?void 0:n.anims[c])??null},hasAnim(c){return!!this.getAnim(c)},onAnimEnd(c){return this.on("animEnd",c)},onAnimStart(c){return this.on("animStart",c)},renderArea(){return new Ee($(0),this.width,this.height)},inspect(){return typeof e=="string"?`sprite: "${e}"`:null}}}function t2(e,t={}){function n(o){var i,a;let s=$n(Object.assign(Kn(o),{text:o.text+"",size:o.textSize,font:o.font,width:t.width&&o.width,align:o.align,letterSpacing:o.letterSpacing,lineSpacing:o.lineSpacing,transform:o.textTransform,styles:o.textStyles,indentAll:t.indentAll}));return t.width||(o.width=s.width/(((i=o.scale)==null?void 0:i.x)||1)),o.height=s.height/(((a=o.scale)==null?void 0:a.y)||1),s}let r={id:"text",set text(o){e=o,n(this),this.renderedText=nl(e).text},get text(){return e},textSize:t.size??36,font:t.font,width:t.width??0,height:0,align:t.align,lineSpacing:t.lineSpacing,letterSpacing:t.letterSpacing,textTransform:t.transform,textStyles:t.styles,renderedText:e?nl(e).text:"",add(){nc(()=>n(this))},draw(){Gn(n(this))},renderArea(){return new Ee($(0),this.width,this.height)}};return n(r),r}function n2(e,t){return{id:"rect",width:e,height:t,draw(){Io(Object.assign(Kn(this),{width:this.width,height:this.height}))},renderArea(){return new Ee($(0),this.width,this.height)},inspect(){return`uvquad: (${Math.ceil(this.width)}w, ${Math.ceil(this.height)})h`}}}function r2(e={}){let t=null,n=null,r=null,o=null;return{id:"agent",require:["pos","tile"],agentSpeed:e.speed??100,allowDiagonals:e.allowDiagonals??!0,getDistanceToTarget(){return t?this.pos.dist(t):0},getNextLocation(){return n&&r?n[r]:null},getPath(){return n?n.slice():null},getTarget(){return t},isNavigationFinished(){return n?r===null:!0},isTargetReachable(){return n!==null},isTargetReached(){return t?this.pos.eq(t):!0},setTarget(s){t=s,n=this.getLevel().getPath(this.pos,t,{allowDiagonals:this.allowDiagonals}),r=n?0:null,n&&r!==null?(o||(o=this.getLevel().onNavigationMapChanged(()=>{t&&n&&r!==null&&(n=this.getLevel().getPath(this.pos,t,{allowDiagonals:this.allowDiagonals}),n?(r=0,this.trigger("navigationNext",this,n[r])):(r=null,this.trigger("navigationEnded",this)))}),this.onDestroy(()=>o==null?void 0:o.cancel())),this.trigger("navigationStarted",this),this.trigger("navigationNext",this,n[r])):this.trigger("navigationEnded",this)},update(){if(t&&n&&r!==null){if(this.pos.sdist(n[r])<2)if(r===n.length-1){this.pos=t.clone(),r=null,this.trigger("navigationEnded",this),this.trigger("targetReached",this);return}else r++,this.trigger("navigationNext",this,n[r]);this.moveTo(n[r],this.agentSpeed)}},onNavigationStarted(s){return this.on("navigationStarted",s)},onNavigationNext(s){return this.on("navigationNext",s)},onNavigationEnded(s){return this.on("navigationEnded",s)},onTargetReached(s){return this.on("targetReached",s)},inspect(){return"agent: "+JSON.stringify({target:JSON.stringify(t),path:JSON.stringify(n)})}}}function o2(e){let t=e.graph;return{id:"pathfinder",require:["pos"],navigateTo(n){var r;return(r=this.graph)==null?void 0:r.getWaypointPath(this.pos,n,e.navigationOpt)},get graph(){if(t)return t;let n=this.parent;for(;n;){if(n.has("pathfinderMap"))return n.graph;n=n.parent}},set graph(n){t=n}}}function s2(e={}){let t=e.waypoints,n=e.speed||100,r=e.endBehavior||"stop",o=0,s=t!=null;return{id:"patrol",require:["pos"],get patrolSpeed(){return n},set patrolSpeed(i){n=i},get waypoints(){return t},set waypoints(i){t=i,o=0,s=!1},get nextLocation(){return t?t[o]:void 0},update(){let i=this.nextLocation;if(!(!t||!i||s)&&(this.moveTo(i,n),this.pos.sdist(i)<9))switch(r){case"loop":o=(o+1)%t.length;break;case"ping-pong":o=o+1,o==t.length&&(t.reverse(),o=0);break;case"stop":o=Math.min(o+1,t.length-1),o==t.length-1&&(s=!0,this.trigger("patrolFinished"));break}},onPatrolFinished(i){return this.on("patrolFinished",i)}}}function i2(e,t={}){let n=typeof e=="function"?e:()=>C.game.root.query(e),r=t.checkFrequency||1,o=typeof t.direction=="number"?X.fromAngle(t.direction):t.direction,s=0;return{id:"sentry",require:["pos"],direction:typeof t.direction=="number"?X.fromAngle(t.direction):t.direction,spotted:[],set directionAngle(i){this.direction=i!==void 0?X.fromAngle(i):void 0},get directionAngle(){return this.direction?this.direction.angle():void 0},fieldOfView:t.fieldOfView||200,isWithinFieldOfView(i,a,l){let c=(typeof a=="number"?X.fromAngle(a):a)||o,d=l||t.fieldOfView;if(!c||!d||d>=360)return!0;let f=d/2;return i.pos&&c.angleBetween(i.pos.sub(this.pos))<=f},hasLineOfSight(i){let a=$p(this.pos,i.pos.sub(this.pos),t.raycastExclude);return a!=null&&a.object===i},update(){if(s+=qe(),s>r){s-=r;let i=n();if(i.length&&o&&this.fieldOfView&&this.fieldOfView<360){let a=this.fieldOfView/2;i=i.filter(l=>l.pos&&o.angleBetween(l.pos.sub(this.pos))<=a)}i.length&&t.lineOfSight&&(i=i.filter(a=>a.pos&&this.hasLineOfSight(a))),i.length>0&&(this.spotted=i,this.trigger("objectSpotted",i))}},onObjectsSpotted(i){return this.on("objectSpotted",i)}}}function ug(e={}){let t=$(0),n=e.isObstacle??!1,r=e.cost??0,o=e.edges??[],s=()=>{let a={left:1,top:2,right:4,bottom:8};return o.map(l=>a[l]||0).reduce((l,c)=>l|c,0)},i=s();return{id:"tile",tilePosOffset:e.offset??$(0),set tilePos(a){let l=this.getLevel();t=a.clone(),this.pos=$(this.tilePos.x*l.tileWidth(),this.tilePos.y*l.tileHeight()).add(this.tilePosOffset)},get tilePos(){return t},set isObstacle(a){n!==a&&(n=a,this.getLevel().invalidateNavigationMap())},get isObstacle(){return n},set cost(a){r!==a&&(r=a,this.getLevel().invalidateNavigationMap())},get cost(){return r},set edges(a){o=a,i=s(),this.getLevel().invalidateNavigationMap()},get edges(){return o},get edgeMask(){return i},getLevel(){return this.parent},tileMove(a){let l=this.getLevel();l.removeFromSpatialMap(this),this.tilePos=this.tilePos.add(a),l.insertIntoSpatialMap(this),l.trigger("spatialMapChanged")},moveLeft(){this.tileMove($(-1,0))},moveRight(){this.tileMove($(1,0))},moveUp(){this.tileMove($(0,-1))},moveDown(){this.tileMove($(0,1))}}}var oc=class{constructor(e,t,n){H(this,"name");H(this,"duration");H(this,"loops");H(this,"direction");H(this,"easing");H(this,"interpolation");H(this,"isFinished");H(this,"timing");H(this,"easings");H(this,"relative");this.name=e,this.duration=t.duration,this.loops=t.loops||0,this.direction=t.direction||"forward",this.easing=t.easing||Co.linear,this.interpolation=t.interpolation||"linear",this.isFinished=!1,this.timing=t.timing,this.easings=t.easings,this.relative=n}update(e,t){return!0}getLowerKeyIndexAndRelativeTime(e,t,n){let r=t-1,o=e/this.duration;if(this.loops!==0&&o>=this.loops)return[r,0,!0];let s=Math.trunc(o);if(o-=s,(this.direction=="reverse"||this.direction=="ping-pong"&&s&1)&&(o=1-o),n){let i=0;for(;n[i+1]!==void 0&&n[i+1]<o;)i++;return i>=r?[r,0,!0]:[i,(o-n[i])/(n[i+1]-n[i]),!1]}else{let i=Math.floor((t-1)*o);return[i,(o-i/r)*r,!1]}}setValue(e,t,n){if(this.relative)switch(t){case"pos":e.pos=e.base.pos.add(n);break;case"angle":e.angle=e.base.angle+n;break;case"scale":e.scale=e.base.scale.scale(n);break;case"opacity":e.opacity=e.base.opacity*n;break;default:e[t]=n}else e[t]=n}serialize(){let e={duration:this.duration,keys:[]};return this.loops&&(e.loops=this.loops),this.direction!=="forward"&&(e.direction=this.direction),this.easing!=Co.linear&&(e.easing=this.easing.name),this.interpolation!=="linear"&&(e.interpolation=this.interpolation),this.timing&&(e.timing=this.timing),this.easings&&(e.easings=this.easings.map(t=>this.easing.name)),e}};function hd(e,t){return t.add(t.sub(e))}var a2=class extends oc{constructor(t,n,r,o){super(t,r,o);H(this,"keys");this.keys=n}update(t,n){let[r,o,s]=this.getLowerKeyIndexAndRelativeTime(n,this.keys.length,this.timing);if(o==0||this.interpolation==="none")this.setValue(t,this.name,this.keys[r]);else{let i=this.easings?this.easings[r]:this.easing;this.setValue(t,this.name,nt(this.keys[r],this.keys[r+1],i(o)))}return s}serialize(){return Object.assign(super.serialize(),{keys:this.keys})}},l2=class extends oc{constructor(t,n,r,o,s){var i;super(t,r,o);H(this,"keys");H(this,"curves");H(this,"dcurves");if(this.keys=n,this.interpolation==="spline"){this.curves=[],s&&(this.dcurves=[]);for(let a=0;a<this.keys.length-1;a++){let l=this.keys[a],c=a+1,d=this.keys[c],f=a>0?this.keys[a-1]:hd(d,l),u=c<this.keys.length-1?this.keys[c+1]:hd(l,d);this.curves.push($s(f,l,d,u)),s&&((i=this.dcurves)==null||i.push($s(f,l,d,u,oS)))}}}update(t,n){let[r,o,s]=this.getLowerKeyIndexAndRelativeTime(n,this.keys.length,this.timing);if(o==0||this.interpolation==="none")this.setValue(t,this.name,this.keys[r]);else{let i=this.easings?this.easings[r]:this.easing;switch(this.interpolation){case"linear":this.setValue(t,this.name,this.keys[r].lerp(this.keys[r+1],i(o)));break;case"slerp":this.setValue(t,this.name,this.keys[r].slerp(this.keys[r+1],i(o)));break;case"spline":if(this.curves){this.setValue(t,this.name,this.curves[r](i(o))),this.dcurves&&this.setValue(t,"angle",this.dcurves[r](i(o)).angle());break}}}return s}serialize(){return Object.assign(super.serialize(),{keys:this.keys.map(t=>[t.x,t.y])})}},c2=class extends oc{constructor(t,n,r,o){super(t,r,o);H(this,"keys");this.keys=n}update(t,n){let[r,o,s]=this.getLowerKeyIndexAndRelativeTime(n,this.keys.length,this.timing);if(o==0||this.interpolation=="none")this.setValue(t,this.name,this.keys[r]);else{let i=this.easings?this.easings[r]:this.easing;this.setValue(t,this.name,this.keys[r].lerp(this.keys[r+1],i(o)))}return s}serialize(){return Object.assign(super.serialize(),{keys:this.keys})}};function u2(e={}){let t=[],n=0,r=!1;return{id:"animate",require:e.followMotion?["rotate"]:void 0,base:{pos:$(0,0),angle:0,scale:$(1,1),opacity:1},animation:{paused:!1,seek(o){n=Bt(o,0,this.duration),t.forEach(s=>{s.isFinished=!1}),r=!1},get duration(){return t.reduce((o,s)=>Math.max(s.duration,o),0)}},add(){e.relative&&(this.has("pos")&&(this.base.pos=this.pos.clone()),this.has("rotate")&&(this.base.angle=this.angle),this.has("scale")&&(this.base.scale=this.scale),this.has("opacity")&&(this.base.opacity=this.opacity))},update(){if(this.animation.paused)return;let o=!0,s;n+=qe();for(let i of t)s=i.update(this,n),s&&!i.isFinished&&(i.isFinished=!0,this.trigger("animateChannelFinished",i.name)),o&&(o=s);o&&!r&&(r=!0,this.trigger("animateFinished"))},animate(o,s,i){r=!1,this.unanimate(o),typeof s[0]=="number"?t.push(new a2(o,s,i,e.relative||!1)):s[0]instanceof X?t.push(new l2(o,s,i,e.relative||!1,o==="pos"&&(e.followMotion||!1))):s[0]instanceof pe&&t.push(new c2(o,s,i,e.relative||!1))},unanimate(o){let s=t.findIndex(i=>i.name===o);s>=0&&t.splice(s,1)},unanimateAll(){t.splice(0,t.length)},onAnimateFinished(o){return this.on("animateFinished",o)},onAnimateChannelFinished(o){return this.on("animateChannelFinished",o)},serializeAnimationChannels(){return t.reduce((o,s)=>(o[s.name]=s.serialize(),o),{})},serializeAnimationOptions(){let o={};return e.followMotion&&(o.followMotion=!0),e.relative&&(o.relative=!0),o}}}function dg(e,t){let n={name:e.name};return e.has("animate")&&(n.channels=e.serializeAnimationChannels(),Object.assign(n,e.serializeAnimationOptions())),e.children.length>0&&(n.children=e.children.filter(r=>r.has("named")).map(r=>dg(r,r.name))),n}function pd(e=2,t=1){let n=0;return{require:["scale"],update(){let r=Math.sin(n*e)*t;r<0&&this.destroy(),this.scale=$(r),n+=qe()}}}function d2(e,t){if(e==null)throw new Error("health() requires the initial amount of hp");return{id:"health",hurt(n=1){this.setHP(e-n),this.trigger("hurt",n)},heal(n=1){let r=e;this.setHP(e+n),this.trigger("heal",e-r)},hp(){return e},maxHP(){return t??null},setMaxHP(n){t=n},setHP(n){e=t?Math.min(t,n):n,e<=0&&this.trigger("death")},onHurt(n){return this.on("hurt",n)},onHeal(n){return this.on("heal",n)},onDeath(n){return this.on("death",n)},inspect(){return`health: ${e}`}}}function f2(e,t={}){if(e==null)throw new Error("lifespan() requires time");let n=t.fade??0;return{id:"lifespan",require:["opacity"],add(){C.game.root.wait(e,()=>{this.opacity=this.opacity??1,n>0?C.game.root.tween(this.opacity,0,n,r=>this.opacity=r,Co.linear).onEnd(()=>{this.destroy()}):this.destroy()})}}}function h2(e){return{id:"named",name:e}}function p2(e,t,n){if(!e)throw new Error("state() requires an initial state");let r={};function o(l){r[l]||(r[l]={enter:new We,end:new We,update:new We,draw:new We})}function s(l,c,d){return o(c),r[c][l].add(d)}function i(l,c,...d){o(c),r[c][l].trigger(...d)}let a=!1;return{id:"state",state:e,enterState(l,...c){if(a=!0,t&&!t.includes(l))throw new Error(`State not found: ${l}`);let d=this.state;if(n){if(!(n!=null&&n[d]))return;let f=typeof n[d]=="string"?[n[d]]:n[d];if(!f.includes(l))throw new Error(`Cannot transition state from "${d}" to "${l}". Available transitions: ${f.map(u=>`"${u}"`).join(", ")}`)}i("end",d,...c),this.state=l,i("enter",l,...c),i("enter",`${d} -> ${l}`,...c)},onStateTransition(l,c,d){return s("enter",`${l} -> ${c}`,d)},onStateEnter(l,c){return s("enter",l,c)},onStateUpdate(l,c){return s("update",l,c)},onStateDraw(l,c){return s("draw",l,c)},onStateEnd(l,c){return s("end",l,c)},update(){a||(i("enter",e),a=!0),i("update",this.state)},draw(){i("draw",this.state)},inspect(){return`state: ${this.state}`}}}function fg(e){return{id:"stay",stay:!0,scenesToStay:e}}function g2(e=!0,t){let n,r;return{id:"textInput",hasFocus:e,require:["text"],typedText:"",add(){let o=()=>{this.text=this.typedText.replace(/([\[\\])/g,"\\$1")};n=C.k.onCharInput(s=>{this.hasFocus&&(!t||this.typedText.length<t)&&(C.k.isKeyDown("shift")?this.typedText+=s.toUpperCase():this.typedText+=s,o())}),r=C.k.onKeyPressRepeat("backspace",()=>{this.hasFocus&&(this.typedText=this.typedText.slice(0,-1)),o()})},destroy(){n.cancel(),r.cancel()}}}function il(e=1e3){return{id:"timer",maxLoopsPerFrame:e,loop(t,n,r=1/0,o=!1){let s=o?0:t,i=new We,a=this.onUpdate(()=>{s+=C.app.state.dt;for(let l=0;s>=t&&l<this.maxLoopsPerFrame;l++)if(r--,n(),s-=t,r<=0){a.cancel(),i.trigger();return}});return{get paused(){return a.paused},set paused(l){a.paused=l},cancel:a.cancel,onEnd(l){i.add(l)},then(l){return i.add(l),this}}},wait(t,n){return this.loop(t,n??(()=>{}),1,!0)},tween(t,n,r,o,s=Co.linear){let i=0,a=[],l=this.onUpdate(()=>{i+=C.app.state.dt;let c=Math.min(i/r,1);o(nt(t,n,s(c))),c===1&&(l.cancel(),o(n),a.forEach(d=>d()))});return{get paused(){return l.paused},set paused(c){l.paused=c},onEnd(c){a.push(c)},then(c){return this.onEnd(c),this},cancel(){l.cancel()},finish(){l.cancel(),o(n),a.forEach(c=>c())}}}}}var al=0;function m2(){return al>0}function y2(e={}){let t={},n=new Set,r=[];return{id:"area",collisionIgnore:e.collisionIgnore??[],add(){al++,this.area.cursor&&r.push(this.onHover(()=>C.app.setCursor(this.area.cursor))),r.push(this.onCollideUpdate((o,s)=>{if(!o.id)throw new Error("area() requires the object to have an id");t[o.id]||this.trigger("collide",o,s),s&&(t[o.id]=s,n.add(o.id))}))},destroy(){al--;for(let o of r)o.cancel()},fixedUpdate(){for(let o in t)n.has(Number(o))||(this.trigger("collideEnd",t[o].target),delete t[o]);n.clear()},drawInspect(){let o=this.localArea();dt(),Te(this.area.offset);let s={outline:{width:4/Rp(),color:we(0,0,255)},anchor:this.anchor,fill:!1,fixed:Bn(this)};o instanceof Ee?ht({...s,pos:o.pos,width:o.width*this.area.scale.x,height:o.height*this.area.scale.y}):o instanceof Ye?hn({...s,pts:o.pts,scale:this.area.scale}):o instanceof st&&Br({...s,pos:o.center,radius:o.radius}),tt()},area:{shape:e.shape??null,scale:e.scale?$(e.scale):$(1),offset:e.offset??$(0),cursor:e.cursor??null},isClicked(){return C.app.isMousePressed()&&this.isHovering()},isHovering(){let o=Bn(this)?C.k.mousePos():C.k.toWorld(C.k.mousePos());return this.hasPoint(o)},checkCollision(o){if(!o.id)throw new Error("checkCollision() requires the object to have an id");return t[o.id]??null},getCollisions(){return Object.values(t)},isColliding(o){if(!o.id)throw new Error("isColliding() requires the object to have an id");return!!t[o.id]},isOverlapping(o){if(!o.id)throw new Error("isOverlapping() requires the object to have an id");let s=t[o.id];return s&&s.hasOverlap()},onClick(o,s="left"){let i=C.app.onMousePress(s,()=>{this.isHovering()&&o()});return r.push(i),i},onHover(o){let s=!1;return this.onUpdate(()=>{s?s=this.isHovering():this.isHovering()&&(s=!0,o())})},onHoverUpdate(o){return this.onUpdate(()=>{this.isHovering()&&o()})},onHoverEnd(o){let s=!1;return this.onUpdate(()=>{s?this.isHovering()||(s=!1,o()):s=this.isHovering()})},onCollide(o,s){if(typeof o=="function"&&s===void 0)return this.on("collide",o);if(typeof o=="string")return this.onCollide((i,a)=>{i.is(o)&&(s==null||s(i,a))});throw new Error("onCollide() requires either a function or a tag")},onCollideUpdate(o,s){if(typeof o=="function"&&s===void 0)return this.on("collideUpdate",o);if(typeof o=="string")return this.on("collideUpdate",(i,a)=>i.is(o)&&(s==null?void 0:s(i,a)));throw new Error("onCollideUpdate() requires either a function or a tag")},onCollideEnd(o,s){if(typeof o=="function"&&s===void 0)return this.on("collideEnd",o);if(typeof o=="string")return this.on("collideEnd",i=>i.is(o)&&(s==null?void 0:s(i)));throw new Error("onCollideEnd() requires either a function or a tag")},hasPoint(o){return yn(this.worldArea(),o)},resolveCollision(o){let s=this.checkCollision(o);s&&!s.resolved&&(this.pos=this.pos.add(s.displacement),s.resolved=!0)},localArea(){return this.area.shape?this.area.shape:this.renderArea()},worldArea(){let o=this.localArea();if(!(o instanceof Ye||o instanceof Ee))throw new Error("Only support polygon and rect shapes for now");let s=this.transform.clone().translate(this.area.offset).scale($(this.area.scale??1));if(o instanceof Ee){let i=Lr(this.anchor||Ci).add(1,1).scale(-.5).scale(o.width,o.height);s.translate(i)}return o.transform(s)},screenArea(){let o=this.worldArea();return Bn(this)?o:o.transform(C.game.cam.transform)},inspect(){var o,s,i,a,l,c,d;return((o=this.area.scale)==null?void 0:o.x)==((s=this.area.scale)==null?void 0:s.y)?`area: ${(a=(i=this.area.scale)==null?void 0:i.x)==null?void 0:a.toFixed(1)}x`:`area: (${(c=(l=this.area.scale)==null?void 0:l.x)==null?void 0:c.toFixed(1)}x, ${(d=this.area.scale.y)==null?void 0:d.toFixed(1)}y)`}}}function w2(e={}){let t=null,n=null,r=!1,o=$(0),s=null,i=null,a;return{id:"body",require:["pos"],vel:$(0),drag:e.drag??0,jumpForce:e.jumpForce??SS,gravityScale:e.gravityScale??1,isStatic:e.isStatic??!1,mass:e.mass??1,add(){if(s=this.pos.clone(),i=this.pos.clone(),a=this.pos.clone(),this.mass===0)throw new Error("Can't set body mass to 0");this.has("area")&&(this.onCollideUpdate((l,c)=>{if(!c||!l.has("body")||c.resolved)return;this.trigger("beforePhysicsResolve",c);let d=c.reverse();if(l.trigger("beforePhysicsResolve",d),!(c.resolved||d.resolved)&&!(this.isStatic&&l.isStatic)){if(!this.isStatic&&!l.isStatic){let f=this.mass+l.mass;this.pos=this.pos.add(c.displacement.scale(l.mass/f)),l.pos=l.pos.add(c.displacement.scale(-this.mass/f)),this.transform=lo(this),l.transform=lo(l)}else{let f=!this.isStatic&&l.isStatic?c:c.reverse();f.source.pos=f.source.pos.add(f.displacement),f.source.transform=lo(f.source)}c.resolved=!0,this.trigger("physicsResolve",c),l.trigger("physicsResolve",c.reverse())}}),this.onPhysicsResolve(l=>{if(C.game.gravity)if(l.isBottom()&&this.isFalling()){this.vel=this.vel.reject(C.game.gravity.unit());let c=t;t=l.target,c!=t&&(n=l.target.pos),r?r=!1:c||(this.trigger("ground",t),l.target.trigger("land",this))}else l.isTop()&&this.isJumping()&&(this.vel=this.vel.reject(C.game.gravity.unit()),this.trigger("headbutt",l.target),l.target.trigger("headbutted",this))}))},update(){t&&this.isColliding(t)&&t.exists()&&t.has("body")&&(n&&!t.pos.eq(n)&&e.stickToPlatform!==!1&&this.moveBy(t.pos.sub(n)),n=t.pos);let l=el();l&&(this.pos.x==a.x&&(this.pos.x=nt(s.x,i.x,l/Ja()),a.x=this.pos.x),this.pos.y==a.y&&(this.pos.y=nt(s.y,i.y,l/Ja()),a.y=this.pos.y))},fixedUpdate(){if(s&&(this.pos.x==a.x&&(this.pos.x=s.x),this.pos.y==a.y&&(this.pos.y=s.y),s=null),C.game.gravity&&!this.isStatic){r&&(t=null,n=null,this.trigger("fallOff"),r=!1),t&&(!this.isColliding(t)||!t.exists()||!t.has("body"))&&(r=!0);let l=this.vel.clone();this.vel=this.vel.add(C.game.gravity.scale(this.gravityScale*qe()));let c=e.maxVelocity??MS;this.vel.slen()>c*c&&(this.vel=this.vel.unit().scale(c)),l.dot(C.game.gravity)<0&&this.vel.dot(C.game.gravity)>=0&&this.trigger("fall")}if(this.vel.x+=o.x*qe(),this.vel.y+=o.y*qe(),this.vel.x*=1-this.drag*qe(),this.vel.y*=1-this.drag*qe(),this.move(this.vel),el()){s=this.pos.clone();let l=this.vel.add(o.scale(qe()));i=this.pos.add(l.scale(qe())),a=this.pos.clone()}o.x=0,o.y=0},onPhysicsResolve(l){return this.on("physicsResolve",l)},onBeforePhysicsResolve(l){return this.on("beforePhysicsResolve",l)},curPlatform(){return t},isGrounded(){return t!==null},isFalling(){return this.vel.dot(uo())>0},isJumping(){return this.vel.dot(uo())<0},applyImpulse(l){this.isStatic||(this.vel=this.vel.add(l))},addForce(l){this.isStatic||(o.x+=l.x/this.mass,o.y+=l.y/this.mass)},jump(l){this.isStatic||(t=null,n=null,this.vel=uo().scale(-l||-this.jumpForce))},onGround(l){return this.on("ground",l)},onFall(l){return this.on("fall",l)},onFallOff(l){return this.on("fallOff",l)},onHeadbutt(l){return this.on("headbutt",l)},onLand(l){return this.on("land",l)},onHeadbutted(l){return this.on("headbutted",l)},inspect(){return`gravityScale: ${this.gravityScale}x`}}}function x2(e=2){let t=e;return{id:"doubleJump",require:["body"],numJumps:e,add(){this.onGround(()=>{t=this.numJumps})},doubleJump(n){t<=0||(t<this.numJumps&&this.trigger("doubleJump"),t--,this.jump(n))},onDoubleJump(n){return this.on("doubleJump",n)},inspect(){return`jumpsLeft: ${t}`}}}function v2(e){return{id:"surfaceEffector",require:["area"],speed:e.speed,speedVariation:e.speedVariation??0,forceScale:e.speedVariation??.9,add(){this.onCollideUpdate("body",(t,n)=>{var i;let r=n==null?void 0:n.normal.normal(),o=t.vel.project(r),s=(i=r==null?void 0:r.scale(this.speed))==null?void 0:i.sub(o);t.addForce(s==null?void 0:s.scale(t.mass*this.forceScale))})}}}function b2(e){return{id:"areaEffector",require:["area"],useGlobalAngle:e.useGlobalAngle||!1,forceAngle:e.forceAngle,forceMagnitude:e.forceMagnitude,forceVariation:e.forceVariation??0,linearDrag:e.linearDrag??0,add(){this.onCollideUpdate("body",(t,n)=>{if(!t.has("body"))return;let r=X.fromAngle(this.forceAngle).scale(this.forceMagnitude);t.addForce(r),this.linearDrag&&t.addForce(t.vel.scale(-this.linearDrag))})}}}function A2(e){return{id:"pointEffector",require:["area","pos"],forceMagnitude:e.forceMagnitude,forceVariation:e.forceVariation??0,distanceScale:e.distanceScale??1,forceMode:e.forceMode||"inverseLinear",linearDrag:e.linearDrag??0,add(){this.onCollideUpdate("body",(t,n)=>{let r=this.pos.sub(t.pos),o=r.len(),s=o*this.distanceScale/10,i=this.forceMode==="constant"?1:this.forceMode==="inverseLinear"?1/s:1/s**2,a=r.scale(this.forceMagnitude*i/o);t.addForce(a),this.linearDrag&&t.addForce(t.vel.scale(-this.linearDrag))})}}}function E2(e){return{id:"constantForce",require:["body"],force:e.force,update(){this.force&&this.addForce(this.force)}}}function S2(e){return{id:"platformEffector",require:["area","body"],surfaceArc:e.surfaceArc??180,useOneWay:e.useOneWay??!1,add(){this.onBeforePhysicsResolve(t=>{let n=t.target.vel,r=uo().scale(-1).angleBetween(n);Math.abs(r)>this.surfaceArc/2&&t.preventResolution()})}}}function M2(e){return{id:"buoyancyEffector",require:["area"],surfaceLevel:e.surfaceLevel,density:e.density??1,linearDrag:e.linearDrag??1,angularDrag:e.angularDrag??.2,flowAngle:e.flowAngle??0,flowMagnitude:e.flowMagnitude??0,flowVariation:e.flowVariation??0,add(){this.onCollideUpdate("body",(t,n)=>{let r=t,o=r.worldArea(),[s,i]=o.cut($(-100,this.surfaceLevel),$(100,this.surfaceLevel));s&&(this.applyBuoyancy(r,s),this.applyDrag(r,s)),this.flowMagnitude&&r.addForce(X.fromAngle(this.flowAngle).scale(this.flowMagnitude))})},applyBuoyancy(t,n){let r=this.density*n.area(),o=$(0,1).scale(-r);t.addForce(o)},applyDrag(t,n){let r=t.vel,o=this.density*this.linearDrag,s=r.scale(-o);t.addForce(s)}}}function ll(e){if(!e)throw new Error("Please define an anchor");return{id:"anchor",anchor:e,inspect(){return typeof this.anchor=="string"?"anchor: "+this.anchor:"anchor: "+this.anchor.toString()}}}function hg(){return{id:"fixed",fixed:!0}}function C2(e,t){return{id:"follow",require:["pos"],follow:{obj:e,offset:t??$(0)},add(){e.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))},update(){e.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))}}}function R2(e){var n;let t=(n=C.game.layers)==null?void 0:n.indexOf(e);return{id:"layer",get layerIndex(){return t??null},get layer(){var r;return t?((r=C.game.layers)==null?void 0:r[t])??null:null},set layer(r){var o;if(t=(o=C.game.layers)==null?void 0:o.indexOf(r),t==-1)throw Error("Invalid layer name")},inspect(){return`layer: ${this.layer}`}}}function P2(e,t){let n=typeof e=="number"?X.fromAngle(e):e.unit();return{id:"move",require:["pos"],update(){this.move(n.scale(t))}}}function I2(e={}){let t=!1,n=new Ee($(0),He(),Ue()),r=new Ee($(0),0,0),o=s=>{s.isOffScreen()?(t||(s.trigger("exitView"),t=!0),e.hide&&(s.hidden=!0),e.pause&&(s.paused=!0),e.destroy&&s.destroy()):(t&&(s.trigger("enterView"),t=!1),e.hide&&(s.hidden=!1),e.pause&&(s.paused=!1))};return{id:"offscreen",require:["pos"],offscreenDistance:e.distance??td,isOffScreen(){let s=this.screenPos();if(!s)return!1;if(n.width=He(),n.height=Ue(),!this.offscreenDistance&&this.width&&this.height)return r.width=this.width,r.height=this.height,r.pos=this.pos,r.collides(n);let i=this.offscreenDistance?this.offscreenDistance:td;return!Ei(n,s)&&n.sdistToPoint(s)>i*i},onExitScreen(s){return this.on("exitView",s)},onEnterScreen(s){return this.on("enterView",s)},add(){e.pause&&e.unpause?Kp(()=>o(this)):this.onUpdate(()=>o(this))}}}function Xs(...e){return{id:"pos",pos:$(...e),moveBy(...t){this.pos=this.pos.add($(...t))},move(...t){this.moveBy($(...t).scale(qe()))},moveTo(...t){if(typeof t[0]=="number"&&typeof t[1]=="number")return this.moveTo($(t[0],t[1]),t[2]);let n=t[0],r=t[1];if(r===void 0){this.pos=$(n);return}let o=n.sub(this.pos);if(o.len()<=r*qe()){this.pos=$(n);return}this.move(o.unit().scale(r))},worldPos(t=null){return t?(this.pos=this.pos.add(this.fromWorld(t)),null):this.parent?this.parent.transform.multVec2(this.pos):this.pos},toWorld(t){return this.parent?this.parent.transform.multVec2(this.pos.add(t)):this.pos.add(t)},fromWorld(t){return this.parent?this.parent.transform.invert().multVec2(t).sub(this.pos):t.sub(this.pos)},screenPos(t=null){if(t)return this.pos=this.pos.add(this.fromScreen(t)),null;{let n=this.worldPos();return n?Bn(this)?n:ol(n):null}},toScreen(t){let n=this.toWorld(t);return Bn(this)?n:ol(n)},fromScreen(t){return Bn(this)?this.fromWorld(t):this.fromWorld(rg(t))},toOther(t,n){return t.fromWorld(this.toWorld(n))},fromOther(t,n){return t.toOther(this,n)},inspect(){return`pos: (${Math.round(this.pos.x)}x, ${Math.round(this.pos.y)}y)`},drawInspect(){Br({color:we(255,0,0),radius:4/Rp()})}}}function N2(e){return{id:"rotate",angle:e??0,rotateBy(t){this.angle+=t},rotateTo(t){this.angle=t},inspect(){return`angle: ${Math.round(this.angle)}`}}}function Qs(...e){if(e.length===0)return Qs(1);let t=$(...e);return{id:"scale",set scale(n){if(!(n instanceof X))throw Error("The scale property on scale is a vector. Use scaleTo or scaleBy to set the scale with a number.");t=$(n)},get scale(){return t},scaleTo(...n){t=$(...n)},scaleBy(...n){t=t.scale($(...n))},inspect(){return t.x==t.y?`scale: ${t.x.toFixed(1)}x`:`scale: (${t.x.toFixed(1)}x, ${t.y.toFixed(1)}y)`}}}function T2(e){return{id:"z",z:e,inspect(){return`z: ${this.z}`}}}var _2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAACDCAYAAAB2kQxsAAAAAXNSR0IArs4c6QAABqxJREFUeJztnU1yFDkQRtMEB+AG7Fk6fBPO6ZsQLGc/N5gbMAtosJvqKv2kpPxS763A0W5XSXqVqZ+SngzgF58/fflx/7N///vnacW1gBkFD2Z2LOYNBF3Dx9UXAGs5kxLWwhNxU2qlJHrOhwLfkNZoiaBzIa3dCFJYLXgSboKXmETPeVDQyamR8vX55fe/v37/9vBzCDoH0tqktEpZ+t0IOh4KOBm16euZmETPtVDAiRgRLRF0HRRuEkrFrE1hzR4Lipxj+bD6AqCPz5++/Bgp5tXfdv1CeAdPPmFmSkn0nE+a0drdFm6XiOkdKWEuKRptTXqlLuqqFNaM6Dkb+T5nbb+npo8WjZVinqFantFJk9bWojaRThq7HzKN8wiPJ7aCoJHEZN5zHvJp7RE1DTV6SnZ1fa/PL1MjJtF5HmnT2tJF3GZ/BIj05I8ULUtR6ypER7ogjxpw61rRGxEal4KYjNyORzatbUlHSxr06tFcBTHPiN5NUEJWzlZKG/aKRqYk5tl1IKgPafucZ7w+vxSluLP6olHnL6MQQfYV6bpk/+BRZXm+cXHEiApSipZHlE6tRBDMkxmyysl5VsmtjXiFoJmiZU35ZWK0oNv1OY+omSv0GDDKJCaMI42cHg25dvFCi6QZxVS6ViVSpLUz38A4oiS9ySjlW2althGWKZrN6XNuOVpbwq0ReIzqZhfTrHwE/PZZuEYqcnqO0tZQGxVqRylprLGIEDXNkLOKEakbYsYiiphmiQaEZuD9BghixiKSmGYJIueqBt4TRZEyHtHENCNyNtMaRREzHhHFNBOKnKv7myVcVXKka4WfRBXTjMjpypl8iBmP6MsOmed0Bgk1UHjxXlpORIAWIqeybyGtha1QEdNMRM5s7wLCGpTENBORE6AXNTHNkBM2QFFMM4F5ToX5TYiLqphmRE7YmMhimiEnJEb9XBdJOUlp4Qp1Mc1E5QQ4I/qyvFJCy8n8JnijEjXNAi3fQ0TwIEM6e2OqnAgII8kkptkgOZEQZlN6BquZjqhVFxlBOkZq4Z6WASAFQQ8jZwQJ70FK8CTiaeb3fDSLJyMiwiwiS/q0SkwEBE+85jYjSTpcTiSE2WQRtVlOpAMVemVdtjXmlZxICFlQk/TJjHcmYS96JJ0p6KmcZggKeWmVdPopYwgKuxJVUuQE+EU0Sd99KYICxJH0ry9DUIA/rFy3WyWnGYLCnqyQ9PCXERTgmJmSPvwlBAU4p1bUWklPP1yytA9JYWdGRtLLDyEowDUjomiRwQgKUIZnJC3OgREUoByPSDpkDyEkBfhJj6RNQ7xEUYA6aiS9Cdo8SUoUBaijVtCuFQwICtBGiajdawARFKCNK0HdVtEjKUAd0+Q0q9v/FklhJ1rmP4e8JEoUBejfq2jYNgtEUdgJzwN7u6dSSkBQyMSME7O7FyHUQpoLCqw8rv5o+d6Uw3NvfzjagUkAZvOlLH1lLMyx8wCzWBEhW3ZDmLZ7NTsrwCpmyui5A1+IPidigjcjhZy14/vytBYxwRsPMVcf/2c2QU72wQUVIgj5lqFyIiZEJ5qQb1me1gLMJLKM93wY9cVETYiGkphmg+RETFhJljY2LHICQB/uchI1AXxwlRMxAfwgrYVtUHvxwk1OoiaAL8MjJ2ICtOEip1q6APnJEBS6VwiRzp4vtM5YBvf3m/EeI8DyvUZK33z4+v1bqsZ7dN+3n2W6zwgMO44hY0X1vIqkXh419x7lXh9ds8oyviFyRqmcXrxf2FUtF89ymFkG6nI2p7WZB4FGvUWfLcVt4ahsdy+TR7ifz6lc0F5v0GfalmXldpE3esrr6PrTR84sjNjS4kpQhQhaUi4lD6KR1xK9DHupfoKoR02vSFDy9FWNoKVivv1/lG7OfZkqR043OZUbWgmtFaomaGl51ZTHCnFv5bqNnFGjZvRtEFUEHSHmI1ZHWgVBXZ5+sxvX7ANlPChpjKsknSllKaPlRU4nZo0Yjq6wiIJGFPMML2mj3M8ZRRe4QkzF6FhCJEFbBn4i0iKswn11yenZiLLKeMRqQdWiZSmlkqrcV9d0gPfksAcqBW+2ZqAoq5gZGSrnTtGwlVmCIqUepxWxerj7iIyNZ7SgiKmJhJw7NJpRgiKmLuHl3KnReA4UIaU+y+WkcbzHQ1DEzMGQ9aJH0BDK6RE0y9wlTDp2HuppERQxc0FFBaZGUMTMB5UlQG/fHyk1odJEaBUUMXWh4oSoFRQxtaHyxMi2uBseQwUKciUoYuaAShTlkaCImQcqUph7QREzF/8DSS/2GZ2/N/sAAAAASUVORK5CYII=",k2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAACDCAYAAAB2kQxsAAAAAXNSR0IArs4c6QAABdRJREFUeJzt3d3N3TYMgGG16ADdoAhyl7UyV9bqXRB0g2zQXgRGDcOWSIoUaX3vAwQBknMk/4gWLcnHrQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACDEb9kb8FH99eeXf6Wf/efn35ynDyj1pEsb6G6NUxOYZ7sdB/QtPdnWRnn29gbKMYDUspPs0SgPb22cHANo/JG9AZF6wWBp3JLgeir36bvff3x9LOvzp2/dbSFA97bk5I4a9VMD7TXOUcP0uJ+d6emu5d6V1QvMs5nj8FZPx37X/b2TFpzShtnafeP0DipJMFnLnN3/w1OQ7tZgP+pA4VVKcHo0TG36KNULKGt5XsHZmi1APS5WM2Vqg0i7vbsG6YcIznN9vRTxXHavgdxtv6Tc3vc1pAHqdaG6ipwKYprpf1sFp6aH0gRTrxxLubPB2avHu+c/l3mICvqnsr//+Cq+qGrK1Xw/wzbBaRkNvSv3yew9cq+cu89L6nu6F/cMzCgzF1ftANlbe+Otp1IkDVxyVfbo6Z481f3507dhvXfbrk3HpdtjKTNqKuio8678c7mzF6ns6arfMyrVNoA75wMfNU2hKSeCx3Fq7dc+SPfDc39H9Vqn2CT//4bsYeT1PecOJyGSJdh6PZOlbElPZz2PHtlD1cUeS4LT4z5IOihwfNaD5ERm9qxH/dZ7Vmt9M999CtCZbdLUP/p3r2zFQ0paG8lr4Eb6+ZWBcSeq/qhyK6bXUfXOSgtO7/tOb9eT1NveqKttpYbiyXu/euV51JV16/T6e86zyF5TUp731V5Sp+Z7M71h9QvFNWWuvr0Sy4LzLfNvrel6zRX1e+hN2VzrnNlfaYD0xhCs++851lDh3vNV95xe6YvHgb8bwbNcuc+f09wbaUj2dzYgjz93//5kh94t0quCM8OKK6glKKuM0EYHfhUZWd8WwenZa0rLsp6s2YY66o0k9WUvS4NManBaGuo1eDIHgUZ1ePdkntsfFaCz5VZJdStsxyt7ziMNXHEAK5yk1mqmhrMPf1fcp57Vqe3SqZTMEduZhqAZyaywFne0DVHngHTZ11bznE88l/1lBZ9meP8851plWkBCO7drmQvWnL/sY/fKtFaqN3iy6iofsQxNktJnTMgfPXJUz3w3VaP5vOQ7Iyszvy2DczSi+aYFET2jINUEqFcAS4+rV480WlwRWXe07dLa0YGvfl9kmbTvPZJ1TXGvn4t4yuRp+2aMgk27wkm63DIztU3vOVfueC8wK4zKWtK0M+nvJXmOdlt65MgFFCva06qsKz044SvjIiN5TjLaaHxhtNyyouXBGZ1WSn66Ivt+M7pRZAWoZsDq+t2emeM1am/WtHxFG9runrO1/n1CxLK7CilxJM/H4bwuTJJBvWtgvm0gcNu01uvpd8la1soLE7xkpYDea4Ot6W3GOSzRc3o/qHw2M9qmXWA+uw+jbd0hyO9Yz0+vJ9QGcO/8ZV2YUqYVPN8dImXp3aJ/w1XTGGYfKZN+P7IXiXqO1uINLzFOm/Pz+BV4C03PNEqpZl//ELXP1ro8nhLyKLPHMyAiXyvh4cMFZ2uyAJXc62gzgJl1nhrSLMEzcLx+5qQnIhgqv6qhTHC2Zmus1tUuowCVDkRU6j0jgiJqhLPSSq2q7wMtMSBkdbcQWjNCq2nMlRrTnajAPP/t+c5Sj3K8VNueQ+pGzaa2MyOb2sZseW2dpL6ZnjMzfeQFt/Fe3XP2WIfGvRY6a569jCJ9TaIlcCS9KQE5p1TP2VrMbwLNDlZEvpE5AkGxh9f2nLO/QOetytIwAnMf6SfS2ns+jaZ6B4i2sWvSvF0HWOAj/aRGNFAaPXbw2rS2Rzr0T/ChshKNM3qd4135BCaqK9VAKy+lAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/4DBC0k0jFtF9wAAAAASUVORK5CYII=",D2=EE.version,C={k:null,globalOpt:null,gfx:null,game:null,app:null,assets:null,fontCacheCanvas:null,fontCacheC2d:null,debug:null,audio:null,pixelDensity:null,canvas:null,gscale:null,kaSprite:null,boomSprite:null},O2=(e={tagsAsComponents:!0})=>{C.k&&(console.warn("KAPLAY already initialized, you are calling kaplay() multiple times, it may lead bugs!"),C.k.quit()),C.globalOpt=e;let t=e.root??document.body;t===document.body&&(document.body.style.width="100%",document.body.style.height="100%",document.body.style.margin="0px",document.documentElement.style.width="100%",document.documentElement.style.height="100%");let n=e.canvas??t.appendChild(document.createElement("canvas"));C.canvas=n;let r=e.scale??1;C.gscale=r;let o=e.width&&e.height&&!e.stretch&&!e.letterbox;o?(n.width=e.width*r,n.height=e.height*r):(n.width=n.parentElement.offsetWidth,n.height=n.parentElement.offsetHeight);let s=["outline: none","cursor: default"];if(o){let J=n.width,re=n.height;s.push(`width: ${J}px`),s.push(`height: ${re}px`)}else s.push("width: 100%"),s.push("height: 100%");e.crisp&&(s.push("image-rendering: pixelated"),s.push("image-rendering: crisp-edges")),n.style.cssText=s.join(";");let i=e.pixelDensity||1;C.pixelDensity=i,n.width*=i,n.height*=i,n.tabIndex=0;let a=document.createElement("canvas");a.width=256,a.height=256,C.fontCacheCanvas=a;let l=a.getContext("2d",{willReadFrequently:!0});C.fontCacheC2d=l;let c=tM({canvas:n,touchToMouse:e.touchToMouse,gamepads:e.gamepads,pixelDensity:e.pixelDensity,maxFPS:e.maxFPS,buttons:e.buttons});C.app=c;let d=[],f=c.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0});if(!f)throw new Error("WebGL not supported");let u=f,h=WM(u,{texFilter:e.texFilter}),p=tC(e,h);C.gfx=p;let m=HC();C.audio=m;let g=PM(h,e.spriteAtlasPadding??0);C.assets=g;let y=BC();C.game=y,y.root.use(il());function b(J,re){let le=new Ws(h,J,re);return{clear:()=>le.clear(),free:()=>le.free(),toDataURL:()=>le.toDataURL(),toImageData:()=>le.toImageData(),width:le.width,height:le.height,draw:ce=>{ft(),le.bind(),ce(),ft(),le.unbind()},get fb(){return le}}}function w(){u.clear(u.COLOR_BUFFER_BIT),p.frameBuffer.bind(),u.clear(u.COLOR_BUFFER_BIT),p.bgColor||dn(()=>{Io({width:He(),height:Ue(),quad:new Ie(0,0,He()/64,Ue()/64),tex:p.bgTex,fixed:!0})}),p.renderer.numDraws=0,p.fixed=!1,p.transformStack.length=0,p.transform=new Ft}function E(J,re){p.postShader=J,p.postShaderUniform=re??null}function P(){ft(),p.lastDrawCalls=p.renderer.numDraws,p.frameBuffer.unbind(),u.viewport(0,0,u.drawingBufferWidth,u.drawingBufferHeight);let J=p.width,re=p.height;p.width=u.drawingBufferWidth/i,p.height=u.drawingBufferHeight/i,Ys({flipY:!0,tex:p.frameBuffer.tex,pos:new X(p.viewport.x,p.viewport.y),width:p.viewport.width,height:p.viewport.height,shader:p.postShader,uniform:typeof p.postShaderUniform=="function"?p.postShaderUniform():p.postShaderUniform,fixed:!0}),ft(),p.width=J,p.height=re}let A=!1,v={inspect:!1,set timeScale(J){C.app.state.timeScale=J},get timeScale(){return C.app.state.timeScale},showLog:!0,fps:()=>c.fps(),numFrames:()=>c.numFrames(),stepFrame:Y,drawCalls:()=>p.lastDrawCalls,clearLog:()=>y.logs=[],log:(...J)=>{let re=e.logMax??8,le=J.length>1?J.concat(" ").join(" "):J[0];y.logs.unshift({msg:le,time:c.time()}),y.logs.length>re&&(y.logs=y.logs.slice(0,re))},error:J=>v.log(new Error(J.toString?J.toString():J)),curRecording:null,numObjects:()=>I("*",{recursive:!0}).length,get paused(){return A},set paused(J){A=J,J?m.ctx.suspend():m.ctx.resume()}};C.debug=v;function M(J,re){try{return JSON.parse(window.localStorage[J])}catch{return re?(N(J,re),re):null}}function N(J,re){window.localStorage[J]=JSON.stringify(re)}function _(J,...re){let le=J(oe),ce;typeof le=="function"?ce=le(...re)(oe):ce=le;for(let me in ce)oe[me]=ce[me],e.global!==!1&&(window[me]=ce[me]);return oe}function D(J){let re=c.canvas.captureStream(J),le=m.ctx.createMediaStreamDestination();m.masterNode.connect(le);let ce=new MediaRecorder(re),me=[];return ce.ondataavailable=de=>{de.data.size>0&&me.push(de.data)},ce.onerror=()=>{m.masterNode.disconnect(le),re.getTracks().forEach(de=>de.stop())},ce.start(),{resume(){ce.resume()},pause(){ce.pause()},stop(){return ce.stop(),m.masterNode.disconnect(le),re.getTracks().forEach(de=>de.stop()),new Promise(de=>{ce.onstop=()=>{de(new Blob(me,{type:"video/mp4"}))}})},download(de="kaboom.mp4"){this.stop().then(be=>nd(de,be))}}}function B(){return document.activeElement===c.canvas}let j=y.root.add.bind(y.root),R=y.root.readd.bind(y.root),O=y.root.removeAll.bind(y.root),I=y.root.get.bind(y.root),k=y.root.wait.bind(y.root),F=y.root.loop.bind(y.root),T=y.root.query.bind(y.root),z=y.root.tween.bind(y.root),V=co(null,k2),U=co(null,_2);C.kaSprite=V,C.boomSprite=U;function K(){y.root.fixedUpdate()}function Y(){y.root.update()}class ee{constructor(re,le,ce,me,de=!1){H(this,"source");H(this,"target");H(this,"normal");H(this,"distance");H(this,"resolved",!1);this.source=re,this.target=le,this.normal=ce,this.distance=me,this.resolved=de}get displacement(){return this.normal.scale(this.distance)}reverse(){return new ee(this.target,this.source,this.normal.scale(-1),this.distance,this.resolved)}hasOverlap(){return!this.displacement.isZero()}isLeft(){return this.displacement.cross(y.gravity||$(0,1))>0}isRight(){return this.displacement.cross(y.gravity||$(0,1))<0}isTop(){return this.displacement.dot(y.gravity||$(0,1))>0}isBottom(){return this.displacement.dot(y.gravity||$(0,1))<0}preventResolution(){this.resolved=!0}}function Z(){if(!m2())return;let J={},re=e.hashGridSize||64,le=new Ft,ce=[];function me(de){if(ce.push(le.clone()),de.pos&&le.translate(de.pos),de.scale&&le.scale(de.scale),de.angle&&le.rotate(de.angle),de.transform=le.clone(),de.c("area")&&!de.paused){let be=de,ze=be.worldArea().bbox(),Xe=Math.floor(ze.pos.x/re),lt=Math.floor(ze.pos.y/re),wt=Math.ceil((ze.pos.x+ze.width)/re),Cn=Math.ceil((ze.pos.y+ze.height)/re),xt=new Set;for(let Le=Xe;Le<=wt;Le++)for(let Qe=lt;Qe<=Cn;Qe++)if(!J[Le])J[Le]={},J[Le][Qe]=[be];else if(!J[Le][Qe])J[Le][Qe]=[be];else{let nr=J[Le][Qe];e:for(let Be of nr){if(Be.paused||!Be.exists()||xt.has(Be.id))continue;for(let vt of be.collisionIgnore)if(Be.is(vt))continue e;for(let vt of Be.collisionIgnore)if(be.is(vt))continue e;let Rn=uS(be.worldArea(),Be.worldArea());if(Rn){let vt=new ee(be,Be,Rn.normal,Rn.distance);be.trigger("collideUpdate",Be,vt);let rr=vt.reverse();rr.resolved=vt.resolved,Be.trigger("collideUpdate",be,rr)}xt.add(Be.id)}nr.push(be)}}de.children.forEach(me),le=ce.pop()}me(y.root)}function q(J){console.error(J),m.ctx.suspend();let re=J.message??String(J)??"Unknown error, check console for more info";c.run(()=>{},()=>{w(),dn(()=>{let le=He(),ce=Ue(),me={size:36,width:le-32*2,letterSpacing:4,lineSpacing:4,font:Gs,fixed:!0};ht({width:le,height:ce,color:we(0,0,255),fixed:!0});let de=$n({...me,text:"Error",pos:$(32),color:we(255,128,0),fixed:!0});Gn(de),fd({...me,text:re,pos:$(32,32+de.height+16),fixed:!0}),tt(),y.events.trigger("error",J)}),P()})}function W(J){d.push(J)}function te(){y.events.onOnce("frameEnd",()=>{c.quit(),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT|u.STENCIL_BUFFER_BIT);let J=u.getParameter(u.MAX_TEXTURE_IMAGE_UNITS);for(let re=0;re<J;re++)u.activeTexture(u.TEXTURE0+re),u.bindTexture(u.TEXTURE_2D,null),u.bindTexture(u.TEXTURE_CUBE_MAP,null);u.bindBuffer(u.ARRAY_BUFFER,null),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,null),u.bindRenderbuffer(u.RENDERBUFFER,null),u.bindFramebuffer(u.FRAMEBUFFER,null),h.destroy(),d.forEach(re=>re())})}let se=!0;c.run(()=>{try{g.loaded&&(v.paused||K(),Z())}catch(J){q(J)}},(J,re)=>{try{J(),g.loaded||Un()===1&&!se&&(g.loaded=!0,Ip().forEach(le=>y.events.trigger("loadError",...le)),y.events.trigger("load")),!g.loaded&&e.loadingScreen!==!1||se?(w(),QM(),P()):(v.paused||Y(),Z(),w(),XM(),e.debug!==!1&&YM(),P()),se&&(se=!1),y.events.trigger("frameEnd"),re()}catch(le){q(le)}}),Cp(),ag();let oe={_k:C,VERSION:D2,loadRoot:MM,loadProgress:Un,loadSprite:co,loadSpriteAtlas:Bp,loadSound:zM,loadMusic:HM,loadBitmapFont:DM,loadFont:_M,loadShader:FM,loadShaderURL:jM,loadAseprite:TM,loadPedit:OM,loadBean:NM,loadJSON:CM,load:tl,getSound:Lp,getFont:kp,getBitmapFont:Dp,getSprite:Np,getShader:Op,getAsset:RM,Asset:yt,SpriteData:wn,SoundData:Po,width:He,height:Ue,center:Ks,dt:qe,fixedDt:Ja,restDt:el,time:c.time,screenshot:c.screenshot,record:D,isFocused:B,setCursor:c.setCursor,getCursor:c.getCursor,setCursorLocked:c.setCursorLocked,isCursorLocked:c.isCursorLocked,setFullscreen:c.setFullscreen,isFullscreen:c.isFullscreen,isTouchscreen:c.isTouchscreen,onLoad:nc,onLoadError:IC,onLoading:CC,onResize:RC,onGamepadConnect:c.onGamepadConnect,onGamepadDisconnect:c.onGamepadDisconnect,onError:PC,onCleanup:W,flash:ng,setCamPos:Xp,getCamPos:Qp,setCamRot:eg,getCamRot:tg,setCamScale:Zp,getCamScale:Jp,getCamTransform:NC,camPos:kC,camScale:DC,camFlash:LC,camRot:OC,camTransform:TC,shake:_C,toScreen:ol,toWorld:rg,setGravity:FC,getGravity:jC,setGravityDirection:qC,getGravityDirection:uo,setBackground:xM,getBackground:vM,getGamepads:c.getGamepads,getTreeRoot:XC,add:j,make:rc,destroy:cg,destroyAll:O,get:I,query:T,readd:R,pos:Xs,scale:Qs,rotate:N2,color:Vp,opacity:Up,anchor:ll,area:y2,sprite:sl,text:t2,polygon:cC,rect:Gp,circle:nC,uvquad:n2,outline:iC,particles:lC,body:w2,platformEffector:S2,surfaceEffector:v2,areaEffector:b2,pointEffector:A2,buoyancyEffector:M2,constantForce:E2,doubleJump:x2,shader:uC,textInput:g2,timer:il,fixed:hg,stay:fg,health:d2,lifespan:f2,named:h2,state:p2,z:T2,layer:R2,move:P2,offscreen:I2,follow:C2,fadeIn:oC,mask:sC,drawon:rC,raycast:$p,tile:ug,animate:u2,serializeAnimation:dg,agent:r2,sentry:i2,patrol:s2,pathfinder:o2,trigger:fC,on:at,onFixedUpdate:hC,onUpdate:Kp,onDraw:pC,onAdd:Wp,onDestroy:gC,onTag:Yp,onUntag:wC,onUse:mC,onUnuse:yC,onClick:AC,onCollide:xC,onCollideUpdate:vC,onCollideEnd:bC,onHover:EC,onHoverUpdate:SC,onHoverEnd:MC,onKeyDown:c.onKeyDown,onKeyPress:c.onKeyPress,onKeyPressRepeat:c.onKeyPressRepeat,onKeyRelease:c.onKeyRelease,onMouseDown:c.onMouseDown,onMousePress:c.onMousePress,onMouseRelease:c.onMouseRelease,onMouseMove:c.onMouseMove,onCharInput:c.onCharInput,onTouchStart:c.onTouchStart,onTouchMove:c.onTouchMove,onTouchEnd:c.onTouchEnd,onScroll:c.onScroll,onHide:c.onHide,onShow:c.onShow,onGamepadButtonDown:c.onGamepadButtonDown,onGamepadButtonPress:c.onGamepadButtonPress,onGamepadButtonRelease:c.onGamepadButtonRelease,onGamepadStick:c.onGamepadStick,onButtonPress:c.onButtonPress,onButtonDown:c.onButtonDown,onButtonRelease:c.onButtonRelease,mousePos:c.mousePos,mouseDeltaPos:c.mouseDeltaPos,isKeyDown:c.isKeyDown,isKeyPressed:c.isKeyPressed,isKeyPressedRepeat:c.isKeyPressedRepeat,isKeyReleased:c.isKeyReleased,isMouseDown:c.isMouseDown,isMousePressed:c.isMousePressed,isMouseReleased:c.isMouseReleased,isMouseMoved:c.isMouseMoved,isGamepadButtonPressed:c.isGamepadButtonPressed,isGamepadButtonDown:c.isGamepadButtonDown,isGamepadButtonReleased:c.isGamepadButtonReleased,getGamepadStick:c.getGamepadStick,isButtonPressed:c.isButtonPressed,isButtonDown:c.isButtonDown,isButtonReleased:c.isButtonReleased,setButton:c.setButton,getButton:c.getButton,pressButton:c.pressButton,releaseButton:c.releaseButton,getLastInputDeviceType:c.getLastInputDeviceType,charInputted:c.charInputted,loop:F,wait:k,play:UC,setVolume:sg,getVolume:ig,volume:$C,burp:og,audioCtx:m.ctx,Line:it,Rect:Ee,Circle:st,Ellipse:rn,Point:GE,Polygon:Ye,Vec2:X,Color:pe,Mat4:Ft,Quad:Ie,RNG:np,rand:je,randi:rp,randSeed:PE,vec2:$,rgb:we,hsl2rgb:SE,quad:ke,choose:TE,chooseMultiple:NE,shuffle:op,chance:IE,lerp:nt,tween:z,easings:Co,map:Ot,mapc:ME,wave:tp,deg2rad:De,rad2deg:Vn,clamp:Bt,evaluateQuadratic:WE,evaluateQuadraticFirstDerivative:YE,evaluateQuadraticSecondDerivative:XE,evaluateBezier:Wl,evaluateBezierFirstDerivative:QE,evaluateBezierSecondDerivative:ZE,evaluateCatmullRom:JE,evaluateCatmullRomFirstDerivative:eS,curveLengthApproximation:pp,normalizedCurve:tS,hermite:qo,cardinal:gp,catmullRom:$s,bezier:nS,kochanekBartels:rS,easingSteps:cS,easingLinear:aS,easingCubicBezier:lS,testLineLine:Hl,testRectRect:sp,testRectLine:Vl,testRectPoint:Ei,testCirclePolygon:Mi,testLinePoint:Ul,testLineCircle:jo,isConvex:gS,triangulate:yp,NavMesh:yM,drawSprite:JM,drawText:fd,formatText:$n,drawRect:ht,drawLine:no,drawLines:tc,drawTriangle:zp,drawCircle:Br,drawEllipse:Fp,drawUVQuad:Io,drawPolygon:hn,drawCurve:jp,drawBezier:GM,drawFormattedText:Gn,drawMasked:ZM,drawSubtracted:eC,pushTransform:dt,popTransform:tt,pushTranslate:Te,pushScale:Ro,pushRotate:Tr,pushMatrix:bM,usePostEffect:E,makeCanvas:b,debug:v,scene:QC,getSceneName:e2,go:ZC,onSceneLeave:JC,layers:YC,getLayers:KC,setLayers:lg,getDefaultLayer:WC,addLevel:dC,getData:M,setData:N,download:Xl,downloadJSON:TS,downloadText:Sp,downloadBlob:nd,plug:_,ASCII_CHARS:wp,canvas:c.canvas,addKaboom:GC,LEFT:X.LEFT,RIGHT:X.RIGHT,UP:X.UP,DOWN:X.DOWN,RED:pe.RED,GREEN:pe.GREEN,BLUE:pe.BLUE,YELLOW:pe.YELLOW,MAGENTA:pe.MAGENTA,CYAN:pe.CYAN,WHITE:pe.WHITE,BLACK:pe.BLACK,quit:te,KEvent:We,KEventHandler:Mo,KEventController:Zn,cancel:()=>vp};C.k=oe;let ne=e.plugins;if(ne&&ne.forEach(_),e.global!==!1)for(let J in oe)window[J]=oe[J];return e.focus!==!1&&c.canvas.focus(),oe},L2=O2;let cs;function sc(e){return cs||(cs=L2({global:!1,pixelDensity:2,touchToMouse:!0,debug:!1,debugKey:"f1",canvas:e}),cs)}let gd=!0;function B2(e){if(!gd)return;gd=!1;const t=sc(e),n=ep.getState().setKeyPressed;t.onKeyDown(s=>{n(s,!0)}),t.onKeyRelease(s=>{n(s,!1)});const r=Hs.getState().setTime,o=Hs.getState().setDeltaTime;return t.onUpdate(()=>{const s=t.time(),i=t.dt();r(s),o(i),fr.getState().compute()}),t}const gn=Ai(e=>({nodeData:new Map,gameData:new Map,setNodeData:(t,n,r)=>e(o=>(o.nodeData.set(t,{handleId:n,value:r}),o)),transferData:()=>e(t=>({gameData:new Map(t.nodeData)}))})),F2=()=>{const e=sc();e.loadBean();const t=e.add([e.sprite("bean"),e.color(0,0,255),e.pos(100,e.height()-100)]);e.add([e.rect(e.width(),5),e.pos(0,e.height()-5),e.color(255,200,200),e.area(),e.body({isStatic:!0}),"floor"]),e.onUpdate(()=>{var o,s;const n=((o=gn.getState().nodeData.get("xpos"))==null?void 0:o.value)??0,r=((s=gn.getState().nodeData.get("ypos"))==null?void 0:s.value)??0;t.pos.x=n,t.pos.y=r,gn.getState().transferData()})},j2=3e3,q2=()=>{const e=sc();e.loadBean();const t=e.add([e.sprite("bean"),e.pos(20,130)]),n=e.add([e.sprite("bean"),e.color(0,0,0),e.pos(400,400),e.scale(.5),e.area()]);n.tag("trashCan"),e.add([e.sprite("bean"),e.color(255,0,0),e.pos(600,100),e.scale(4,.5),e.area()]).tag("finishLine"),e.onCollide("trashCan","finishLine",(o,s)=>{console.log("Collided with finish line")}),e.onUpdate(()=>{var i,a;t.move(j2*e.dt(),0);const o=((i=gn.getState().nodeData.get("xpos"))==null?void 0:i.value)??0,s=((a=gn.getState().nodeData.get("ypos"))==null?void 0:a.value)??0;n.pos.x=o,n.pos.y=s,gn.getState().transferData()})},md={playground:{name:"Playground",description:"This is a playground level where you can test your game mechanics.",category:"Sandbox",image:"",nodes:[],edges:[],initialState:F2,solution:{nodes:[],edges:[]},hints:[]},"1.1":{name:"Level 1.1",description:"This is the first level of the game. It introduces the basic mechanics and objectives.",category:"Introduction",image:"",nodes:[],edges:[],initialState:q2,solution:{nodes:[],edges:[]},hints:[]}},z2=e=>{if(!(e in md))throw new Error(`Level ${e} not found`);md[e].initialState()};function ic(e){const t=e+"CollectionProvider",[n,r]=Dr(t),[o,s]=n(t,{collectionRef:{current:null},itemMap:new Map}),i=m=>{const{scope:g,children:y}=m,b=St.useRef(null),w=St.useRef(new Map).current;return S.jsx(o,{scope:g,itemMap:w,collectionRef:b,children:y})};i.displayName=t;const a=e+"CollectionSlot",l=Rs(a),c=St.forwardRef((m,g)=>{const{scope:y,children:b}=m,w=s(a,y),E=Ce(g,w.collectionRef);return S.jsx(l,{ref:E,children:b})});c.displayName=a;const d=e+"CollectionItemSlot",f="data-radix-collection-item",u=Rs(d),h=St.forwardRef((m,g)=>{const{scope:y,children:b,...w}=m,E=St.useRef(null),P=Ce(g,E),A=s(d,y);return St.useEffect(()=>(A.itemMap.set(E,{ref:E,...w}),()=>void A.itemMap.delete(E))),S.jsx(u,{[f]:"",ref:P,children:b})});h.displayName=d;function p(m){const g=s(e+"CollectionConsumer",m);return St.useCallback(()=>{const b=g.collectionRef.current;if(!b)return[];const w=Array.from(b.querySelectorAll(`[${f}]`));return Array.from(g.itemMap.values()).sort((A,v)=>w.indexOf(A.ref.current)-w.indexOf(v.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:i,Slot:c,ItemSlot:h},p,r]}var H2=x.createContext(void 0);function ac(e){const t=x.useContext(H2);return e||t||"ltr"}function qt(e){const t=x.useRef(e);return x.useEffect(()=>{t.current=e}),x.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function V2(e,t=globalThis==null?void 0:globalThis.document){const n=qt(e);x.useEffect(()=>{const r=o=>{o.key==="Escape"&&n(o)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var U2="DismissableLayer",cl="dismissableLayer.update",$2="dismissableLayer.pointerDownOutside",G2="dismissableLayer.focusOutside",yd,pg=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),lc=x.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:s,onInteractOutside:i,onDismiss:a,...l}=e,c=x.useContext(pg),[d,f]=x.useState(null),u=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=x.useState({}),p=Ce(t,v=>f(v)),m=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=m.indexOf(g),b=d?m.indexOf(d):-1,w=c.layersWithOutsidePointerEventsDisabled.size>0,E=b>=y,P=Y2(v=>{const M=v.target,N=[...c.branches].some(_=>_.contains(M));!E||N||(o==null||o(v),i==null||i(v),v.defaultPrevented||a==null||a())},u),A=X2(v=>{const M=v.target;[...c.branches].some(_=>_.contains(M))||(s==null||s(v),i==null||i(v),v.defaultPrevented||a==null||a())},u);return V2(v=>{b===c.layers.size-1&&(r==null||r(v),!v.defaultPrevented&&a&&(v.preventDefault(),a()))},u),x.useEffect(()=>{if(d)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(yd=u.body.style.pointerEvents,u.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),wd(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(u.body.style.pointerEvents=yd)}},[d,u,n,c]),x.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),wd())},[d,c]),x.useEffect(()=>{const v=()=>h({});return document.addEventListener(cl,v),()=>document.removeEventListener(cl,v)},[]),S.jsx(xe.div,{...l,ref:p,style:{pointerEvents:w?E?"auto":"none":void 0,...e.style},onFocusCapture:ue(e.onFocusCapture,A.onFocusCapture),onBlurCapture:ue(e.onBlurCapture,A.onBlurCapture),onPointerDownCapture:ue(e.onPointerDownCapture,P.onPointerDownCapture)})});lc.displayName=U2;var K2="DismissableLayerBranch",W2=x.forwardRef((e,t)=>{const n=x.useContext(pg),r=x.useRef(null),o=Ce(t,r);return x.useEffect(()=>{const s=r.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),S.jsx(xe.div,{...e,ref:o})});W2.displayName=K2;function Y2(e,t=globalThis==null?void 0:globalThis.document){const n=qt(e),r=x.useRef(!1),o=x.useRef(()=>{});return x.useEffect(()=>{const s=a=>{if(a.target&&!r.current){let l=function(){gg($2,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",o.current),o.current=l,t.addEventListener("click",o.current,{once:!0})):l()}else t.removeEventListener("click",o.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",s),t.removeEventListener("click",o.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function X2(e,t=globalThis==null?void 0:globalThis.document){const n=qt(e),r=x.useRef(!1);return x.useEffect(()=>{const o=s=>{s.target&&!r.current&&gg(G2,n,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",o),()=>t.removeEventListener("focusin",o)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function wd(){const e=new CustomEvent(cl);document.dispatchEvent(e)}function gg(e,t,n,{discrete:r}){const o=n.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?$d(o,s):o.dispatchEvent(s)}var pa=0;function mg(){x.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??xd()),document.body.insertAdjacentElement("beforeend",e[1]??xd()),pa++,()=>{pa===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),pa--}},[])}function xd(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var ga="focusScope.autoFocusOnMount",ma="focusScope.autoFocusOnUnmount",vd={bubbles:!1,cancelable:!0},Q2="FocusScope",cc=x.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:s,...i}=e,[a,l]=x.useState(null),c=qt(o),d=qt(s),f=x.useRef(null),u=Ce(t,m=>l(m)),h=x.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;x.useEffect(()=>{if(r){let m=function(w){if(h.paused||!a)return;const E=w.target;a.contains(E)?f.current=E:an(f.current,{select:!0})},g=function(w){if(h.paused||!a)return;const E=w.relatedTarget;E!==null&&(a.contains(E)||an(f.current,{select:!0}))},y=function(w){if(document.activeElement===document.body)for(const P of w)P.removedNodes.length>0&&an(a)};document.addEventListener("focusin",m),document.addEventListener("focusout",g);const b=new MutationObserver(y);return a&&b.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",g),b.disconnect()}}},[r,a,h.paused]),x.useEffect(()=>{if(a){Ad.add(h);const m=document.activeElement;if(!a.contains(m)){const y=new CustomEvent(ga,vd);a.addEventListener(ga,c),a.dispatchEvent(y),y.defaultPrevented||(Z2(rR(yg(a)),{select:!0}),document.activeElement===m&&an(a))}return()=>{a.removeEventListener(ga,c),setTimeout(()=>{const y=new CustomEvent(ma,vd);a.addEventListener(ma,d),a.dispatchEvent(y),y.defaultPrevented||an(m??document.body,{select:!0}),a.removeEventListener(ma,d),Ad.remove(h)},0)}}},[a,c,d,h]);const p=x.useCallback(m=>{if(!n&&!r||h.paused)return;const g=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,y=document.activeElement;if(g&&y){const b=m.currentTarget,[w,E]=J2(b);w&&E?!m.shiftKey&&y===E?(m.preventDefault(),n&&an(w,{select:!0})):m.shiftKey&&y===w&&(m.preventDefault(),n&&an(E,{select:!0})):y===b&&m.preventDefault()}},[n,r,h.paused]);return S.jsx(xe.div,{tabIndex:-1,...i,ref:u,onKeyDown:p})});cc.displayName=Q2;function Z2(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(an(r,{select:t}),document.activeElement!==n)return}function J2(e){const t=yg(e),n=bd(t,e),r=bd(t.reverse(),e);return[n,r]}function yg(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function bd(e,t){for(const n of e)if(!eR(n,{upTo:t}))return n}function eR(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function tR(e){return e instanceof HTMLInputElement&&"select"in e}function an(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&tR(e)&&t&&e.select()}}var Ad=nR();function nR(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=Ed(e,t),e.unshift(t)},remove(t){var n;e=Ed(e,t),(n=e[0])==null||n.resume()}}}function Ed(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function rR(e){return e.filter(t=>t.tagName!=="A")}const oR=["top","right","bottom","left"],xn=Math.min,Je=Math.max,Zs=Math.round,us=Math.floor,jt=e=>({x:e,y:e}),sR={left:"right",right:"left",bottom:"top",top:"bottom"},iR={start:"end",end:"start"};function ul(e,t,n){return Je(e,xn(t,n))}function Jt(e,t){return typeof e=="function"?e(t):e}function en(e){return e.split("-")[0]}function Fr(e){return e.split("-")[1]}function uc(e){return e==="x"?"y":"x"}function dc(e){return e==="y"?"height":"width"}function vn(e){return["top","bottom"].includes(en(e))?"y":"x"}function fc(e){return uc(vn(e))}function aR(e,t,n){n===void 0&&(n=!1);const r=Fr(e),o=fc(e),s=dc(o);let i=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(i=Js(i)),[i,Js(i)]}function lR(e){const t=Js(e);return[dl(e),t,dl(t)]}function dl(e){return e.replace(/start|end/g,t=>iR[t])}function cR(e,t,n){const r=["left","right"],o=["right","left"],s=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?o:r:t?r:o;case"left":case"right":return t?s:i;default:return[]}}function uR(e,t,n,r){const o=Fr(e);let s=cR(en(e),n==="start",r);return o&&(s=s.map(i=>i+"-"+o),t&&(s=s.concat(s.map(dl)))),s}function Js(e){return e.replace(/left|right|bottom|top/g,t=>sR[t])}function dR(e){return{top:0,right:0,bottom:0,left:0,...e}}function wg(e){return typeof e!="number"?dR(e):{top:e,right:e,bottom:e,left:e}}function ei(e){const{x:t,y:n,width:r,height:o}=e;return{width:r,height:o,top:n,left:t,right:t+r,bottom:n+o,x:t,y:n}}function Sd(e,t,n){let{reference:r,floating:o}=e;const s=vn(t),i=fc(t),a=dc(i),l=en(t),c=s==="y",d=r.x+r.width/2-o.width/2,f=r.y+r.height/2-o.height/2,u=r[a]/2-o[a]/2;let h;switch(l){case"top":h={x:d,y:r.y-o.height};break;case"bottom":h={x:d,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:f};break;case"left":h={x:r.x-o.width,y:f};break;default:h={x:r.x,y:r.y}}switch(Fr(t)){case"start":h[i]-=u*(n&&c?-1:1);break;case"end":h[i]+=u*(n&&c?-1:1);break}return h}const fR=async(e,t,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:s=[],platform:i}=n,a=s.filter(Boolean),l=await(i.isRTL==null?void 0:i.isRTL(t));let c=await i.getElementRects({reference:e,floating:t,strategy:o}),{x:d,y:f}=Sd(c,r,l),u=r,h={},p=0;for(let m=0;m<a.length;m++){const{name:g,fn:y}=a[m],{x:b,y:w,data:E,reset:P}=await y({x:d,y:f,initialPlacement:r,placement:u,strategy:o,middlewareData:h,rects:c,platform:i,elements:{reference:e,floating:t}});d=b??d,f=w??f,h={...h,[g]:{...h[g],...E}},P&&p<=50&&(p++,typeof P=="object"&&(P.placement&&(u=P.placement),P.rects&&(c=P.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:o}):P.rects),{x:d,y:f}=Sd(c,u,l)),m=-1)}return{x:d,y:f,placement:u,strategy:o,middlewareData:h}};async function No(e,t){var n;t===void 0&&(t={});const{x:r,y:o,platform:s,rects:i,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:f="floating",altBoundary:u=!1,padding:h=0}=Jt(t,e),p=wg(h),g=a[u?f==="floating"?"reference":"floating":f],y=ei(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(g)))==null||n?g:g.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:d,strategy:l})),b=f==="floating"?{x:r,y:o,width:i.floating.width,height:i.floating.height}:i.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),E=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},P=ei(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:w,strategy:l}):b);return{top:(y.top-P.top+p.top)/E.y,bottom:(P.bottom-y.bottom+p.bottom)/E.y,left:(y.left-P.left+p.left)/E.x,right:(P.right-y.right+p.right)/E.x}}const hR=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:o,rects:s,platform:i,elements:a,middlewareData:l}=t,{element:c,padding:d=0}=Jt(e,t)||{};if(c==null)return{};const f=wg(d),u={x:n,y:r},h=fc(o),p=dc(h),m=await i.getDimensions(c),g=h==="y",y=g?"top":"left",b=g?"bottom":"right",w=g?"clientHeight":"clientWidth",E=s.reference[p]+s.reference[h]-u[h]-s.floating[p],P=u[h]-s.reference[h],A=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c));let v=A?A[w]:0;(!v||!await(i.isElement==null?void 0:i.isElement(A)))&&(v=a.floating[w]||s.floating[p]);const M=E/2-P/2,N=v/2-m[p]/2-1,_=xn(f[y],N),D=xn(f[b],N),B=_,j=v-m[p]-D,R=v/2-m[p]/2+M,O=ul(B,R,j),I=!l.arrow&&Fr(o)!=null&&R!==O&&s.reference[p]/2-(R<B?_:D)-m[p]/2<0,k=I?R<B?R-B:R-j:0;return{[h]:u[h]+k,data:{[h]:O,centerOffset:R-O-k,...I&&{alignmentOffset:k}},reset:I}}}),pR=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:o,middlewareData:s,rects:i,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:d=!0,crossAxis:f=!0,fallbackPlacements:u,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=Jt(e,t);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const y=en(o),b=vn(a),w=en(a)===a,E=await(l.isRTL==null?void 0:l.isRTL(c.floating)),P=u||(w||!m?[Js(a)]:lR(a)),A=p!=="none";!u&&A&&P.push(...uR(a,m,p,E));const v=[a,...P],M=await No(t,g),N=[];let _=((r=s.flip)==null?void 0:r.overflows)||[];if(d&&N.push(M[y]),f){const R=aR(o,i,E);N.push(M[R[0]],M[R[1]])}if(_=[..._,{placement:o,overflows:N}],!N.every(R=>R<=0)){var D,B;const R=(((D=s.flip)==null?void 0:D.index)||0)+1,O=v[R];if(O)return{data:{index:R,overflows:_},reset:{placement:O}};let I=(B=_.filter(k=>k.overflows[0]<=0).sort((k,F)=>k.overflows[1]-F.overflows[1])[0])==null?void 0:B.placement;if(!I)switch(h){case"bestFit":{var j;const k=(j=_.filter(F=>{if(A){const T=vn(F.placement);return T===b||T==="y"}return!0}).map(F=>[F.placement,F.overflows.filter(T=>T>0).reduce((T,z)=>T+z,0)]).sort((F,T)=>F[1]-T[1])[0])==null?void 0:j[0];k&&(I=k);break}case"initialPlacement":I=a;break}if(o!==I)return{reset:{placement:I}}}return{}}}};function Md(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Cd(e){return oR.some(t=>e[t]>=0)}const gR=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...o}=Jt(e,t);switch(r){case"referenceHidden":{const s=await No(t,{...o,elementContext:"reference"}),i=Md(s,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:Cd(i)}}}case"escaped":{const s=await No(t,{...o,altBoundary:!0}),i=Md(s,n.floating);return{data:{escapedOffsets:i,escaped:Cd(i)}}}default:return{}}}}};async function mR(e,t){const{placement:n,platform:r,elements:o}=e,s=await(r.isRTL==null?void 0:r.isRTL(o.floating)),i=en(n),a=Fr(n),l=vn(n)==="y",c=["left","top"].includes(i)?-1:1,d=s&&l?-1:1,f=Jt(t,e);let{mainAxis:u,crossAxis:h,alignmentAxis:p}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),l?{x:h*d,y:u*c}:{x:u*c,y:h*d}}const yR=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:o,y:s,placement:i,middlewareData:a}=t,l=await mR(t,e);return i===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:o+l.x,y:s+l.y,data:{...l,placement:i}}}}},wR=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,{mainAxis:s=!0,crossAxis:i=!1,limiter:a={fn:g=>{let{x:y,y:b}=g;return{x:y,y:b}}},...l}=Jt(e,t),c={x:n,y:r},d=await No(t,l),f=vn(en(o)),u=uc(f);let h=c[u],p=c[f];if(s){const g=u==="y"?"top":"left",y=u==="y"?"bottom":"right",b=h+d[g],w=h-d[y];h=ul(b,h,w)}if(i){const g=f==="y"?"top":"left",y=f==="y"?"bottom":"right",b=p+d[g],w=p-d[y];p=ul(b,p,w)}const m=a.fn({...t,[u]:h,[f]:p});return{...m,data:{x:m.x-n,y:m.y-r,enabled:{[u]:s,[f]:i}}}}}},xR=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:o,rects:s,middlewareData:i}=t,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Jt(e,t),d={x:n,y:r},f=vn(o),u=uc(f);let h=d[u],p=d[f];const m=Jt(a,t),g=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const w=u==="y"?"height":"width",E=s.reference[u]-s.floating[w]+g.mainAxis,P=s.reference[u]+s.reference[w]-g.mainAxis;h<E?h=E:h>P&&(h=P)}if(c){var y,b;const w=u==="y"?"width":"height",E=["top","left"].includes(en(o)),P=s.reference[f]-s.floating[w]+(E&&((y=i.offset)==null?void 0:y[f])||0)+(E?0:g.crossAxis),A=s.reference[f]+s.reference[w]+(E?0:((b=i.offset)==null?void 0:b[f])||0)-(E?g.crossAxis:0);p<P?p=P:p>A&&(p=A)}return{[u]:h,[f]:p}}}},vR=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:o,rects:s,platform:i,elements:a}=t,{apply:l=()=>{},...c}=Jt(e,t),d=await No(t,c),f=en(o),u=Fr(o),h=vn(o)==="y",{width:p,height:m}=s.floating;let g,y;f==="top"||f==="bottom"?(g=f,y=u===(await(i.isRTL==null?void 0:i.isRTL(a.floating))?"start":"end")?"left":"right"):(y=f,g=u==="end"?"top":"bottom");const b=m-d.top-d.bottom,w=p-d.left-d.right,E=xn(m-d[g],b),P=xn(p-d[y],w),A=!t.middlewareData.shift;let v=E,M=P;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(M=w),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(v=b),A&&!u){const _=Je(d.left,0),D=Je(d.right,0),B=Je(d.top,0),j=Je(d.bottom,0);h?M=p-2*(_!==0||D!==0?_+D:Je(d.left,d.right)):v=m-2*(B!==0||j!==0?B+j:Je(d.top,d.bottom))}await l({...t,availableWidth:M,availableHeight:v});const N=await i.getDimensions(a.floating);return p!==N.width||m!==N.height?{reset:{rects:!0}}:{}}}};function Ni(){return typeof window<"u"}function jr(e){return xg(e)?(e.nodeName||"").toLowerCase():"#document"}function rt(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function $t(e){var t;return(t=(xg(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function xg(e){return Ni()?e instanceof Node||e instanceof rt(e).Node:!1}function Nt(e){return Ni()?e instanceof Element||e instanceof rt(e).Element:!1}function zt(e){return Ni()?e instanceof HTMLElement||e instanceof rt(e).HTMLElement:!1}function Rd(e){return!Ni()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof rt(e).ShadowRoot}function zo(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=Tt(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(o)}function bR(e){return["table","td","th"].includes(jr(e))}function Ti(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function hc(e){const t=pc(),n=Nt(e)?Tt(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function AR(e){let t=bn(e);for(;zt(t)&&!_r(t);){if(hc(t))return t;if(Ti(t))return null;t=bn(t)}return null}function pc(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function _r(e){return["html","body","#document"].includes(jr(e))}function Tt(e){return rt(e).getComputedStyle(e)}function _i(e){return Nt(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function bn(e){if(jr(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Rd(e)&&e.host||$t(e);return Rd(t)?t.host:t}function vg(e){const t=bn(e);return _r(t)?e.ownerDocument?e.ownerDocument.body:e.body:zt(t)&&zo(t)?t:vg(t)}function To(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=vg(e),s=o===((r=e.ownerDocument)==null?void 0:r.body),i=rt(o);if(s){const a=fl(i);return t.concat(i,i.visualViewport||[],zo(o)?o:[],a&&n?To(a):[])}return t.concat(o,To(o,[],n))}function fl(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function bg(e){const t=Tt(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=zt(e),s=o?e.offsetWidth:n,i=o?e.offsetHeight:r,a=Zs(n)!==s||Zs(r)!==i;return a&&(n=s,r=i),{width:n,height:r,$:a}}function gc(e){return Nt(e)?e:e.contextElement}function br(e){const t=gc(e);if(!zt(t))return jt(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:s}=bg(t);let i=(s?Zs(n.width):n.width)/r,a=(s?Zs(n.height):n.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!a||!Number.isFinite(a))&&(a=1),{x:i,y:a}}const ER=jt(0);function Ag(e){const t=rt(e);return!pc()||!t.visualViewport?ER:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function SR(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==rt(e)?!1:t}function Wn(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const o=e.getBoundingClientRect(),s=gc(e);let i=jt(1);t&&(r?Nt(r)&&(i=br(r)):i=br(e));const a=SR(s,n,r)?Ag(s):jt(0);let l=(o.left+a.x)/i.x,c=(o.top+a.y)/i.y,d=o.width/i.x,f=o.height/i.y;if(s){const u=rt(s),h=r&&Nt(r)?rt(r):r;let p=u,m=fl(p);for(;m&&r&&h!==p;){const g=br(m),y=m.getBoundingClientRect(),b=Tt(m),w=y.left+(m.clientLeft+parseFloat(b.paddingLeft))*g.x,E=y.top+(m.clientTop+parseFloat(b.paddingTop))*g.y;l*=g.x,c*=g.y,d*=g.x,f*=g.y,l+=w,c+=E,p=rt(m),m=fl(p)}}return ei({width:d,height:f,x:l,y:c})}function mc(e,t){const n=_i(e).scrollLeft;return t?t.left+n:Wn($t(e)).left+n}function Eg(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),o=r.left+t.scrollLeft-(n?0:mc(e,r)),s=r.top+t.scrollTop;return{x:o,y:s}}function MR(e){let{elements:t,rect:n,offsetParent:r,strategy:o}=e;const s=o==="fixed",i=$t(r),a=t?Ti(t.floating):!1;if(r===i||a&&s)return n;let l={scrollLeft:0,scrollTop:0},c=jt(1);const d=jt(0),f=zt(r);if((f||!f&&!s)&&((jr(r)!=="body"||zo(i))&&(l=_i(r)),zt(r))){const h=Wn(r);c=br(r),d.x=h.x+r.clientLeft,d.y=h.y+r.clientTop}const u=i&&!f&&!s?Eg(i,l,!0):jt(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+d.x+u.x,y:n.y*c.y-l.scrollTop*c.y+d.y+u.y}}function CR(e){return Array.from(e.getClientRects())}function RR(e){const t=$t(e),n=_i(e),r=e.ownerDocument.body,o=Je(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),s=Je(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+mc(e);const a=-n.scrollTop;return Tt(r).direction==="rtl"&&(i+=Je(t.clientWidth,r.clientWidth)-o),{width:o,height:s,x:i,y:a}}function PR(e,t){const n=rt(e),r=$t(e),o=n.visualViewport;let s=r.clientWidth,i=r.clientHeight,a=0,l=0;if(o){s=o.width,i=o.height;const c=pc();(!c||c&&t==="fixed")&&(a=o.offsetLeft,l=o.offsetTop)}return{width:s,height:i,x:a,y:l}}function IR(e,t){const n=Wn(e,!0,t==="fixed"),r=n.top+e.clientTop,o=n.left+e.clientLeft,s=zt(e)?br(e):jt(1),i=e.clientWidth*s.x,a=e.clientHeight*s.y,l=o*s.x,c=r*s.y;return{width:i,height:a,x:l,y:c}}function Pd(e,t,n){let r;if(t==="viewport")r=PR(e,n);else if(t==="document")r=RR($t(e));else if(Nt(t))r=IR(t,n);else{const o=Ag(e);r={x:t.x-o.x,y:t.y-o.y,width:t.width,height:t.height}}return ei(r)}function Sg(e,t){const n=bn(e);return n===t||!Nt(n)||_r(n)?!1:Tt(n).position==="fixed"||Sg(n,t)}function NR(e,t){const n=t.get(e);if(n)return n;let r=To(e,[],!1).filter(a=>Nt(a)&&jr(a)!=="body"),o=null;const s=Tt(e).position==="fixed";let i=s?bn(e):e;for(;Nt(i)&&!_r(i);){const a=Tt(i),l=hc(i);!l&&a.position==="fixed"&&(o=null),(s?!l&&!o:!l&&a.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||zo(i)&&!l&&Sg(e,i))?r=r.filter(d=>d!==i):o=a,i=bn(i)}return t.set(e,r),r}function TR(e){let{element:t,boundary:n,rootBoundary:r,strategy:o}=e;const i=[...n==="clippingAncestors"?Ti(t)?[]:NR(t,this._c):[].concat(n),r],a=i[0],l=i.reduce((c,d)=>{const f=Pd(t,d,o);return c.top=Je(f.top,c.top),c.right=xn(f.right,c.right),c.bottom=xn(f.bottom,c.bottom),c.left=Je(f.left,c.left),c},Pd(t,a,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function _R(e){const{width:t,height:n}=bg(e);return{width:t,height:n}}function kR(e,t,n){const r=zt(t),o=$t(t),s=n==="fixed",i=Wn(e,!0,s,t);let a={scrollLeft:0,scrollTop:0};const l=jt(0);if(r||!r&&!s)if((jr(t)!=="body"||zo(o))&&(a=_i(t)),r){const u=Wn(t,!0,s,t);l.x=u.x+t.clientLeft,l.y=u.y+t.clientTop}else o&&(l.x=mc(o));const c=o&&!r&&!s?Eg(o,a):jt(0),d=i.left+a.scrollLeft-l.x-c.x,f=i.top+a.scrollTop-l.y-c.y;return{x:d,y:f,width:i.width,height:i.height}}function ya(e){return Tt(e).position==="static"}function Id(e,t){if(!zt(e)||Tt(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return $t(e)===n&&(n=n.ownerDocument.body),n}function Mg(e,t){const n=rt(e);if(Ti(e))return n;if(!zt(e)){let o=bn(e);for(;o&&!_r(o);){if(Nt(o)&&!ya(o))return o;o=bn(o)}return n}let r=Id(e,t);for(;r&&bR(r)&&ya(r);)r=Id(r,t);return r&&_r(r)&&ya(r)&&!hc(r)?n:r||AR(e)||n}const DR=async function(e){const t=this.getOffsetParent||Mg,n=this.getDimensions,r=await n(e.floating);return{reference:kR(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function OR(e){return Tt(e).direction==="rtl"}const LR={convertOffsetParentRelativeRectToViewportRelativeRect:MR,getDocumentElement:$t,getClippingRect:TR,getOffsetParent:Mg,getElementRects:DR,getClientRects:CR,getDimensions:_R,getScale:br,isElement:Nt,isRTL:OR};function Cg(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function BR(e,t){let n=null,r;const o=$t(e);function s(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function i(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const c=e.getBoundingClientRect(),{left:d,top:f,width:u,height:h}=c;if(a||t(),!u||!h)return;const p=us(f),m=us(o.clientWidth-(d+u)),g=us(o.clientHeight-(f+h)),y=us(d),w={rootMargin:-p+"px "+-m+"px "+-g+"px "+-y+"px",threshold:Je(0,xn(1,l))||1};let E=!0;function P(A){const v=A[0].intersectionRatio;if(v!==l){if(!E)return i();v?i(!1,v):r=setTimeout(()=>{i(!1,1e-7)},1e3)}v===1&&!Cg(c,e.getBoundingClientRect())&&i(),E=!1}try{n=new IntersectionObserver(P,{...w,root:o.ownerDocument})}catch{n=new IntersectionObserver(P,w)}n.observe(e)}return i(!0),s}function FR(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:s=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=gc(e),d=o||s?[...c?To(c):[],...To(t)]:[];d.forEach(y=>{o&&y.addEventListener("scroll",n,{passive:!0}),s&&y.addEventListener("resize",n)});const f=c&&a?BR(c,n):null;let u=-1,h=null;i&&(h=new ResizeObserver(y=>{let[b]=y;b&&b.target===c&&h&&(h.unobserve(t),cancelAnimationFrame(u),u=requestAnimationFrame(()=>{var w;(w=h)==null||w.observe(t)})),n()}),c&&!l&&h.observe(c),h.observe(t));let p,m=l?Wn(e):null;l&&g();function g(){const y=Wn(e);m&&!Cg(m,y)&&n(),m=y,p=requestAnimationFrame(g)}return n(),()=>{var y;d.forEach(b=>{o&&b.removeEventListener("scroll",n),s&&b.removeEventListener("resize",n)}),f==null||f(),(y=h)==null||y.disconnect(),h=null,l&&cancelAnimationFrame(p)}}const jR=yR,qR=wR,zR=pR,HR=vR,VR=gR,Nd=hR,UR=xR,$R=(e,t,n)=>{const r=new Map,o={platform:LR,...n},s={...o.platform,_c:r};return fR(e,t,{...o,platform:s})};var Ss=typeof document<"u"?x.useLayoutEffect:x.useEffect;function ti(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!ti(e[r],t[r]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,o[r]))return!1;for(r=n;r--!==0;){const s=o[r];if(!(s==="_owner"&&e.$$typeof)&&!ti(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function Rg(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Td(e,t){const n=Rg(e);return Math.round(t*n)/n}function wa(e){const t=x.useRef(e);return Ss(()=>{t.current=e}),t}function GR(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:s,floating:i}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[d,f]=x.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[u,h]=x.useState(r);ti(u,r)||h(r);const[p,m]=x.useState(null),[g,y]=x.useState(null),b=x.useCallback(F=>{F!==A.current&&(A.current=F,m(F))},[]),w=x.useCallback(F=>{F!==v.current&&(v.current=F,y(F))},[]),E=s||p,P=i||g,A=x.useRef(null),v=x.useRef(null),M=x.useRef(d),N=l!=null,_=wa(l),D=wa(o),B=wa(c),j=x.useCallback(()=>{if(!A.current||!v.current)return;const F={placement:t,strategy:n,middleware:u};D.current&&(F.platform=D.current),$R(A.current,v.current,F).then(T=>{const z={...T,isPositioned:B.current!==!1};R.current&&!ti(M.current,z)&&(M.current=z,Al.flushSync(()=>{f(z)}))})},[u,t,n,D,B]);Ss(()=>{c===!1&&M.current.isPositioned&&(M.current.isPositioned=!1,f(F=>({...F,isPositioned:!1})))},[c]);const R=x.useRef(!1);Ss(()=>(R.current=!0,()=>{R.current=!1}),[]),Ss(()=>{if(E&&(A.current=E),P&&(v.current=P),E&&P){if(_.current)return _.current(E,P,j);j()}},[E,P,j,_,N]);const O=x.useMemo(()=>({reference:A,floating:v,setReference:b,setFloating:w}),[b,w]),I=x.useMemo(()=>({reference:E,floating:P}),[E,P]),k=x.useMemo(()=>{const F={position:n,left:0,top:0};if(!I.floating)return F;const T=Td(I.floating,d.x),z=Td(I.floating,d.y);return a?{...F,transform:"translate("+T+"px, "+z+"px)",...Rg(I.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:T,top:z}},[n,a,I.floating,d.x,d.y]);return x.useMemo(()=>({...d,update:j,refs:O,elements:I,floatingStyles:k}),[d,j,O,I,k])}const KR=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:o}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?Nd({element:r.current,padding:o}).fn(n):{}:r?Nd({element:r,padding:o}).fn(n):{}}}},WR=(e,t)=>({...jR(e),options:[e,t]}),YR=(e,t)=>({...qR(e),options:[e,t]}),XR=(e,t)=>({...UR(e),options:[e,t]}),QR=(e,t)=>({...zR(e),options:[e,t]}),ZR=(e,t)=>({...HR(e),options:[e,t]}),JR=(e,t)=>({...VR(e),options:[e,t]}),eP=(e,t)=>({...KR(e),options:[e,t]});var tP="Arrow",Pg=x.forwardRef((e,t)=>{const{children:n,width:r=10,height:o=5,...s}=e;return S.jsx(xe.svg,{...s,ref:t,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:S.jsx("polygon",{points:"0,0 30,0 15,10"})})});Pg.displayName=tP;var nP=Pg;function rP(e){const[t,n]=x.useState(void 0);return gt(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const s=o[0];let i,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;i=c.inlineSize,a=c.blockSize}else i=e.offsetWidth,a=e.offsetHeight;n({width:i,height:a})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var yc="Popper",[Ig,ki]=Dr(yc),[oP,Ng]=Ig(yc),Tg=e=>{const{__scopePopper:t,children:n}=e,[r,o]=x.useState(null);return S.jsx(oP,{scope:t,anchor:r,onAnchorChange:o,children:n})};Tg.displayName=yc;var _g="PopperAnchor",kg=x.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...o}=e,s=Ng(_g,n),i=x.useRef(null),a=Ce(t,i);return x.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:S.jsx(xe.div,{...o,ref:a})});kg.displayName=_g;var wc="PopperContent",[sP,iP]=Ig(wc),Dg=x.forwardRef((e,t)=>{var q,W,te,se,oe,ne;const{__scopePopper:n,side:r="bottom",sideOffset:o=0,align:s="center",alignOffset:i=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:d=0,sticky:f="partial",hideWhenDetached:u=!1,updatePositionStrategy:h="optimized",onPlaced:p,...m}=e,g=Ng(wc,n),[y,b]=x.useState(null),w=Ce(t,J=>b(J)),[E,P]=x.useState(null),A=rP(E),v=(A==null?void 0:A.width)??0,M=(A==null?void 0:A.height)??0,N=r+(s!=="center"?"-"+s:""),_=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},D=Array.isArray(c)?c:[c],B=D.length>0,j={padding:_,boundary:D.filter(lP),altBoundary:B},{refs:R,floatingStyles:O,placement:I,isPositioned:k,middlewareData:F}=GR({strategy:"fixed",placement:N,whileElementsMounted:(...J)=>FR(...J,{animationFrame:h==="always"}),elements:{reference:g.anchor},middleware:[WR({mainAxis:o+M,alignmentAxis:i}),l&&YR({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?XR():void 0,...j}),l&&QR({...j}),ZR({...j,apply:({elements:J,rects:re,availableWidth:le,availableHeight:ce})=>{const{width:me,height:de}=re.reference,be=J.floating.style;be.setProperty("--radix-popper-available-width",`${le}px`),be.setProperty("--radix-popper-available-height",`${ce}px`),be.setProperty("--radix-popper-anchor-width",`${me}px`),be.setProperty("--radix-popper-anchor-height",`${de}px`)}}),E&&eP({element:E,padding:a}),cP({arrowWidth:v,arrowHeight:M}),u&&JR({strategy:"referenceHidden",...j})]}),[T,z]=Bg(I),V=qt(p);gt(()=>{k&&(V==null||V())},[k,V]);const U=(q=F.arrow)==null?void 0:q.x,K=(W=F.arrow)==null?void 0:W.y,Y=((te=F.arrow)==null?void 0:te.centerOffset)!==0,[ee,Z]=x.useState();return gt(()=>{y&&Z(window.getComputedStyle(y).zIndex)},[y]),S.jsx("div",{ref:R.setFloating,"data-radix-popper-content-wrapper":"",style:{...O,transform:k?O.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ee,"--radix-popper-transform-origin":[(se=F.transformOrigin)==null?void 0:se.x,(oe=F.transformOrigin)==null?void 0:oe.y].join(" "),...((ne=F.hide)==null?void 0:ne.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:S.jsx(sP,{scope:n,placedSide:T,onArrowChange:P,arrowX:U,arrowY:K,shouldHideArrow:Y,children:S.jsx(xe.div,{"data-side":T,"data-align":z,...m,ref:w,style:{...m.style,animation:k?void 0:"none"}})})})});Dg.displayName=wc;var Og="PopperArrow",aP={top:"bottom",right:"left",bottom:"top",left:"right"},Lg=x.forwardRef(function(t,n){const{__scopePopper:r,...o}=t,s=iP(Og,r),i=aP[s.placedSide];return S.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:S.jsx(nP,{...o,ref:n,style:{...o.style,display:"block"}})})});Lg.displayName=Og;function lP(e){return e!==null}var cP=e=>({name:"transformOrigin",options:e,fn(t){var g,y,b;const{placement:n,rects:r,middlewareData:o}=t,i=((g=o.arrow)==null?void 0:g.centerOffset)!==0,a=i?0:e.arrowWidth,l=i?0:e.arrowHeight,[c,d]=Bg(n),f={start:"0%",center:"50%",end:"100%"}[d],u=(((y=o.arrow)==null?void 0:y.x)??0)+a/2,h=(((b=o.arrow)==null?void 0:b.y)??0)+l/2;let p="",m="";return c==="bottom"?(p=i?f:`${u}px`,m=`${-l}px`):c==="top"?(p=i?f:`${u}px`,m=`${r.floating.height+l}px`):c==="right"?(p=`${-l}px`,m=i?f:`${h}px`):c==="left"&&(p=`${r.floating.width+l}px`,m=i?f:`${h}px`),{data:{x:p,y:m}}}});function Bg(e){const[t,n="center"]=e.split("-");return[t,n]}var Fg=Tg,jg=kg,qg=Dg,zg=Lg,uP="Portal",xc=x.forwardRef((e,t)=>{var a;const{container:n,...r}=e,[o,s]=x.useState(!1);gt(()=>s(!0),[]);const i=n||o&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return i?K0.createPortal(S.jsx(xe.div,{...r,ref:t}),i):null});xc.displayName=uP;var xa="rovingFocusGroup.onEntryFocus",dP={bubbles:!1,cancelable:!0},Ho="RovingFocusGroup",[hl,Hg,fP]=ic(Ho),[hP,Vg]=Dr(Ho,[fP]),[pP,gP]=hP(Ho),Ug=x.forwardRef((e,t)=>S.jsx(hl.Provider,{scope:e.__scopeRovingFocusGroup,children:S.jsx(hl.Slot,{scope:e.__scopeRovingFocusGroup,children:S.jsx(mP,{...e,ref:t})})}));Ug.displayName=Ho;var mP=x.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:o=!1,dir:s,currentTabStopId:i,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:d=!1,...f}=e,u=x.useRef(null),h=Ce(t,u),p=ac(s),[m,g]=Ps({prop:i,defaultProp:a??null,onChange:l,caller:Ho}),[y,b]=x.useState(!1),w=qt(c),E=Hg(n),P=x.useRef(!1),[A,v]=x.useState(0);return x.useEffect(()=>{const M=u.current;if(M)return M.addEventListener(xa,w),()=>M.removeEventListener(xa,w)},[w]),S.jsx(pP,{scope:n,orientation:r,dir:p,loop:o,currentTabStopId:m,onItemFocus:x.useCallback(M=>g(M),[g]),onItemShiftTab:x.useCallback(()=>b(!0),[]),onFocusableItemAdd:x.useCallback(()=>v(M=>M+1),[]),onFocusableItemRemove:x.useCallback(()=>v(M=>M-1),[]),children:S.jsx(xe.div,{tabIndex:y||A===0?-1:0,"data-orientation":r,...f,ref:h,style:{outline:"none",...e.style},onMouseDown:ue(e.onMouseDown,()=>{P.current=!0}),onFocus:ue(e.onFocus,M=>{const N=!P.current;if(M.target===M.currentTarget&&N&&!y){const _=new CustomEvent(xa,dP);if(M.currentTarget.dispatchEvent(_),!_.defaultPrevented){const D=E().filter(I=>I.focusable),B=D.find(I=>I.active),j=D.find(I=>I.id===m),O=[B,j,...D].filter(Boolean).map(I=>I.ref.current);Kg(O,d)}}P.current=!1}),onBlur:ue(e.onBlur,()=>b(!1))})})}),$g="RovingFocusGroupItem",Gg=x.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:o=!1,tabStopId:s,children:i,...a}=e,l=Er(),c=s||l,d=gP($g,n),f=d.currentTabStopId===c,u=Hg(n),{onFocusableItemAdd:h,onFocusableItemRemove:p,currentTabStopId:m}=d;return x.useEffect(()=>{if(r)return h(),()=>p()},[r,h,p]),S.jsx(hl.ItemSlot,{scope:n,id:c,focusable:r,active:o,children:S.jsx(xe.span,{tabIndex:f?0:-1,"data-orientation":d.orientation,...a,ref:t,onMouseDown:ue(e.onMouseDown,g=>{r?d.onItemFocus(c):g.preventDefault()}),onFocus:ue(e.onFocus,()=>d.onItemFocus(c)),onKeyDown:ue(e.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){d.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const y=xP(g,d.orientation,d.dir);if(y!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let w=u().filter(E=>E.focusable).map(E=>E.ref.current);if(y==="last")w.reverse();else if(y==="prev"||y==="next"){y==="prev"&&w.reverse();const E=w.indexOf(g.currentTarget);w=d.loop?vP(w,E+1):w.slice(E+1)}setTimeout(()=>Kg(w))}}),children:typeof i=="function"?i({isCurrentTabStop:f,hasTabStop:m!=null}):i})})});Gg.displayName=$g;var yP={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function wP(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function xP(e,t,n){const r=wP(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return yP[r]}function Kg(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function vP(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var bP=Ug,AP=Gg,EP=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},lr=new WeakMap,ds=new WeakMap,fs={},va=0,Wg=function(e){return e&&(e.host||Wg(e.parentNode))},SP=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=Wg(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},MP=function(e,t,n,r){var o=SP(t,Array.isArray(e)?e:[e]);fs[n]||(fs[n]=new WeakMap);var s=fs[n],i=[],a=new Set,l=new Set(o),c=function(f){!f||a.has(f)||(a.add(f),c(f.parentNode))};o.forEach(c);var d=function(f){!f||l.has(f)||Array.prototype.forEach.call(f.children,function(u){if(a.has(u))d(u);else try{var h=u.getAttribute(r),p=h!==null&&h!=="false",m=(lr.get(u)||0)+1,g=(s.get(u)||0)+1;lr.set(u,m),s.set(u,g),i.push(u),m===1&&p&&ds.set(u,!0),g===1&&u.setAttribute(n,"true"),p||u.setAttribute(r,"true")}catch(y){console.error("aria-hidden: cannot operate on ",u,y)}})};return d(t),a.clear(),va++,function(){i.forEach(function(f){var u=lr.get(f)-1,h=s.get(f)-1;lr.set(f,u),s.set(f,h),u||(ds.has(f)||f.removeAttribute(r),ds.delete(f)),h||f.removeAttribute(n)}),va--,va||(lr=new WeakMap,lr=new WeakMap,ds=new WeakMap,fs={})}},Yg=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),o=EP(e);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),MP(r,o,n,"aria-hidden")):function(){return null}},Dt=function(){return Dt=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Dt.apply(this,arguments)};function Xg(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n}function CP(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,s;r<o;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}var Ms="right-scroll-bar-position",Cs="width-before-scroll-bar",RP="with-scroll-bars-hidden",PP="--removed-body-scroll-bar-size";function ba(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function IP(e,t){var n=x.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var o=n.value;o!==r&&(n.value=r,n.callback(r,o))}}}})[0];return n.callback=t,n.facade}var NP=typeof window<"u"?x.useLayoutEffect:x.useEffect,_d=new WeakMap;function TP(e,t){var n=IP(null,function(r){return e.forEach(function(o){return ba(o,r)})});return NP(function(){var r=_d.get(n);if(r){var o=new Set(r),s=new Set(e),i=n.current;o.forEach(function(a){s.has(a)||ba(a,null)}),s.forEach(function(a){o.has(a)||ba(a,i)})}_d.set(n,e)},[e]),n}function _P(e){return e}function kP(e,t){t===void 0&&(t=_P);var n=[],r=!1,o={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(s){var i=t(s,r);return n.push(i),function(){n=n.filter(function(a){return a!==i})}},assignSyncMedium:function(s){for(r=!0;n.length;){var i=n;n=[],i.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){r=!0;var i=[];if(n.length){var a=n;n=[],a.forEach(s),i=n}var l=function(){var d=i;i=[],d.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(d){i.push(d),c()},filter:function(d){return i=i.filter(d),n}}}};return o}function DP(e){e===void 0&&(e={});var t=kP(null);return t.options=Dt({async:!0,ssr:!1},e),t}var Qg=function(e){var t=e.sideCar,n=Xg(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return x.createElement(r,Dt({},n))};Qg.isSideCarExport=!0;function OP(e,t){return e.useMedium(t),Qg}var Zg=DP(),Aa=function(){},Di=x.forwardRef(function(e,t){var n=x.useRef(null),r=x.useState({onScrollCapture:Aa,onWheelCapture:Aa,onTouchMoveCapture:Aa}),o=r[0],s=r[1],i=e.forwardProps,a=e.children,l=e.className,c=e.removeScrollBar,d=e.enabled,f=e.shards,u=e.sideCar,h=e.noIsolation,p=e.inert,m=e.allowPinchZoom,g=e.as,y=g===void 0?"div":g,b=e.gapMode,w=Xg(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),E=u,P=TP([n,t]),A=Dt(Dt({},w),o);return x.createElement(x.Fragment,null,d&&x.createElement(E,{sideCar:Zg,removeScrollBar:c,shards:f,noIsolation:h,inert:p,setCallbacks:s,allowPinchZoom:!!m,lockRef:n,gapMode:b}),i?x.cloneElement(x.Children.only(a),Dt(Dt({},A),{ref:P})):x.createElement(y,Dt({},A,{className:l,ref:P}),a))});Di.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Di.classNames={fullWidth:Cs,zeroRight:Ms};var LP=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function BP(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=LP();return t&&e.setAttribute("nonce",t),e}function FP(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function jP(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var qP=function(){var e=0,t=null;return{add:function(n){e==0&&(t=BP())&&(FP(t,n),jP(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},zP=function(){var e=qP();return function(t,n){x.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Jg=function(){var e=zP(),t=function(n){var r=n.styles,o=n.dynamic;return e(r,o),null};return t},HP={left:0,top:0,right:0,gap:0},Ea=function(e){return parseInt(e||"",10)||0},VP=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],o=t[e==="padding"?"paddingRight":"marginRight"];return[Ea(n),Ea(r),Ea(o)]},UP=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return HP;var t=VP(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},$P=Jg(),Ar="data-scroll-locked",GP=function(e,t,n,r){var o=e.left,s=e.top,i=e.right,a=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(RP,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(Ar,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ms,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Cs,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Ms," .").concat(Ms,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Cs," .").concat(Cs,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Ar,`] {
    `).concat(PP,": ").concat(a,`px;
  }
`)},kd=function(){var e=parseInt(document.body.getAttribute(Ar)||"0",10);return isFinite(e)?e:0},KP=function(){x.useEffect(function(){return document.body.setAttribute(Ar,(kd()+1).toString()),function(){var e=kd()-1;e<=0?document.body.removeAttribute(Ar):document.body.setAttribute(Ar,e.toString())}},[])},WP=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,o=r===void 0?"margin":r;KP();var s=x.useMemo(function(){return UP(o)},[o]);return x.createElement($P,{styles:GP(s,!t,o,n?"":"!important")})},pl=!1;if(typeof window<"u")try{var hs=Object.defineProperty({},"passive",{get:function(){return pl=!0,!0}});window.addEventListener("test",hs,hs),window.removeEventListener("test",hs,hs)}catch{pl=!1}var cr=pl?{passive:!1}:!1,YP=function(e){return e.tagName==="TEXTAREA"},em=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!YP(e)&&n[t]==="visible")},XP=function(e){return em(e,"overflowY")},QP=function(e){return em(e,"overflowX")},Dd=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var o=tm(e,r);if(o){var s=nm(e,r),i=s[1],a=s[2];if(i>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},ZP=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},JP=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},tm=function(e,t){return e==="v"?XP(t):QP(t)},nm=function(e,t){return e==="v"?ZP(t):JP(t)},eI=function(e,t){return e==="h"&&t==="rtl"?-1:1},tI=function(e,t,n,r,o){var s=eI(e,window.getComputedStyle(t).direction),i=s*r,a=n.target,l=t.contains(a),c=!1,d=i>0,f=0,u=0;do{var h=nm(e,a),p=h[0],m=h[1],g=h[2],y=m-g-s*p;(p||y)&&tm(e,a)&&(f+=y,u+=p),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(t.contains(a)||t===a));return(d&&Math.abs(f)<1||!d&&Math.abs(u)<1)&&(c=!0),c},ps=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Od=function(e){return[e.deltaX,e.deltaY]},Ld=function(e){return e&&"current"in e?e.current:e},nI=function(e,t){return e[0]===t[0]&&e[1]===t[1]},rI=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},oI=0,ur=[];function sI(e){var t=x.useRef([]),n=x.useRef([0,0]),r=x.useRef(),o=x.useState(oI++)[0],s=x.useState(Jg)[0],i=x.useRef(e);x.useEffect(function(){i.current=e},[e]),x.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var m=CP([e.lockRef.current],(e.shards||[]).map(Ld),!0).filter(Boolean);return m.forEach(function(g){return g.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),m.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var a=x.useCallback(function(m,g){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var y=ps(m),b=n.current,w="deltaX"in m?m.deltaX:b[0]-y[0],E="deltaY"in m?m.deltaY:b[1]-y[1],P,A=m.target,v=Math.abs(w)>Math.abs(E)?"h":"v";if("touches"in m&&v==="h"&&A.type==="range")return!1;var M=Dd(v,A);if(!M)return!0;if(M?P=v:(P=v==="v"?"h":"v",M=Dd(v,A)),!M)return!1;if(!r.current&&"changedTouches"in m&&(w||E)&&(r.current=P),!P)return!0;var N=r.current||P;return tI(N,g,m,N==="h"?w:E)},[]),l=x.useCallback(function(m){var g=m;if(!(!ur.length||ur[ur.length-1]!==s)){var y="deltaY"in g?Od(g):ps(g),b=t.current.filter(function(P){return P.name===g.type&&(P.target===g.target||g.target===P.shadowParent)&&nI(P.delta,y)})[0];if(b&&b.should){g.cancelable&&g.preventDefault();return}if(!b){var w=(i.current.shards||[]).map(Ld).filter(Boolean).filter(function(P){return P.contains(g.target)}),E=w.length>0?a(g,w[0]):!i.current.noIsolation;E&&g.cancelable&&g.preventDefault()}}},[]),c=x.useCallback(function(m,g,y,b){var w={name:m,delta:g,target:y,should:b,shadowParent:iI(y)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(E){return E!==w})},1)},[]),d=x.useCallback(function(m){n.current=ps(m),r.current=void 0},[]),f=x.useCallback(function(m){c(m.type,Od(m),m.target,a(m,e.lockRef.current))},[]),u=x.useCallback(function(m){c(m.type,ps(m),m.target,a(m,e.lockRef.current))},[]);x.useEffect(function(){return ur.push(s),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:u}),document.addEventListener("wheel",l,cr),document.addEventListener("touchmove",l,cr),document.addEventListener("touchstart",d,cr),function(){ur=ur.filter(function(m){return m!==s}),document.removeEventListener("wheel",l,cr),document.removeEventListener("touchmove",l,cr),document.removeEventListener("touchstart",d,cr)}},[]);var h=e.removeScrollBar,p=e.inert;return x.createElement(x.Fragment,null,p?x.createElement(s,{styles:rI(o)}):null,h?x.createElement(WP,{gapMode:e.gapMode}):null)}function iI(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const aI=OP(Zg,sI);var vc=x.forwardRef(function(e,t){return x.createElement(Di,Dt({},e,{ref:t,sideCar:aI}))});vc.classNames=Di.classNames;var gl=["Enter"," "],lI=["ArrowDown","PageUp","Home"],rm=["ArrowUp","PageDown","End"],cI=[...lI,...rm],uI={ltr:[...gl,"ArrowRight"],rtl:[...gl,"ArrowLeft"]},dI={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Vo="Menu",[_o,fI,hI]=ic(Vo),[er,om]=Dr(Vo,[hI,ki,Vg]),Oi=ki(),sm=Vg(),[pI,tr]=er(Vo),[gI,Uo]=er(Vo),im=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:o,onOpenChange:s,modal:i=!0}=e,a=Oi(t),[l,c]=x.useState(null),d=x.useRef(!1),f=qt(s),u=ac(o);return x.useEffect(()=>{const h=()=>{d.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>d.current=!1;return document.addEventListener("keydown",h,{capture:!0}),()=>{document.removeEventListener("keydown",h,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),S.jsx(Fg,{...a,children:S.jsx(pI,{scope:t,open:n,onOpenChange:f,content:l,onContentChange:c,children:S.jsx(gI,{scope:t,onClose:x.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:d,dir:u,modal:i,children:r})})})};im.displayName=Vo;var mI="MenuAnchor",bc=x.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,o=Oi(n);return S.jsx(jg,{...o,...r,ref:t})});bc.displayName=mI;var Ac="MenuPortal",[yI,am]=er(Ac,{forceMount:void 0}),lm=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:o}=e,s=tr(Ac,t);return S.jsx(yI,{scope:t,forceMount:n,children:S.jsx(si,{present:n||s.open,children:S.jsx(xc,{asChild:!0,container:o,children:r})})})};lm.displayName=Ac;var pt="MenuContent",[wI,Ec]=er(pt),cm=x.forwardRef((e,t)=>{const n=am(pt,e.__scopeMenu),{forceMount:r=n.forceMount,...o}=e,s=tr(pt,e.__scopeMenu),i=Uo(pt,e.__scopeMenu);return S.jsx(_o.Provider,{scope:e.__scopeMenu,children:S.jsx(si,{present:r||s.open,children:S.jsx(_o.Slot,{scope:e.__scopeMenu,children:i.modal?S.jsx(xI,{...o,ref:t}):S.jsx(vI,{...o,ref:t})})})})}),xI=x.forwardRef((e,t)=>{const n=tr(pt,e.__scopeMenu),r=x.useRef(null),o=Ce(t,r);return x.useEffect(()=>{const s=r.current;if(s)return Yg(s)},[]),S.jsx(Sc,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ue(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),vI=x.forwardRef((e,t)=>{const n=tr(pt,e.__scopeMenu);return S.jsx(Sc,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),bI=Rs("MenuContent.ScrollLock"),Sc=x.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:o,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:f,onInteractOutside:u,onDismiss:h,disableOutsideScroll:p,...m}=e,g=tr(pt,n),y=Uo(pt,n),b=Oi(n),w=sm(n),E=fI(n),[P,A]=x.useState(null),v=x.useRef(null),M=Ce(t,v,g.onContentChange),N=x.useRef(0),_=x.useRef(""),D=x.useRef(0),B=x.useRef(null),j=x.useRef("right"),R=x.useRef(0),O=p?vc:x.Fragment,I=p?{as:bI,allowPinchZoom:!0}:void 0,k=T=>{var q,W;const z=_.current+T,V=E().filter(te=>!te.disabled),U=document.activeElement,K=(q=V.find(te=>te.ref.current===U))==null?void 0:q.textValue,Y=V.map(te=>te.textValue),ee=kI(Y,z,K),Z=(W=V.find(te=>te.textValue===ee))==null?void 0:W.ref.current;(function te(se){_.current=se,window.clearTimeout(N.current),se!==""&&(N.current=window.setTimeout(()=>te(""),1e3))})(z),Z&&setTimeout(()=>Z.focus())};x.useEffect(()=>()=>window.clearTimeout(N.current),[]),mg();const F=x.useCallback(T=>{var V,U;return j.current===((V=B.current)==null?void 0:V.side)&&OI(T,(U=B.current)==null?void 0:U.area)},[]);return S.jsx(wI,{scope:n,searchRef:_,onItemEnter:x.useCallback(T=>{F(T)&&T.preventDefault()},[F]),onItemLeave:x.useCallback(T=>{var z;F(T)||((z=v.current)==null||z.focus(),A(null))},[F]),onTriggerLeave:x.useCallback(T=>{F(T)&&T.preventDefault()},[F]),pointerGraceTimerRef:D,onPointerGraceIntentChange:x.useCallback(T=>{B.current=T},[]),children:S.jsx(O,{...I,children:S.jsx(cc,{asChild:!0,trapped:o,onMountAutoFocus:ue(s,T=>{var z;T.preventDefault(),(z=v.current)==null||z.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:S.jsx(lc,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:f,onInteractOutside:u,onDismiss:h,children:S.jsx(bP,{asChild:!0,...w,dir:y.dir,orientation:"vertical",loop:r,currentTabStopId:P,onCurrentTabStopIdChange:A,onEntryFocus:ue(l,T=>{y.isUsingKeyboardRef.current||T.preventDefault()}),preventScrollOnEntryFocus:!0,children:S.jsx(qg,{role:"menu","aria-orientation":"vertical","data-state":Mm(g.open),"data-radix-menu-content":"",dir:y.dir,...b,...m,ref:M,style:{outline:"none",...m.style},onKeyDown:ue(m.onKeyDown,T=>{const V=T.target.closest("[data-radix-menu-content]")===T.currentTarget,U=T.ctrlKey||T.altKey||T.metaKey,K=T.key.length===1;V&&(T.key==="Tab"&&T.preventDefault(),!U&&K&&k(T.key));const Y=v.current;if(T.target!==Y||!cI.includes(T.key))return;T.preventDefault();const Z=E().filter(q=>!q.disabled).map(q=>q.ref.current);rm.includes(T.key)&&Z.reverse(),TI(Z)}),onBlur:ue(e.onBlur,T=>{T.currentTarget.contains(T.target)||(window.clearTimeout(N.current),_.current="")}),onPointerMove:ue(e.onPointerMove,ko(T=>{const z=T.target,V=R.current!==T.clientX;if(T.currentTarget.contains(z)&&V){const U=T.clientX>R.current?"right":"left";j.current=U,R.current=T.clientX}}))})})})})})})});cm.displayName=pt;var AI="MenuGroup",Mc=x.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return S.jsx(xe.div,{role:"group",...r,ref:t})});Mc.displayName=AI;var EI="MenuLabel",um=x.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return S.jsx(xe.div,{...r,ref:t})});um.displayName=EI;var ni="MenuItem",Bd="menu.itemSelect",Li=x.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...o}=e,s=x.useRef(null),i=Uo(ni,e.__scopeMenu),a=Ec(ni,e.__scopeMenu),l=Ce(t,s),c=x.useRef(!1),d=()=>{const f=s.current;if(!n&&f){const u=new CustomEvent(Bd,{bubbles:!0,cancelable:!0});f.addEventListener(Bd,h=>r==null?void 0:r(h),{once:!0}),$d(f,u),u.defaultPrevented?c.current=!1:i.onClose()}};return S.jsx(dm,{...o,ref:l,disabled:n,onClick:ue(e.onClick,d),onPointerDown:f=>{var u;(u=e.onPointerDown)==null||u.call(e,f),c.current=!0},onPointerUp:ue(e.onPointerUp,f=>{var u;c.current||(u=f.currentTarget)==null||u.click()}),onKeyDown:ue(e.onKeyDown,f=>{const u=a.searchRef.current!=="";n||u&&f.key===" "||gl.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});Li.displayName=ni;var dm=x.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:o,...s}=e,i=Ec(ni,n),a=sm(n),l=x.useRef(null),c=Ce(t,l),[d,f]=x.useState(!1),[u,h]=x.useState("");return x.useEffect(()=>{const p=l.current;p&&h((p.textContent??"").trim())},[s.children]),S.jsx(_o.ItemSlot,{scope:n,disabled:r,textValue:o??u,children:S.jsx(AP,{asChild:!0,...a,focusable:!r,children:S.jsx(xe.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...s,ref:c,onPointerMove:ue(e.onPointerMove,ko(p=>{r?i.onItemLeave(p):(i.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ue(e.onPointerLeave,ko(p=>i.onItemLeave(p))),onFocus:ue(e.onFocus,()=>f(!0)),onBlur:ue(e.onBlur,()=>f(!1))})})})}),SI="MenuCheckboxItem",fm=x.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...o}=e;return S.jsx(ym,{scope:e.__scopeMenu,checked:n,children:S.jsx(Li,{role:"menuitemcheckbox","aria-checked":ri(n)?"mixed":n,...o,ref:t,"data-state":Rc(n),onSelect:ue(o.onSelect,()=>r==null?void 0:r(ri(n)?!0:!n),{checkForDefaultPrevented:!1})})})});fm.displayName=SI;var hm="MenuRadioGroup",[MI,CI]=er(hm,{value:void 0,onValueChange:()=>{}}),pm=x.forwardRef((e,t)=>{const{value:n,onValueChange:r,...o}=e,s=qt(r);return S.jsx(MI,{scope:e.__scopeMenu,value:n,onValueChange:s,children:S.jsx(Mc,{...o,ref:t})})});pm.displayName=hm;var gm="MenuRadioItem",mm=x.forwardRef((e,t)=>{const{value:n,...r}=e,o=CI(gm,e.__scopeMenu),s=n===o.value;return S.jsx(ym,{scope:e.__scopeMenu,checked:s,children:S.jsx(Li,{role:"menuitemradio","aria-checked":s,...r,ref:t,"data-state":Rc(s),onSelect:ue(r.onSelect,()=>{var i;return(i=o.onValueChange)==null?void 0:i.call(o,n)},{checkForDefaultPrevented:!1})})})});mm.displayName=gm;var Cc="MenuItemIndicator",[ym,RI]=er(Cc,{checked:!1}),wm=x.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...o}=e,s=RI(Cc,n);return S.jsx(si,{present:r||ri(s.checked)||s.checked===!0,children:S.jsx(xe.span,{...o,ref:t,"data-state":Rc(s.checked)})})});wm.displayName=Cc;var PI="MenuSeparator",xm=x.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return S.jsx(xe.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});xm.displayName=PI;var II="MenuArrow",vm=x.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,o=Oi(n);return S.jsx(zg,{...o,...r,ref:t})});vm.displayName=II;var NI="MenuSub",[bT,bm]=er(NI),ro="MenuSubTrigger",Am=x.forwardRef((e,t)=>{const n=tr(ro,e.__scopeMenu),r=Uo(ro,e.__scopeMenu),o=bm(ro,e.__scopeMenu),s=Ec(ro,e.__scopeMenu),i=x.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=s,c={__scopeMenu:e.__scopeMenu},d=x.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return x.useEffect(()=>d,[d]),x.useEffect(()=>{const f=a.current;return()=>{window.clearTimeout(f),l(null)}},[a,l]),S.jsx(bc,{asChild:!0,...c,children:S.jsx(dm,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":o.contentId,"data-state":Mm(n.open),...e,ref:Vd(t,o.onTriggerChange),onClick:f=>{var u;(u=e.onClick)==null||u.call(e,f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ue(e.onPointerMove,ko(f=>{s.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(s.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:ue(e.onPointerLeave,ko(f=>{var h,p;d();const u=(h=n.content)==null?void 0:h.getBoundingClientRect();if(u){const m=(p=n.content)==null?void 0:p.dataset.side,g=m==="right",y=g?-5:5,b=u[g?"left":"right"],w=u[g?"right":"left"];s.onPointerGraceIntentChange({area:[{x:f.clientX+y,y:f.clientY},{x:b,y:u.top},{x:w,y:u.top},{x:w,y:u.bottom},{x:b,y:u.bottom}],side:m}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(f),f.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:ue(e.onKeyDown,f=>{var h;const u=s.searchRef.current!=="";e.disabled||u&&f.key===" "||uI[r.dir].includes(f.key)&&(n.onOpenChange(!0),(h=n.content)==null||h.focus(),f.preventDefault())})})})});Am.displayName=ro;var Em="MenuSubContent",Sm=x.forwardRef((e,t)=>{const n=am(pt,e.__scopeMenu),{forceMount:r=n.forceMount,...o}=e,s=tr(pt,e.__scopeMenu),i=Uo(pt,e.__scopeMenu),a=bm(Em,e.__scopeMenu),l=x.useRef(null),c=Ce(t,l);return S.jsx(_o.Provider,{scope:e.__scopeMenu,children:S.jsx(si,{present:r||s.open,children:S.jsx(_o.Slot,{scope:e.__scopeMenu,children:S.jsx(Sc,{id:a.contentId,"aria-labelledby":a.triggerId,...o,ref:c,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var f;i.isUsingKeyboardRef.current&&((f=l.current)==null||f.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:ue(e.onFocusOutside,d=>{d.target!==a.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:ue(e.onEscapeKeyDown,d=>{i.onClose(),d.preventDefault()}),onKeyDown:ue(e.onKeyDown,d=>{var h;const f=d.currentTarget.contains(d.target),u=dI[i.dir].includes(d.key);f&&u&&(s.onOpenChange(!1),(h=a.trigger)==null||h.focus(),d.preventDefault())})})})})})});Sm.displayName=Em;function Mm(e){return e?"open":"closed"}function ri(e){return e==="indeterminate"}function Rc(e){return ri(e)?"indeterminate":e?"checked":"unchecked"}function TI(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function _I(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function kI(e,t,n){const o=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=n?e.indexOf(n):-1;let i=_I(e,Math.max(s,0));o.length===1&&(i=i.filter(c=>c!==n));const l=i.find(c=>c.toLowerCase().startsWith(o.toLowerCase()));return l!==n?l:void 0}function DI(e,t){const{x:n,y:r}=e;let o=!1;for(let s=0,i=t.length-1;s<t.length;i=s++){const a=t[s],l=t[i],c=a.x,d=a.y,f=l.x,u=l.y;d>r!=u>r&&n<(f-c)*(r-d)/(u-d)+c&&(o=!o)}return o}function OI(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return DI(n,t)}function ko(e){return t=>t.pointerType==="mouse"?e(t):void 0}var LI=im,BI=bc,FI=lm,jI=cm,qI=Mc,zI=um,HI=Li,VI=fm,UI=pm,$I=mm,GI=wm,KI=xm,WI=vm,YI=Am,XI=Sm,Bi="DropdownMenu",[QI,AT]=Dr(Bi,[om]),Ge=om(),[ZI,Cm]=QI(Bi),Rm=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:o,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,l=Ge(t),c=x.useRef(null),[d,f]=Ps({prop:o,defaultProp:s??!1,onChange:i,caller:Bi});return S.jsx(ZI,{scope:t,triggerId:Er(),triggerRef:c,contentId:Er(),open:d,onOpenChange:f,onOpenToggle:x.useCallback(()=>f(u=>!u),[f]),modal:a,children:S.jsx(LI,{...l,open:d,onOpenChange:f,dir:r,modal:a,children:n})})};Rm.displayName=Bi;var Pm="DropdownMenuTrigger",Im=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...o}=e,s=Cm(Pm,n),i=Ge(n);return S.jsx(BI,{asChild:!0,...i,children:S.jsx(xe.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...o,ref:Vd(t,s.triggerRef),onPointerDown:ue(e.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(s.onOpenToggle(),s.open||a.preventDefault())}),onKeyDown:ue(e.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&s.onOpenToggle(),a.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});Im.displayName=Pm;var JI="DropdownMenuPortal",Nm=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Ge(t);return S.jsx(FI,{...r,...n})};Nm.displayName=JI;var Tm="DropdownMenuContent",_m=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Cm(Tm,n),s=Ge(n),i=x.useRef(!1);return S.jsx(jI,{id:o.contentId,"aria-labelledby":o.triggerId,...s,...r,ref:t,onCloseAutoFocus:ue(e.onCloseAutoFocus,a=>{var l;i.current||(l=o.triggerRef.current)==null||l.focus(),i.current=!1,a.preventDefault()}),onInteractOutside:ue(e.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;(!o.modal||d)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});_m.displayName=Tm;var eN="DropdownMenuGroup",tN=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(qI,{...o,...r,ref:t})});tN.displayName=eN;var nN="DropdownMenuLabel",rN=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(zI,{...o,...r,ref:t})});rN.displayName=nN;var oN="DropdownMenuItem",ml=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(HI,{...o,...r,ref:t})});ml.displayName=oN;var sN="DropdownMenuCheckboxItem",iN=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(VI,{...o,...r,ref:t})});iN.displayName=sN;var aN="DropdownMenuRadioGroup",lN=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(UI,{...o,...r,ref:t})});lN.displayName=aN;var cN="DropdownMenuRadioItem",uN=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx($I,{...o,...r,ref:t})});uN.displayName=cN;var dN="DropdownMenuItemIndicator",fN=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(GI,{...o,...r,ref:t})});fN.displayName=dN;var hN="DropdownMenuSeparator",km=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(KI,{...o,...r,ref:t})});km.displayName=hN;var pN="DropdownMenuArrow",gN=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(WI,{...o,...r,ref:t})});gN.displayName=pN;var mN="DropdownMenuSubTrigger",yN=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(YI,{...o,...r,ref:t})});yN.displayName=mN;var wN="DropdownMenuSubContent",xN=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,o=Ge(n);return S.jsx(XI,{...o,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});xN.displayName=wN;const Fe=[];for(let e=0;e<256;++e)Fe.push((e+256).toString(16).slice(1));function vN(e,t=0){return(Fe[e[t+0]]+Fe[e[t+1]]+Fe[e[t+2]]+Fe[e[t+3]]+"-"+Fe[e[t+4]]+Fe[e[t+5]]+"-"+Fe[e[t+6]]+Fe[e[t+7]]+"-"+Fe[e[t+8]]+Fe[e[t+9]]+"-"+Fe[e[t+10]]+Fe[e[t+11]]+Fe[e[t+12]]+Fe[e[t+13]]+Fe[e[t+14]]+Fe[e[t+15]]).toLowerCase()}let Sa;const bN=new Uint8Array(16);function AN(){if(!Sa){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Sa=crypto.getRandomValues.bind(crypto)}return Sa(bN)}const EN=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Fd={randomUUID:EN};function Qt(e,t,n){var o;if(Fd.randomUUID&&!e)return Fd.randomUUID();e=e||{};const r=e.random??((o=e.rng)==null?void 0:o.call(e))??AN();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,vN(r)}const kr=({id:e,position:t})=>{const n=So({handleId:e,handleType:"target"});if(t==ae.Right)return S.jsx(Nr,{id:e,type:"source",position:ae.Right,className:"!static float-right mt-3 flex !h-3 !w-3 items-baseline justify-center !rounded-[2px] !border-emerald-300 text-[8px]"});if(t==ae.Left)return S.jsx(Nr,{id:e,type:"target",position:ae.Left,isConnectable:n.length<1,className:"!static float-left mt-3 flex !h-3 !w-3 items-baseline justify-center !rounded-[2px] !border-emerald-300 text-[8px]"})},Ht=({id:e,position:t,label:n})=>{if(t==ae.Right)return S.jsxs("div",{className:"text-right",children:[n,S.jsx(kr,{id:e,position:t})]});if(t==ae.Left)return S.jsxs("div",{className:"text-left",children:[n,S.jsx(kr,{id:e,position:t})]})},En=({label:e,type:t,active:n=!1,children:r})=>S.jsxs("div",{className:Ud("flex flex-col justify-around rounded-sm border-1 pb-3 font-mono text-white",n?"border-emerald-400 outline-2 outline-emerald-400":"border-blue-300"),children:[S.jsxs("div",{className:"flex items-start justify-between p-3",children:[S.jsxs("div",{children:[S.jsx("h2",{className:"font-bold",children:e}),S.jsx("p",{className:"text-xs italic",children:t})]}),e!=="Select Math Type"&&S.jsx(z0,{target:"_blank",to:`/docs/nodes/${e.toLowerCase()}`,children:S.jsx(H0,{className:"cursor-pointer text-slate-400"})})]}),r]}),Fn=(e,t,n)=>{const r=e.get(t);return(r==null?void 0:r.sourceNode.getResult(r.sourceHandleId))??n},mn="input-handle-x",jn="input-handle-y",Ma="input-handle-z",Vt="output-handle-x",jd="output-handle-y",SN=x.memo(({id:e})=>{const{updateNodeData:t}=$e(),[n,r]=x.useState(0);return x.useEffect(()=>{t(e,{compute:(o,s)=>{r(Fn(o,mn,0))}})},[]),S.jsx("div",{className:"min-w-48",children:S.jsx(En,{label:"Debug-Display",type:"float",children:S.jsxs("div",{className:"flex gap-2",children:[S.jsx(Ht,{id:mn,position:ae.Left}),S.jsx("p",{children:n})]})})})}),MN=x.memo(({id:e})=>{const t=gn(r=>r.gameData),{updateNodeData:n}=$e();return x.useEffect(()=>{n(e,{compute:(r,o)=>{t.forEach(({handleId:s,value:i})=>{o.set(s,i)})}})},[t]),S.jsx("div",{className:"min-w-48",children:S.jsx(En,{label:"XPOS TEST",type:"float",children:Array.from(t).map(([r,{handleId:o}])=>S.jsx(Ht,{id:o,position:ae.Right,label:r},o))})})});function qd(e,[t,n]){return Math.min(n,Math.max(t,e))}function CN(e){const t=x.useRef({value:e,previous:e});return x.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Dm=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),RN="VisuallyHidden",PN=x.forwardRef((e,t)=>S.jsx(xe.span,{...e,ref:t,style:{...Dm,...e.style}}));PN.displayName=RN;var IN=[" ","Enter","ArrowUp","ArrowDown"],NN=[" ","Enter"],Yn="Select",[Fi,ji,TN]=ic(Yn),[qr,ET]=Dr(Yn,[TN,ki]),qi=ki(),[_N,Sn]=qr(Yn),[kN,DN]=qr(Yn),Om=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:o,onOpenChange:s,value:i,defaultValue:a,onValueChange:l,dir:c,name:d,autoComplete:f,disabled:u,required:h,form:p}=e,m=qi(t),[g,y]=x.useState(null),[b,w]=x.useState(null),[E,P]=x.useState(!1),A=ac(c),[v,M]=Ps({prop:r,defaultProp:o??!1,onChange:s,caller:Yn}),[N,_]=Ps({prop:i,defaultProp:a,onChange:l,caller:Yn}),D=x.useRef(null),B=g?p||!!g.closest("form"):!0,[j,R]=x.useState(new Set),O=Array.from(j).map(I=>I.props.value).join(";");return S.jsx(Fg,{...m,children:S.jsxs(_N,{required:h,scope:t,trigger:g,onTriggerChange:y,valueNode:b,onValueNodeChange:w,valueNodeHasChildren:E,onValueNodeHasChildrenChange:P,contentId:Er(),value:N,onValueChange:_,open:v,onOpenChange:M,dir:A,triggerPointerDownPosRef:D,disabled:u,children:[S.jsx(Fi.Provider,{scope:t,children:S.jsx(kN,{scope:e.__scopeSelect,onNativeOptionAdd:x.useCallback(I=>{R(k=>new Set(k).add(I))},[]),onNativeOptionRemove:x.useCallback(I=>{R(k=>{const F=new Set(k);return F.delete(I),F})},[]),children:n})}),B?S.jsxs(o0,{"aria-hidden":!0,required:h,tabIndex:-1,name:d,autoComplete:f,value:N,onChange:I=>_(I.target.value),disabled:u,form:p,children:[N===void 0?S.jsx("option",{value:""}):null,Array.from(j)]},O):null]})})};Om.displayName=Yn;var Lm="SelectTrigger",Bm=x.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...o}=e,s=qi(n),i=Sn(Lm,n),a=i.disabled||r,l=Ce(t,i.onTriggerChange),c=ji(n),d=x.useRef("touch"),[f,u,h]=i0(m=>{const g=c().filter(w=>!w.disabled),y=g.find(w=>w.value===i.value),b=a0(g,m,y);b!==void 0&&i.onValueChange(b.value)}),p=m=>{a||(i.onOpenChange(!0),h()),m&&(i.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return S.jsx(jg,{asChild:!0,...s,children:S.jsx(xe.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":s0(i.value)?"":void 0,...o,ref:l,onClick:ue(o.onClick,m=>{m.currentTarget.focus(),d.current!=="mouse"&&p(m)}),onPointerDown:ue(o.onPointerDown,m=>{d.current=m.pointerType;const g=m.target;g.hasPointerCapture(m.pointerId)&&g.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(p(m),m.preventDefault())}),onKeyDown:ue(o.onKeyDown,m=>{const g=f.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&u(m.key),!(g&&m.key===" ")&&IN.includes(m.key)&&(p(),m.preventDefault())})})})});Bm.displayName=Lm;var Fm="SelectValue",jm=x.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:o,children:s,placeholder:i="",...a}=e,l=Sn(Fm,n),{onValueNodeHasChildrenChange:c}=l,d=s!==void 0,f=Ce(t,l.onValueNodeChange);return gt(()=>{c(d)},[c,d]),S.jsx(xe.span,{...a,ref:f,style:{pointerEvents:"none"},children:s0(l.value)?S.jsx(S.Fragment,{children:i}):s})});jm.displayName=Fm;var ON="SelectIcon",qm=x.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...o}=e;return S.jsx(xe.span,{"aria-hidden":!0,...o,ref:t,children:r||""})});qm.displayName=ON;var LN="SelectPortal",zm=e=>S.jsx(xc,{asChild:!0,...e});zm.displayName=LN;var Xn="SelectContent",Hm=x.forwardRef((e,t)=>{const n=Sn(Xn,e.__scopeSelect),[r,o]=x.useState();if(gt(()=>{o(new DocumentFragment)},[]),!n.open){const s=r;return s?Al.createPortal(S.jsx(Vm,{scope:e.__scopeSelect,children:S.jsx(Fi.Slot,{scope:e.__scopeSelect,children:S.jsx("div",{children:e.children})})}),s):null}return S.jsx(Um,{...e,ref:t})});Hm.displayName=Xn;var Et=10,[Vm,Mn]=qr(Xn),BN="SelectContentImpl",FN=Rs("SelectContent.RemoveScroll"),Um=x.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:s,onPointerDownOutside:i,side:a,sideOffset:l,align:c,alignOffset:d,arrowPadding:f,collisionBoundary:u,collisionPadding:h,sticky:p,hideWhenDetached:m,avoidCollisions:g,...y}=e,b=Sn(Xn,n),[w,E]=x.useState(null),[P,A]=x.useState(null),v=Ce(t,q=>E(q)),[M,N]=x.useState(null),[_,D]=x.useState(null),B=ji(n),[j,R]=x.useState(!1),O=x.useRef(!1);x.useEffect(()=>{if(w)return Yg(w)},[w]),mg();const I=x.useCallback(q=>{const[W,...te]=B().map(ne=>ne.ref.current),[se]=te.slice(-1),oe=document.activeElement;for(const ne of q)if(ne===oe||(ne==null||ne.scrollIntoView({block:"nearest"}),ne===W&&P&&(P.scrollTop=0),ne===se&&P&&(P.scrollTop=P.scrollHeight),ne==null||ne.focus(),document.activeElement!==oe))return},[B,P]),k=x.useCallback(()=>I([M,w]),[I,M,w]);x.useEffect(()=>{j&&k()},[j,k]);const{onOpenChange:F,triggerPointerDownPosRef:T}=b;x.useEffect(()=>{if(w){let q={x:0,y:0};const W=se=>{var oe,ne;q={x:Math.abs(Math.round(se.pageX)-(((oe=T.current)==null?void 0:oe.x)??0)),y:Math.abs(Math.round(se.pageY)-(((ne=T.current)==null?void 0:ne.y)??0))}},te=se=>{q.x<=10&&q.y<=10?se.preventDefault():w.contains(se.target)||F(!1),document.removeEventListener("pointermove",W),T.current=null};return T.current!==null&&(document.addEventListener("pointermove",W),document.addEventListener("pointerup",te,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",W),document.removeEventListener("pointerup",te,{capture:!0})}}},[w,F,T]),x.useEffect(()=>{const q=()=>F(!1);return window.addEventListener("blur",q),window.addEventListener("resize",q),()=>{window.removeEventListener("blur",q),window.removeEventListener("resize",q)}},[F]);const[z,V]=i0(q=>{const W=B().filter(oe=>!oe.disabled),te=W.find(oe=>oe.ref.current===document.activeElement),se=a0(W,q,te);se&&setTimeout(()=>se.ref.current.focus())}),U=x.useCallback((q,W,te)=>{const se=!O.current&&!te;(b.value!==void 0&&b.value===W||se)&&(N(q),se&&(O.current=!0))},[b.value]),K=x.useCallback(()=>w==null?void 0:w.focus(),[w]),Y=x.useCallback((q,W,te)=>{const se=!O.current&&!te;(b.value!==void 0&&b.value===W||se)&&D(q)},[b.value]),ee=r==="popper"?yl:$m,Z=ee===yl?{side:a,sideOffset:l,align:c,alignOffset:d,arrowPadding:f,collisionBoundary:u,collisionPadding:h,sticky:p,hideWhenDetached:m,avoidCollisions:g}:{};return S.jsx(Vm,{scope:n,content:w,viewport:P,onViewportChange:A,itemRefCallback:U,selectedItem:M,onItemLeave:K,itemTextRefCallback:Y,focusSelectedItem:k,selectedItemText:_,position:r,isPositioned:j,searchRef:z,children:S.jsx(vc,{as:FN,allowPinchZoom:!0,children:S.jsx(cc,{asChild:!0,trapped:b.open,onMountAutoFocus:q=>{q.preventDefault()},onUnmountAutoFocus:ue(o,q=>{var W;(W=b.trigger)==null||W.focus({preventScroll:!0}),q.preventDefault()}),children:S.jsx(lc,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:q=>q.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:S.jsx(ee,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:q=>q.preventDefault(),...y,...Z,onPlaced:()=>R(!0),ref:v,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:ue(y.onKeyDown,q=>{const W=q.ctrlKey||q.altKey||q.metaKey;if(q.key==="Tab"&&q.preventDefault(),!W&&q.key.length===1&&V(q.key),["ArrowUp","ArrowDown","Home","End"].includes(q.key)){let se=B().filter(oe=>!oe.disabled).map(oe=>oe.ref.current);if(["ArrowUp","End"].includes(q.key)&&(se=se.slice().reverse()),["ArrowUp","ArrowDown"].includes(q.key)){const oe=q.target,ne=se.indexOf(oe);se=se.slice(ne+1)}setTimeout(()=>I(se)),q.preventDefault()}})})})})})})});Um.displayName=BN;var jN="SelectItemAlignedPosition",$m=x.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...o}=e,s=Sn(Xn,n),i=Mn(Xn,n),[a,l]=x.useState(null),[c,d]=x.useState(null),f=Ce(t,v=>d(v)),u=ji(n),h=x.useRef(!1),p=x.useRef(!0),{viewport:m,selectedItem:g,selectedItemText:y,focusSelectedItem:b}=i,w=x.useCallback(()=>{if(s.trigger&&s.valueNode&&a&&c&&m&&g&&y){const v=s.trigger.getBoundingClientRect(),M=c.getBoundingClientRect(),N=s.valueNode.getBoundingClientRect(),_=y.getBoundingClientRect();if(s.dir!=="rtl"){const oe=_.left-M.left,ne=N.left-oe,J=v.left-ne,re=v.width+J,le=Math.max(re,M.width),ce=window.innerWidth-Et,me=qd(ne,[Et,Math.max(Et,ce-le)]);a.style.minWidth=re+"px",a.style.left=me+"px"}else{const oe=M.right-_.right,ne=window.innerWidth-N.right-oe,J=window.innerWidth-v.right-ne,re=v.width+J,le=Math.max(re,M.width),ce=window.innerWidth-Et,me=qd(ne,[Et,Math.max(Et,ce-le)]);a.style.minWidth=re+"px",a.style.right=me+"px"}const D=u(),B=window.innerHeight-Et*2,j=m.scrollHeight,R=window.getComputedStyle(c),O=parseInt(R.borderTopWidth,10),I=parseInt(R.paddingTop,10),k=parseInt(R.borderBottomWidth,10),F=parseInt(R.paddingBottom,10),T=O+I+j+F+k,z=Math.min(g.offsetHeight*5,T),V=window.getComputedStyle(m),U=parseInt(V.paddingTop,10),K=parseInt(V.paddingBottom,10),Y=v.top+v.height/2-Et,ee=B-Y,Z=g.offsetHeight/2,q=g.offsetTop+Z,W=O+I+q,te=T-W;if(W<=Y){const oe=D.length>0&&g===D[D.length-1].ref.current;a.style.bottom="0px";const ne=c.clientHeight-m.offsetTop-m.offsetHeight,J=Math.max(ee,Z+(oe?K:0)+ne+k),re=W+J;a.style.height=re+"px"}else{const oe=D.length>0&&g===D[0].ref.current;a.style.top="0px";const J=Math.max(Y,O+m.offsetTop+(oe?U:0)+Z)+te;a.style.height=J+"px",m.scrollTop=W-Y+m.offsetTop}a.style.margin=`${Et}px 0`,a.style.minHeight=z+"px",a.style.maxHeight=B+"px",r==null||r(),requestAnimationFrame(()=>h.current=!0)}},[u,s.trigger,s.valueNode,a,c,m,g,y,s.dir,r]);gt(()=>w(),[w]);const[E,P]=x.useState();gt(()=>{c&&P(window.getComputedStyle(c).zIndex)},[c]);const A=x.useCallback(v=>{v&&p.current===!0&&(w(),b==null||b(),p.current=!1)},[w,b]);return S.jsx(zN,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:h,onScrollButtonChange:A,children:S.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:E},children:S.jsx(xe.div,{...o,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});$m.displayName=jN;var qN="SelectPopperPosition",yl=x.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:o=Et,...s}=e,i=qi(n);return S.jsx(qg,{...i,...s,ref:t,align:r,collisionPadding:o,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});yl.displayName=qN;var[zN,Pc]=qr(Xn,{}),wl="SelectViewport",Gm=x.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...o}=e,s=Mn(wl,n),i=Pc(wl,n),a=Ce(t,s.onViewportChange),l=x.useRef(0);return S.jsxs(S.Fragment,{children:[S.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),S.jsx(Fi.Slot,{scope:n,children:S.jsx(xe.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:ue(o.onScroll,c=>{const d=c.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:u}=i;if(u!=null&&u.current&&f){const h=Math.abs(l.current-d.scrollTop);if(h>0){const p=window.innerHeight-Et*2,m=parseFloat(f.style.minHeight),g=parseFloat(f.style.height),y=Math.max(m,g);if(y<p){const b=y+h,w=Math.min(p,b),E=b-w;f.style.height=w+"px",f.style.bottom==="0px"&&(d.scrollTop=E>0?E:0,f.style.justifyContent="flex-end")}}}l.current=d.scrollTop})})})]})});Gm.displayName=wl;var Km="SelectGroup",[HN,VN]=qr(Km),Wm=x.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,o=Er();return S.jsx(HN,{scope:n,id:o,children:S.jsx(xe.div,{role:"group","aria-labelledby":o,...r,ref:t})})});Wm.displayName=Km;var Ym="SelectLabel",UN=x.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,o=VN(Ym,n);return S.jsx(xe.div,{id:o.id,...r,ref:t})});UN.displayName=Ym;var oi="SelectItem",[$N,Xm]=qr(oi),Qm=x.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:o=!1,textValue:s,...i}=e,a=Sn(oi,n),l=Mn(oi,n),c=a.value===r,[d,f]=x.useState(s??""),[u,h]=x.useState(!1),p=Ce(t,b=>{var w;return(w=l.itemRefCallback)==null?void 0:w.call(l,b,r,o)}),m=Er(),g=x.useRef("touch"),y=()=>{o||(a.onValueChange(r),a.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return S.jsx($N,{scope:n,value:r,disabled:o,textId:m,isSelected:c,onItemTextChange:x.useCallback(b=>{f(w=>w||((b==null?void 0:b.textContent)??"").trim())},[]),children:S.jsx(Fi.ItemSlot,{scope:n,value:r,disabled:o,textValue:d,children:S.jsx(xe.div,{role:"option","aria-labelledby":m,"data-highlighted":u?"":void 0,"aria-selected":c&&u,"data-state":c?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...i,ref:p,onFocus:ue(i.onFocus,()=>h(!0)),onBlur:ue(i.onBlur,()=>h(!1)),onClick:ue(i.onClick,()=>{g.current!=="mouse"&&y()}),onPointerUp:ue(i.onPointerUp,()=>{g.current==="mouse"&&y()}),onPointerDown:ue(i.onPointerDown,b=>{g.current=b.pointerType}),onPointerMove:ue(i.onPointerMove,b=>{var w;g.current=b.pointerType,o?(w=l.onItemLeave)==null||w.call(l):g.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ue(i.onPointerLeave,b=>{var w;b.currentTarget===document.activeElement&&((w=l.onItemLeave)==null||w.call(l))}),onKeyDown:ue(i.onKeyDown,b=>{var E;((E=l.searchRef)==null?void 0:E.current)!==""&&b.key===" "||(NN.includes(b.key)&&y(),b.key===" "&&b.preventDefault())})})})})});Qm.displayName=oi;var oo="SelectItemText",Zm=x.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:o,...s}=e,i=Sn(oo,n),a=Mn(oo,n),l=Xm(oo,n),c=DN(oo,n),[d,f]=x.useState(null),u=Ce(t,y=>f(y),l.onItemTextChange,y=>{var b;return(b=a.itemTextRefCallback)==null?void 0:b.call(a,y,l.value,l.disabled)}),h=d==null?void 0:d.textContent,p=x.useMemo(()=>S.jsx("option",{value:l.value,disabled:l.disabled,children:h},l.value),[l.disabled,l.value,h]),{onNativeOptionAdd:m,onNativeOptionRemove:g}=c;return gt(()=>(m(p),()=>g(p)),[m,g,p]),S.jsxs(S.Fragment,{children:[S.jsx(xe.span,{id:l.textId,...s,ref:u}),l.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Al.createPortal(s.children,i.valueNode):null]})});Zm.displayName=oo;var Jm="SelectItemIndicator",e0=x.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return Xm(Jm,n).isSelected?S.jsx(xe.span,{"aria-hidden":!0,...r,ref:t}):null});e0.displayName=Jm;var xl="SelectScrollUpButton",t0=x.forwardRef((e,t)=>{const n=Mn(xl,e.__scopeSelect),r=Pc(xl,e.__scopeSelect),[o,s]=x.useState(!1),i=Ce(t,r.onScrollButtonChange);return gt(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollTop>0;s(c)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),o?S.jsx(r0,{...e,ref:i,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});t0.displayName=xl;var vl="SelectScrollDownButton",n0=x.forwardRef((e,t)=>{const n=Mn(vl,e.__scopeSelect),r=Pc(vl,e.__scopeSelect),[o,s]=x.useState(!1),i=Ce(t,r.onScrollButtonChange);return gt(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollHeight-l.clientHeight,d=Math.ceil(l.scrollTop)<c;s(d)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),o?S.jsx(r0,{...e,ref:i,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});n0.displayName=vl;var r0=x.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...o}=e,s=Mn("SelectScrollButton",n),i=x.useRef(null),a=ji(n),l=x.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return x.useEffect(()=>()=>l(),[l]),gt(()=>{var d;const c=a().find(f=>f.ref.current===document.activeElement);(d=c==null?void 0:c.ref.current)==null||d.scrollIntoView({block:"nearest"})},[a]),S.jsx(xe.div,{"aria-hidden":!0,...o,ref:t,style:{flexShrink:0,...o.style},onPointerDown:ue(o.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:ue(o.onPointerMove,()=>{var c;(c=s.onItemLeave)==null||c.call(s),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:ue(o.onPointerLeave,()=>{l()})})}),GN="SelectSeparator",KN=x.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return S.jsx(xe.div,{"aria-hidden":!0,...r,ref:t})});KN.displayName=GN;var bl="SelectArrow",WN=x.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,o=qi(n),s=Sn(bl,n),i=Mn(bl,n);return s.open&&i.position==="popper"?S.jsx(zg,{...o,...r,ref:t}):null});WN.displayName=bl;var YN="SelectBubbleInput",o0=x.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const o=x.useRef(null),s=Ce(r,o),i=CN(t);return x.useEffect(()=>{const a=o.current;if(!a)return;const l=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(l,"value").set;if(i!==t&&d){const f=new Event("change",{bubbles:!0});d.call(a,t),a.dispatchEvent(f)}},[i,t]),S.jsx(xe.select,{...n,style:{...Dm,...n.style},ref:s,defaultValue:t})});o0.displayName=YN;function s0(e){return e===""||e===void 0}function i0(e){const t=qt(e),n=x.useRef(""),r=x.useRef(0),o=x.useCallback(i=>{const a=n.current+i;t(a),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(a)},[t]),s=x.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return x.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,o,s]}function a0(e,t,n){const o=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=n?e.indexOf(n):-1;let i=XN(e,Math.max(s,0));o.length===1&&(i=i.filter(c=>c!==n));const l=i.find(c=>c.textValue.toLowerCase().startsWith(o.toLowerCase()));return l!==n?l:void 0}function XN(e,t){return e.map((n,r)=>e[(t+r)%e.length])}const QN=({children:e,category:t="",...n})=>{const[r,o]=x.useState(!1);return S.jsxs("div",{className:"h-fit transition-all duration-200 ease-in-out",...n,children:[S.jsxs("button",{onClick:()=>o(!r),className:"text-s flex w-full justify-between rounded-sm px-2 py-1 text-left font-mono font-bold text-white hover:bg-slate-800 focus:bg-slate-800 focus:outline-none",children:[t,S.jsx(Ra,{})]}),S.jsx("div",{className:"flex flex-col items-start justify-start rounded-sm bg-slate-900 text-white transition-all duration-200 ease-in-out"+(r?" h-fit border-1 border-slate-700 p-2":" h-0 overflow-hidden border-1 border-transparent p-0"),children:S.jsx("div",{className:"flex w-full flex-col",children:e})})]})},l0=({setSelected:e,items:t,defaultValue:n=""})=>S.jsxs(Om,{onValueChange:r=>e(r),defaultValue:n,children:[S.jsxs(Bm,{className:"nodrag text-md mx-3 flex flex-1 items-baseline rounded-sm border border-slate-700 bg-slate-900 px-1 text-white focus:border-slate-500 focus:outline-none","aria-label":"Key",children:[S.jsx(jm,{placeholder:"..."}),S.jsx(qm,{className:"ml-auto text-white",children:S.jsx(Ra,{})})]}),S.jsx(zm,{children:S.jsxs(Hm,{className:"overflow-hidden rounded-md border border-slate-700 bg-slate-900 shadow-md",children:[S.jsx(t0,{className:"flex h-[25px] items-center justify-center bg-slate-900 text-white",children:S.jsx(U0,{})}),S.jsx(Gm,{className:"p-1",children:S.jsx(Wm,{children:Object.entries(t).map(([r,o])=>S.jsx(QN,{category:r,children:o.map(s=>S.jsx(ZN,{value:s,className:"w-full",children:s},s))},r))})}),S.jsx(n0,{className:"flex h-[25px] items-center justify-center bg-slate-900 text-white",children:S.jsx(Ra,{})})]})})]}),ZN=St.forwardRef(({className:e,children:t,...n},r)=>S.jsxs(Qm,{className:Ud("text-md relative flex h-[25px] items-center justify-between rounded px-1 font-mono leading-none text-white select-none data-[disabled]:pointer-events-none data-[disabled]:text-slate-500 data-[highlighted]:bg-slate-800 data-[highlighted]:outline-none",e),...n,ref:r,children:[S.jsx(Zm,{children:t}),S.jsx(e0,{className:"absolute right-0 inline-flex w-[25px] items-center justify-center",children:S.jsx(V0,{})})]})),JN=x.memo(({id:e})=>{const{updateNodeData:t}=$e(),[n,r]=x.useState(""),o=ep(s=>s.keysPressed[n]??!1);return x.useEffect(()=>{t(e,{compute:(s,i)=>{i.set(Vt,+o)}})},[o]),S.jsx("div",{className:"min-w-48",children:S.jsx(En,{label:"KeyPress",type:"float",active:o,children:S.jsxs("div",{className:"flex w-full justify-end gap-2",children:[S.jsx(l0,{setSelected:r,items:{keys:["w","a","s","d"],other:["space","enter"]}}),S.jsx(Ht,{id:Vt,position:ae.Right,label:"Value"})]})})})}),Qn=({value:e,setValue:t,defaultValue:n,disabled:r=!1,type:o="float",...s})=>{const[i,a]=x.useState(String(n)),l=d=>{if(r&&e)return;const f=d.target.value.replace(",",".");/^(-?)\d*\.?\d*$/.test(f)&&a(f);const u=Number(f);isNaN(u)||t(u)},c=d=>{if(r&&e)return;const f=d.target.value;/^(-?)\d*$/.test(f)&&(a(f),t(Number(f)))};return S.jsx("input",{type:"text",inputMode:"decimal",onChange:d=>{switch(o){case"float":l(d);break;case"int":c(d);break}},className:"nodrag ml-3 w-12 rounded-sm border-1 border-slate-700 bg-slate-900 px-1 focus:border-slate-500 focus:outline-none disabled:text-slate-500",value:e&&r?e:i,disabled:r,...s})},eT=x.memo(({id:e})=>{const{updateNodeData:t}=$e(),n=Hs(o=>o.time),r=Hs(o=>o.deltaTime);return x.useEffect(()=>{t(e,{compute:(o,s)=>{s.set(Vt,n),s.set(jd,r)}})},[n]),S.jsx("div",{className:"min-w-48",children:S.jsxs(En,{label:"Time",type:"float",children:[S.jsxs("div",{className:"flex w-full justify-end gap-2",children:[S.jsx(Qn,{value:n,setValue:()=>{},defaultValue:0,disabled:!0}),S.jsx(Ht,{id:Vt,position:ae.Right,label:"Time"})]}),S.jsxs("div",{className:"flex w-full justify-end gap-2",children:[S.jsx(Qn,{value:r,setValue:()=>{},defaultValue:0,disabled:!0}),S.jsx(Ht,{id:jd,position:ae.Right,label:"Delta time"})]})]})})}),tT=x.memo(({id:e})=>{const{updateNodeData:t}=$e(),[n,r]=x.useState(""),[o,s]=x.useState(new Map([["xpos",mn],["ypos",jn]])),i=gn(a=>a.setNodeData);return x.useEffect(()=>{t(e,{compute:(a,l)=>{o.forEach((c,d)=>{i(d,c,Fn(a,c,0))})}})},[o]),S.jsx("div",{children:S.jsxs(En,{label:"Export To Gameobject",type:"export",children:[Array.from(o).map(([a,l])=>S.jsx(Ht,{id:l,position:ae.Left,label:a},l)),S.jsxs("div",{children:[S.jsx("input",{type:"text",className:"nodrag ml-3 w-12 rounded-sm border-1 border-slate-700 bg-slate-900 px-1 focus:border-slate-500 focus:outline-none disabled:text-slate-500",onChange:a=>{r(a.target.value)}}),S.jsx("button",{className:"ml-2 hover:cursor-pointer",onClick:()=>{if(o.has(n))return;const a=new Map(o);a.set(n,Qt()),s(a)},children:"+"})]})]})})}),nT=x.memo(({id:e})=>{const{updateNodeData:t}=$e(),[n,r]=x.useState(0),[o,s]=x.useState(0),[i,a]=x.useState(0),[l,c]=x.useState(0),d=So({handleId:jn,handleType:"target"}),f=So({handleId:Ma,handleType:"target"});return x.useEffect(()=>{t(e,{compute:(u,h)=>{const p=Fn(u,mn,0),m=Fn(u,jn,i),g=Fn(u,Ma,l);r(m),s(g),h.set(Vt,p==0?m:g)}})},[i,l]),S.jsx("div",{className:"min-w-3xs",children:S.jsxs(En,{label:"Switch",type:"float",children:[S.jsx(Ht,{id:Vt,position:ae.Right,label:"Result"}),S.jsx(Ht,{label:"bool",id:mn,position:ae.Left}),S.jsxs("div",{className:"text-left",children:["False",S.jsx(Qn,{value:n,setValue:a,defaultValue:0,disabled:!!d.length}),S.jsx(kr,{id:jn,position:ae.Left})]}),S.jsxs("div",{className:"text-left",children:["True",S.jsx(Qn,{value:o,setValue:c,defaultValue:0,disabled:!!f.length}),S.jsx(kr,{id:Ma,position:ae.Left})]})]})})}),rT=x.memo(({id:e,data:t})=>{const{updateNodeData:n}=$e(),[r,o]=x.useState(t.initialComputeType??null),[s,i]=x.useState(zd[r??"Addition"]),[a,l]=x.useState(0),[c,d]=x.useState(0);function f(b){o(b),i(zd[b])}const[u,h]=x.useState(0),[p,m]=x.useState(0),g=So({handleId:mn,handleType:"target"}),y=So({handleId:jn,handleType:"target"});return x.useEffect(()=>{r&&n(e,{compute:(b,w)=>{const E=Fn(b,mn,u),P=Fn(b,jn,p);l(E),d(P),w.set(Vt,sT[r](E,P))}})},[u,p,r]),S.jsx("div",{className:"min-w-3xs",children:S.jsxs(En,{label:r??"Select Math Type",type:"float",children:[S.jsx(l0,{items:oT,setSelected:f,defaultValue:r??""}),r&&S.jsxs(S.Fragment,{children:[S.jsx("br",{}),S.jsx(Ht,{id:Vt,position:ae.Right,label:"Result"}),s[0].enable&&S.jsxs("div",{className:"text-left",children:[s[0].label,S.jsx(Qn,{value:a,setValue:h,defaultValue:0,disabled:!!g.length,type:s[0].type}),S.jsx(kr,{id:mn,position:ae.Left})]}),s[1].enable&&S.jsxs("div",{className:"text-left",children:[s[1].label,S.jsx(Qn,{value:c,setValue:m,defaultValue:0,disabled:!!y.length,type:s[1].type}),S.jsx(kr,{id:jn,position:ae.Left})]})]})]})})}),oT={Functions:["Addition","Substraction","Multiply","Divide","Power","Logarithm","Absolute"],Rounding:["Round","Floor","Ceil","Modulo"],Trigonometric:["Sine","Cosine","Tangent"],Conversion:["To Radians","To Degrees"],Compare:["Equals","Greater Than","Less Than"]},zd={Addition:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],Substraction:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],Multiply:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],Divide:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],Power:[{enable:!0,type:"float",label:"base"},{enable:!0,type:"float",label:"exponent"}],Logarithm:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],Absolute:[{enable:!0,type:"float",label:"x"},{enable:!1,type:void 0,label:""}],Round:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"int",label:"decimal places"}],Floor:[{enable:!0,type:"float",label:"x"},{enable:!1,type:void 0,label:""}],Ceil:[{enable:!0,type:"float",label:"x"},{enable:!1,type:void 0,label:""}],Modulo:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],Sine:[{enable:!0,type:"float",label:"t"},{enable:!1,type:void 0,label:""}],Cosine:[{enable:!0,type:"float",label:"t"},{enable:!1,type:void 0,label:""}],Tangent:[{enable:!0,type:"float",label:"t"},{enable:!1,type:void 0,label:""}],"To Radians":[{enable:!0,type:"float",label:"deg"},{enable:!1,type:void 0,label:""}],"To Degrees":[{enable:!0,type:"float",label:"rad"},{enable:!1,type:void 0,label:""}],Equals:[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],"Greater Than":[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}],"Less Than":[{enable:!0,type:"float",label:"x"},{enable:!0,type:"float",label:"y"}]},sT={Addition:(e,t)=>e+t,Substraction:(e,t)=>e-t,Multiply:(e,t)=>e*t,Divide:(e,t)=>e/t,Power:(e,t)=>Math.pow(e,t),Logarithm:(e,t)=>Math.log(e)/Math.log(t),Absolute:(e,t)=>Math.abs(e),Round:(e,t)=>Math.round((e+Number.EPSILON)*Math.pow(10,t))/Math.pow(10,t),Floor:(e,t)=>Math.floor(e),Ceil:(e,t)=>Math.ceil(e),Modulo:(e,t)=>e%t,Sine:(e,t)=>Math.sin(e),Cosine:(e,t)=>Math.cos(e),Tangent:(e,t)=>Math.tan(e),"To Radians":(e,t)=>e*(Math.PI/180),"To Degree":(e,t)=>e*(180/Math.PI),Equals:(e,t)=>+(e==t),"Greater Than":(e,t)=>+(e>t),"Less Than":(e,t)=>+(e<t)},iT=x.memo(({id:e})=>{const{updateNodeData:t}=$e(),[n,r]=x.useState(0);return x.useEffect(()=>{t(e,{compute:(o,s)=>{s.set(Vt,n)}})},[n]),S.jsx("div",{className:"min-w-48",children:S.jsx(En,{label:"Value",type:"float",children:S.jsxs("div",{className:"flex w-full justify-end gap-2",children:[S.jsx(Qn,{setValue:r,defaultValue:0}),S.jsx(Ht,{id:Vt,position:ae.Right,label:"Value"})]})})})}),Ic={Value:iT,Display:SN,Time:eT,KeyPress:JN,MathFloat:rT,ExportToGameobject:tT,GetFromGameobject:MN,Switch:nT},$o=new Map;$o.set("Game Get",{nodes:[{name:"Key Press",type:"KeyPress",description:"Get key press events."},{name:"Time",type:"Time",description:"Get time-related information."},{name:"Get From Gameobject",type:"GetFromGameobject",description:"Get data from a game object."}]});$o.set("Game Set",{nodes:[{name:"Export To Gameobject",type:"ExportToGameobject",description:"Export data to a game object."}]});$o.set("Math Float",{nodes:[{name:"Math Float",type:"MathFloat",description:"Perform mathematical operations on float values."},{name:"Value",type:"Value",description:"Output a float value."}]});$o.set("Logic",{nodes:[{name:"Switch",type:"Switch",description:"Conditional logic node."}]});$o.set("Debug",{nodes:[{name:"Display",type:"Display",description:"Display a value on the screen."}]});const aT=x.memo(()=>{const{addNodes:e}=$e();return S.jsx(nn,{children:S.jsxs(Rm,{children:[S.jsx(Im,{asChild:!0,children:S.jsx("button",{className:`inline-flex size-[35px] items-center justify-center rounded border-2 bg-white hover:cursor-pointer focus: border-none
            data-[state=open]:bg-slate-800 data-[state=open]:text-white data-[state=open]:rounded-b-none`,"aria-label":"Customise options",children:S.jsx($0,{})})}),S.jsx(Nm,{children:S.jsx(_m,{className:"flex flex-col items-center space-y-2 rounded rounded-tl-none   bg-slate-800 p-2 shadow-lg pt-2 pb-2  w-65 outline-5 outline-solid outline-slate-700",sideOffset:0,align:"start",children:Object.keys(Ic).map((t,n)=>n===0?[S.jsx(ml,{className:"hover:bg-slate-700 rounded pl-2 pr-4 w-62",children:S.jsx("button",{className:"text-white text-sm text-left",onClick:()=>{e({id:Qt(),type:t,position:{x:0,y:0},data:{}})},children:t})},"add_node_dropdown_"+n)]:[S.jsx(km,{className:"bg-slate-700 w-[95%] h-px"},`sep-${n}`),S.jsx(ml,{className:"hover:bg-slate-700 rounded pl-2 pr-4 w-62",children:S.jsx("button",{className:"text-white text-sm text-left",onClick:()=>{e({id:Qt(),type:t,position:{x:0,y:0},data:{}})},children:t})},"add_node_dropdown_"+n)])})})]})})}),lT=({nodeId:e,x:t,y:n,onClose:r})=>{const{getNode:o,setNodes:s,addNodes:i,setEdges:a}=$e(),l=x.useCallback(()=>{const d=o(e);if(!d)return;const f={x:d.position.x+50,y:d.position.y+50};i({...d,selected:!1,dragging:!1,id:Qt(),position:f}),r()},[e,o,i]),c=x.useCallback(()=>{s(d=>d.filter(f=>f.id!==e)),a(d=>d.filter(f=>f.source!==e)),r()},[e,s,a]);return S.jsx("div",{style:{position:"absolute",top:n,left:t,zIndex:1e3},children:S.jsxs(nn,{className:"w-65 space-y-2 rounded bg-slate-800 p-2 pt-2 pb-2 shadow-lg outline-1 outline-slate-700 outline-solid",children:[S.jsx("button",{className:"w-full rounded p-2 text-left text-sm text-white hover:bg-slate-700",onClick:l,children:"Duplicate"}),S.jsx("button",{className:"w-full rounded p-2 text-left text-sm text-white hover:bg-slate-700",onClick:c,children:"Delete"})]})})},cT=({x:e,y:t,onClose:n})=>{const{addNodes:r}=$e(),o=x.useRef(null),[s,i]=x.useState(""),[a,l,c]=ge(f=>f.transform);x.useEffect(()=>{var f;(f=o.current)==null||f.focus()},[]);const d=f=>{const u=document.getElementById("node-editor");if(!u){console.error("Canvas element with ID 'node-editor' not found.");return}const h=u==null?void 0:u.getBoundingClientRect(),p=(e-a)/c-h.left/c,m=(t-l)/c-h.top/c;r({id:Qt(),type:f,position:{x:p,y:m},data:{}}),n()};return S.jsx("div",{style:{position:"absolute",top:t,left:e,zIndex:1e3},children:S.jsxs(nn,{className:"w-65 space-y-2 rounded bg-slate-800 p-2 py-2 font-mono shadow-lg outline-1 outline-slate-700 outline-solid",children:[S.jsx("div",{className:"w-64 pr-4 shadow",children:S.jsx("input",{ref:o,type:"text",placeholder:"Search",className:"w-full rounded bg-slate-900 p-2 text-sm text-white focus:border-gray-300 focus:ring-0 focus:outline-none",onChange:f=>i(f.target.value)})}),S.jsx("div",{children:Object.keys(Ic).filter(f=>f.toLowerCase().includes(s.toLowerCase())).map((f,u)=>S.jsx("button",{className:"w-full rounded px-2 py-1 text-left text-sm text-white hover:bg-slate-700",onClick:()=>d(f),children:f},`add_node_${f}_${u}`))})]})})},uT=({nodeIds:e,x:t,y:n,onClose:r})=>{const{getNodes:o,getEdges:s,addNodes:i,addEdges:a,setNodes:l,setEdges:c}=$e(),d=x.useCallback(()=>{const u=o().filter(y=>e.includes(y.id)),h=s(),p=new Map,m=u.map(y=>{const b=Qt();return p.set(y.id,b),{...y,id:b,position:{x:y.position.x+50,y:y.position.y+50},selected:!1,dragging:!1}}),g=h.filter(y=>p.has(y.source)&&p.has(y.target)).map(y=>{const b=p.get(y.source),w=p.get(y.target);return{...y,id:"xy-edge__"+b+y.sourceHandle+"-"+w+y.targetHandle,source:b,target:w,selected:!1}});i(m),a(g),l(y=>y.map(b=>({...b,selected:m.some(w=>w.id===b.id)}))),r()},[e,o,s,i,a,l,r]),f=x.useCallback(()=>{l(u=>u.filter(h=>!e.includes(h.id))),c(u=>u.filter(h=>!e.includes(h.source)&&!e.includes(h.target))),r()},[e,l,c,r]);return S.jsx("div",{style:{position:"absolute",top:n,left:t,zIndex:1e3},children:S.jsxs(nn,{className:"w-65 space-y-2 rounded bg-slate-800 p-2 shadow-lg",children:[S.jsxs("button",{className:"w-full rounded p-2 text-left text-sm text-white hover:bg-slate-700",onClick:d,children:["Duplicate ",e.length," nodes"]}),S.jsxs("button",{className:"w-full rounded p-2 text-left text-sm text-white hover:bg-slate-700",onClick:f,children:["Delete ",e.length," nodes"]})]})})},dT=[{id:Qt(),type:"Value",position:{x:0,y:0},data:{value:0}},{id:Qt(),type:"MathFloat",position:{x:0,y:200},data:{initialComputeType:"Addition"}},{id:Qt(),type:"Display",position:{x:0,y:500},data:{}}],fT=[],hT=({level:e})=>{const[t,n]=x.useState(dT),[r,o]=x.useState(fT),[s,i]=x.useState(null),[a,l]=x.useState(null),[c,d]=x.useState(null),f=fr(v=>v.replaceNode),u=fr(v=>v.removeNode),h=fr(v=>v.addEdge),p=fr(v=>v.removeEdge),m=fr(v=>v.debugPrint),g=x.useCallback(v=>{v.forEach(M=>{switch(M.type){case"add":f(M.item);break;case"remove":u(M.id);break;case"replace":f(M.item);break}}),n(M=>Sh(v,M))},[n]),y=x.useCallback(v=>{v.forEach(M=>{switch(M.type){case"remove":p(M.id);break;case"add":h(M.item);break}}),o(M=>Mh(v,M))},[o]),b=x.useCallback(v=>{h(v),o(M=>ih(v,M))},[o]),w=x.useCallback(v=>{v.preventDefault();const M=Ca(v);i({x:M.x,y:M.y})},[i]),E=x.useCallback((v,M)=>{v.preventDefault();const N=Ca(v);l({nodeId:M.id,x:N.x,y:N.y})},[l]),P=x.useCallback((v,M)=>{if(v.preventDefault(),M.length===0)return;const N=Ca(v);d({nodeIds:M.map(_=>_.id),x:N.x,y:N.y})},[d]),A=x.useCallback(()=>{i(null),l(null),d(null)},[s,a,c]);return S.jsxs(Yh,{children:[S.jsxs(VA,{id:"node-editor",nodeTypes:Ic,nodes:t,edges:r,onNodesChange:g,onEdgesChange:y,onPaneContextMenu:w,onNodeContextMenu:E,onSelectionContextMenu:P,onConnect:b,onPaneClick:A,fitView:!0,proOptions:{hideAttribution:!0},deleteKeyCode:["Delete","Backspace"],children:[S.jsx(YA,{bgColor:"#14141d",color:"#a7abc2"}),S.jsx(aT,{}),S.jsx(nn,{position:"top-right",children:S.jsx("button",{onClick:m,className:"bg-white p-2",children:"Print Map"})})]}),s&&S.jsx(cT,{x:s.x,y:s.y,onClose:()=>i(null)}),a&&S.jsx(lT,{nodeId:a.nodeId,x:a.x,y:a.y,onClose:()=>l(null)}),c&&S.jsx(uT,{nodeIds:c.nodeIds,x:c.x,y:c.y,onClose:()=>d(null)})]})};function Ca(e){const t=e.clientX>window.innerWidth-274?window.innerWidth-274:e.clientX,n=e.clientY>window.innerHeight-284?window.innerHeight-284:e.clientY;return{x:t-15,y:n-15}}const pT=({params:e})=>{const t=x.useRef(null),n=e.id||"playground";return x.useEffect(()=>{t.current&&(B2(t.current),z2(n))},[t.current]),S.jsxs(df,{direction:"horizontal",children:[S.jsx(Pa,{id:"game-panel",minSize:25,order:1,children:S.jsx("canvas",{id:"game-canvas",ref:t,className:"w-1/2"})}),S.jsx(ff,{className:"flex w-2 items-center justify-center bg-slate-800",children:S.jsx(G0,{width:32,height:32,className:"scale-125 text-slate-400"})}),S.jsx(Pa,{id:"nodes-panel",minSize:25,order:2,children:S.jsx(hT,{level:n})})]})},ST=F0(pT);export{ST as default};
