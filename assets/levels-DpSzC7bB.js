import{n as k,o as P,p as E,a as i,c as O,M as j,u as g}from"./time-DteIwvcY.js";const G="/dumpster/assets/alley_one-Ch0po_m1.jpg",w="/dumpster/assets/alley_two-D6HTRiqu.png",z="/dumpster/assets/house-BZR3Z7t1.png",m=new Set,y=new Set,b=new Set;let f=!1,C,x;function T(e){const t=e.toLowerCase();return t==="space"?" ":t==="enter"?"Enter":e}function K(){f||(f=!0,C=e=>{const t=e.key;m.has(t)||y.add(t),m.add(t)},x=e=>{const t=e.key;m.delete(t),b.add(t)},window.addEventListener("keydown",C),window.addEventListener("keyup",x))}function D(){f&&(window.removeEventListener("keydown",C),window.removeEventListener("keyup",x),f=!1,m.clear(),y.clear(),b.clear())}function M(e){return m.has(T(e))}function Y(e){return y.has(T(e))}function _(e){return b.has(T(e))}function R(){y.clear(),b.clear()}const h={init:K,cleanup:D,isKeyDown:M,isKeyPressed:Y,isKeyReleased:_,clearPressedAndReleased:R},F={first:!0};function V(e){if(!F.first)return;F.first=!1;let t=0,a=0;const{k:o,game:s}=u(e);return k.getState().setKeyDownFunction(h.isKeyDown),k.getState().setKeyPressedFunction(h.isKeyPressed),k.getState().setKeyReleasedFunction(h.isKeyReleased),P.getState().setMousePosFunction(()=>o.mousePos()),E.getState().setTimeFunction(()=>o.time()-a),E.getState().setDeltaTimeFunction(()=>o.dt()),o.onUpdate(()=>{if(i.getState().isPaused){s.paused||(t=o.time()),s.paused=!0;return}s.paused&&(a+=o.time()-t,t=0,s.paused=!1),O.getState().compute(),h.clearPressedAndReleased()}),o}let p;function u(e){if(p)return p;const t=j({global:!1,pixelDensity:2,touchToMouse:!0,debug:!1,debugKey:"f1",canvas:e,background:"#2b292f"}),a=t.add([t.timer()]);return p={k:t,game:a},p}function A(){if(!p)return;const{game:e,app:t}=p.k._k;e.events.onOnce("frameEnd",()=>{t.quit()}),p=void 0,F.first=!0}function v(e){const{k:t,game:a}=u(),o={};if(e.includes("raccoon")){t.loadSprite("raccoon","/game/sprites/raccoon_spritesheet.png",{sliceX:4,sliceY:4,anims:{idle:{from:0,to:0,loop:!1},idleHolding:{from:1,to:1,loop:!1},walk:{from:2,to:7,loop:!0},walkHolding:{from:8,to:13,loop:!0}}});const s=a.add([t.sprite("raccoon",{anim:"walkHolding"}),t.pos(0,0),t.scale(d),t.anchor("bot"),t.area(),t.z(2),"raccoon",t.state("idle",["idle","walkLeft","walkRight"])]);s.onStateEnter("idle",()=>{s.play("idle")}),s.onStateEnter("walkLeft",()=>{s.play("walk"),s.scaleTo(t.vec2(-5.5,d))}),s.onStateEnter("walkRight",()=>{s.play("walk"),s.scaleTo(t.vec2(d,d))}),o.raccoon=s}if((e.includes("trashcanEmpty")||e.includes("trashcanFilled"))&&t.loadSprite("trashcan","/game/sprites/trashcan_spritesheet.png",{sliceX:2,sliceY:1,anims:{empty:{from:0,to:0,loop:!1},filled:{from:1,to:1,loop:!1}}}),e.includes("trashcanEmpty")){const s=a.add([t.sprite("trashcan",{anim:"empty"}),t.anchor("bot"),t.pos(0,0),t.scale(d),t.area(),t.z(1),"trashcanEmpty"]);o.trashcanEmpty=s}if(e.includes("trashcanFilled")){const s=a.add([t.sprite("trashcan",{anim:"filled"}),t.anchor("bot"),t.pos(0,0),t.scale(5),t.area(),t.z(1),"trashcanFilled"]);o.trashcanFilled=s}if(e.includes("goalFlag")){t.loadSprite("flag","/game/sprites/flag_spritesheet.png",{sliceX:2,sliceY:2,anims:{default:{from:0,to:3,loop:!0}}});const s=a.add([t.sprite("flag",{anim:"default"}),t.anchor("bot"),t.pos(0,0),t.area(),t.scale(d),t.z(1)]);o.goalFlag=s}return o}function S(e,t=0){const{k:a,game:o}=u();e.includes("background1")&&(a.loadSprite("background","/game/backgrounds/background1.png"),a.loadSprite("backgroundLight","/game/backgrounds/background1_light.png")),e.includes("backgroundCalc")&&(a.loadSprite("background","/game/backgrounds/background_calculator.png"),a.loadSprite("backgroundLight","/game/backgrounds/background1_light.png")),o.add([a.sprite("background"),a.anchor("center"),a.scale(d),a.pos(0,-260),a.z(0)]),o.add([a.sprite("backgroundLight"),a.anchor("center"),a.scale(d),a.pos(t,-260),a.z(100),a.opacity(.75)])}function L(e,t){var l,n,c,r;const a=e.pos.x;e.pos.x=((n=(l=g.getState().gameObjects.get("raccoon"))==null?void 0:l.get("xpos"))==null?void 0:n.value)??0,e.pos.y=((r=(c=g.getState().gameObjects.get("raccoon"))==null?void 0:c.get("ypos"))==null?void 0:r.value)??0,t.setCamPos(t.lerp(t.getCamPos(),t.vec2(e.pos.x,-260),.1));const o=e.pos.x-a,s=o===0?"idle":o<0?"walkLeft":"walkRight";e.state!==s&&e.enterState(s)}const I=()=>{const{k:e,game:t}=u();S(["background1"]);const{raccoon:a}=v(["raccoon"]);e.setCamPos(0,-260),e.setCamScale(e.height()/947),e.loadSprite("trashcan","/game/sprites/trashcan_spritesheet.png",{sliceX:2,sliceY:1,anims:{empty:{from:0,to:0,loop:!1},filled:{from:1,to:1,loop:!1}}});const o=t.add([e.sprite("trashcan",{anim:"empty"}),e.anchor("bot"),e.pos(0,0),e.scale(5),e.area(),e.z(1),"trashcan1"]),s=t.add([e.sprite("trashcan",{anim:"filled"}),e.anchor("bot"),e.pos(0,0),e.scale(5),e.area(),e.z(1),"trashcan2"]);o.z=3,o.pos.x=200,o.pos.y=-25,s.z=3,s.pos.x=-280,s.pos.y=-110,g.getState().gameObjects.set("trashcan1",new Map([["filled",{access:"get",value:0}],["xpos",{access:"get",value:200}],["ypos",{access:"get",value:-25}]])),g.getState().gameObjects.set("trashcan2",new Map([["filled",{access:"get",value:1}],["xpos",{access:"get",value:-280}],["ypos",{access:"get",value:-110}]])),t.onUpdate(()=>{if(i.getState().isPaused)return;L(a,e),a.pos.dist(s.pos)<=10&&!i.getState().levelCompleted&&(i.getState().setLevelCompleteDialogOpen(!0),i.getState().setLevelCompleted(!0))})},d=5.5,H=()=>{const{k:e,game:t}=u();S(["backgroundCalc"],-200);const{raccoon:a}=v(["raccoon"]);e.setCamPos(-300,-260),e.setCamScale(e.height()/947),a.scaleBy(-1,1);const o=16;t.onUpdate(()=>{var l,n;if(i.getState().isPaused)return;(((n=(l=g.getState().gameObjects.get("raccoon"))==null?void 0:l.get("equationSolution"))==null?void 0:n.value)??0)==o&&!i.getState().levelCompleted&&(i.getState().setLevelCompleteDialogOpen(!0),i.getState().setLevelCompleted(!0))})},N=()=>{const{k:e,game:t}=u();e.loadSprite("raccoon","/game/sprites/raccoon_spritesheet.png",{sliceX:4,sliceY:4,anims:{idle:{from:0,to:0,loop:!1},idleHolding:{from:1,to:1,loop:!1},walk:{from:2,to:7,loop:!0},walkHolding:{from:8,to:13,loop:!0}}}),e.loadSprite("trashcan","/game/sprites/trashcan_spritesheet.png",{sliceX:2,sliceY:1,anims:{empty:{from:0,to:0,loop:!1},filled:{from:1,to:1,loop:!1}}}),e.loadSprite("flag","/game/sprites/flag_spritesheet.png",{sliceX:2,sliceY:2,anims:{default:{from:0,to:3,loop:!0}}}),e.setGravity(2e3);const a=t.add([e.sprite("raccoon",{anim:"walkHolding"}),e.pos(100,e.height()-100),e.scale(5),e.area(),e.body(),"raccoon"]);t.add([e.sprite("flag",{anim:"default"}),e.pos(800,125),e.scale(5),e.area(),"flag"]),t.add([e.rect(e.width(),5),e.pos(0,e.height()-5),e.color(255,200,200),e.area(),e.body({isStatic:!0}),"floor"]);const o=t.add([e.rect(100,300),e.pos(e.width()-200,e.height()-325),e.color(50,50,50),e.area(),"ladderRight"]);t.add([e.rect(e.width()-50,40),e.pos(25,e.height()-345),e.color(100,100,100),e.area(),e.body({isStatic:!0}),e.platformEffector(),"platformMiddle"]);const s=t.add([e.rect(100,300),e.pos(50,e.height()-665),e.color(50,50,50),e.area(),"ladderLeft"]);t.add([e.rect(e.width()-50,40),e.pos(25,e.height()-690),e.color(100,100,100),e.area(),e.body({isStatic:!0}),e.platformEffector(),"platformTop"]),e.onCollide("raccoon","flag",(l,n)=>{l.pos.x=100,l.pos.y=e.height()-100,l.vel.x=0,l.vel.y=0,console.log("Collided with finish line")}),t.onUpdate(()=>{var c,r;if(i.getState().isPaused)return;a.isOverlapping(o||s)?a.gravityScale=0:a.gravityScale=1;const l=((r=(c=g.getState().gameObjects.get("raccoon"))==null?void 0:c.get("value"))==null?void 0:r.value)??0,n=i.getState().levelCompleted;l==24&&!n&&(a.pos.x=.5*e.width(),i.getState().setLevelCompleteDialogOpen(!0),i.getState().setLevelCompleted(!0))})},X=()=>{const{k:e,game:t}=u();S(["background1"]);const{raccoon:a,trashcanFilled:o,goalFlag:s}=v(["raccoon","trashcanFilled","goalFlag"]);e.setCamPos(0,-260),e.setCamScale(e.height()/947),t.onUpdate(()=>{var l,n,c,r;i.getState().isPaused||(L(a,e),o.pos.x=((n=(l=g.getState().gameObjects.get("trashcanFilled"))==null?void 0:l.get("xpos"))==null?void 0:n.value)??0,o.pos.y=((r=(c=g.getState().gameObjects.get("trashcanFilled"))==null?void 0:c.get("ypos"))==null?void 0:r.value)??0)})},q=()=>{const{k:e,game:t}=u();S(["background1"]);const{raccoon:a,trashcanFilled:o}=v(["raccoon","trashcanFilled"]);e.setCamPos(0,-260),e.setCamScale(e.height()/947),o.z=3,o.pos.x=-280,o.pos.y=-110,t.onUpdate(()=>{if(i.getState().isPaused)return;L(a,e),a.pos.dist(o.pos)<=10&&!i.getState().levelCompleted&&(i.getState().setLevelCompleteDialogOpen(!0),i.getState().setLevelCompleted(!0))})},B={playground:{slug:"playground",name:"Playground",description:"This is a sandbox level where you can freely test game mechanics.",dialog:["This is a playground level where you can freely implement game mechanics.","You are allowed to use all available nodes."],goals:["No goals, this level is designed for experimentation and testing."],success:"How did you complete a sandbox level?",category:"Sandbox",image:G,nodes:[],edges:[],initialState:X,hints:["This is a playground level","You don't need hints here","stop clicking there is nothing coming","42"],modifiableGameObjects:[{id:"raccoon",connections:[{label:"xpos",access:"all"},{label:"ypos",access:"all"}]},{id:"trashcanFilled",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]}],availableNodes:["Display","Value","Time","KeyPress","MathFloat","ExportToGameobject","ImportFromGameobject","Switch","Group","ForLoop","MousePosition"],difficulty:0},calculator:{slug:"calculator",name:"Calculator",description:"This is the first level of the game, introducing basic mechanics.",dialog:["Whoa... what's this? Some kinda ancient scribble? Wait… it looks like an equation!","Hmm… maybe it's a clue - maybe if I solve it, I'll figure out what this place is hiding","Quick, human buddy - help me solve it before my brain melts into raccoon soup!!","You! Yes you - my opposable-thumbed hero!","I bet we can solve it using the math nodes in your toolbox.","Once you've figured it out, plug the result into the 'solution' handle on the Export Node"],goals:["Create your first nodes.","Solve the equation."],success:"You solved the equation!",category:"Introduction",image:w,nodes:[],edges:[],initialState:H,hints:[],modifiableGameObjects:[{id:"raccoon",connections:[{label:"equationSolution",access:"set"}]}],availableNodes:["Display","Value","MathFloat","ExportToGameobject"],difficulty:1},sitting:{slug:"sitting",name:"Sitting",description:"This is the second level of the game, introducing position of game objects.",dialog:[`This is the second level of the game. Complete the "calculator" level first, if you haven't done so yet.`,"You will learn how to manipulate the position of a game object."],goals:["Move the raccoon into the trashcan by changing his position."],success:"The raccoon is now happily searching for food in the trashcan!",category:"Introduction",image:w,nodes:[],edges:[],initialState:q,hints:[],modifiableGameObjects:[{id:"raccoon",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]}],availableNodes:["Display","Value","ExportToGameobject"],difficulty:1},iffies:{slug:"iffies",name:"Iffies",description:"This is the third level of the game, introducing if statements.",dialog:[`This is the third level of the game. Complete the "sitting" level first, if you haven't done so yet.`,"You will learn how to use if statements to control game object behavior."],goals:["Use an if statement to make the raccoon move into the filled trashcan."],success:"Luckily the raccoon doesn't have to search for food in an empty trashcan!",category:"Introduction",image:w,nodes:[],edges:[],initialState:I,hints:[],modifiableGameObjects:[{id:"raccoon",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]},{id:"trashcan1",connections:[{label:"filled",access:"get"},{label:"xpos",access:"get"},{label:"ypos",access:"get"}]},{id:"trashcan2",connections:[{label:"filled",access:"get"},{label:"xpos",access:"get"},{label:"ypos",access:"get"}]}],availableNodes:["Display","Value","MathFloat","ImportFromGameobject","Switch","ExportToGameobject"],difficulty:1},move:{slug:"move",name:"Move",description:"This is the first level of the main game, introducing movement mechanics.",dialog:["This is the first level of the main game. It introduces movement mechanics.","You will learn how to move a game object using key inputs."],goals:["Move the raccoon to the flag."],success:"Look, he just learned how to use his feet!",category:"Main Game",image:z,nodes:[],edges:[],initialState:N,hints:[],modifiableGameObjects:[{id:"raccoon",connections:[{label:"xpos",access:"set"},{label:"ypos",access:"set"}]}],availableNodes:["Display","ExportToGameobject"],difficulty:2}};export{B as L,A as c,h as g,V as i};
